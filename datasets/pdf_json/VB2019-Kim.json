{
    "title": "VB2019-Kim",
    "text": "KimsukyGroup : Track the King of the Spear-Phishing JaekiKim, Kyoung-JuKwak, Min-Chang Jang@Financial Security Institute2019.10.042/155 §JAEKI KIM (a.k.aJACK2)§Malware & Threat  Analysis§Computer Emergency Analysis Team @FSI (2016~ )§Main Author of Threat Intelligence Report ‘Campaign DOKKAEBI’§Speaker of DOKKAEBI: Documents of Korean and Evil Binary @VB2018§Digital Forensic§CECRC @NEC(National Election Commission) (2016)§M.S. degree -Information Security §SANE Lab, Korea University (2014 ~ 2016)§Interest in Analysis§Mentor of Best of the Best(B.O.B) Program(Vulnerability Analysis Track) @KITRI§Member of “KOREANBADASS”, “SeoulPlusBadass” Team@DEFCON CTF Finalist (2017, 2018, 2019)§SNS(facebook,twitter) @2runjack2About Me 3/155 About Me§Kyoung-juKWAK§Manager of FSI Threat Analysis Team (~Jan.2019)§Manager of FSI Security Operations Center (Current)§Adjunct Professor, Department of Forensics, @SungKyunKwanUniversity§Main Author of Threat Intelligence Report “Campaign Rifle : Andariel, The Maiden of Anguish”§Member of National Police Agency Cybercrime Advisory Committee§Speaker of {Blackhat, Kaspersky SAS, Kaspersky CSW, PACSEC, HITCON,HACKCON, ISCR, etc}§SNS(facebook,twitter) @kjkwak12  4/155 About Me▪Min-Chang Jang (a.k.aOSIRIS)A manager of CEATComputer Emergency Analysis Team @FSI (2014~ )Main Author of Threat Intelligence Report ‘Shadow Voice’A graduate student (M.S degree)SANE Lab, Korea University (2014 ~ Now)Served in the Korea NAVY CERTInterest in Extreme SportsSpeaker of {BlackHatEurope & Asia, KIMCHI CON, CODE BLUE}SNS (fb: mins4416, twt: 051R15) 5/155 About Us▪Threat Intelligence Report http://www.fsec.or.kr/user/bbs/fsec/163/344/bbsDataList.doANDARIEL (2017.07), DOKKAEBI(2018.08),ShadowVoice(2018.12) 6/155 Contents§Introduction§Related Cases§Toolset characteristics§Tracking Malware & Monitoring C&C§Relationships§Recent Trends§Conclusion7/155 Contents§Introduction§Related Cases§Toolset characteristics§Tracking Malware & Monitoring C&C§Relationships§Recent Trends§Conclusion8/155 §JAEKI KIM (a.k.aJACK2)§Malware & Threat  Analysis§Computer Emergency Analysis Team @FSI (2016~ )§Main Author of Threat Intelligence Report ‘Campaign DOKKAEBI’§Speaker of DOKKAEBI: Documents of Korean and Evil Binary @VB2018§Digital Forensic§CECRC @NEC(National Election Commission) (2016)§M.S. degree -Information Security §SANE Lab, Korea University (2014 ~ 2016)§Interest in Analysis§Mentor of Best of the Best(B.O.B) Program(Vulnerability Analysis Track) @KITRI§Member of “KOREANBADASS”, “SeoulPlusBadass” Team@DEFCON CTF Finalist (2017, 2018, 2019)§SNS(facebook,twitter) @2runjack2About Me DOKKAEBI: Documents of Korean and Evil Binary JaekiKim, Kyoung-JuKwak, Min-Chang Jang@Financial Security Institute2018.10.03 10/155 Introduction§Campaign DOKKAEBI §A set of Operation carried out by Threat Groups  §using malicious Hangul documentsfor some particular purpose§Related Threat Groups§Bluenoroff, Kimsuky, Scarcruft§Ddddddd§Dddddddd§Ddddd§d Hangul documents and dropped(downloaded) malware=> Documents Of KoreanAnd Evil BinaryCampaignDOKKAEBIBluenoroffKimsukyScarcruft11/155 Introduction§Related Threat GroupsThreat GroupTargetPurposeActivity TimeMajor IncidentBluenoroffGlobal and Korean domestic financial  companiesOfficials and users of crypto-currency exchangesConfidential information takeover and monetary gain (SWIFT, crypto-currency)2015 ~SWIFT illegal transaction of central bank of BangladeshKimsukyInfrastructure, Government, North Korean defectors and politiciansInformation gathering and social confusion2013 ~KHNP cyber terrorism (2014)ScarcruftDiplomatic and North Korean Human Rights Organizations and PeopleInformation gathering and information destruction purposes2016 ~Attack using Flash Zero Day (CVE-2016-4171, CVE-2018-4878)12/155 §Related Threat GroupsThreat GroupTargetPurposeActivity TimeMajor IncidentKimsukyInfrastructure, Government, North Korean defectors and politiciansInformation gathering and social confusion2013 ~KHNP cyber terrorism (2014) Introduction13/155 Introduction§KimsukyGroup§The kimsukyoperation: a north koreanapt? (Kaspersky, 2013.09)14/155 Introduction§KimsukyGroup§The kimsukyoperation: a north koreanapt? (Kaspersky, 2013.09)§KHNP (Korea Hydro & Nuclear Power) cyber terrorism attacks (2014.12)15/155 Introduction§KimsukyGroup§The kimsukyoperation: a north koreanapt? (Kaspersky, 2013.09)§KHNP (Korea Hydro & Nuclear Power) cyber terrorism attacks (2014.12)§Still active as of 201916/155 Contents§Introduction§Related Cases§Toolset characteristics§Tracking Malware & Monitoring C&C§Relationships§Recent Trends§Conclusion17/155 Related Cases§2019.01. ~  Reference : https://www.koreatimes.co.kr/www/nation/2019/01/356_261573.html18/155 Related Cases §Known as Variously Operations§Cobra Vennom,Kitty Phishing,KabarCobra…Reference :https://blog.alyac.co.kr/2066https://threatrecon.nshc.net/2019/01/30/operation-kitty-phishing/https://global.ahnlab.com/global/upload/download/techreport/[Analysis_Report]Operation%20Kabar%20Cobra%20(1).pdfKimsukyAttacks Journalist and a Cryptocurrency Business in South Korea (2019.02.11, Kaspersky)19/155 Contents§Introduction§Related Cases§Toolset characteristics§Tracking Malware & Monitoring C&C§Relationships§Recent Trends§Conclusion20/155 Toolset characteristics§Server-side Toolkits & Malware  21/155 Toolset characteristics§Server-side Toolkits (for Spear-Phishing)§1) Mailer –shape§2) Mailer –core§3) Beaconer§4) Phisher§5) Logger22/155 Toolset characteristics§Server-side Toolkits (for Spear-Phishing)§1) Mailer –shape §2) Mailer -core§3) Beaconer§4) Phisher§5) Logger 23/155 Toolset characteristics§Server-side Toolkits (for Spear-Phishing)§1) Mailer -shape §2) Mailer –core§3) Beaconer§4) Phisher§5) Logger Reference :  24/155 Toolset characteristics§Server-side Toolkits (for Spear-Phishing)§1) Mailer -shape §2) Mailer -core§3) Beaconer§4) Phisher§5) Logger25/155 Toolset characteristics §Server-side§1) Mailer -shape §2) Mailer -core§3) Beaconer§4) Phisher26/155 Toolset characteristics §Server-side(for Spear-Phishing)§4) Phisher§5) Logger27/155 Toolset characteristics §Server-side(for Spear-Phishing)§4) Phisher§5) Logger 28/155 Toolset characteristics§Malware §6) Dropper –Malicious HWP Documents§7) Dropper –Camouflaged HWP Documents§8) Script§9) Info Stealer Reference : 29/155 Toolset characteristics Reference :  §Malware  §Full Image:http://bit.ly/VB2019_IMG_Malware30/155 Toolset characteristics §Malware §7) Dropper –Camouflaged HWP31/155 Toolset characteristics §Malware §9) Info Stealer32/155 Toolset characteristics§Toolsets Reference : NameNo.Type (Tag)ContentsMailer (shape)1MailerMailer (just shape)Mailer (core)2MailerMailer (actual function) 1) Attachment malware 2) Link to phishing page for account takeoverBeaconer3Web-BeaconBeacon to check whether mail is being viewedPhisher4Account StealerPhishingPhishing Toolkit(lod) Phishing Page for Account StealLogger5LoggingPhishingLogging for Phishing Target InformationMalicious HWP6DropperSprear-PhishingMalicious HWP DocumetsCamouflaged HWP7DropperSprear-PhishingCamouflaged HWP Documents (Ex. sfx, exe ...)Script8DownloaderLoggingDownload additional malware and logging (Ex. *.vbs, *.wsf, *.jse, *.ps1)Info Stealer9C&C / DLL / FTPDownloaderLoggingSteal Information of Infected Target and Download additional malware (Ex. Some case using FTP)33/155 Contents§Introduction§Related Cases§Toolset characteristics§Tracking Malware & Monitoring C&C§Relationships§Recent Trends§Conclusion34/155 Tracking Malware & Monitoring C&C§Focus35/155 Tracking Malware & Monitoring C&C§Focus§Attacker 36/155 Tracking Malware & Monitoring C&C§Focus§Attacker != Defender 37/155 Tracking Malware & Monitoring C&C§Focus§Attacker != Defender 38/155 Tracking Malware & Monitoring C&C§Focus§Attacker != Defender : OPSEC FAIL 39/155 Tracking Malware & Monitoring C&C§OPSEC FAIL CASES§1) Directory Listing§2) Leaked FTP Access Information§3) File Download vulnerability40/155 Tracking Malware & Monitoring C&C§OPSEC FAIL CASES§1) Directory Listing41/155 Tracking Malware & Monitoring C&C§[CASE 1-1] Directory Listing –HWP Malware§After “Campaign DOKKAEBI” (H-DS type)42/155 Related Toolset§Toolsets Reference : NameNo.Type (Tag)ContentsMailer (shape)1MailerMailer (just shape)Mailer (core)2MailerMailer (actual function) 1) Attachment malware 2) Link to phishing page for account takeoverBeaconer3Web-BeaconBeacon to check whether mail is being viewedPhisher4Account StealerPhishingPhishing Toolkit(lod) Phishing Page for Account StealLogger5LoggingPhishingLogging for Phishing Target InformationMalicious HWP6DropperSprear-PhishingMalicious HWP DocumetsCamouflaged HWP7DropperSprear-PhishingCamouflaged HWP Documents (Ex. sfx, exe ...)Script8DownloaderLoggingDownload additional malware and logging (Ex. *.vbs, *.wsf, *.jse, *.ps1)Info Stealer9C&C / DLL / FTPDownloaderLoggingSteal Information of Infected Target and Download additional malware (Ex. Some case using FTP)43/155 Related Toolset§Toolsets Reference : NameNo.Type (Tag)ContentsMailer (shape)1MailerMailer (just shape)Mailer (core)2MailerMailer (actual function) 1) Attachment malware 2) Link to phishing page for account takeoverBeaconer3Web-BeaconBeacon to check whether mail is being viewedPhisher4Account StealerPhishingPhishing Toolkit(lod) Phishing Page for Account StealLogger5LoggingPhishingLogging for Phishing Target InformationMalicious HWP6DropperSprear-PhishingMalicious HWP DocumetsCamouflaged HWP7DropperSprear-PhishingCamouflaged HWP Documents (Ex. sfx, exe ...)Script8DownloaderLoggingDownload additional malware and logging (Ex. *.vbs, *.wsf, *.jse, *.ps1)Info Stealer9C&C / DLL / FTPDownloaderLoggingSteal Information of Infected Target and Download additional malware (Ex. Some case using FTP)44/155 Tracking Malware & Monitoring C&C§[CASE 1-1] Directory Listing –HWP Malware 45/155 Tracking Malware & Monitoring C&C§[CASE 1-1] Directory Listing –HWP Malware§Process Hollowing : notepad.exe§core.dll(4de21c3af64b3b605446278de92dfff4)§DLL Name : OneDll.dll§Export Function Name : DllRegisterServer 46/155 Tracking Malware & Monitoring C&C§[CASE 1-1] Directory Listing –HWP Malware§fontchk.jse(f22db1e3ea74af791e34ad5aa0297664)§C&C : suppcrt-seourity[.]esy.es(185.224.138[.]29, NL) 47/155 Tracking Malware & Monitoring C&C§[CASE 1-1] Directory Listing –HWP Malware§fontchk.jse(f22db1e3ea74af791e34ad5aa0297664)§C&C : suppcrt-seourity[.]esy.es(185.224.138[.]29, NL) 48/155 Tracking Malware & Monitoring C&C§Like Sherlock Holmes …§fontchk.jse(f22db1e3ea74af791e34ad5aa0297664)§C&C : suppcrt-seourity[.]esy.es(185.224.138[.]29, NL) 49/155 Tracking Malware & Monitoring C&C§[CASE 1-1] Directory Listing –HWP Malware§fontchk.jse(f22db1e3ea74af791e34ad5aa0297664)§C&C : suppcrt-seourity[.]esy.es(185.224.138[.]29, NL) 50/155 Tracking Malware & Monitoring C&C§C&C -Tracking/Monitoring§fontchk.jse(f22db1e3ea74af791e34ad5aa0297664)§C&C : suppcrt-seourity[.]esy.es(185.224.138[.]29, NL)51/155 Tracking Malware & Monitoring C&C§C&C -Tracking/Monitoring (18.07.10., D+49)§fontchk.jse(f22db1e3ea74af791e34ad5aa0297664)§C&C : suppcrt-seourity[.]esy.es(185.224.138[.]29, NL) 52/155 Tracking Malware & Monitoring C&C§C&C -Tracking/Monitoring (18.07.10., D+49)§fontchk.jse(f22db1e3ea74af791e34ad5aa0297664)§C&C : suppcrt-seourity[.]esy.es(185.224.138[.]29, NL) 53/155 Tracking Malware & Monitoring C&C§C&C -Tracking/Monitoring (18.07.13., D+52)§fontchk.jse(f22db1e3ea74af791e34ad5aa0297664)§C&C : suppcrt-seourity[.]esy.es(185.224.138[.]29, NL) 54/155 Tracking Malware & Monitoring C&C§C&C -Tracking/Monitoring (18.07.13., D+52)§zerobase(53ac231e8091abcd0978124f9268b4e4)§XOR : 0x09FD8477 55/155 Tracking Malware & Monitoring C&C§C&C -Tracking/Monitoring (18.07.13., D+52)§zerobase_xor_09FD8477(MD5: 8b59ea1ee28e0123da82801abc0cce4d)§DLL Name : HanyangUpload_script.dll§Build Time : 2018.07.12. 08:25:45 56/155 Tracking Malware & Monitoring C&C§C&C -Tracking/Monitoring (18.07.13., D+52)§HanyangUpload_script.dll–GetName§1) Get Computer Information (Mac Address, Volume) 57/155 Tracking Malware & Monitoring C&C§C&C -Tracking/Monitoring (18.07.13., D+52)§HanyangUpload_script.dll–GetName§2) Scan Specific Files 58/155 Tracking Malware & Monitoring C&C§C&C -Tracking/Monitoring (18.07.13., D+52)§HanyangUpload_script.dll–GetName§2) Scan Specific Files 59/155 Tracking Malware & Monitoring C&C§C&C -Tracking/Monitoring (18.07.13., D+52)§HanyangUpload_script.dll–GetName§3) C&C  60/155 Tracking Malware & Monitoring C&C§C&C -Tracking/Monitoring (18.07.13., D+52)§HanyangUpload_script.dll–GetName§3) C&C  61/155 Tracking Malware & Monitoring C&C§C&C -Tracking/Monitoring (18.07.13., D+52)§HanyangUpload_script.dll–GetName§3) C&C : www.military[.]co.kr(211.202.2[.]51, KR) 62/155 Tracking Malware & Monitoring C&C§C&C -Tracking/Monitoring (18.07.13., D+52)§HanyangUpload_script.dll–GetName§3) C&C : www.military[.]co.kr(211.202.2[.]51, KR) 63/155 Tracking Malware & Monitoring C&C§[CASE 1-2] Camouflaged as HWP documents64/155 Related Toolset§Toolsets Reference : NameNo.Type (Tag)ContentsMailer (shape)1MailerMailer (just shape)Mailer (core)2MailerMailer (actual function) 1) Attachment malware 2) Link to phishing page for account takeoverBeaconer3Web-BeaconBeacon to check whether mail is being viewedPhisher4Account StealerPhishingPhishing Toolkit(lod) Phishing Page for Account StealLogger5LoggingPhishingLogging for Phishing Target InformationMalicious HWP6DropperSprear-PhishingMalicious HWP DocumetsCamouflaged HWP7DropperSprear-PhishingCamouflaged HWP Documents (Ex. sfx, exe ...)Script8DownloaderLoggingDownload additional malware and logging (Ex. *.vbs, *.wsf, *.jse, *.ps1)Info Stealer9C&C / DLL / FTPDownloaderLoggingSteal Information of Infected Target and Download additional malware (Ex. Some case using FTP)65/155 Related Toolset§Toolsets Reference : NameNo.Type (Tag)ContentsMailer (shape)1MailerMailer (just shape)Mailer (core)2MailerMailer (actual function) 1) Attachment malware 2) Link to phishing page for account takeoverBeaconer3Web-BeaconBeacon to check whether mail is being viewedPhisher4Account StealerPhishingPhishing Toolkit(lod) Phishing Page for Account StealLogger5LoggingPhishingLogging for Phishing Target InformationMalicious HWP6DropperSprear-PhishingMalicious HWP DocumetsCamouflaged HWP7DropperSprear-PhishingCamouflaged HWP Documents (Ex. sfx, exe ...)Script8DownloaderLoggingDownload additional malware and logging (Ex. *.vbs, *.wsf, *.jse, *.ps1)Info Stealer9C&C / DLL / FTPDownloaderLoggingSteal Information of Infected Target and Download additional malware (Ex. Some case using FTP)66/155 Tracking Malware & Monitoring C&C§[CASE 1-2] Camouflaged as HWP documents§SFX 67/155 Tracking Malware & Monitoring C&C§[CASE 1-2] Camouflaged as HWP documents§Flow 68/155 Tracking Malware & Monitoring C&C§[CASE 1-2] Camouflaged as HWP documents§Powershell–Set Registry§Path: \\Windows\\CurrentVersion\\Screensavers§Name: ScreenRibbonsDomain§Value: primary-help.esy.es 69/155 Tracking Malware & Monitoring C&C§[CASE 1-2] Camouflaged as HWP documents§Powershell–Download malware and Execute 70/155 Tracking Malware & Monitoring C&C§5) Powershell–Download§Path: \\Windows\\CurrentVersion\\Screensavers§Name: ScreenRibbonsDomain§Value: primary-help.esy.es§S§Ddddddd§Dddddddd§Ddddd 71/155 Tracking Malware & Monitoring C&C§[CASE 1-2] Camouflaged as HWP documents§Return! (2019.04.01.)72/155 Tracking Malware & Monitoring C&C§[CASE 1-2] Camouflaged as HWP documents§Return! (2019.04.01.) 73/155 Tracking Malware & Monitoring C&C§[CASE 1-2] Camouflaged as HWP documents§Return! (2019.04.01.)§Directory Listing àMailer +_+ 74/155 Tracking Malware & Monitoring C&C§[CASE 1-2] Camouflaged as HWP documents§Return! (2019.04.01.)§Mailer –shape & core 75/155 Tracking Malware & Monitoring C&C§[CASE 1-2] Camouflaged as HWP documents§Return! (2019.04.01.)§Mailer –shape & core 76/155 Tracking Malware & Monitoring C&C§[CASE 1-2] Camouflaged as HWP documents§Return! (2019.04.01.)§Mailer –shape & core 77/155 Tracking Malware & Monitoring C&C§[CASE 1-2] Camouflaged as HWP documents§Self-Testing using My Email 78/155 Tracking Malware & Monitoring C&C§[CASE 1-2] Camouflaged as HWP documents§Self-Testing using My Email=> Sending normally 79/155 Tracking Malware & Monitoring C&C§[CASE 1-2] Camouflaged as HWP documents§Check Email (Sent by mailer) 80/155 Tracking Malware & Monitoring C&C§[CASE 1-2] Camouflaged as HWP documents§Check Email§Attachment from Daum: 시사회.zip (시사회.vbs)§Web Beacon: hxxp://[C&C]/_log/reading.php?uid=[E-mail] 81/155 Tracking Malware & Monitoring C&C§OPSEC FAIL CASES§1) Directory Listing => Detect New Malware & Mailer82/155 Tracking Malware & Monitoring C&C§OPSEC FAIL CASES§1) Directory Listing : Detect New Malware & Mailer§2) Leaked FTP Access Information83/155 Related Toolset§Toolsets Reference : NameNo.Type (Tag)ContentsMailer (shape)1MailerMailer (just shape)Mailer (core)2MailerMailer (actual function) 1) Attachment malware 2) Link to phishing page for account takeoverBeaconer3Web-BeaconBeacon to check whether mail is being viewedPhisher4Account StealerPhishingPhishing Toolkit(lod) Phishing Page for Account StealLogger5LoggingPhishingLogging for Phishing Target InformationMalicious HWP6DropperSprear-PhishingMalicious HWP DocumetsCamouflaged HWP7DropperSprear-PhishingCamouflaged HWP Documents (Ex. sfx, exe ...)Script8DownloaderLoggingDownload additional malware and logging (Ex. *.vbs, *.wsf, *.jse, *.ps1)Info Stealer9C&C / DLL / FTPDownloaderLoggingSteal Information of Infected Target and Download additional malware (Ex. Some case using FTP)84/155 Related Toolset§Toolsets Reference : NameNo.Type (Tag)ContentsMailer (shape)1MailerMailer (just shape)Mailer (core)2MailerMailer (actual function) 1) Attachment malware 2) Link to phishing page for account takeoverBeaconer3Web-BeaconBeacon to check whether mail is being viewedPhisher4Account StealerPhishingPhishing Toolkit(lod) Phishing Page for Account StealLogger5LoggingPhishingLogging for Phishing Target InformationMalicious HWP6DropperSprear-PhishingMalicious HWP DocumetsCamouflaged HWP7DropperSprear-PhishingCamouflaged HWP Documents (Ex. sfx, exe ...)Script8DownloaderLoggingDownload additional malware and logging (Ex. *.vbs, *.wsf, *.jse, *.ps1)Info Stealer9C&C / DLL / FTPDownloaderLoggingSteal Information of Infected Target and Download additional malware (Ex. Some case using FTP)85/155 Tracking Malware & Monitoring C&C§[CASE 2] Leaked FTP Access Information§Malicious Script (Delivered-Email.wsf) Reference : https://twitter.com/anyrun_app/status/1115513990711521280 86/155 Tracking Malware & Monitoring C&C§[CASE 2] Leaked FTP Access Information§Malicious Script (Delivered-Email.wsf)§1) Additional Malware download from C&C§2) Open Email (Normal file)§3) Execute Malware (Info Stealer)§4) FTP Upload 87/155 Tracking Malware & Monitoring C&C§[CASE 2] Leaked FTP Access Information§Malicious Script (Delivered-Email.wsf)§1) Additional Malware download from C&C§2) Open Email (Normal Email)§3) Execute Malware (Info Stealer)§4) FTP Upload 88/155 Tracking Malware & Monitoring C&C§[CASE 2] Leaked FTP Access Information§Malicious Script (Delivered-Email.wsf)§1) Additional Malware download from C&C§2) Open Email (Normal file)§3) Execute Malware (Info Stealer)§4) FTP Upload 89/155 Tracking Malware & Monitoring C&C§[CASE 2] Leaked FTP Access Information§Malicious Script (Delivered-Email.wsf)§1) Additional Malware download from C&C§2) Open Email (Normal file)§3) Execute Malware (Info Stealer)§4) FTP Upload 90/155 Tracking Malware & Monitoring C&C§[CASE 2] Leaked FTP Access Information§OPSEC FAIL!§4) FTP Upload 91/155 Tracking Malware & Monitoring C&C§[CASE 2] Leaked FTP Access Information§C&C : FTP Upload §Free Hosting Service (Hostinger) §Compromised website in South Korea§Love victory&rhdwn(공주->princess)92/155 Tracking Malware & Monitoring C&C§[CASE 2] Leaked FTP Access Information§OPSEC FAIL!§4) FTP Upload 93/155 Tracking Malware & Monitoring C&C§[CASE 2] Leaked FTP Access Information§OPSEC FAIL!§4) FTP Upload 94/155 Tracking Malware & Monitoring C&C§[CASE 2] Leaked FTP Access Information§OPSEC FAIL!§4) FTP Upload 95/155 Tracking Malware & Monitoring C&C§[CASE 2] Leaked FTP Access Information§Free Hosting Service (Hostinger)§Love victory&rhdwn(공주->princess) 96/155 Tracking Malware & Monitoring C&C§[CASE 2] Leaked FTP Access Information§Free Hosting Service (Hostinger)§Love victory -> WebshellPassword 97/155 Tracking Malware & Monitoring C&C§OPSEC FAIL CASES§1) Directory Listing : Detect New Malware & Mailer§2) Leaked FTP Access Information=> Get Server-side toolkit98/155 Tracking Malware & Monitoring C&C§OPSEC FAIL CASES§1) Directory Listing : Detect New Malware & Mailer§2) Leaked FTP Access Information : Get Server toolkit§3) File Download vulnerability99/155 Related Toolset§Toolsets Reference : NameNo.Type (Tag)ContentsMailer (shape)1MailerMailer (just shape)Mailer (core)2MailerMailer (actual function) 1) Attachment malware 2) Link to phishing page for account takeoverBeaconer3Web-BeaconBeacon to check whether mail is being viewedPhisher4Account StealerPhishingPhishing Toolkit(lod) Phishing Page for Account StealLogger5LoggingPhishingLogging for Phishing Target InformationMalicious HWP6DropperSprear-PhishingMalicious HWP DocumetsCamouflaged HWP7DropperSprear-PhishingCamouflaged HWP Documents (Ex. sfx, exe ...)Script8DownloaderLoggingDownload additional malware and logging (Ex. *.vbs, *.wsf, *.jse, *.ps1)Info Stealer9C&C / DLL / FTPDownloaderLoggingSteal Information of Infected Target and Download additional malware (Ex. Some case using FTP)100/155 Related Toolset§Toolsets Reference : NameNo.Type (Tag)ContentsMailer (shape)1MailerMailer (just shape)Mailer (core)2MailerMailer (actual function) 1) Attachment malware 2) Link to phishing page for account takeoverBeaconer3Web-BeaconBeacon to check whether mail is being viewedPhisher4Account StealerPhishingPhishing Toolkit(lod) Phishing Page for Account StealLogger5LoggingPhishingLogging for Phishing Target InformationMalicious HWP6DropperSprear-PhishingMalicious HWP DocumetsCamouflaged HWP7DropperSprear-PhishingCamouflaged HWP Documents (Ex. sfx, exe ...)Script8DownloaderLoggingDownload additional malware and logging (Ex. *.vbs, *.wsf, *.jse, *.ps1)Info Stealer9C&C / DLL / FTPDownloaderLoggingSteal Information of Infected Target and Download additional malware (Ex. Some case using FTP)101/155 Tracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§EML –HWP Attachment 102/155 Tracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§EML –HWP Attachment§Distribution Server : member-authorize[.]com 103/155 Tracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§EML –HWP Attachment§Distribution Server : member-authorize[.]com 104/155 Tracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§1) HWP§EPS(Encapsulated Postscript), Summary Information (X) 105/155 Tracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§2) Powershell§Get Malicious Script from ddlove[.]kr 106/155 Tracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§3) 1.wsf§(a) Set var§(b) Check Extract Util–WinRAR / ALZip§(c) Check Response§(d) Save File & Extract§(e) or Save File & Decoding §(f) Execute file107/155 Tracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§3) 1.wsf§(a) Set var§(b) Check Extract Util–WinRAR / ALZip§(c) Check Response§(d) Save File & Extract§(e) or Save File & Decoding §(f) Execute file 108/155 Tracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§4) Freedom.dll§Timestamp : Tue Jan 08 09:02:00 2019§Export : GrapHouse§Check Env (32/64)§64bit : /bbs/data/font/exts.fmt§Process Hollwing(explorer.exe)§[SND]: /register.php?WORD=com_XXXXXXXX&NOTE=§[GET]: /bbs/data/ariaK[T]_XXXXXXXX§[DEL]: /join.php?file=109/155 Tracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§4) Freedom.dll§Timestamp : Tue Jan 08 09:02:00 2019§Export : GrapHouse§Check Env (32/64)§64bit : /bbs/data/font/exts.fmt§Process Hollwing(explorer.exe)§[SND]: /register.php?WORD=com_XXXXXXXX&NOTE=§[GET]: /bbs/data/ariaK[T]_XXXXXXXX§[DEL]: /join.php?file= 110/155 Tracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§4) Freedom.dll§Timestamp : Tue Jan 08 09:02:00 2019§Export : GrapHouse§Check Env (32/64)§64bit : /bbs/data/font/exts.fmt§Process Hollwing(explorer.exe)§[SND]: /register.php?WORD=com_XXXXXXXX&NOTE=§[GET]: /bbs/data/ariaK[T]_XXXXXXXX§[DEL]: /join.php?file= 111/155 Tracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§EML –HWP Attachment§Distribution Server : member-authorize[.]com 112/155 Tracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing (OPSEC FAIL –CASE #01)§/security/downloads 113/155 Tracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing (OPSEC FAIL –CASE #01)§/security/downloads/download.php 114/155 Tracking Malware & Monitoring C&C§Like Sherlock Holmes … again§fontchk.jse(f22db1e3ea74af791e34ad5aa0297664)§C&C : suppcrt-seourity[.]esy.es(185.224.138[.]29, NL) 115/155 Tracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Try to File download§/security/downloads/download.php?fileName=dowonload.php 116/155 Tracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Try to file download§/security/downloads/download.php?fileName=dowonload.php 117/155 Tracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing + File download§../../../../../../../home/u385698457/public_html/  118/155 Tracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing + File download§../../../../../../../home/u385698457/public_html/  119/155 Tracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing + File download§../../../../../../../home/u385698457/public_html/  120/155 Tracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing + File download§../../../../../../../home/u385698457/public_html/ §Languagesused only inNorth Korea 121/155 Tracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing + File download§../../../../../../../home/u385698457/public_html/  122/155 Tracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing + File download§../../../../../../../home/u385698457/public_html/  123/155 Tracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing + File download§github.com/ostoc/http2_php/miniProxy.php 124/155 Tracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing + File download§/security/mailer 125/155 Tracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing + File download§/security/mailer 126/155 Tracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing + File download§/security/mailer 127/155 Tracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing + File download§/security/mailer 128/155 Tracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing + File download§/security/mailer 129/155 Tracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing + File download§1) mail.php 130/155 Tracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing + File download§2) mail_ok.php-attachFileName 131/155 Tracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing + File download§2) mail_ok.php–Phishing (Previous) 132/155 Contents§Introduction§Related Cases§Toolset characteristics§Tracking Malware & Monitoring C&C§Relationships§Recent Trends§Conclusion133/155 Relationships§Like Sherlock Holmes …§fontchk.jse(f22db1e3ea74af791e34ad5aa0297664)§C&C : suppcrt-seourity[.]esy.es(185.224.138[.]29, NL) 134/155 Relationships§[CASE 1-1] Directory Listing –HWP Malware§fontchk.jse(f22db1e3ea74af791e34ad5aa0297664)§C&C : suppcrt-seourity[.]esy.es(185.224.138[.]29, NL) 135/155 Relationships§BetweenToolsetsand C&C server§Compromised website in South Korea§Cooperation with the police and investigation agency§Respond about C&C server 136/155 Relationships§Toolsets Reference : NameNo.Type (Tag)ContentsMailer (shape)1MailerMailer (just shape)Mailer (core)2MailerMailer (actual function) 1) Attachment malware 2) Link to phishing page for account takeoverBeaconer3Web-BeaconBeacon to check whether mail is being viewedPhisher4Account StealerPhishingPhishing Toolkit(lod) Phishing Page for Account StealLogger5LoggingPhishingLogging for Phishing Target InformationMalicious HWP6DropperSprear-PhishingMalicious HWP DocumetsCamouflaged HWP7DropperSprear-PhishingCamouflaged HWP Documents (Ex. sfx, exe ...)Script8DownloaderLoggingDownload additional malware and logging (Ex. *.vbs, *.wsf, *.jse, *.ps1)Info Stealer9C&C / DLL / FTPDownloaderLoggingSteal Information of Infected Target and Download additional malware (Ex. Some case using FTP)137/155 Relationships§Between Toolsets and C&C server§fontchk.jse(f22db1e3ea74af791e34ad5aa0297664)§C&C : suppcrt-seourity[.]esy.es(185.224.138[.]29, NL) 138/155 Relationships§Between Toolsets and C&C server§fontchk.jse(f22db1e3ea74af791e34ad5aa0297664)§C&C : suppcrt-seourity[.]esy.es(185.224.138[.]29, NL) 139/155 Relationships§Between Toolsets and C&C server§fontchk.jse(f22db1e3ea74af791e34ad5aa0297664)§C&C : suppcrt-seourity[.]esy.es(185.224.138[.]29, NL) 140/155 Relationships §BetweenToolsetsand C&C server§Some of the results of analyzing§gyjmc[.]com (KR) → member-authorize[.]com (HOSTINGER) → ddlovke[.]kr(KR) → military[.]co.kr(KR) ← suppcrt-seourity[.]esy.es(HOSTINGER) Full ver. : http://bit.ly/VB2019_Kimsuky_Maltego141/155 Contents§Introduction§Related Cases§Toolset characteristics§Tracking Malware & Monitoring C&C§Relationships§Recent Trends§Conclusion142/155 Recent Trends§[CASE 3] File Download vulnerability§Directory Listing (OPSEC FAIL –CASE #01)§/security/downloads 143/155 Recent Trends§[CASE 3] File Download vulnerability§Directory Listing (OPSEC FAIL –CASE #01)§/security/downloads 144/155 Recent Trends§[CASE 3] File Download vulnerability§Directory Listing : New Malware§F:\\PC_Manager\\Utopia_v0.1\\bin\\AppleSeed.pdb 145/155 Recent Trends§[CASE 1-1] Directory Listing –HWP Malware§HanyangUpload_script.dll–GetName(2018.07.13)§3) C&C : www.military[.]co.kr(211.202.2[.]51, KR) 146/155 Recent Trends§[CASE 1-1] Directory Listing –HWP Malware§Another Logs (2019.07.)=>NUCLEAR§3) C&C : www.military[.]co.kr(211.202.2[.]51, KR) 147/155 §Related Threat GroupsThreat GroupTargetPurposeActivity TimeMajor IncidentKimsukyInfrastructure, Government, North Korean defectors and politiciansInformation gathering and social confusion2013 ~KHNP cyber terrorism (2014) Recent Trends148/155 Contents§Introduction§Related Cases§Toolset characteristics§Tracking Malware & Monitoring C&C§Relationships§Recent Trends§Conclusion149/155 Conclusion§Incidents Response in advance §Geopolitical location in South Korea§Tracking&Monitoring+ @§REMEMBER -Obtained various information through like OPSEC FAIL CASES§Share Information§Cooperate with Relevant agency for Response150/155 Thank you :)Special Thanks:SeongsuPark(@unpacker) @GReATamur84 @National Police Agencyhypen1117E –mail : jack2@fsec.or.krTwitter @2runjack2Q&A"
}