{
    "title": "new zero-day exploit targeting internet explorer versions 9 through 11 identified in targeted attacks _ fireeye inc",
    "text": "Threat Research new Zero-Day Exploit ta rgeting Internet Explorer Versions 9 through 11 Identified in Targeted attack s april 27, 2014 | by Xiaobo Chen , Mike Scott , Dan Ca selden ZERO-DaY Summary FireEye Research Labs identified a new Internet Explorer (IE) zero-day exploit used in targeted attacks.  The vulnerability affect s IE6 through IE11, but the attack i s targeting IE9 through IE11.  This zero-day bypa sses both aSLR an d DEP. Microsoft has assigned CVE-2014-1776 to the v ulnerability an d released security advisory to track this issue. Threat acto rs are actively using this exploit in an ongoing campaign which we have name d \"Operation Clandestine Fox.\" However, for many reasons, we will not p rovide campaign details. But we believe thi s is a significant zero day as the vulnerable ve rsions represent abo ut a quarter of the total b rowser market. We recommen d applying a patch once available. according to netMarket Sha re, the ma rket share for the targeted versions of IE in 2013  were: IE 9      13.9% IE 10    11.04% IE 11     1.32% Collectively, in 2013 , the vulnerable ve rsions of IE accounted for 26.25% of the b rowser market.  The vulnerability, ho wever, does appear in IE6 through IE11 though the exploit ta rgets IE9 and higher.   The Detail s   The exploit leve rages a previously unknown use-after-free vulnerability, an d uses a well-known Flash exploitation techniq ue to achieve a rbitrary memo ry access and bypass Windows’ aSLR an d DEP protection s.   Exploitation     • Preparing the heap   The exploit page loa ds a Flash SWF file to manip ulate the heap layo ut with the common techniq ue heap feng shui. It allocate s Flash vecto r objects to spray memo ry and cover address 0x18184000. next, it allocate s a vector object that contain s a flash.Media.Sound() object, which it late r corrupts to pivot cont rol to its ROP chain.   • arbitrary memo ry access   The SWF file call s back to Java script in IE to trigger the IE bug and overwrite the length fiel d of a Fla sh vecto r object in the heap spray. The SWF file loop s through the heap spray to fin d the corrupted vector object, an d uses it to again mo dify the length of anothe r vector object. Thi s other corrupted vector object i s then used for subsequent memo ry accesses, which it then uses to bypa ss aSLR an d DEP.   • Runtime ROP gene ration   With full memo ry control, the exploit will search for ZwProtectVi rtualMemo ry, and a stack pivot (opco de 0x94 0xc3) from nTDLL. It also searches for SetThreadContext  in kernel32, which is used to clea r the debug registers. This techniq ue, may be an attempt to bypa ss protection s that use hardware breakpoint s, such as EMET’s EaF mitigation. With the a ddresses of the afo rementione d aPIs and gadget, the SWF file con structs a ROP chain, an d prepends it to its RC4 decrypted shellcode. It then replaces the vftable of a sound object with a fake one that point s to the newly created ROP payloa d. When the sound object attempt s to call into it s vftable, it in stead pivots control to the attacke r’s ROP chain.   • ROP an d Shellco de   The ROP payloa d basically tries to make memo ry at 0x18184000 executable, an d to return to 0x1818411c to execute the shellcode.   0:008> dds eax   18184100  770b5f58 ntdll!ZwProtectVi rtualMemo ry 18184104  1818411c 18184108  ffffffff 1818410c  181840e8 18184110  181840ec 18184114  000000 40 18184118  181840e4   Inside the shellcode, it saves the current stack pointe r to 0x18181800  to safely return to the calle r.   mov     dword ptr ds:[18181800h],ebp   Then, it restores the flash.Media.Sound vftable an d repairs the corrupted vector object to avoi d application  Email Up dates Information an d insight on to day's advanced threats from FireEye. SHaRE Recent Po sts 09 Mar 2020 24 Feb 2020 20 Feb 2020 RSS FEED: STaY CO nnECTEDFirst name Last name Email address Company name Threat Research Blog FireEye Stories Blog Industry Perspective s Blog Yes, I would like to receive communication s from FireEye. Please read more about our information collection an d use. SUBSCR IBE Crescendo: Real Time Event Vie wer for macOS   Ransomware again st the Machine: How adversaries are Learning to Disrupt Industrial Production by Targeting IT and OT  M-Trends 2020 : Insights From the Front Line s   Home  FireEye Blog s Threat Research  april 2014 Threat Research Blog Po sts  new Zero-Day Exploit ta rgeting Internet Explorer V...     Solutions Services Customers Partners Resources Company   PREVIOUS POST nEXT POSTcrashes.   18184123 b820609f06      mov     eax,69F6020h   18184128 90              nop 18184129 90              nop 1818412a c700c0f22169     mov     dword ptr [eax],off set Flash32_11_7_700_261!adobeCPGetaP I+0x42ac00 (6921 f2c0) 18184133 b800401818       mov     eax, 18184000h 18184138 90              nop 18184139 90              nop 1818413a c700fe030000     mov     dword ptr [eax],3FEh ds:0023 :18184000=3ffffff0   The shellcode also recovers the ESP register to make sure the stack range is in the c urrent thread stack base/limit.   18184140 8be5            mov     esp,ebp   18184142 83ec2c          sub     esp,2Ch 18184145 90              nop 18184146 eb2c            jmp     18184174   The shellcode calls SetThreadContext to clea r the debug registers. It is possible that thi s is an attempt to bypa ss mitigation s that use the debug registers.   18184174 57              push    edi   18184175 81ece0050000     sub     esp,5E0h 1818417b c7042410000100   mov     dword ptr [esp],10010 h 18184182 8d7c2404        lea     e di,[esp+4] 18184186 b9dc050000       mov     ecx, 5DCh 1818418b 33c0            xo r     eax,eax 1818418d f3aa            rep stos byte pt r es:[edi] 1818418f 54              p ush    esp 18184190 6afe            p ush    0FFFFFFF Eh 18184192 b8b308b476      mov     eax,off set kernel32!SetThreadContext (7 6b408b3) 18184197 ffd0            call    eax   The shellcode calls URLDownloadToCacheFilea to download the next stage of the payloa d, disguised as an image.   Mitigation   Using EMET may b reak the exploit in yo ur environment an d prevent it f rom successfully cont rolling yo ur computer. EMET versions 4.1 and 5.0 break (an d/or detect) the exploit in o ur tests. Enhance d Protected Mode in IE breaks the exploit in o ur tests. EPM was introduced in IE10. additionally, the attack will not work without adobe Fla sh. Disabling the Fla sh plugin within IE will prevent the exploit f rom functioning.   Threat Group History   The aPT g roup responsible for this exploit ha s been the fi rst group to have acce ss to a select number of browser-based 0-day exploit s (e.g. IE, Firefox, an d Flash) in the pa st. They a re extremely p roficient at late ral movement an d are difficult to track, as they typically do not reuse comman d and control infrastructure. They have a n umber of back doors including one kno wn as Pirpi that we previously discussed here. CVE-2010 -3962 , then a 0-day exploit in Internet Explorer 6, 7, and 8 dropped the Pirpi payloa d discussed in this previous case. as this is still an active inve stigation we are not releasing further indicators about the exploit at thi s time. acknowledgement: We thank Ch ristopher Glyer, Matt Fo wler, Josh Homan, ned Moran, nart Villene uve and Yichong Lin fo r their support, research, and analysis on these findings.   Company Why Fi reEye? Customer Stories Careers Certification s and Compliance Investor Relation s Supplier Documents  news and Events newsroom Press Releases Webina rs Events awards and Honors Email Preferences Technical S upport Incident? Report Security Issue Contact S upport Customer Portal Communities Documentation Po rtal FireEye Blog s Threat Research FireEye Stories Industry Perspective s Threat Map View the Late st Threats Contact U s +1 877-347-3393   Stay Connecte d  Copyright   2020  FireEye, Inc. all rights reserved.  Privacy & Cookie s Policy  | Privacy Shiel d | Legal Doc umentationSite Lang uage English  "
}