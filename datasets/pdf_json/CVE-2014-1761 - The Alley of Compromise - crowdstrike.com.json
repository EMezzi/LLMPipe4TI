{
    "title": "CVE-2014-1761 - The Alley of Compromise - crowdstrike.com",
    "text": "01/04/24, 21:15CVE-2014-1761 - The Alley of Compromise - crowdstrike.com Pagina 1 di 13https://www.crowdstrike.com/blog/cve-2014-1761-alley-compromise/×\"  Search CVE-2014-1761 – The Alley of CompromiseOctober 29, 2014 Chris Dietrich Counter Adversary Operations A significant fraction of targeted attacks involve spearphishing emails with malicious lure documents that, whenopened, exploit a vulnerability in the document viewerapplication to invoke a backdoor executable. As such, it doesnot come as a big surprise that zero-day exploits for CVE-2014-1761, a recent vulnerability in Microsoft Word, made\"✉ |BLOGFeatured⌄Recent⌄Videos⌄Categories⌄Start Free Trial01/04/24, 21:15CVE-2014-1761 - The Alley of Compromise - crowdstrike.com Pagina 2 di 13https://www.crowdstrike.com/blog/cve-2014-1761-alley-compromise/their way into the toolkit of multiple adversaries. In this blogpost, we provide an overview of how and when these groupsstarted to leverage this new vulnerability in their campaigns.Zero-Day Activities Around CVE-2014-1761Before diving into the timeline of adversary activity involvingCVE-2014-1761, here are some key facts about thevulnerability. Microsoft’s advisory credits the Google SecurityTeam with the discovery of a memory corruption bug in thecode that handles the parsing of Rich Text Format (RTF)documents that can be exploited to execute arbitrary code onthe target machine. Since RTF spans a wide variety ofMicrosoft products, this vulnerability is particularly well suitedfor malicious activity. As will be described later in more detail,exploits for this vulnerability have become popular amongtargeted attack actors, especially in the second quarter of2014. Let’s take a look at how the events unfolded aroundCVE-2014-1761. 01/04/24, 21:15CVE-2014-1761 - The Alley of Compromise - crowdstrike.com Pagina 3 di 13https://www.crowdstrike.com/blog/cve-2014-1761-alley-compromise/The figure above shows a timeline of events regarding CVE-2014-1761 in first half of 2014. Events above the x-axis markgeneral adversary activity related to CVE-2014-1761, andevents below the x-axis refer to (re-)actions of the securitycommunity and vendors. While the exact date of discovery isnot known, the first public reference to CVE-2014-1761 wasmade when its MITRE CVE entry was created on 29 January2014. On 24 March 2014, Microsoft announced its SecurityAdvisory 2953095, which confirmed the vulnerability. Abouttwo weeks later, on 8 April 2014, Microsoft published patchesto fix the vulnerability along with Security Bulletin MS14-017.First Activity Leveraging the VulnerabilityInterestingly, even before the acknowledgement of thevulnerability, CrowdStrike witnessed malicious documentsexploiting CVE-2014-1761 in order to drop non-targetedcrimeware already in mid-March 2014. The time period whereno patch is available is typically referred to as the classiczero-day period. In this time frame, we spotted two interestingtargeted attack incidents. In one of them, an actor of likelyChinese origin leveraged CVE-2014-1761 in a targeted attackagainst Taiwanese institutions. In this case, the exploitdocument (MD5 hash d7c45971ea35ba2ba4902a58732f8e85)dropped the Taidoor malware, a Remote Access Tool (RAT)often observed with Chinese actors. In addition, andunrelated to the Taidoor incident, an exploit document thatdrops the Miniduke malware has been witnessed (MD5 hash6b08ff05b50dd89d81e2aa47554aa5e6). Both attacks areassumed to have taken place in close timely proximity, butprior to the release of Microsoft’s Security Bulletin.Diversiﬁcation of the Exploits and the Shellcode Involved01/04/24, 21:15CVE-2014-1761 - The Alley of Compromise - crowdstrike.com Pagina 4 di 13https://www.crowdstrike.com/blog/cve-2014-1761-alley-compromise/After patches have been released, another actor ofpresumably Chinese origin who exploited CVE-2014-1761appeared. Exploits by this actor use a distinct shellcode thatis different from what has been observed in attacks by othergroups: A minimalistic shellcode connects to a remote hostvia TCP to request a second-stage shellcode buffer.Interestingly, in most of the cases, the remote location isactually an RFC1918 IP address, as it is typically used inlocal area networks. As these IP addresses were scatteredover several different RFC1918 IP address ranges (14different /24 networks), this could indicate that this activitywas part of lateral movement instead of an initial compromise.Figure 2 shows an excerpt of the disassembly of one suchshellcode that attempts to download the second-stage codefrom the IP address 192.168.11.104. 01/04/24, 21:15CVE-2014-1761 - The Alley of Compromise - crowdstrike.com Pagina 5 di 13https://www.crowdstrike.com/blog/cve-2014-1761-alley-compromise/PITTY PANDAWhile the cases discussed above already provided interestinginsights into adversary behavior, it was PITTY PANDA – aChinese actor that we’ve been tracking for quite some time –that really caught our attention. Most likely in preparation ofsubsequent attacks, on 5 May 2014, PITTY PANDA begantesting exploit documents that leverage CVE-2014-1761 bysubmitting them to VirusTotal. All of these documents carriedbenign binaries and test decoy documents. An example is thefile with the MD5 hash ofa1cc433f5c09694cf707116dec6c44c5. Only a few days later,on 12 May 2014, PITTY PANDA conducted the first actualattack with a document prepared to exploit CVE-2014-1761(MD5 hash 2b3149926ebced31284867e71648094b). Aftermultiple layers of droppers, an instance of the PittyTiger RATis dropped on the victim computer. Subsequently, severalexploit documents have been observed, many of which usethe same exploit for CVE-2014-1761 and the same shellcode,and are thus attributed to PITTY PANDA as well. At this point,it became clear that PITTY PANDA has added the  CVE-2014-1761 exploit to its stock of attack tools.The PITTY PANDA case highlights an important aspect oftoday’s adversaries: persistence. We found traces thatcorroborate the assumption that this adversary’s activity goesback to 2008, and likely even as far as 2005. This underlinesa persistent approach and a dedicated mindset. In addition,the constant evolution of its toolkit allows this threat actor toquickly switch among tools. The exploit for CVE-2014-1761 isjust one of several exploits available to the adversary. Notonly has PITTY PANDA evolved in terms of exploitation, butalso subsequent payloads have been improved over theyears, leading to a variety of downloader and RAT familystrains. All of these highlight a professional long-term01/04/24, 21:15CVE-2014-1761 - The Alley of Compromise - crowdstrike.com Pagina 6 di 13https://www.crowdstrike.com/blog/cve-2014-1761-alley-compromise/intelligence-gathering operation. The persistence aspect ofthe often-used term Advanced Persistent Threat (APT) isclearly reflected in the mode of operation of this threat group.Professionalism of Exploit WeaponizationThe professionalism of malicious activity revolving aroundCVE-2014-1761 also manifests in another observation. Inorder to quickly create a malicious document with an exploit,adversaries develop tools specifically for this purpose. Anexample is shown in the following figure. This tool expects adecoy document and a malware executable as input andcreates an exploit document for the CVE-2014-1761vulnerability that drops the two payloads. Credit to SnorreFagerland who was the first to report on this tool. Retrospective analysis and integration of exploits for client-side applications has not only been observed with ChineseAPT groups. In mid-May 2014, a malicious document (MD5hash 16b4a8bcaf8c20b0786c97de1a943dc5) exploiting CVE-01/04/24, 21:15CVE-2014-1761 - The Alley of Compromise - crowdstrike.com Pagina 7 di 13https://www.crowdstrike.com/blog/cve-2014-1761-alley-compromise/ Tweet Share2014-1761 was identified, which is associated with anadversary tracked by CrowdStrike under the nameENERGETIC BEAR. This particular exploit document droppedthe Havex RAT. ENERGETIC BEAR is an actor with a Russiannexus that has been observed to target a variety of victimswith a particular focus on the energy sector. This adversary isknown to favor strategic web compromise (SWC) as infectiontactic. An interesting observation here is that even this actorwith an apparent passion for SWC “cannot resist” leveragingCVE-2014-1761, possibly due to the wide range of affectedsoftware.This blog post highlighted the prevalence of exploitsleveraging CVE-2014-1761 and associated actors.Throughout the second quarter of 2014, the variety of actorsleveraging this vulnerability has increased significantly,including APT actors associated with the People’s Republic ofChina as well as the Russian Federation. The set of actorsspans several groups, most of which are known to conductintelligence-gathering activities on a sustained level.CrowdStrike Intelligence will continue to monitor the threatgroups mentioned throughout this blog post. Related Content \u0000\u0000\u0000\u0000\u0000\u0000\u0000\u000001/04/24, 21:15CVE-2014-1761 - The Alley of Compromise - crowdstrike.com Pagina 8 di 13https://www.crowdstrike.com/blog/cve-2014-1761-alley-compromise/Still Alive: Updates for Well-Known Latin America eCrimeMalware Identified in 2023CrowdStrike 2024 Global Threat Report: Adversaries GainSpeed and StealthHow Malicious Insiders Use Known Vulnerabilities AgainstTheir OrganizationsCATEGORIESCloud and Application Security83Counter Adversary Operations173Endpoint Security & XDR376 01/04/24, 21:15CVE-2014-1761 - The Alley of Compromise - crowdstrike.com Pagina 9 di 13https://www.crowdstrike.com/blog/cve-2014-1761-alley-compromise/Engineering & Tech75Executive Viewpoint151From The Front Lines191Identity Protection33Next-Gen SIEM & Log Management79Public Sector2Tech Center151CONNECT WITH US01/04/24, 21:15CVE-2014-1761 - The Alley of Compromise - crowdstrike.com Pagina 10 di 13https://www.crowdstrike.com/blog/cve-2014-1761-alley-compromise/      01/04/24, 21:15CVE-2014-1761 - The Alley of Compromise - crowdstrike.com Pagina 11 di 13https://www.crowdstrike.com/blog/cve-2014-1761-alley-compromise/ FEATURED ARTICLESBuilding the Modern SOC: How CrowdStrike Deployed Next-GenSIEM to Increase Search Speed by 150x and Find Issues in Secondsmarzo 27, 2024How to Defend Employees and Data as Social Engineering Evolvesmarzo 22, 2024CrowdStrike Enhances Cloud Detection and Response (CDR)01/04/24, 21:15CVE-2014-1761 - The Alley of Compromise - crowdstrike.com Pagina 12 di 13https://www.crowdstrike.com/blog/cve-2014-1761-alley-compromise/« How cybercrime and cybersecurity affects nations and geopoliticsMalware-Free Intrusions: Adversary Tricks and CrowdStrike Treats»Capabilities to Protect CI/CD Pipelinemarzo 21, 20245 Best Practices to Secure Azure Resourcesmarzo 18, 2024SUBSCRIBESign up now to receive the latest notiﬁcations and updates from CrowdStrike.Sign Up See CrowdStrike Falcon  in ActionDetect, prevent, and respond to attacks— even malware-free intrusions—at any stage, with next-generation endpoint protection.See Demo Copyright   2024 CrowdStrike|Privacy|Request Info|Blog|01/04/24, 21:15CVE-2014-1761 - The Alley of Compromise - crowdstrike.com Pagina 13 di 13https://www.crowdstrike.com/blog/cve-2014-1761-alley-compromise/Contact Us|1.888.512.8906|Accessibility"
}