{
    "title": "know your enemy_ tracking a rapidly evolving apt actor _ fireeye inc",
    "text": "Threat Research Know Your Enemy: T racking a Rapi dly Evolving aPT actor Octobe r 31, 2013  | by ned Moran, Thoufique Haq Between Oct. 24–25 FireEye detected two spear-phishing attack s attributed to a th reat acto r we have previously dubbed admin@338 .[1] The ne wly discovered attacks targeted a number of organizations and were apparently foc used on gathe ring data related to inte rnational t rade, finance, an d economic policy. The se two attacks utilized different mal ware familie s and demonstrate an ability to q uickly adapt techniq ues, tactics, and procedures (TTPs). Investor Guide and Contact Li st Lure On Friday Oct. 25, 2013 , FireEye detected an attempte d targeted campaign again st the follo wing: The Cent ral Bank of a We stern European gove rnment an International o rganization involve d in trade, economic, an d financial policy a U.S.-ba sed think tank a high- ranking gove rnment official fo r a country in the Fa r East This spear-phish email, shown in Fig ure 1, containe d a malicio us Word document attachment that exploite d the CVE-2012 -0158  vulnerability. Figure 1: Spear-phish email used in a recent a dmin@338  attack The malicio us Word document ha d the follo wing properties: File: Investor Relation s Contact s.doc MD5: 87576708689 7e90fb47a021b45e161b2 Upon opening the file, a malicio us executable with the MD 5 hash value of c5d8b7c8e2f50b171840e071f8a079b6 is then written to C:\\Win dows\\wmiserver.exe an d subsequently exec uted. This executable is a variant of the Bozok RaT, which was configured to connect to it s comman d–and-control (CnC) server at microsoft.mrbasic.com and www.microsoft.mrbasic.com with the Bozok connection password of “wwwst@Admin”. We observed the domain microsoft.mrbasic.com resolving to 58.64.153.157 on Oct. 26, 2013. Bozok RaT Capabilitie s and Behavio r Bozok, like many othe r popular RaTs, is freely available [2]. The author of the Bo zok RaT goe s by the monike r “Slayer616” and has created anothe r RaT kno wn as Schwarze Sonne, o r “SS-RaT” fo r short. Both of the se RaTs are free and easy to find — various aPT acto rs have used both in p revious targeted attacks. Unlike SS-RaT, Bo zok is still actively maintaine d, with two new updates released in Octobe r that fixe d some bugs and added language support for Spanish, arabic, Bulgarian, Poli sh, and French. The se and other improvement s have ma de Bozok intuitive an d easy to use. as shown in Fig ure 2, it features an easy-to-navigate g raphical user interface that enable s operators to point an d click thei r way through the ent renchment, late ral movement, an d exfiltration process. Figure 2: The Bo zok interface Once an en dpoint is infecte d with Bozok, the attacke r can do the follo wing: Upload and download files to and from the ta rget’s machine Launch and kill processes Modify the registry Grab stored passwords attacke rs can also use the Bo zok graphical user interface to run arbitrary shell comman ds on the ta rget machine s, as shown in Fig ure 3. Figure 3: Running shell comman ds with Bozok. a DLL pl ugin — which can be downloaded and loaded through the Bo zok GUI control panel onto the infecte d endpoint — exten ds the RaT’ s functionality with the follo wing comman ds: StartVNC StopVNC StartWebcam StopWebcam SendCamList IsWebcam DeleteKeylog  Email Up dates Information an d insight on to day's advanced threats from FireEye. SHaRE Recent Po sts 09 Mar 2020 24 Feb 2020 20 Feb 2020 RSS FEED: STaY CO nnECTEDFirst name Last name Email address Company name Threat Research Blog FireEye Stories Blog Industry Perspective s Blog Yes, I would like to receive communication s from FireEye. Please read more about our information collection an d use. SUBSCR IBE Crescendo: Real Time Event Vie wer for macOS   Ransomware again st the Machine: How adversaries are Learning to Disrupt Industrial Production by Targeting IT and OT  M-Trends 2020 : Insights From the Front Line s   Home  FireEye Blog s Threat Research  Octobe r 2013  Threat Research Blog Po sts Know Your Enemy: T racking a Rapi dly Evolving aPT a...     COnTaCT US  REPORT a n InCIDEnT Solutions Services Customers Partners Resources Company  GetKeylog StopKeylog QueryScreen Bozok stores its configuration pa rameters in the resource section of the exec utable file. The pa rameters are containe d in a PE manife st called \"CFG\". The config uration fo r the Bo zok variant from the c urrent attack (wmiserver.exe c5d8b7c8e2f50b171840e071f8a079b6) is shown in Fig ure 4. Figure 4: Bo zok PE manife st The follo wing parameters are stored in this manife st: ID = aubok Mutex = 801JsYqFulHpg Filename = wmiserver.exe Startup Entry Name = wmiupdate Plugin filename = ext.dat Connection password = wwwst@Admin Connection port = 80 Connection servers = www.microsoft.mrbasic.com, microsoft.mrbasic.com     These parameters are config ured at the b uild time of the RaT. The m utex is randomly gene rated at the b uild time of the RaT an d is used to ensure that only one copy of the mal ware is running on a ta rgeted machine. Upon initial infection, Bo zok emit s the outgoing initial net work beacon t raffic shown in Fig ure 5. Figure 5: Bozok beacon t raffic The beacon contain s the length of the packet in little-en dian format bet ween the off sets 04. The follo wing data follows this in a wide-string format with a pipe separator as follows: LengthofData | Hostname | U sername| ID | Locale Info | OS Ve rsion | RaT Ve rsion | 0 | 2 | ConnectionPa ssword | IdleTime | activeWin downame The beacon al so contain s a hardcoded connection pa ssword “wwws t@admin” in the beacon, which is used to authenticate when connecting to it s GUI control panel. attribution We have att ributed this attack to the a dmin@338  actor that we described in our report Poison Ivy: assessing Damage an d Extracting Intelligence  [3]. The admin@338  actor has also used the same “wwws t@admin” string as a password in previously observed Poison Ivy samples used in targeted attacks. For example, the file SnowdenBook. doc (MD 5: d40f50d3 7d51f6cd92e98c4da4e066ff) dropped a Poison Ivy sample that used “wwws t@admin” as a password. additionally, the CnC IP of 58.64.153.157, used by the Bo zok variant (MD 5: c5d8b7c8e2f50b171840e071f8a079b6) dropped by the Investor Relation s Contact s.doc lure has also hosted a number of othe r CnC domains linked to the a dmin@338  actor. On Oct. 27, 2013  we observed the follo wing known admin@338  domains resolving to 58.64.153.157: consilium.dnset.com consilium.dynssl.com consilium.proxydns.com dnscache.lookin.at ecnet.rr.nu european.athe rsite.com hq.dsmtp.com hq.dynssl.com ipsecupdate.byinte r.net itagov.byinte r.net microsoft.acmetoy.com microsoft.dhcp.biz microsoft.dynssl.com microsoft.ftpserver.biz microsoft.instanthq.com microsoft.isasecret.com microsoft.lookin.at microsoft.proxydns.com microsoft.wikaba.com microsofta.byinte r.net microsoftb.byinte r.net phpdns.myredirect.us sslupdate.byinte r.net svchost.lookin.at svchost.passas.us teamware.rr.nu webserver.dynssl.com webserver.fartit.com webserver.freetcp.com www .consilium.dnset.com www .consilium.dynssl.com www .consilium.proxydns.com www .hq.dsmtp.com www .hq.dynssl.com www .microsoft.acmetoy.com   PREVIOUS POST nEXT POSTwww .microsoft.dhcp.biz www .microsoft.dsmtp.com www .microsoft.dynssl.com www .microsoft.instanthq.com www .microsoft.isasecret.com www .microsoft.proxydns.com www .microsoft.wikaba.com www .svchost.ddns.info www .svchost.dyndns.pro www .svchost.dynssl.com www .verizon.dynssl.com www .verizon.item db.com www .verizon.proxydns.com www .webserver.dynssl.com www .webserver.fartit.com www .webserver.freetcp.com We previously detected the same admin@338  actor using the Bo zok RaT on Jan. 6, 2013 . In this attack, the admin@338  actor emailed the malicio us spreadsheet EcoMissionList.xls (MD5: f10e89c194742a9ad98efbf165008 4f3) to the same inte rnational o rganization involve d in trade, economic, an d financial policy ta rgeted by the mo re recent Investor Relation s Contact s.doc lure (MD5: 87576708689 7e90fb47a021b45e161b2). The malicio us EcoMissionList.xls spreadsheet dropped a Bozok variant with an MD 5 of a45d356 4d1fa27161b33712f035a5962 . This Bozok implant connecte d to CnC servers at www .microsoftupdate.dynssl.com with the pa ssword of “gwxpass”. a previous admin@338  Poison Ivy sample (MD5: d22e974b348be44dde556626 7250ff0e) was configured with the similar password “gwx@338 ”. Investor Relation s Contact s-asiaPacific L ure During our investigation of the mo st recent Bo zok sample within Investor Relation s Contact s.doc, we discovered a related attack that occ urred on Oct. 24, 2013  — one day befo re the wave of Bo zok-fueled spear phishes. This attack al so utilized spear phishing as a delivery mechani sm by sending the follo wing malicio us document to the same U.S.-ba sed think tank ta rgeted by admin@338  with the Bo zok RaT on Oct. 25: File: Investor Relation s Contact s-asiaPacific. doc MD5: c6de1ca261662 aca6b8a782075a8671f The malicio us document dropped an implant with the MD 5 f7fb380f2b0c22c12f605ce9b4b162f2 to C:\\Documents and Setting s\\admin\\application Data\\ svchost.exe. We detect thi s implant a s Backdoor.aPT.FakeWin HTTPHelper. This sample connecte d to CnC servers at www .dpmc.dynssl.com an d www .dataupdate.dynssl.com. The domain www .dpmc.dynssl.com resolved to Oct. 24, 2013 , and www .dataupdate.dynssl.com resolved to 58.64.153.157 on Oct. 21, 2013 . Though the Oct. 24 attack did not use the Bo zok RaT, it i s likely that the a dmin@338  actor was also responsible for this attempte d intrusion for the follo wing reasons: We have p reviously observed the admin@338  actor use Backdoor.aPT.FakeWin HTTPHelper in targeted attacks. The same 58.64.153.157 IP address was used in both attack s. The same US-ba sed think-tank was targeted in both attack s. Conclusions These consecutive inci dents, Backdoor.aPT.FakeWin HTTPHelper on Oct. 24 and Bozok RaT on Oct. 25, demonstrate that the a dmin@338  actor has the ability to rapidly alter TTPs. Further, the admin@338  actor can integrate publicly available RaT s such as Poison Ivy and Bozok as well as custom RaT s such as Backdoor.aPT.FakeWin HTTPHelper into thei r arsenal. Organizations must be prepared to defend themselves from this wide array of attack s. Footnote s: [1] For more on admin@338 , see our previous blog ent ry on Poision Ivy [2] http://ss-rat.blogspot.com/ [3] This report is available at here.    Company Why Fi reEye? Customer Stories Careers Certification s and Compliance Investor Relation s Supplier Documents news and Events newsroom Press Releases Webina rs Events awards and Honors Email Preferences Technical S upport Incident? Report Security Issue Contact S upport Customer Portal Communities Documentation Po rtal FireEye Blog s Threat Research FireEye Stories Industry Perspective s Threat Map View the Late st Threats  Contact U s +1 877-347-3393   Stay Connecte d  Copyright   2020  FireEye, Inc. all rights reserved.  Privacy & Cookie s Policy  | Privacy Shiel d | Legal Doc umentationSite Lang uage English  "
}