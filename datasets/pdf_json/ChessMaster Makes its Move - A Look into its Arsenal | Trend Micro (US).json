{
    "title": "ChessMaster Makes its Move - A Look into its Arsenal | Trend Micro (US)",
    "text": "01/04/24, 21:09ChessMaster Makes its Move: A Look into its Arsenal | Trend Micro (US) Pagina 1 di 6https://www.trendmicro.com/en_us/research/17/g/chessmaster-cyber-espionage-campaign.htmlChessMaster Makes its Move: A Look into its ArsenalChessMaster, a campaign targeting Japanese academe, technology enterprises, media outﬁts, managed service providers, and government agencies, employs malware-laden spear-phishing emails with decoy documents purporting to be legitimate.By: Benson Sy, Kawabata KoheiJuly 27, 2017Read time: 4 min (1144 words) SubscribeFrom gathering intelligence, using the right social engineering lures, and exploiting vulnerabilitiesto laterally moving within the network, targeted attacks have multifarious tools at their disposal.And like in a game of chess, they are the set pieces that make up their modus operandi.Take for instance the self-named ChessMaster, a campaign targeting Japanese academe,technology enterprises, media outﬁts, managed service providers, and government agencies. Itemploys various poisoned pawns in the form of malware-laden spear-phishing emails containingdecoy documents. And beyond ChessMaster’s endgame and pawns, we also found red ﬂags thatallude to its links to APT 10, also known as menuPass, POTASSIUM, Stone Panda, Red Apollo, andCVNX.ChessMaster’s name is from pieces of chess/checkers/draughts we found in the resourcesection of the main backdoor they use against their targets: ChChes, which Trend Micro detectsas BKDR_CHCHES.What makes the campaign unique is its arsenal of tools and techniques:Malicious shortcut (LNK) ﬁles and PowerShell. The LNK ﬁles execute Command Prompt that downloads aPowerShell script, which would either directly drop or reﬂectively load ChChes into the machine. The lattermethod makes ChChes a ﬁleless malware.Self-extracting archive (SFX). An archive that drops an executable (EXE), a dynamic-link library (DLL), and a binaryﬁle (.BIN). Upon their extraction, malicious code is injected into the process of a legitimate ﬁle/application (DLLhijacking). ChessMaster takes it up a notch via load-time dynamic linking to trigger the malicious DLL’s function.Runtime packers. Throughout its campaign, ChChes used three packers to obfuscate itself and avoid detection.The ﬁrst had no encryption and a varied loader code. The second had a buggy (or anti-emulation) exclusive OR(XOR) encryption technique. The third added an AES algorithm on top of XOR encryption. Their compile datesoverlap, which indicates ChChes’ authors take cues and ﬁne-tune their malware.Second-stage payloads. Additional malware are introduced to the infected system for persistence. These areactually variants of ChChes that use similar entry points but di!erent and encrypted C&C communication.Hacking Tools. ChessMaster draws on legitimate email and browser password recovery and dumping toolsthey’ve misused and modiﬁed for their campaign. These can restore forgotten passwords, which are thendumped and retrieved. Lateral movement and further attacks can be worked out from here.TinyX. A version of PlugX sans the plug-in functionality that allows it to adopt new capabilities. TinyX is bundledseparately in spear-phishing emails.RedLeaves. A second-stage backdoor that operates like the open-source and ﬁleless remote access Trojan (RAT)Trochilus, which is known for enabling lateral movement in the infected systems. RedLeaves adoptedcapabilities from PlugX. In April, a RedLeaves variant named himawari (Japanese for sunﬂower) emerged capableof evading YARA rules released during that time.AuthorsBenson SyThreats AnalystKawabata KoheiSr. Security SpecialistCONTACT USSUBSCRIBERelated ArticlesAgenda RansomwarePropagates to vCenters andESXi via Custom PowerShellScriptTeamCity Vulnerability ExploitsLead to Jasmin Ransomware,Other Malware TypesJenkins Args4j CVE-2024-23897: Files Exposed, Code atRiskSee all articlesBusiness01/04/24, 21:09ChessMaster Makes its Move: A Look into its Arsenal | Trend Micro (US) Pagina 2 di 6https://www.trendmicro.com/en_us/research/17/g/chessmaster-cyber-espionage-campaign.html ChessMaster and APT 10 Plays the Same Cyberespionage GameAPT 10/menuPass is a cyberespionage group whose speciﬁc campaign, Operation Cloud Hopper,attacked the intermediaries of their targets of interest—managed service providers (MSPs). Itsnotoriety stems from their proliﬁc use of multifarious information-stealing backdoors andvulnerability exploits, along with the tenacity of its subterfuges, from spear-phishing emails toattack and infection chains. It also abused legitimate or open-source remote administration toolsto steal data.If that sounded familiar, it's because ChessMaster and APT 10 appear to be playing the samecyberespionage game. Here’s a further illustration: Figure 1: Similarities in ChessMaster and APT 10’s attack chainWe ﬁrst saw ChChes set its sights on an organization that’s long been a target of APT10/menuPass. As we caught and delved into more ChChes samples in the wild, however, we alsosaw how they followed the same pattern—exclusive packers, mutual targets, overlapping C&Cinfrastructure.ChChes’ packer, for instance, resembled the one used in menuPass’ old PlugX samples. DNSrecords also showed that some of their command and control (C&C) servers and domainsresolved to the same IP address, or resided in the same subnet. Are they operated by the sameactors? Their commonalities make it appear so. It’s also known to happen; BlackTech’scyberespionage campaigns are a case in point.01/04/24, 21:09ChessMaster Makes its Move: A Look into its Arsenal | Trend Micro (US) Pagina 3 di 6https://www.trendmicro.com/en_us/research/17/g/chessmaster-cyber-espionage-campaign.html Figure 2: Comparison of Emdivi and ChChesChessMaster’s ChChes also resembles another backdoor, Emdivi, which ﬁrst made waves in2014. They have the same endgame. Both are second-stage payloads that use the system’sSecurity Identiﬁer (SID) as encryption key so they execute only in their target’s machine. Theirdi\"erence lies in complexity—ChChes hides part of the decryption key and payload in registrykeys to make it harder to reverse engineer.But that’s just one dot in several we’ve connected. In one instance, we detected PlugX and Emdivion the same machine. This PlugX variant connected to an APT 10/menuPass-owned domain, butthe packer is similar to that used by ChChes. While it’s possible it was hit by two di\"erentcampaigns, further analysis told a di\"erent story. Both were compiled on the same date, onlyseveral hours apart. We detected and acquired the samples the next day, which means bothbackdoors were delivered to the victim a day after they were compiled.01/04/24, 21:09ChessMaster Makes its Move: A Look into its Arsenal | Trend Micro (US) Pagina 4 di 6https://www.trendmicro.com/en_us/research/17/g/chessmaster-cyber-espionage-campaign.html Figure 3: Overview of the overlaps in ChessMaster and APT 10’s campaignsTake ‘Control of the Center’Ultimately attacks like ChessMaster’s make pawns out of the systems, networks, devices andtheir users, all of which hold the organization’s crown jewels. This is why enterprises need to besteps ahead of the game: prepare, respond, restore, and learn. Plan ahead—what techniqueswill attackers use? How can I defend against them? Don’t just pull the plug—understand whathappened to better assess and mitigate the damage. Fine-tune your response—what worked,what didn’t, and what could’ve been done better?Defense in depth plays a crucial role especially for the IT/system administrators and informationsecurity professionals that watch over them. The network, endpoints, servers, mobile devices,and web/email gateways are the bishops, knights, and rooks that underpin the enterprise’scrown jewels, which is why securing them is important. Reduce their attack surface. Keep thesystems updated and regularly patched, and enforce the principle of least privilege. Employbehavior monitoring and application control. Deploy ﬁrewalls as well intrusion detection andprevention systems. Implement URL categorization, network segmentation, and datacategorization.ChessMaster’s gambit is spear-phishing, so it’s especially important to ﬁlter and safeguard theemail gateway. Additionally, foster a cybersecurity-aware workforce. Seemingly benign icons ordecoy documents can still swindle the victim, for instance. More importantly, develop proactiveincident response and remediation strategies—threat intelligence helps enterprises prepare andmitigate attacks. Like in chess, the more you understand your enemy’s moves, the moresuccessful you can be at thwarting them.The Indicators of Compromise (IoCs) related to ChessMaster's campaigns is in this appendix.This has been presented in the RSA Conference 2017 Asia Paciﬁc & Japan as “ChessMaster: A New01/04/24, 21:09ChessMaster Makes its Move: A Look into its Arsenal | Trend Micro (US) Pagina 5 di 6https://www.trendmicro.com/en_us/research/17/g/chessmaster-cyber-espionage-campaign.htmlCampaign Targeting Japan Using the New ChChes Backdoor” on July 27, 2017, in Marina Bay Sands,Singapore. Updated on August 14, 2017, 11:50 PM to include IoCs related to ChessMaster.Tags||MalwareEndpointsResearch Tryourservicesfreefor30daysCountryHeadquartersTrend Micro -United States(US)225 East JohnCarpenterFreewaySuite 1500Irving, Texas75062Phone: +1(817) 569-8900 Resources Support AboutTrend01/04/24, 21:09ChessMaster Makes its Move: A Look into its Arsenal | Trend Micro (US) Pagina 6 di 6https://www.trendmicro.com/en_us/research/17/g/chessmaster-cyber-espionage-campaign.html SSSSttttaaaarrrrttttyyyyoooouuuurrrrffffrrrreeeeeeeettttrrrriiiiaaaallllttttooooddddaaaayyyy UnitedStates Select acountry/ region PrivaPrivaPrivaPrivacycycycy LegalLegalLegalLegal AccesAccesAccesAccessibilitsibilitsibilitsibilityyyy SiteSiteSiteSitemapmapmapmap Copyright  2024Trend MicroIncorporated. Allrights reserved Cliccando su “Accetta tutti i cookie”, l'utente accetta di memorizzare i cookie sul dispositivo per migliorare lanavigazione del sito, analizzare l'utilizzo del sito e assistere nelle nostre attività di marketing.Impostazioni cookieAccetta tutti icookie"
}