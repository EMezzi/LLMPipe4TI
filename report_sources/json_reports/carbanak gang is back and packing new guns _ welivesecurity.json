{
    "title": "carbanak gang is back and packing new guns _ welivesecurity",
    "text": "Menu\nCarbanak gang is back and\npacking new guns\nA few days ago, CSIS published details about new Carbanak samples found in the wild. In this blog we\nexamine the latest developments in the Carbanak story.\nAnton Cherepanov  8 Sep 2015 - 10:49AM\nShare\n\n\nThe Carbanak financial APT group made the headlines when Group-IB and Fox-IT broke the news  in December\n2014, followed by the Kaspersky report  in February 2015. The two reports describe the same cybercriminal gang\nwhich stole up to several hundreds of millions of dollars from various financial institutions.\nHowever, the story is interesting not only because of the large amount of money stolen but also from a\ntechnical point of view. The Carbanak team does not just blindly compromise large numbers of computers and\ntry to ‘milk the cow’ as other actors do, instead they act like a mature APT-group. They only compromise\nspecific high-value targets and once inside the company networks, move laterally to hosts that can be\nmonetized.\nA few days ago CSIS published details  about new Carbanak samples found in the wild.\nIn this blog we will describe the latest developments in the Carbanak story.\nCasino hotel hack\nAt the end of August, we detected an attempt to compromise the network of a casino hotel in the USA. The\ninfection vector used in this attack may have been a spearphishing e-mail with a malicious attachment using an\nRTF-exploit or .SCR file. The attackers’ aim was to compromise PoS servers used in payment processing.\nThe main backdoor used by attackers was the open-source Tiny Meterpreter. In this case, however, the source\nwas modified – the process injection to svchost.exe was added to its functionality.\nThis Tiny Meterpreter backdoor dropped two different malware families:\nWin32/Spy.Sekur  – well known malware used by the Carbanak gang\nWin32/Wemosis  – a PoS RAM Scraper backdoor\nAs mentioned here  by our colleagues from TrendMicro, Carbanak malware is capable of targeting Epicor/NSB\nPoS systems, while Win32/Wemosis is a general-purpose PoS RAM Scraper which targets any PoS that stores\ncard data in the memory. The Wemosis backdoor is written in Delphi and allows the attacker to control an\ninfected computer remotely.\nBoth executables were digitally signed with the same certificate:\nThe certificate details:\n Company name: Blik\nValidity: from 02 October 2014 to 03 October 2015\nThumbprint: 0d0971b6735265b28f39c1f015518768e375e2a3\nSerial number:  00d95d2caa093bf43a029f7e2916eae7fb\nSubject: CN = Blik\nO = Blik\nSTREET = Berzarina, 7, 1\nL = Moscow\nS = Moscow\nPostalCode = 123298\nC = RU\nThis certificate was also used in the digital signature of a third malware family used by the same gang:\nWin32/Spy.Agent.ORM .\nWin32/Spy.Agent.ORM – overview\nWin32/Spy.Agent.ORM  (also known as Win32/Toshliph ) is a trojan used as one of their first-stage payloads by the\nCarbanak gang. The binary of the testing version was signed with a Blik certificate: moreover, Spy.Agent.ORM\nshares some similarities in the code with “the regular” Carbanak malware.\nThe Win32/Spy.Agent.ORM  malware family is already known in the industry because of two blogposts. In July 2015\nsecurity company Cyphort reported  the compromise of a news portal and a banking site – rbc.ua and\nunicredit.ua. It turns out  that the compromised sites served Win32/Spy.Agent.ORM . After that, Blue Coat reported\na spearphishing attempt targeting Central Bank of Armenia employees, the payload being the same.\nThis malware appeared on our radar at the beginning of summer 2015, and afterwards we started to track it.\nWe have seen attempts to attack various companies in Russia and Ukraine using spearphishing e-mails that\nhave malicious attachments consisting of .SCR files or .RTF exploits.\nHere is an example of a spearphishing email sent to one of the biggest Forex-trading companies:\nRoughly translated from Russian to English, it says:\n“Due to the high volatility of the ruble exchange rate the Bank of Russia sends rules of trading on the currency market.\nPassword the attached document: cbr”\nHere is another example of a spear phishing attempt. Email with this text was sent to the largest electronic\npayment service in Russia:\nПостановлением Роскомнадзора от 04.08.2015г. Вам необходимо заблокировать материалы попадающие\nпод Федеральный закон от 27.07.2006 N 152-ФЗ (ред. от 21.07.2014) “О персональных данных”. Перечень\nматериалов в документе.\nПароль roscomnadzor\nAnother rough translation from Russian to English:\n“According to Roscomnadzor prescript you should block the materials, which you can find in the attachment. Password is\nroscomnadzor”\nWe have seen similar .SCR files with following filenames:\nАО «АЛЬФА-БАНК» ДОГОВОР.scr (Alfabank contract)\n Перечень материалов для блокировки от 04.08.2015г.scr (List to block)\nPostanovlene_ob_ustranenii_18.08.2015.pdf %LOTS_OF_SPACES% ..scr\nПравила Банка России от 06.08.2015.pdf %LOTS_OF_SPACES% .scr (Rules of Bank of Russia)\nAll these attachments contained a password protected archive with .SCR file. The files had Adobe Acrobat reader\nicon or MS Word icons.\nIn other cases attackers used RTF files with different exploits, including an exploit for one of the latest Microsoft\nOffice vulnerabilities, CVE-2015-1770, which was patched by Microsoft in June 2015 in MS15-059 .\nWe have seen RTF files with the following names used in attacks:\nprikaz-451.doc\nREMITTANCE ADVICE ON REJECTION.doc\nPROOF OF REMITTANCE ADVICE .doc\nHDHS739_230715_010711_A17C7148_INTERNAL.doc\nԲանկերի  և բանկային  գործունեության  մասին  ՀՀ օրենք  27.07.2015.doc (Armenian: The Law on Banks and Banking\n27.07.2015)\nPAYMENT DETAILS.doc\nАО «АЛЬФА-БАНК» ДОГОВОР.doc (Russian: Alpha-bank contract)\nAML REPORTS_20082015_APPLICATION FORM-USD-MR VYDIAR.doc\nAnti-Money Laudering & Suspicious cases.doc\nApplicationXformXUSDXduplicateXpayment.doc\nAML USD & Suspicious cases.doc\nAmendment inquiry ( reference TF1518869100.doc\nInformation 2.doc\nHere is example of a spearphishing message that was sent to a bank in the United Arab Emirates:\nHere is example of a spearphishing email that was sent to a German bank:\n Win32/Spy.Agent.ORM – Technical details\nWin32/Spy.Agent.ORM is a small and simple backdoor that enables the attackers to assess the victim. When\nexecuted the trojan connects to a C&C server and receives commands to grab screenshots, enumerate running\nprocesses and get information about the system and campaign ID. Based on that information malware operator\ndecides whether the infected computer is useful: that is, whether it’s the intended target or just a system that\nwas accidentally infected.\nHere is list of commands that it can receive from C&C server:\nCommand Purpose\n0x02Collects information about computer: Computer Name, User Name, Windows Version, Architecture\n(32/64 bit) and campaign ID\n0x03 Collects list of running processes\n0x04 Downloads binary to %TEMP% and executes\n0x05 Updates itself\n0x06 Deletes itself\n0x07 Makes screenshot\n0x08 Loads binary in the memory, without dropping to the disk\nThe latest sample of this malware family found in the wild is also digitally signed with a different certificate:\nThe certificate details:\nCompany name: In travel TOV\nValidity: from 21 July 2015 to 21 July 2016\nThumbprint:  7809fbd8d24949124283b9ff14d12da497d9c724\nSerial number: 00dfd915e32c5f3181a0cdf0aff50f8052\nSubject: CN = In travel TOV\nO = In travel TOV\nSTREET = prospekt Pravdi 33\nL = Kiev\nS = Kievskaja\nPostalCode = 04108\nC = UA\nAlso, the latest sample is able to gain system privileges via an exploit and install itself as a system service. The\ntrojan attempts to exploit a vulnerability – CVE-2015-2426 in the OpenType manager module (ATMFD.dll) –\nwhich was patched by Microsoft in MS15-078 . The exploit for this vulnerability was leaked in a Hacking Team\ndump .\nThe digital certificate for Blik used in this case is not the only link between Win32/Spy.Agent.ORM and\nWin32/Spy.Sekur (Carbanak malware). They share similarities in code – take a look at the function that\ngenerates the BOTID-value, for example:\n The BOTID-value is a unique value generated on the basis of the hardware parameters of infected computer,\nand it’s used by attackers for computer identification. In both cases generation is based on the MAC-address and\ncomputer name and the resulting value is formatted using the wsprintf  –function.\nSinkhole statistics\nOur sinkhole of some C&C domains used by the Win32/Wemosis has resulted in hits from bots in the following\ncountries.\nAs the attacks are highly targeted, the total number of victims is low in absolute numbers. Victims in the USA\nare situated in several states, including Nevada (Las Vegas), California, and New York, and include casinos and\nhotels.\nConclusions\nEven after it has reportedly stolen hundreds of millions of dollars, the infamous Carbanak APT group isn’t resting\non its laurels. On the contrary, it is very active and keeps attacking specific targets related to the finance\nindustry, including banks, Forex-trading companies, and even an American casino hotel. Recently, we have\ndetected malware used by the Carbanak group in the following countries, among others:\nUnited States of America\nGermany\nUnited Arab Emirates\nAs described in this blog post, the gang doesn’t use just one malware family to carry out its operations but\nseveral. While the code in the different families – Carbanak (Win32/Spy.Sekur), Win32/Spy.Agent.ORM, and\nWin32/Wemosis – is different it does contain similar traits, including the same digital certificate.\nFurthermore, the attackers are updating their arsenal with the latest exploits, such as the Microsoft Office\nremote code execution vulnerability, CVE-2015-1770, or the zero-day exploit leaked in the Hacking Team dumps,\nCVE-2015-2426.\n We continue to monitor the Carbanak threats. For any enquiries or sample submissions related to the subject,\ncontact as at: threatintel@eset.com .\nIndicators of Compromise (IoC)\nTrojan.Win32/Spy.Sekur (Carbanak malware) SHA-1:\nA048C093C5DA06AF148CA75299960F618F878B3A\n3552338D471B7A406D8F7E264E93B848075235C0\n3A9A23C01393A4046A5F38FDBAC371D5D4A282F1\n8D5F2BF805A9047D58309788A3C9E8DE395469A8\nBCF9E4DCE910E94739728158C98578A8D145BE56\n8330BC5A3DCC52A22E50187080A60D6DBF23E7E6\nE838004A216E58C44553A168760100B497E514E8\nCF1F97879A6EB26FEDC7207D6679DFA221DD2D45\n7267791340204020727923CC7C8D65AFC18F6F5B\nF8CBF647A64028CAE835A750EF3F8D1AA216E46C\n33870482BA7DE041587D4B809574B458C0673E94\n3927835C620058EFCADF76642489FC13AACE305B\nD678BD90257CF859C055A82B4A082F9182EB3437\n0B8605D0293D04BBF610103039768CBE62E2FAAE\n7A9BE31078BC9B5FECE94BC1A9F45B7DBF0FCE12\nRTF-exploits SHA-1:\nD71E310ADF183F02E36B06D166F8E3AD54FDBCC9\n5B6ABA51215A9662987F59AEF6CAE0A9E3A720B8\n1AD84A244B7D4FBB4D89D023B21715B346027E49\nE8514BF4C4E1F35FB1737C2F28A4A4CED07AA649\n68EA12CDCCEE01D50C23EBC29CAA96BF40925DC6\nAC95F01487B4F179A1F10684B1E0A5656940A005\nB4A94A214FC664B8D184154431E1C5A73CA0AE63\nTrojan.Win32/Spy.Sekur C2 servers:\nweekend-service.com:80\nseven-sky.org:80\ncomixed.org:80\n91.207.60.68:80\n89.144.14.65:80\n87.98.217.9:443\n82.163.78.188:443\n50.62.171.62:700\n31.3.155.123:443\n216.170.116.120:80\n216.170.116.120:700\n216.170.116.120:443\n194.146.180.58:80\n193.203.48.41:700\n185.29.9.28:443\n178.209.50.245:443\n162.221.183.11:80\n162.221.183.11:443\n162.221.183.109:443\n141.255.167.28:443\n104.232.32.62:443\n104.232.32.61:443\nTrojan.Win32/Spy.Agent.ORM SHA-1:\n2DD485729E0402FD652CF613E172EA834B5C9077\n5E8B566095FD6A98949EF5C479CE290F520DD9E2\n8C2C08111F76C84C7573CF07C3D319A43180E734\n36093A6004A9502079B054041BADC43C69A0BDEB\n6F452C76F7AC00FE1463314F5AA0A80EC4F7360C\n850E9A10E6D20D33C8D2C765E22771E8919FC3EE\nA09F520DDED0D5292A5FA48E80DE02F9AF718D06\n3707029DC5CBBE17FD4DE34134847F92E7324C45\n905D0842CC246A772C595B8CF4A4E9E517683EB7\n237784574AFB8868213C900C18A114D3FA528B95\n6090853934833D0814F9239E6746161491CCCB44\n 3672C9F4E7F647F2AF9AE6D5EA8D9C7FF16FAF40\nEC5DADAACAE763D0E55CE6A78C9A5F57B01A5135\n4E8EE08FF4F8DC06AFF8DE2E476AFAFBA58BDC11\nA734193F550DDA5C1FFD9FEC3A0186A0A793449C\nEFC0555418A6ED641047D29178D0DA3AEFA7ADEB\nB79E6A21D8C2813EC2279727746BDB685180751A\n4DB58E7D0FCA8D6748E17087EB34E562B78E1FDE\n567749B4F2330F02DD181C6C0840191CEE2186D9\n3ACEA9477B219FC6B8C0A734E67339AE2EB2AA5B\n2896814E5F8860E620AC633AF53A55D9AA21F8C0\n84CC02B3C10306BFCECE8BF274B57475B056C6D6\n207FF65543DAC6D1D9F86DFFD891C507AD24018B\nD627DD4E3850CBD571AFC4799A331054C7080B0D\nDCC932B878B374D47540D43A2DEE97F37D68267F\n983D33F547588A59B53D7F794768B264454446D5\n19E7C7A78C5D58945B615D98FF0990389485933F\nDED83A1E3B6630D69077976CC01321FBC946DCE2\n170142C042BF32FF86AF680EAD86CD1AF075B0CB\nA77336620DF96642691C1E5B6C91511BFA76A5BE\n3CEF1CA36A78CBA308FB29A46B20E5CA22D03289\nDD01331ABFF03525506CDCBAC4D76CB4EFD602A4\nRTF-exploits SHA-1:\n1F9462AA39645376C74566D55866F7921BD848F7\n81E43D653ACD2B55C8D3107E5B50007870D84D76\nAC68AD2E5F5802A6AB9E7E1C1EC7FAB3C6BDBAA4\nF869C7EA683337A2249908C21B9D3283CC2DD780\n7162BB61CD36ED8B7EE98CBD0BFFEC33D34DD3E7\n5943ABCF662DC9634B714B1358164B65E5651D15\nA40BDF005B4B469D2C7BED1766C9DA9823E1CFB7\n833A8D88BE11807BAE966D56B28AF7B3CC34DBCD\nAF7564EE7959142C3B0D9EB8129605C2AE582CB7\nDCC932B878B374D47540D43A2DEE97F37D68267F\n6FF3AE5BA4E9A312602CBD44A398A02AB0437378\n32AA4911BC6AB8098E496CD88790FF7147EC6AC3\nTrojan.Win32/Spy.Agent.ORM – C2 Servers:\n192.52.166.66\n84.200.4.226\n78.128.92.117\n176.31.157.62\nclients4-google.com (192.169.82.86)\nadobe-dns-3-adobe.com (78.128.92.112)\nimg.in-travelusa.com (192.169.82.86)\nTiny meterpreter SHA-1:\n28D514FE46D8B5720FE27C40C3889F3B45967CC7\n0B0884992F28A3C1439DBA60007076B22831CE51\nWin32/Wemosis (PoS RAM Scraper) SHA-1:\n5E31DB305A97736C0F419A3F2F8F093FF6A1F56F\nWin32/Wemosis – C2 server:\n198.100.119.14\n\nAnton Cherepanov  8 Sep 2015 - 10:49AM\nSimilar Articles\nCYBERCRIME\n CYBERCRIME\n CYBERCRIME\n CYBERCRIME\n FBI: Cybercrime losses tripled\nover the last 5 yearsHow to catch a cybercriminal:\nTales from the digital\nforensics labFBI shuts down website\nselling billions of stolen\nrecordsSimple steps to protect\nyourself against identity theft\nHome\nAbout Us\nContact UsSitemap\nOur Experts\nESETResearch\nHow To\nCategoriesRSS Configurator\nNews Widget\nDiscussion\n "
}