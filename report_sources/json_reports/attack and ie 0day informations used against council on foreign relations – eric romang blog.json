{
    "title": "attack and ie 0day informations used against council on foreign relations – eric romang blog",
    "text": "PREVIOUS NEXT29/12/2012  BY WOW\nAttack and IE 0day Informations Used\nAgainst Council on Foreign Relations\nCouncil on Foreign Relations  (CFR.org ), a foreign policy web group,\nhas been victim of a targeted attack who seem to be linked to\ncomputer hackers traced to China.\nRegarding information’s posted on the Washington Free Beacon ,\ninfected CFR.org website was used to attack visitors in order to extract\nvaluable information’s. The “ drive-by ” attack was detected around\n2:00 pm on Wednesday 26 December and CFR members who visited\nthe website between Wednesday and Thursday could have been\ninfected and their data compromised, the specialists said.\nThrough Washington Free Beacon news we know that only Internet\nExplorer 8 and higher versions have been targeted. A possible Internet\nExplorer 0day was used to infect visitors computers. We also know\nthat the attack was limited to CFR members and website visitors who\nused browsers configured for Chinese language characters.\nAs always, I was curious and tried to have more information’s\nregarding this attack and potential 0day.\nurlQuery.net investigations\nOn urlQuery.net , we can see that the first submission was done, the 20\nDecember. More interesting is the submission of 21 December  on URL\n“/js/js/news_123432476.html “. “/js/js/ ” directory seem to be a strange\nbehavior. We can see that a “ deployJava.js ” was involved by loading\nthis page.\nOther URLs are interesting like “ /js/js/robots.txt “, “/js/js/today.swf “,\n“/js/js/news_435435s.html ” but all these URLs have been submitted the\n27 December and after, and the file are no more available.\njsunpack investigations\nOn jsunpack we can observe that the “ deployJava.js ” was submitted\nthe 26 December. All other files have been submitted the 27 December\nand after, and the file are no more available.\nCLEAN MX realtime database investigations\nOn CLEAN MX we can observe an analysis the 20 December .\nWhy so many parallel submission ? Ok guys, the infection has started\nsince minimum the 20 December, so not since Wednesday 26\nDecember. Now, if you have some skill in researching information’s and\nif you are still curious, you will find part of the “ drive-by ” attack source\ncode. By doing some additional researches I found the source code of\nthe “drive-by” attack, and I can confirm you that this attack has started\nsince minimum the 7 December !\nLet analyze this source code.\nI can confirm that only visitors with Internet Explorer 8 and higher\nversions have been targeted.\nBut, a fact who was not pointed is if the visitor don’t has Adobe Flash,\nhe will not be part of the party, Flash free Internet Explorer are not\ntargeted.\nI can also confirm that visitors who used browsers configured for\nChinese language characters were targeted, but also Taiwanese and\nAmerican visitors…\nIf you load the malicious page for the first time, a “ visit ” named cookie\nis create with a lifetime of 7 days through the “ DisplayInfo() ” function. If\nyou have already a cookie, you will no more be exploited until the\nexpiration of the cookie.\nThen the page is loading the “ download ” Javascript function. This\nfunction is trying a XML HTTP request to a “ xsainfo.jpg ” file. After some\ndiscussion with @binjo , it could be that “ xsainfo.jpg ” maybe just a clean\nfile, ajax trick to call the “ callback ” function.\n“xsainfo.jpg ” file is maybe “ 320e0729e1a50fd6a2aebf277cfcad66 ”\nfound on VirScan  and VirusTotal . This file was submitted the 13\nDecember.\nThe “ callback ” function verifies if the “ xsainfo.jpg ” has been loaded and\nthat a “ 200 ” HTTP status code has been returned.\nIf the visitor operating system is Windows 7 or Windows 2008 R2, an\nOffice document is opened through the “ SharePoint.OpenDocuments ”\nActiveX control. Depending the way the document is opened the “ key ”\nvariable is initiated with funny values “ boy ” or “ girl“. I’m not specialist in\nthis domain, maybe one of the blog post reader could provide some\nmore information’s.\nDepending if you are “ girl” or a “ boy “, the “ test ” division of the HTML\ndocument will be manipulated, a “ today.swf ” flash object will be loaded\nplus a “ news.html ” iframe.\nIf you are not a “ girl” or a “ boy “, you will need to have Java SE 6, but not\nJSE 7, in order to load the two same files as previously mentioned. If the\nvisitor operating system is Windows XP, the “ test ” division of the\nHTML document will be also manipulated, and the two same files are\nloaded.\nUnfortunately, actually I didn’t find these two files, but after more\ndiscussions with @binjo  it could be that the swf is used to setup\npayload, “ news.html ” used to trigger the vulnerability.\nSo if 0day exist, this 0day is surely in “ news.html ” file, and it is also sure\nthat this targeted attack has not begin on Wednesday, not only\ntargeted visitors who used browsers configured for Chinese language\ncharacters.\nI keep you in touch if I have additional information’s regarding this\npotential new Internet Explorer 0day.\nUpdate 1 – 12/29 2am:\nFireEye has post some additional information’s  regarding the attack. It\nseem that “ today.swf ” trigger a heap spray in Internet Explorer in order\nto complete the compromise. Once the browser is exploited, it appears\nto download “xsainfo.jpg,” which is the dropper encoded using single-\nbyte XOR (key: 0x83, ignoring null bytes).\nWhat is also new regarding FireEye blog post is that their version is\ntargeting English (U.S.), Chinese (China), Chinese (Taiwan), Japanese,\nKorean, or Russian. My version of 7 December was only\ntargeting English (U.S.), Chinese (China), Chinese (Taiwan), so the guys\nhad time to release new version of they’re code during this elapse of\ntime. Also they didn’t mention the news.html file.\nUpdate 2 – 12/29 11am:\n@binjo  has release further information’s regarding “ new IE 0day\ncoming-mshtml!CDwnBindInfo object use after free vulnerability” .\nAlso, I can observe that a certain number of people have samples of\nthe 0day, I could not imagine that an active exploit will not be out\nbefore the end of the year.\nUpdate 3 – 12/29 6pm:\nAlienVault has publish more detailed information’s  regarding the\nattack and the 0day.\nUpdate 4 – 12/29 10pm:\n@_sinn3r is on the way to deliver a Metasploit module for the CFR.org\n0day exploit.\nUpdate 5 – 12/30 00am:\nMicrosoft has release MSA-2794220 and confirm the vulnerability\ntargeting Internet Explorer 6, Internet Explorer 7, and Internet Explorer\n8. Internet Explorer 9 and Internet Explorer 10 are not affected by the\nvulnerability. CVE-2012-4792  has been assigned to this vulnerability.\nUpdate 6 – 12/30 2am:\nMetasploit team has release the Microsoft Internet Explorer 0day.\nhttps://twitter.com/_juan_vazquez_/status/285186813637849088\nUpdate 7 – 12/30 11am:\nHere under is the code version I found in Google cache  as it appeared\non 7 Dec 2012 14:12:28 GMT\nGot some more samples:\nHelps.html (a25c13d4edb207e6ce153469c1104223)\nnews.html (76d14311bae24a40816e3832b1421dee)\nrobots.txt (96b01d14892435ae031290cd58d85c2e)\nxsainfo.jpg (7c713c44e34fa8e63745744e3b7221db)\nShare this:\n19 Replies to “Attack and IE 0day Informations Used\nAgainst Council on Foreign Relations”\nPingback: Microsoft Internet Explorer 6/7/8 mshtml!CDwnBindInfo?????????????\n| Panni Security Team\nPingback: VU#154201: Microsoft Internet Explorer CButton use-after-free\nvulnerability | Varanoid.comVaranoid.com\nPingback: It Marks the End of 2012 « Y.C's Blog\nPingback: [CVE-2012-4792]IE 0DAY – CDwnBindInfo Object Use-After-Free\nVulnerability _ ????\nPingback: ??IE 0day?????IE8??????IE8??????? | ???? ??'S blog\nPingback: ?? IE 0day ????? IE 8 ??????IE 8 ??????? « ??????\nPingback: VU#154201: Microsoft Internet Explorer CDwnBindInfo use-after-free\nvulnerability | Varanoid.comVaranoid.com\n29/12/2012 AT 17:12\nxsainfo.jpg is the XOR encrypted payload (0x83, ignoring null bytes)\n29/12/2012 AT 12:10\nRT @eromang: Attack and #Microsoft IE #0day Informations Used Against\nCouncil on Foreign Relations http://t.co/4NxuCJcx  #infosec\n29/12/2012 AT 12:04\nRT @eromang: Attack and #Microsoft IE #0day Informations Used Against\nCouncil on Foreign Relations http://t.co/4NxuCJcx  #infosec\n29/12/2012 AT 10:47\nRT @eromang: Attack and #Microsoft IE #0day Informations Used Against\nCouncil on Foreign Relations http://t.co/4NxuCJcx  #infosec\n29/12/2012 AT 10:11\n@eromang Attack and #Microsoft IE #0day Informations Used Against Council on\nForeign Relations http://t.co/IvDFKBLU  « detailed analysis\n29/12/2012 AT 09:35\nRT @eromang: Attack and #Microsoft IE #0day Informations Used Against\nCouncil on Foreign Relations http://t.co/4NxuCJcx  #infosec\n29/12/2012 AT 09:29\nRT @eromang: Attack and #Microsoft IE #0day Informations Used Against\nCouncil on Foreign Relations http://t.co/4NxuCJcx  #infosec\n29/12/2012 AT 07:46\nRT @eromang: Attack and #Microsoft IE #0day Informations Used Against\nCouncil on Foreign Relations http://t.co/4NxuCJcx  #infosec\n29/12/2012 AT 05:59\nRT @eromang: Attack and #Microsoft IE #0day Informations Used Against\nCouncil on Foreign Relations http://t.co/4NxuCJcx  #infosec\n29/12/2012 AT 03:14\n@eromang hi. it is on robots.txt for the trigger, at least inside of one my sample.\nnews.html will do some replace chars and will load it\n29/12/2012 AT 02:45\nRT @eromang: Attack and #Microsoft IE #0day Informations Used Against\nCouncil on Foreign Relations http://t.co/4NxuCJcx  #infosec\n29/12/2012 AT 02:44\nRT @eromang: Attack and #Microsoft IE #0day Informations Used Against\nCouncil on Foreign Relations http://t.co/4NxuCJcx  #infosec\nComments are closed.\nFOLLOW ME!\nRECENT POSTS: ERIC ROMANG BLOG\nCVE-2016-3116 Dropbear SSH\nforced-command and security\nbypass\nCVE-2016-3115 OpenSSH forced-\ncommand and security bypass\nCVE-2015-1701 Windows\nClientCopyImage Win32k Exploit\nCVE-2015-3105 Adobe Flash Player\nDrawing Fill Shader Memory\nCorruption\nCVE-2015-3306 ProFTPD 1.3.5\nMod_Copy Command Execution\nTOP POSTS\nMetasploit Meterpreter webcam_list\nwebcam_snap record_mic\nWhy and howto calculate your Events Per Second\nCVE-2015-3306 ProFTPD 1.3.5 Mod_Copy\nCommand Execution\nArcSight SmartConnector commands and\nfeatures\nMetasploit Meterpreter screenshot screenspy\nscreengrab\nCVE-2013-1892 MongoDB nativeHelper.apply\nRemote Code Execution Metasploit Demo\nFping à la découverte d’hôtes\nCVE-2012-1823 PHP CGI Argument Injection\nMetasploit Demo\nCVE-2016-3116 Dropbear SSH forced-command\nand security bypass\nMetasploit SSH Auxiliary Modules\nSUBSCRIBE TO BLOG VIA EMAIL\nEnter your email address to subscribe to this blog\nand receive notifications of new posts by email.\nEmail Address\nSubscribe\nFOLLOW ME !\n\nProudly powered by WordPress\nMore\nRelated\nEXPLOITS\nAPT , CFR , CHINA , COUNCIL ON FOREIGN RELATIONS , CVE-2012-\n4792 , IE 0DAY , INTERNET EXPLORER , INTERNET EXPLORER 0DAY ,\nKB2794220 , MICROSOFT , MSA-2794220 , WATERING HOLE\nATTACKS\nAdobe Flash 2012 Vulnerabilities\nReviewMicrosoft Release Security\nAdvisory MSA-2794220 for CFE\nInternet Explorer 0day\nF0REAL\nSecObscurity\nshu_tom\ncelilunuver\nmarco_cova\nwopot\nBlackmond_\nnode5\ndum0k\nyomuds\nmichaelmcg19\nbinjoERIC ROMANG BLOG\nEn cliquant sur OK vous profitez gratuitement de ZATAZ.COM et vous acceptez les cookies nécessaires au bon fonctionnement du blog. Mentions légales Ok\n "
}