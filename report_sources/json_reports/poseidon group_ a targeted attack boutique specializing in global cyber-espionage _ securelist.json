{
    "title": "poseidon group_ a targeted attack boutique specializing in global cyber-espionage _ securelist",
    "text": "Share post on:\nDuring the latter part of 2015, Kaspersky researchers from GReAT (Global Research and Analysis Team) got hold of the\nmissing pieces of an intricate puzzle that points to the dawn of the first Portuguese-speaking targeted attack group, named\n“Poseidon.” The group’s campaigns appear to have been active since at least 2005, while the very first sample found points\nto 2001. This signals just how long ago the Poseidon threat actor was already working on its offensive framework.\nWhy has the Poseidon threat remained undetected for so many years? In reality, it has not. Most samples were detected\npromptly. However, Poseidon’s practice of being a ‘custom-tailored malware implants boutique’ kept security researchers\nfrom connecting different campaigns under the umbrella of a single threat actor. This approach entails crafting campaigns\ncomponents on-demand and sometimes fabricating entirely unique malicious artifacts.\nOur research team was able to put together the disparate pieces of this puzzle by diligently tracing the evolution of\nPoseidon’s toolkit in pursuit of an overarching understanding of how the actor thinks and the specific practices involved in\ninfecting and extorting its victims. With a set of tools developed for the sole purpose of information gathering and privilege\nescalation, the sophistication level of campaign highlights that, today, regional actors are not far behind better-known\nplayers in the global game of targeted attacks.\nBecoming familiar with the operations of the Poseidon Group meant patiently dismantling their modus operandi to unearth\nthe custom-designed infection tools deployed to each of their selected targets. This process revealed a series of campaigns\nwith highly-regionalized malware practices and geographically-skewed victim tasking, unsurprising in a region with a\ngradually-maturing cybercrime industry. The proper detection of each iteration of their evolving toolkit may have been\nenough to thwart specific efforts, but to truly understand the magnitude of Poseidon’s combined operations required an\narcheological effort to match.\nFrequently asked questions\nWhat exactly is the Poseidon Group?\nThe Poseidon Group is a long-running team operating on all domains: land, air, and sea. They are dedicated to running\ntargeted attacks campaigns to aggressively collect information from company networks through the use of spear-phishing\npackaged with embedded, executable elements inside office documents and extensive lateral movement tools. The\ninformation exfiltrated is then leveraged by a company front to blackmail victim companies into contracting the Poseidon\nGroup as a security firm. Even when contracted, the Poseidon Group may continue its infection or initiate another infection\nat a later time, persisting on the network to continue data collection beyond its contractual obligation. The Poseidon Group\nhas been active, using custom code and evolving their toolkit since at least 2005. Their tools are consistently designed to\nfunction on English and Portuguese systems spanning the gamut of Windows OS, and their exfiltration methods include the\nuse of hijacked satellite connections. Poseidon continues to be active at this time.\nWhy do you call it Poseidon’s Targeted Attack Boutique?\nThe presence of several text fragments found in the strings section of executable files belonging to the campaign reveal the\nactor’s fondness for Greek mythology, especially regarding Poseidon, the God of the Seas (which also coincides with their\nlater abuse of satellite communications meant to service ships at sea). The boutique element is reflected in their artisanally\nadaptive toolkit for lateral movement and data collection which appears to change from infection to infection to fit\ncustom-tailored requirements for each of their prospective clients. The business cycle includes what is euphemistically\nreferred to as ‘financial forecasting’ using stolen information, so we like to say that Poseidon’s boutique not only deals in\ntargeted attacks but also stolen treasures.\nHow did you become aware of this threat? Who reported it?\nWe noticed that several security companies and enthusiasts had unwittingly reported on fragments of Poseidon’s campaigns\nover the years. However, nobody noticed that these fragments actually belonged to the same threat actor. Perhaps\nbecause many of these campaigns were designed to run on specific machines, using English and Portuguese languages, with\ndiverse command and control servers located in different countries and soon discarded, signing malware with different\ncertificates issued in the name of rogue companies, and so on. By carefully collecting all the evidence and then\nreconstructing the attacker’s timeline, we found that it was actually a single group operating since at least 2005, and\npossible earlier, and still active on the market.\nWith this understanding, GReAT researchers were able to recognize similarities in obfuscation and development traits leading\nback to widely-reported but little understood variants on a sample in 2015, which searched for prominent leaders and secret\ndocuments involving them.\nWhen did you discover this targeted attack?\nThe very first samples from this campaign were detected by Kaspersky Lab back in the early 2000s. However, as noted\npreviously, it is a very complex task to correlate indicators and evidence in order to put together all the pieces of this\nintricate puzzle. By the middle of 2015 it was possible to identify that throughout this period of time it’s been the same\nthreat actor, which we call Poseidon Group.\nWho are the victims? / What can you say about the targets of the\nattacks?\nThe targets are companies in energy and utilities, telecommunications, public relations, media, financial institutions,\ngovernmental institutions, services in general and manufacturing. The geographical spread of victims is heavily-skewed\ntowards Brazil, the United States, France, Kazakhstan, United Arab Emirates, India and Russia. Many of the victims have joint\nventures or partner operations in Brazil. The importance of the victims is not measured in numbers since each of these\nvictims is a large-scale (often multinational) enterprise.\nWhat exactly is being stolen from the target machines?\nOne of the characteristics of the group behind Poseidon is an active exploration of domain-based networks. Such network\ntopology is typical for companies and enterprises.\nThe highest value asset for these companies is proprietary information, technologies, and business-sensitive information that\nrepresents significant value in relation to investments and stock valuations. The Poseidon Group actively targets this sort of\ncorporate environment for the theft of intellectual property and commercial information, occasionally focusing on\npersonal information on executives.\nHow does Poseidon’s APT Boutique infect computers?\nThe main infection vector for Poseidon is the use of spear-phishing emails including RTF/DOC files, usually with a human\nresources lure. The executables are also often digitally signed and occasionally hidden in alternate data streams to fool\nsecurity solutions. Poseidon’s toolkit displays an awareness of many antivirus providers over the years, attempting to attack\nor spoof these processes as a means of self-defense for their infections. Once the infection happens, it reports to the\ncommand and control servers before beginning a complex lateral movement phase. This phase will often leverage a\nspecialized tool that automatically collects a wide array of information including credentials, group management policies,\nand even system logs to better hone further attacks and assure execution of their malware. This way the attackers actually\nknow what applications and commands they can use without raising an alert to the network administrator during lateral\nmovement and exfiltration.\nWhat does the Poseidon Group do? What happens after a target\nmachine is infected?\nOnce the target’s machine is compromised, the attacker first enumerates all processes running in the system and all\nservices. Then the attacker looks for all administrator accounts on both the local machine and the network. This technique\nallows them to map network resources and make lateral movements inside the network, landing in the perfect machine to\nmatch the attacker’s interest. This reflects the Poseidon Group’s familiarity with Windows network administration. In many\ncases, their ultimate interest is the Domain Controller.\nAdditionally malware reports itself to its hardcoded command and control servers and established a backdoor connection,\nso the attacker may have a permanent remote connection.\nWhat are the malicious tools used by the Poseidon Group? What\nare their functions?\nPoseidon utilizes a variety of tools. Their main infection tool has been steadily evolving since 2005, with code remnants\nremaining the same to this day, while others have been altered to fit the requirements of new operating systems and specific\ncampaigns. A noteworthy addition to the Poseidon toolkit is the IGT supertool (Information Gathering toolkit), a bulking 15\nmegabyte executable that orchestrates a series of different information collections steps, exfiltration, and the cleanup of\ncomponents. This tool appears to be designed to operate on high-value corporate systems like Domain Controllers or IIS\nservers that act as repositories of valuable information, particularly for lateral movement. The Information Gathering Tool\n(IGT) tool is coded in Delphi and includes powershell and SQL components across a dozen different drops. This tool\ncontains several other executable files made in different programming languages ranging from Visual Basic 6 to C#, each\none performing a very clear task devised by the group when trying to obtain more information from an objective. The main\npurpose of the IGT tool is to make an inventory of the system, saving information from the network interfaces and\naddresses, credentials belonging to the Domain and database server, services being run from the OS and everything that\ncould help the Poseidon Group make its attack more customized to its victim.\nAre the attackers using any zero-day vulnerabilities?\nNo zero-day vulnerabilities have been found in the analysis of the samples obtained regarding this campaign. Poseidon’s\nconventional means of deceiving users with executable files posing inside Word and RTF document files, and actual\npoisoned documents with malicious macro-scripts has been the sole method used for compromising their desired targets.\nAs we have seen in other targeted campaigns, social engineering and carefully crafted spear-phishing attacks play a crucial\nrole in the effectiveness of getting a foothold in the desired system.\nIs this a Windows-only threat? Which versions of Windows are\ntargeted?\nPoseidon is particularly focused on the Microsoft Windows operating system family, specifically customizing the infection\nmethod for each one so as to gather different information and hide its presence after the initial infection. Other products\nusually found in corporate environments, such as an SQL server, are being used for lateral movement and credential\nharvesting using a customized toolset designed by the crafty Poseidon Group. Because of Poseidon’s longevity, there are\nsamples targeting Windows systems as early as Windows NT 4.0 Server and Windows 95 Workstation up to current versions\nlike Windows 8.1, as well as server variants (very important to them, given the emphasis on reaching Domain Controllers in\ncorporate environments.)\nHow is this diﬀerent from any other targeted attack?\nThe extortion elements of this campaign are what set it apart from others. The exfiltration of sensitive data is done in order\nto coerce the victim into a business relationship under the threat of exchanging this information with competitors or\nleveraging it as part of the company’s offering of ‘investment forecasting’. Additionally this is the first ever publicly known\nPortuguese-speaking targeted attacks campaign.\nAre there multiple variants of the Poseidon Group’s malware? Are\nthere any major diﬀerences in the variants?\nPoseidon has maintained a consistently evolving toolkit since the mid-2000s. The malware has not avoided detection but\ninstead been so inconspicuous as to not arouse much suspicion due to the fact that this malware only represents the initial\nphase of the attack. An altogether different component is leveraged once Poseidon reaches an important machine like an\nenterprise’s Domain Controller. This is where the main collection takes place by use of the IGT (Information Gathering Tool)\ntoolkit.\nIs the command and control server used by the Poseidon Group\nstill active? Have you been able to sinkhole any of the command\nand controls?\nPoseidon Group has interesting practices when it comes to its use of command and control servers, including redundancies\nand quickly discarding command and control (C&Cs) servers after specific campaigns. This has actually allowed us to\nsinkhole several domains. A few of these still had active infections attempting to report to the C&Cs. This adds an interesting\ndimension to the story. As part of Kaspersky Lab’s commitment to securing cyberspace for everyone, we reached out and\nnotified identifiable victims, regardless of their security solution and provided them with indicators of compromise (IOCs) to\nhelp root out the active infection. In the process, we were able to confirm the previously described operating procedures\nfor the Poseidon Group.\nIs this a state-sponsored attack? Who is responsible?\nWe do not believe this to be a state-sponsored attack but rather a commercial threat player. Collaboration with\ninformation-sharing partners and victim institutions allowed us to become aware of the more complicated business cycle\ninvolved in this story, greatly adding to our research interest in tracking these campaigns. The malware is designed to\nfunction specifically on English and Portuguese-language systems. This is the first ever Portuguese-speaking targeted attack\ncampaign.\nHow long have the attackers been active?\nThe attackers have been active for more than ten years. The main distribution of samples goes back to 2005 with possible\nearlier outliers.\nOperating systems such as Windows 95 for desktop computers and Windows NT for server editions were not uncommon at\nthe time and Poseidon’s team has evolved gradually into targeting the latest flagship editions of Microsoft’s operating\nsystems. Recent samples show interest in Windows 2012 Server and Windows 8.1.\nDid the attackers use any interesting/advanced technologies?\nDuring a particular campaign, conventional Poseidon samples were directed to IPs resolving to satellite uplinks. The\nnetworks abused were designed for internet communications with ships at sea which span a greater geographical area at\nnearly global scale, while providing nearly no security for their downlinks.\nThe malware authors also possess an interesting understanding of execution policies which they leverage to manipulate their\nvictim systems. They combine reconnaissance of GPO (Group Policy Object management for execution) with digitally-\nsigned malware to avoid detection or blocking during their infection phases. These digital certificates are often issued in the\nname of rogue and legitimate companies to avoid arousing suspicion from researchers and incident responders.\nDoes Kaspersky Lab detect all variants of this malware?\nYes, all samples are detected by signatures and also heuristics. With a fully updated Kaspersky Lab anti-malware solution, all\ncustomers are protected now. Kaspersky Lab products detect the malware used by Poseidon Group with the following\ndetection names:\nBackdoor.Win32.Nhopro\nHEUR:Backdoor.Win32.Nhopro.gen\nHEUR:Hacktool.Win32.Nhopro.gen\nHow many victims have you found?\nAt least 35 victim companies have been identified with primary targets including financial and government institutions,\ntelecommunications, manufacturing, energy and other service utility companies, as well as media and public relations firms.\nThe archaeological effort of understanding such a long-standing group can severely complicate victim identification. We\nsee traces of upwards of a few tens of companies targeted. The exact number of the victims may actually vary. Since it is a\nvery long term group, some victims may be impossible to identify now.\nAt this time, we are reaching out to victims of active infections to offer remediation assistance, IOCs, and our full\nintelligence report to help them counteract this threat. Any victims or potential targets concerned about this threat should\nplease contact us at intelreports@kaspersky.com .\nWho is behind these attacks?\nWe do not speculate on attribution. Language code used to compile implants, as well as the language used to describe\ncertain commands used by the group, actually corresponds to Portuguese from Brazil. The inclusion of Portuguese\nlanguage strings and preference for Portuguese systems is prominent throughout the samples.\nThe tasking of Poseidon’s campaigns appears to be heavily focused on espionage for commercial interests. Speculating\nfurther would be unsubstantiated.\nReference samples hashes:\n2ce818518ca5fd03cbacb26173aa60ce\nf3499a9d9ce3de5dc10de3d7831d0938\n0a870c900e6db25a0e0a65b8545656d4\n2fd8bb121a048e7c9e29040f9a9a6eee\n4cc1b23daaaac6bf94f99f309854ea10\n2c4aeacd3f7b587c599c2c4b5c1475da\nf821eb4be9840feaf77983eb7d55e5f6\n2ce818518ca5fd03cbacb26173aa60ce\nCommand and control servers:\nakamaihub[.]com – SINKHOLED by Kaspersky Lab\nigdata[.]net – SINKHOLED by Kaspersky Lab\nmozillacdn[.]com – SINKHOLED by Kaspersky Lab\nmsupdatecdn[.]com – SINKHOLED by Kaspersky Lab\nsslverification[.]net – SINKHOLED by Kaspersky Lab\nFor more about counter Poseidon and similar attacks, read this article  in the Kaspersky Business Blog.\nAPT BRAZIL  CYBER ESPIONAGE  DIGITAL CERTIFICATES  TARGETED ATTACKS  THESAS2016\nRelated Posts\nLEAVE A REPLY\nYour email address will not be published.  Required fields are marked *\nEnter your comment here\nName *\nEmail *\nSave my name, email, and website in this browser for the next time I comment.\n \nSUBMIT\nI'm not a robot\nreCAPTCHA\nPrivacy  - Terms\n APT REPORTS\nPoseidon Group: a Targeted Attack\nBoutique specializing in global cyber-\nespionage\nBy GReAT  on February 9, 2016. 10:27 am\n1st Portuguese-speaking group #ThePoseidonAPT\nattacks companies globally #TheSAS2016\nTwee\nt\n \nNotify me when new comments are added.\nIN THE SAME CATEGORY\nChafer used Remexi malware to spy on\nIran-based foreign diplomatic entities\nGreyEnergy’s overlap with Zebrocy\nA Zebrocy Go Downloader\nAPT review of the year\nDarkPulsar FAQ\n© 2020 AO Kaspersky Lab.  All Rights Reserved. \nRegistered trademarks and service marks are the property of their respective owners.\nContact us  | Privacy Policy  | License AgreementEmail\n I agree to provide my email address to “AO Kaspersky\nLab” to receive information about new posts on the\nsite. I understand that I can withdraw this consent at\nany time via e-mail by clicking the “unsubscribe” link\nthat I find at the bottom of any e-mail sent to me for\nthe purposes mentioned above.SUBSCRIBE\nMokes and Buerak\ndistributed under the guise\nof security certificates\nOperation AppleJeus Sequel\n OilRig’s Poison Frog – old\nsamples, same trick\nTHREATS\n CATEGORIES\n TAGS\n STATISTICS ENCYCLOPEDIA DESCRIPTIONS KSB 2019\n English\nSolutions\n Industries\n Products\n Services\n Resource Center\n Contact Us GDPR GET IN TOUCH\n "
}