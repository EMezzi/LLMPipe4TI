{
    "title": "rpt-fin10",
    "text": "SPECIAL REPORTFireEye  iSIGHT Intelligence\nBITCOIN RANSOM \nDEMAND100 =  $124,000\nAS OF MID-APRIL 2017TARGETING CASINOS AND \nMINING ORGANIZATIONS IN \nNORTH AMERICA, WITH A \nFOCUS ON CANADAPRIMARY GOAL TO STEAL: \nBUSINESS DATA, FILES, \nRECORDS, CORRESPONDENCE \nAND CUSTOMER PII100-500\nREQUESTED RANSOMS RANGED  \nFROM 100 TO 500 BITCOINSFIN10 \nAnatomy of a Cyber \nExtortion OperationSPECIAL REPORT2\nCONTENTS\nIntroduction  3\nBackground  4\nTargeting  6\nFIN10 Tactics, Techniques and Procedures 6\nInitial Compromise  7\nEarly Stage Malware 7\nLateral Movement & Internal Reconnaissance  8\nSystem Disruption 8\nEnd-Stage Operations  9\nOutlook  10\nLessons learned from investigating FIN10 and other disruptive breaches 12\nConclusion  14\nAppendix - Sample Extortion Email 153 FIN10: ANATOMY OF A CYBER EXTORTION OPERATION\nINTRODUCTION\nFireEye has identified a set of financially \nmotivated intrusion operations being \ncarried out by an actor we have dubbed \nFIN10. \nWithin these clusters of activity, the attacker(s) have compromised organizations’ networks and sought \nto monetize this illicit access by exfiltrating sensitive data and extorting victim organizations. We have \nobserved FIN10 targeting organizations in North America, predominately in Canada.\nFIN10 primarily relies on publicly-available software, scripts and techniques to gain a foothold into \nvictims’ networks. The threat group then posts proof of the stolen data on publicly accessible websites. \nFailure to pay the threat group could result in the public release of stolen data and potential disruption \nor destruction of the victim’s information assets and systems.\nIn this report, we describe FIN10’s activities and tactics, techniques and procedures (TTPs), and provide \na glimpse into how they execute their operations.4 SPECIAL REPORT\nTARGETING CASINOS AND \nMINING ORGANIZATIONS IN \nNORTH AMERICA, WITH A \nFOCUS ON CANADA\nBackground5 FIN10: ANATOMY OF A CYBER EXTORTION OPERATION\nFireeye has observed  multiple  targeted  intrusions  \noccurring in North America — predominately \nin Canada — dating back to at least 2013 and \ncontinuing through at least 2016, in which the \nattacker(s) have compromised organizations’ \nnetworks and sought to monetize this illicit \naccess by exfiltrating sensitive data and \nextorting victim organizations. In some cases, \nwhen the extortion demand was not met, the \nattacker(s) destroyed production Windows \nsystems by deleting critical operating system \nfiles and then shutting down the impacted \nsystems. Based on near parallel TTPs used by \nthe attacker(s) across these targeted intrusions, \nwe believe these clusters of activity are linked \nto a single, previously unobserved actor or \ngroup that we have dubbed FIN10.BITCOIN RANSOM \nDEMAND100 =  $124,000\nAS OF MID-APRIL 2017SPECIAL REPORT 6\nBeginning as early as 2013 and continuing \nthrough at least 2016, we have observed \nFIN10 target organizations based in North \nAmerica – predominately in Canada. \nTargeted organizations have primarily \nbeen casinos and mining organizations. \nFigure 1. TTPs as organized by targeted attack lifecycle model\nMAINTAIN PRESENCE / MOVE LATERALLY• Compromised \ncredentials / VPN\n• RDP\n• Meterpreter\n• PowerShell Empire\n• SplinterRAT\n• Extortion via \nFalse Flag\n• Data Exposure\n• Destructive Batch \nScripts• PowerShell \nEmpire\n• Meterpreter\n• SplinterRAT• Meterpreter \nfunction of \nMetasploit\n• PowerShell \nEmpire\n• SplinterRAT• Likely Spear \nPhishing EmailsINITIAL  \nCOMPROMISEESTABLISH  \nFOOTHOLDCOMPLETE  \nMISSIONINTERNAL  \nRECONNAISSANCE\nFIN10 Tactics, Techniques \nand Procedures\nThe following sections correspond to \nthe attackers’ TTPs and are organized \nby the stages of the targeted attack \nlifecycle (See Figure 1). Targeting7 FIN10: ANATOMY OF A CYBER EXTORTION OPERATION\nInitial Compromise\nIn the majority of intrusions attributed to FIN10, \nthere was insufficient evidence to determine \nthe initial infection vector. However, in at least \ntwo intrusions, FIN10 leveraged spear phishing \nemails with malicious attachments, making \nit plausible that this methodology was used \nacross all breaches. \n• In both instances where the initial compromise \nwas identified, the attacker(s) used social \nengineering and specifically crafted lures to \nentice victims to click on a link that directed \nthem to a FIN10-controlled server. The server \nhosted malicious artifacts that ultimately \nexecuted code on one or more systems. In \nthese instances, the malicious code were \ndownloaders that beaconed out to attacker-\ncontrolled infrastructure. \n• In one intrusion, the phishing email referenced \nan updated holiday schedule for organizational \nstaff. The embedded URL pointed to a \nmalicious HTML Application (HTA) file. \n• In another intrusion, a phishing email \nreferenced an employee questionnaire. The \nembedded URL pointed to a Word Open XML \nMacro-Enabled Document file (DOCM) file. \n• Of note, FIN10 likely uses LinkedIn — among \nother social media and public data sources \n— to support the crafting of phishing emails \nthat appear legitimate.\nEarly Stage Malware \nThe attacker(s) primarily relied on publicly-\navailable software, scripts and techniques to \ngain a foothold into victims’ networks. \nMeterpreter\nFIN10 used Meterpreter as the primary method \nof establishing an initial foothold within victim \nenvironments. However, in one case, we also \nobserved the group use Splinter Remote Access \nTrojan (SplinterRAT).Meterpreter, short for the Meta-Interpreter, is \nan advanced payload included in the Metasploit \nFramework. It provides functionality that \nwould otherwise be difficult to implement in \nassembly by allowing developers to write their \nown extensions in the form of DLL files that can \nbe uploaded and injected post exploitation. \nMeterpreter and most of its extensions are \nexecuted in memory, thus largely evading \ndetection by standard anti-virus. Due to its \npublic availability, FireEye iSIGHT Intelligence \nhas observed multiple threat actor groups use \nMeterpreter in targeted attacks across various \nindustries.\nPowerShell\nThreat actors often use PowerShell to write \ntheir own malicious utilities, which typically \ndecrease chance of detection by popular \nendpoint security controls. When scripts are \nexecuted with PowerShell, the scripts run inside \npowershell.exe (locally) or wsmprovhasost.\nexe (remotely), both of which are often trusted \nprocesses. PowerShell provides threat actors \nwith the ability to create scripts that exceed the \ncapabilities of a standard Windows shell, batch \nfiles and VBS files. \nIn the majority of cases, we observed FIN10 \nleveraging PowerShell Empire (a pen-testing tool \nthat utilizes PowerShell) for elevated persistence , \nmainly by utilizing the Registry and Scheduled \nTask options; however, in at least one intrusion, we \nobserved FIN10 use S4U tasks  for this purpose, \nalthough this method was likely abandoned in \nfavor of PowerShell Empire once it was released. \nIn at least one instance, PowerShell Empire was \nused to install a randomly named service that \nexecuted a Meterpreter PowerShell script, which \nin turn executed malicious .bat files. The created \nbatch scripts typically contained PowerShell \ncommands for 32-bit and 64-bit operating \nsystems and upon execution could connect to \nan attacker command and control (C2) server. \nWe have also observed FIN10 using PowerShell to \nload Metasploit Meterpreter stagers into memory. SPECIAL REPORT8\nLateral Movement and Internal Reconnaissance\nFIN10 routinely leverages Windows Remote \nDesktop Protocol (RDP) to access systems \nwithin the environment. More specifically, \nattacker(s) leveraged RDP to authenticate to \ninternal systems that were configured to allow \ningress RDP connections from systems residing \noutside organizational firewall perimeters. \nSimilarly, we have observed FIN10, in at least \ntwo instances, use single-factor protected VPN \nto connect remotely to victim networks after \nstealing credentials. \nIn multiple events, FIN10 also leveraged \nfunctionality within the PowerShell script \nMeterpreter backdoor to perform internal \nreconnaissance and move laterally throughout \nthe environment. Further analysis found the \nattacker(s) used Meterpreter functionality \nto enumerate users on remote systems and \nexecute additional PowerShell functionality. In \nat least one network compromise, attacker(s) \nmoved laterally using the Local Administrator \naccount and deployed Metasploit Meterpreter \nstagers and SplinterRAT instances on targeted \nsystems. SplinterRAT is an open-source red \nteam collaboration framework. It is a Java-\nbased framework that was publicly available \nand relatively easy to implement with limited \nknowledge. In addition, SplinterRAT provides \ncapabilities such as file system browsing, \nfile upload and download, execution of shell commands and beaconing in case of \ncommunication issues with a C2 server. Both the \nMetasploit related backdoors and SplinterRAT \ninstances were programmed to connect to \nattacker-controlled C2 servers. \nWe have regularly observed FIN10 use \nscheduled tasks as a persistence mechanism. \nFor example, in at least one intrusion we \nobserved FIN10 create a scheduled task named \n“C:\\Windows\\System32\\Tasks\\Updater” , \nwhich executed a PowerShell script encoded \nin the Windows registry. The script was \nconfigured to communicate with attacker-\ncontrolled C2 infrastructure.\nSystem Disruption \nFIN10 routinely deploys destructive batch \nscripts intended to delete critical system files \nand shutdown network systems. Network \ndegradation activity typically consisted of \nthe attacker(s) creating scheduled tasks on \nmultiple systems within the targeted network \nenvironment to disrupt the normal operations \nof those systems by rendering their operating \nsystems unusable. In at least two instances, \nFIN10 created a scheduled task that used \nthe command shown in Figure 2 to delete \nthe Windows directory using the Microsoft \nrobocopy tool on critical systems within  \nthe environment. \nmkdir \"C:\\emptydir\"\nrobocopy \"C:\\emptydir\" \"C:\\windows\\system32\"/MIR | shutdown /s /t 1800Figure 2.  \nExample of \nscheduled task \ncreated to disrupt \nnormal operations\nWhile this TTP could potentially be viewed as an attempt by FIN10 to obfuscate malicious \nactivity, the resulting effects of these scheduled tasks were easily detected, suggesting that \nthese activities were intended to lend credence to the perceived threat. 9\nFIN10: ANATOMY OF A CYBER EXTORTION OPERATION\nEnd-Stage Operations\nWe believe the primary goal of this threat group \nis to steal corporate business data, files, records, \ncorrespondence and customer PII, and then \nto extort victim organizations for non-release \nof the stolen data. The threat group posts \nproof of the stolen data on publicly accessible \nwebsites. Failure to pay the threat group could \nresult in the public release of stolen data and \npotential disruption or destruction of the victim’s \ninformation assets and systems.\nExtortion\nIn all but one targeted intrusion we have \nattributed to FIN10, the attacker(s) demanded \na variable sum payable in Bitcoin for the non-\nrelease of sensitive data obtained during \nnetwork reconnaissance stages (See Appendix \nfor sample extortion email). \n• Requested sums ranged from 100 to 500 \nBitcoins (roughly $124,000 to $620,000 as of \nmid-April 2017). \n• Notably, we identified at least two victims who \nwere issued the same Bitcoin address. \n• In the first incident Mandiant investigated that \nwas attributed to FIN10, the attacker(s) did not \nextort the targeted organization. However, it is \nplausible that the group was still in the process \nof honing its TTPs. \nData Exposure\nFIN10 likely uses a combination of copy tools \nand file transfer utilities to both harvest \nand stage sensitive data. Data exposure is \naccomplished routinely using openly-accessible \nwebsites such as “pastebin.com,” “justpaste.it,” \nand “thepiratebay.se.” We have also observed \nthe group using popular cloud file sharing/\nstorage solutions, such as Dropbox, to receive \nstolen data in extortion attempts \nLinks to the leaked data are initially kept private \nand provided solely to the victim organization as \nproof of the authenticity of the compromise.  \nWe have seen FIN10 heavily leverage the \n“justpaste.it” service for these purposes. \nNarrative & Messaging\nAttacker(s) in all instances utilized a false flag — a \nterm used to describe covert operations that are \ndesigned to deceive in such a way that activities appear as though they are being carried out by \nentities, groups or nations other than those who \nactually planned and executed them.\n• Based on open-source reporting, the \nattacker(s) in at least one intrusion self-\nidentified as the “Angels_Of_Truth,” and \nclaimed the attacks on the victim were in \nreciprocity for Canada-imposed economic \nsanctions on Russia. The quality of the \nRussian-language posts, however, was \nconsiderably poor and very similar to output \nobtained from online translating solutions, \nmaking it likely the attacker(s) are not native \nRussian speakers and were using this narrative \nto mislead attribution attempts. \n• The attacker(s) more commonly used a \nmoniker associated with a Serbian hacktivist \ngroup dubbed “Tesla Team.” Given the vast \ndifferences in external targeting calculus \n— targeted industry verticals by FIN10 as \ncompared to political organizations, non-\ngovernmental organizations and websites \nof anti-Serb organizations targeted by Tesla \nTeam — and inconsistencies in tradecraft, \nwe doubt that the Serbian hacktivist group \nTesla Team (previously active in 2013) is \nassociated with FIN10. \n –In at least one intrusion, we observed the \ngroup abandon the moniker Tesla Team \nin the group’s last correspondence to the \ntargeted victim and adopt the moniker \n“Anonymous Threat Agent.” \n• Emphasis in regional targeting of North \nAmerican-based organizations could \npossibly suggest the attacker(s) familiarity \nwith the region. \nFIN10 also seeks to increase its leverage by \nsending multiple emails to staff and board \nmembers of the victim organizations, notifying \nthem of the breach and potential consequences \nfor nonpayment. FIN10 also informs open-source \nblogs about breaches in a likely effort to publicly \nexpose these breaches and apply additional \npressure on affected organizations to acquiesce \nto extortion demands. Alternatively, it is just as \nplausible FIN10 does this to simply maximize \nexposure for victims who do not pay. Notably, \nwe have also observed the group engage local \njournalists to publicize these breaches. SPECIAL REPORT 10\nBITCOIN RANSOM \nDEMAND500 =  $620,000\nAS OF MID-APRIL 2017\n100-500\nREQUESTED RANSOMS RANGED \nFROM 100 TO 500 BITCOINSOutlook11\nThe relative degree of operational success enjoyed by FIN10 makes it \nhighly probable the group will continue to conduct similar extortion-\nbased campaigns at least in the near term. Notably, we already have \nsome evidence to suggest FIN10 has targeted additional victims beyond \ncurrently confirmed targets.  \nFurthermore, while FIN10 is predominantly financially motivated, as \nevidenced by its preferred monetization technique (i.e., extortion), it is \nplausible the group is also motivated, at least in part, by ego. For instance, \nthe group’s willingness to contact cyber security bloggers is likely the \nresult of at least two motivational factors:\n1 2\nTo further the groups operational \nobjectives, likely by putting \nincreased pressure on targeted \nvictims to acquiesce to now public \nextortion demandsTo gain some degree of notoriety \nand public exposure of the \ngroup’s campaigns\nWhile the secondary motivation may be a necessary byproduct of the first, \nmore primary objective, desire to gain notoriety could potentially influence \nthe group’s decision-making calculus.\nLastly, while FIN10 has seemingly only targeted organizations within two \nindustry verticals, it is possible the group has previously or will in the \nfuture expand their regional and industry-specific targeting. Historically, \nwe have seen this type of threat activity — cyber attacks resulting in the \ntheft or compromise of sensitive data to be leveraged in extortion plots — \naffect multiple targeted verticals.FIN10: ANATOMY OF A CYBER EXTORTION OPERATIONSPECIAL REPORT 12\nJust because someone \nclaimed they hacked \nyou doesn’t necessarily \nmake it true. Empty \nextortion attempts are \nnot uncommon. Examine \nyour environment for \nevidence of compromise \nbefore considering to pay \nthe ransom. Usually FIN10 \nprovides data as proof \n(see the ‘Data Exposure’ \nsection), so confirm \nthat the data is real and \ndetermine if it came from \nyour environment. Humans can be \nunpredictable and they \nmay react out of emotion. \nCarefully consider how \nan attacker will react to \nyour action or inaction. \nThey can become more \naggressive if they get \nupset. They may back \ndown and allow for more \ntime if they believe you \nare trying to meet their \ndemands.You need to validate \nand scope the breach \nas quickly as possible. \nThis may require the \nteam working nights and \nweekends, so be careful \nof fatigue and burnout. \nYou may need to approve \nemergency change \nrequests within short order.It’s easy to get distracted. \nEvaluate whether the tasks \nyou are taking on will help \nmitigate, detect, respond \nto or contain the attack. \nRemember that you’re \nracing against the clock. \nFocus on the must-haves \ninstead of the nice-to-\nhaves and understand that \nyou may need to deploy \na number of temporary \nsolutions to address the \nattack.Attackers do not always \nexpect a response.  \nIf you decide to respond, \nlimit the interactions \nand carefully consider \neverything you say. \nConsider involving \nlaw enforcement and \nlegal counsel in all \ncommunications.1 2 3 4 5\nCONFIRM THERE \nIS A BREACHREMEMBER THAT \nYOU’RE DEALING \nWITH A HUMAN \nADVERSARYTIMING IS \nCRITICALSTAY  \nFOCUSEDCAREFULLY \nEVALUATE \nWHETHER TO \nENGAGE WITH \nTHE ATTACKER(S)Responding to disruptive breaches such as FIN10 is challenging and not easy to plan for given the dynamic \nnature of these attacks and the attacker(s). Unlike breaches where a containment plan may be able to stop an \nattacker from stealing more information, in these disruptive instances the damage may have already been done \nby the time the attacker(s) contacts the victim organization. Therefore, a different response to these incidents \nmight be required. The following ten lessons from our incident response engagements may help organizations \ndeal with disruptive attacks, including those from groups such as FIN10:Lessons Learned \nfrom investigating FIN10 and \nother disruptive breaches13 FIN10: ANATOMY OF A CYBER EXTORTION OPERATION\nYou will need forensic, \nlegal and public relations \nsupport to get through a \ndisruptive breach. Identify \npartners before the breach \nand get them on retainer.Understand that paying the \nransom may be the right \noption, but there are no \nguarantees the attacker(s) \nwon’t come back for \nmore money or simply \nleak the data anyway. \nInclude experts in the \ndecision-making process \nand understand the risks \nassociated with all options.Most organizations have \nmature backup policies so \nthey can recover quickly \nin the event of a system \nfailure. However, it’s \ncommon for the systems \ncontaining backups to \nbe part of the same \nenvironment compromised \nby the attacker. Tighten \naccess to your backup \nenvironment to mitigate \nthe risk of an attacker \naccessing the system using \ncompromised credentials \nand destroying your \nbackups.Regardless of the \noutcome, you should \nensure that attackers such \nas FIN10 cannot come \nback in and do more \ndamage. You also don’t \nwant a second attacker \ntargeting you because \nthey think you are willing \nto pay a ransom. Ensure \nyou understand the full \nextent of the breach and \nimplement both tactical \nand strategic actions to \nprevent future attackers \nfrom gaining access.Don’t forget to \noperationalize and \nenhance the temporary \nsolutions that were \ndeployed to immediately \naddress the attack. \nConduct penetration \ntesting and Red Team \nassessments to validate \nyour security controls, \nidentify vulnerabilities and \nfix them immediately.6 7 8 9 10\nENGAGE THE EXPERTS \nBEFORE A BREACHCONSIDER ALL \nOPTIONS WHEN \nASKED TO PAY A \nRANSOMENSURE STRONG \nSEGMENTATION AND \nCONTROLS OVER \nYOUR BACKUPS AFTER THE INCIDENT \nHAS BEEN HANDLED, \nIMMEDIATELY FOCUS \nON BROADER SECURITY \nIMPROVEMENTS IF YOU KICK THEM \nOUT, THEY MAY TRY \nTO COME BACK IN A \nDIFFERENT WAY PRIMARY GOAL TO STEAL: \nBUSINESS DATA, FILES, \nRECORDS, CORRESPONDENCE \nAND CUSTOMER PIISPECIAL REPORT 14\nAlthough FireEye has observed FIN10 primarily \ntargeting casinos and mining organizations in \nNorth America (with a focus on Canada), all \norganizations from around the world must be \nprepared to detect and respond to threats from \nthis group and other bad actors. \nWe believe the primary goal of FIN10 is to \nsteal corporate business data, files, records, \ncorrespondence and customer PII for the \npurposes of extorting victim organizations for \nthe non-release of the stolen data. Enterprises \nthat are contacted by a group claiming to have \ntheir data will want to carefully assess if an \nincident has actually occurred. In the case of \nFIN10, we have observed them posting proof of \nthe stolen data on publicly accessible websites.\nWhen dealing with these types of extortion-\nbased attacks, we strongly recommend that \norganizations work quickly, stay focused, consider \nall options and potentially involve forensic, legal, \nlaw enforcement and public relations experts \nbefore taking any actions or communicating \nwith the threat actor. Strong segmentation and \ncontrols over backups will help organizations to \nquickly recover from a breach. Additionally, when \nthe incident has been resolved organizations \nshould focus on broader security improvements \nand ensuring the threat actor cannot come back \nin a different way.SPECIAL REPORT 14\nConclusion15 FIN10: ANATOMY OF A CYBER EXTORTION OPERATION\nAppendix – Sample Extortion Email Conclusion\nThe text below is a redacted email that FIN10 sent to one of their victims.FireEye is the intelligence-led security company. Working as a seamless, scalable extension of customer security operations, FireEye offers a single platform that blends innovative \nsecurity technologies, nation-state grade threat intelligence, and world-renowned Mandiant® consulting. With this approach, FireEye eliminates the complexity and burden of cyber \nsecurity for organizations struggling to prepare for, prevent, and respond to cyber attacks. FireEye has over 5,300 customers across 67 countries, including more than 845 of the \nForbes Global 2000.\n© 2017 FireEye, Inc. All rights reserved. FireEye is a registered trademark of FireEye, Inc.  \nAll other brands, products, or service names are or may be trademarks  \nor service marks of their respective owners. SP.FIN10.EN-US.062017FireEye, Inc.  \n1440 McCarthy Blvd. Milpitas, CA 95035  \n408.321.6300 / 877.FIREEYE (347.3393) / info@FireEye.com  \nwww.FireEye.comTo download this or other FireEye Threat Intellience reports, visit:\nwww.fireeye.com/reports"
}