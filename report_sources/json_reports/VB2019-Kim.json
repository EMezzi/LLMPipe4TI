{
    "title": "VB2019-Kim",
    "text": "KimsukyGroup : Track the King of the Spear-Phishing\nJaekiKim, Kyoung-JuKwak, Min-Chang Jang@Financial Security Institute2019.10.042/155\n§JAEKI KIM (a.k.aJACK2)§Malware & Threat  Analysis§Computer Emergency Analysis Team @FSI (2016~ )§Main Author of Threat Intelligence Report ‘Campaign DOKKAEBI’§Speaker of DOKKAEBI: Documents of Korean and Evil Binary @VB2018§Digital Forensic§CECRC @NEC(National Election Commission) (2016)§M.S. degree -Information Security §SANE Lab, Korea University (2014 ~ 2016)§Interest in Analysis§Mentor of Best of the Best(B.O.B) Program(Vulnerability Analysis Track) @KITRI§Member of “KOREANBADASS”, “SeoulPlusBadass” Team@DEFCON CTF Finalist (2017, 2018, 2019)§SNS(facebook,twitter) @2runjack2About Me\n3/155\nAbout Me§Kyoung-juKWAK§Manager of FSI Threat Analysis Team (~Jan.2019)§Manager of FSI Security Operations Center (Current)§Adjunct Professor, Department of Forensics, @SungKyunKwanUniversity§Main Author of Threat Intelligence Report “Campaign Rifle : Andariel, The Maiden of Anguish”§Member of National Police Agency Cybercrime Advisory Committee§Speaker of {Blackhat, Kaspersky SAS, Kaspersky CSW, PACSEC, HITCON,HACKCON, ISCR, etc}§SNS(facebook,twitter) @kjkwak12 \n4/155\nAbout Me▪Min-Chang Jang (a.k.aOSIRIS)A manager of CEATComputer Emergency Analysis Team @FSI (2014~ )Main Author of Threat Intelligence Report ‘Shadow Voice’A graduate student (M.S degree)SANE Lab, Korea University (2014 ~ Now)Served in the Korea NAVY CERTInterest in Extreme SportsSpeaker of {BlackHatEurope & Asia, KIMCHI CON, CODE BLUE}SNS (fb: mins4416, twt: 051R15)\n5/155\nAbout Us▪Threat Intelligence Report http://www.fsec.or.kr/user/bbs/fsec/163/344/bbsDataList.doANDARIEL (2017.07), DOKKAEBI(2018.08),ShadowVoice(2018.12)\n6/155\nContents§Introduction§Related Cases§Toolset characteristics§Tracking Malware & Monitoring C&C§Relationships§Recent Trends§Conclusion7/155\nContents§Introduction§Related Cases§Toolset characteristics§Tracking Malware & Monitoring C&C§Relationships§Recent Trends§Conclusion8/155\n§JAEKI KIM (a.k.aJACK2)§Malware & Threat  Analysis§Computer Emergency Analysis Team @FSI (2016~ )§Main Author of Threat Intelligence Report ‘Campaign DOKKAEBI’§Speaker of DOKKAEBI: Documents of Korean and Evil Binary @VB2018§Digital Forensic§CECRC @NEC(National Election Commission) (2016)§M.S. degree -Information Security §SANE Lab, Korea University (2014 ~ 2016)§Interest in Analysis§Mentor of Best of the Best(B.O.B) Program(Vulnerability Analysis Track) @KITRI§Member of “KOREANBADASS”, “SeoulPlusBadass” Team@DEFCON CTF Finalist (2017, 2018, 2019)§SNS(facebook,twitter) @2runjack2About Me\nDOKKAEBI: Documents of Korean and Evil Binary\nJaekiKim, Kyoung-JuKwak, Min-Chang Jang@Financial Security Institute2018.10.03\n10/155\nIntroduction§Campaign DOKKAEBI §A set of Operation carried out by Threat Groups  §using malicious Hangul documentsfor some particular purpose§Related Threat Groups§Bluenoroff, Kimsuky, Scarcruft§Ddddddd§Dddddddd§Ddddd§d\nHangul documents and dropped(downloaded) malware=> Documents Of KoreanAnd Evil BinaryCampaignDOKKAEBIBluenoroffKimsukyScarcruft11/155\nIntroduction§Related Threat GroupsThreat GroupTargetPurposeActivity TimeMajor IncidentBluenoroffGlobal and Korean domestic financial  companiesOfficials and users of crypto-currency exchangesConfidential information takeover and monetary gain (SWIFT, crypto-currency)2015 ~SWIFT illegal transaction of central bank of BangladeshKimsukyInfrastructure, Government, North Korean defectors and politiciansInformation gathering and social confusion2013 ~KHNP cyber terrorism (2014)ScarcruftDiplomatic and North Korean Human Rights Organizations and PeopleInformation gathering and information destruction purposes2016 ~Attack using Flash Zero Day (CVE-2016-4171, CVE-2018-4878)12/155\n§Related Threat GroupsThreat GroupTargetPurposeActivity TimeMajor IncidentKimsukyInfrastructure, Government, North Korean defectors and politiciansInformation gathering and social confusion2013 ~KHNP cyber terrorism (2014)\nIntroduction13/155\nIntroduction§KimsukyGroup§The kimsukyoperation: a north koreanapt? (Kaspersky, 2013.09)14/155\nIntroduction§KimsukyGroup§The kimsukyoperation: a north koreanapt? (Kaspersky, 2013.09)§KHNP (Korea Hydro & Nuclear Power) cyber terrorism attacks (2014.12)15/155\nIntroduction§KimsukyGroup§The kimsukyoperation: a north koreanapt? (Kaspersky, 2013.09)§KHNP (Korea Hydro & Nuclear Power) cyber terrorism attacks (2014.12)§Still active as of 201916/155\nContents§Introduction§Related Cases§Toolset characteristics§Tracking Malware & Monitoring C&C§Relationships§Recent Trends§Conclusion17/155\nRelated Cases§2019.01. ~ \nReference : https://www.koreatimes.co.kr/www/nation/2019/01/356_261573.html18/155\nRelated Cases\n§Known as Variously Operations§Cobra Vennom,Kitty Phishing,KabarCobra…Reference :https://blog.alyac.co.kr/2066https://threatrecon.nshc.net/2019/01/30/operation-kitty-phishing/https://global.ahnlab.com/global/upload/download/techreport/[Analysis_Report]Operation%20Kabar%20Cobra%20(1).pdfKimsukyAttacks Journalist and a Cryptocurrency Business in South Korea (2019.02.11, Kaspersky)19/155\nContents§Introduction§Related Cases§Toolset characteristics§Tracking Malware & Monitoring C&C§Relationships§Recent Trends§Conclusion20/155\nToolset characteristics§Server-side Toolkits & Malware \n21/155\nToolset characteristics§Server-side Toolkits (for Spear-Phishing)§1) Mailer –shape§2) Mailer –core§3) Beaconer§4) Phisher§5) Logger22/155\nToolset characteristics§Server-side Toolkits (for Spear-Phishing)§1) Mailer –shape §2) Mailer -core§3) Beaconer§4) Phisher§5) Logger\n23/155\nToolset characteristics§Server-side Toolkits (for Spear-Phishing)§1) Mailer -shape §2) Mailer –core§3) Beaconer§4) Phisher§5) Logger\nReference : \n24/155\nToolset characteristics§Server-side Toolkits (for Spear-Phishing)§1) Mailer -shape §2) Mailer -core§3) Beaconer§4) Phisher§5) Logger25/155\nToolset characteristics\n§Server-side§1) Mailer -shape §2) Mailer -core§3) Beaconer§4) Phisher26/155\nToolset characteristics\n§Server-side(for Spear-Phishing)§4) Phisher§5) Logger27/155\nToolset characteristics\n§Server-side(for Spear-Phishing)§4) Phisher§5) Logger\n28/155\nToolset characteristics§Malware §6) Dropper –Malicious HWP Documents§7) Dropper –Camouflaged HWP Documents§8) Script§9) Info Stealer\nReference : 29/155\nToolset characteristics\nReference : \n§Malware \n§Full Image:http://bit.ly/VB2019_IMG_Malware30/155\nToolset characteristics\n§Malware §7) Dropper –Camouflaged HWP31/155\nToolset characteristics\n§Malware §9) Info Stealer32/155\nToolset characteristics§Toolsets\nReference : NameNo.Type (Tag)ContentsMailer (shape)1MailerMailer (just shape)Mailer (core)2MailerMailer (actual function) 1) Attachment malware 2) Link to phishing page for account takeoverBeaconer3Web-BeaconBeacon to check whether mail is being viewedPhisher4Account StealerPhishingPhishing Toolkit(lod) Phishing Page for Account StealLogger5LoggingPhishingLogging for Phishing Target InformationMalicious HWP6DropperSprear-PhishingMalicious HWP DocumetsCamouflaged HWP7DropperSprear-PhishingCamouflaged HWP Documents (Ex. sfx, exe ...)Script8DownloaderLoggingDownload additional malware and logging (Ex. *.vbs, *.wsf, *.jse, *.ps1)Info Stealer9C&C / DLL / FTPDownloaderLoggingSteal Information of Infected Target and Download additional malware (Ex. Some case using FTP)33/155\nContents§Introduction§Related Cases§Toolset characteristics§Tracking Malware & Monitoring C&C§Relationships§Recent Trends§Conclusion34/155\nTracking Malware & Monitoring C&C§Focus35/155\nTracking Malware & Monitoring C&C§Focus§Attacker\n36/155\nTracking Malware & Monitoring C&C§Focus§Attacker != Defender\n37/155\nTracking Malware & Monitoring C&C§Focus§Attacker != Defender\n38/155\nTracking Malware & Monitoring C&C§Focus§Attacker != Defender : OPSEC FAIL\n39/155\nTracking Malware & Monitoring C&C§OPSEC FAIL CASES§1) Directory Listing§2) Leaked FTP Access Information§3) File Download vulnerability40/155\nTracking Malware & Monitoring C&C§OPSEC FAIL CASES§1) Directory Listing41/155\nTracking Malware & Monitoring C&C§[CASE 1-1] Directory Listing –HWP Malware§After “Campaign DOKKAEBI” (H-DS type)42/155\nRelated Toolset§Toolsets\nReference : NameNo.Type (Tag)ContentsMailer (shape)1MailerMailer (just shape)Mailer (core)2MailerMailer (actual function) 1) Attachment malware 2) Link to phishing page for account takeoverBeaconer3Web-BeaconBeacon to check whether mail is being viewedPhisher4Account StealerPhishingPhishing Toolkit(lod) Phishing Page for Account StealLogger5LoggingPhishingLogging for Phishing Target InformationMalicious HWP6DropperSprear-PhishingMalicious HWP DocumetsCamouflaged HWP7DropperSprear-PhishingCamouflaged HWP Documents (Ex. sfx, exe ...)Script8DownloaderLoggingDownload additional malware and logging (Ex. *.vbs, *.wsf, *.jse, *.ps1)Info Stealer9C&C / DLL / FTPDownloaderLoggingSteal Information of Infected Target and Download additional malware (Ex. Some case using FTP)43/155\nRelated Toolset§Toolsets\nReference : NameNo.Type (Tag)ContentsMailer (shape)1MailerMailer (just shape)Mailer (core)2MailerMailer (actual function) 1) Attachment malware 2) Link to phishing page for account takeoverBeaconer3Web-BeaconBeacon to check whether mail is being viewedPhisher4Account StealerPhishingPhishing Toolkit(lod) Phishing Page for Account StealLogger5LoggingPhishingLogging for Phishing Target InformationMalicious HWP6DropperSprear-PhishingMalicious HWP DocumetsCamouflaged HWP7DropperSprear-PhishingCamouflaged HWP Documents (Ex. sfx, exe ...)Script8DownloaderLoggingDownload additional malware and logging (Ex. *.vbs, *.wsf, *.jse, *.ps1)Info Stealer9C&C / DLL / FTPDownloaderLoggingSteal Information of Infected Target and Download additional malware (Ex. Some case using FTP)44/155\nTracking Malware & Monitoring C&C§[CASE 1-1] Directory Listing –HWP Malware\n45/155\nTracking Malware & Monitoring C&C§[CASE 1-1] Directory Listing –HWP Malware§Process Hollowing : notepad.exe§core.dll(4de21c3af64b3b605446278de92dfff4)§DLL Name : OneDll.dll§Export Function Name : DllRegisterServer\n46/155\nTracking Malware & Monitoring C&C§[CASE 1-1] Directory Listing –HWP Malware§fontchk.jse(f22db1e3ea74af791e34ad5aa0297664)§C&C : suppcrt-seourity[.]esy.es(185.224.138[.]29, NL)\n47/155\nTracking Malware & Monitoring C&C§[CASE 1-1] Directory Listing –HWP Malware§fontchk.jse(f22db1e3ea74af791e34ad5aa0297664)§C&C : suppcrt-seourity[.]esy.es(185.224.138[.]29, NL)\n48/155\nTracking Malware & Monitoring C&C§Like Sherlock Holmes …§fontchk.jse(f22db1e3ea74af791e34ad5aa0297664)§C&C : suppcrt-seourity[.]esy.es(185.224.138[.]29, NL)\n49/155\nTracking Malware & Monitoring C&C§[CASE 1-1] Directory Listing –HWP Malware§fontchk.jse(f22db1e3ea74af791e34ad5aa0297664)§C&C : suppcrt-seourity[.]esy.es(185.224.138[.]29, NL)\n50/155\nTracking Malware & Monitoring C&C§C&C -Tracking/Monitoring§fontchk.jse(f22db1e3ea74af791e34ad5aa0297664)§C&C : suppcrt-seourity[.]esy.es(185.224.138[.]29, NL)51/155\nTracking Malware & Monitoring C&C§C&C -Tracking/Monitoring (18.07.10., D+49)§fontchk.jse(f22db1e3ea74af791e34ad5aa0297664)§C&C : suppcrt-seourity[.]esy.es(185.224.138[.]29, NL)\n52/155\nTracking Malware & Monitoring C&C§C&C -Tracking/Monitoring (18.07.10., D+49)§fontchk.jse(f22db1e3ea74af791e34ad5aa0297664)§C&C : suppcrt-seourity[.]esy.es(185.224.138[.]29, NL)\n53/155\nTracking Malware & Monitoring C&C§C&C -Tracking/Monitoring (18.07.13., D+52)§fontchk.jse(f22db1e3ea74af791e34ad5aa0297664)§C&C : suppcrt-seourity[.]esy.es(185.224.138[.]29, NL)\n54/155\nTracking Malware & Monitoring C&C§C&C -Tracking/Monitoring (18.07.13., D+52)§zerobase(53ac231e8091abcd0978124f9268b4e4)§XOR : 0x09FD8477\n55/155\nTracking Malware & Monitoring C&C§C&C -Tracking/Monitoring (18.07.13., D+52)§zerobase_xor_09FD8477(MD5: 8b59ea1ee28e0123da82801abc0cce4d)§DLL Name : HanyangUpload_script.dll§Build Time : 2018.07.12. 08:25:45\n56/155\nTracking Malware & Monitoring C&C§C&C -Tracking/Monitoring (18.07.13., D+52)§HanyangUpload_script.dll–GetName§1) Get Computer Information (Mac Address, Volume)\n57/155\nTracking Malware & Monitoring C&C§C&C -Tracking/Monitoring (18.07.13., D+52)§HanyangUpload_script.dll–GetName§2) Scan Specific Files\n58/155\nTracking Malware & Monitoring C&C§C&C -Tracking/Monitoring (18.07.13., D+52)§HanyangUpload_script.dll–GetName§2) Scan Specific Files\n59/155\nTracking Malware & Monitoring C&C§C&C -Tracking/Monitoring (18.07.13., D+52)§HanyangUpload_script.dll–GetName§3) C&C \n60/155\nTracking Malware & Monitoring C&C§C&C -Tracking/Monitoring (18.07.13., D+52)§HanyangUpload_script.dll–GetName§3) C&C \n61/155\nTracking Malware & Monitoring C&C§C&C -Tracking/Monitoring (18.07.13., D+52)§HanyangUpload_script.dll–GetName§3) C&C : www.military[.]co.kr(211.202.2[.]51, KR)\n62/155\nTracking Malware & Monitoring C&C§C&C -Tracking/Monitoring (18.07.13., D+52)§HanyangUpload_script.dll–GetName§3) C&C : www.military[.]co.kr(211.202.2[.]51, KR)\n63/155\nTracking Malware & Monitoring C&C§[CASE 1-2] Camouflaged as HWP documents64/155\nRelated Toolset§Toolsets\nReference : NameNo.Type (Tag)ContentsMailer (shape)1MailerMailer (just shape)Mailer (core)2MailerMailer (actual function) 1) Attachment malware 2) Link to phishing page for account takeoverBeaconer3Web-BeaconBeacon to check whether mail is being viewedPhisher4Account StealerPhishingPhishing Toolkit(lod) Phishing Page for Account StealLogger5LoggingPhishingLogging for Phishing Target InformationMalicious HWP6DropperSprear-PhishingMalicious HWP DocumetsCamouflaged HWP7DropperSprear-PhishingCamouflaged HWP Documents (Ex. sfx, exe ...)Script8DownloaderLoggingDownload additional malware and logging (Ex. *.vbs, *.wsf, *.jse, *.ps1)Info Stealer9C&C / DLL / FTPDownloaderLoggingSteal Information of Infected Target and Download additional malware (Ex. Some case using FTP)65/155\nRelated Toolset§Toolsets\nReference : NameNo.Type (Tag)ContentsMailer (shape)1MailerMailer (just shape)Mailer (core)2MailerMailer (actual function) 1) Attachment malware 2) Link to phishing page for account takeoverBeaconer3Web-BeaconBeacon to check whether mail is being viewedPhisher4Account StealerPhishingPhishing Toolkit(lod) Phishing Page for Account StealLogger5LoggingPhishingLogging for Phishing Target InformationMalicious HWP6DropperSprear-PhishingMalicious HWP DocumetsCamouflaged HWP7DropperSprear-PhishingCamouflaged HWP Documents (Ex. sfx, exe ...)Script8DownloaderLoggingDownload additional malware and logging (Ex. *.vbs, *.wsf, *.jse, *.ps1)Info Stealer9C&C / DLL / FTPDownloaderLoggingSteal Information of Infected Target and Download additional malware (Ex. Some case using FTP)66/155\nTracking Malware & Monitoring C&C§[CASE 1-2] Camouflaged as HWP documents§SFX\n67/155\nTracking Malware & Monitoring C&C§[CASE 1-2] Camouflaged as HWP documents§Flow\n68/155\nTracking Malware & Monitoring C&C§[CASE 1-2] Camouflaged as HWP documents§Powershell–Set Registry§Path: \\Windows\\CurrentVersion\\Screensavers§Name: ScreenRibbonsDomain§Value: primary-help.esy.es\n69/155\nTracking Malware & Monitoring C&C§[CASE 1-2] Camouflaged as HWP documents§Powershell–Download malware and Execute\n70/155\nTracking Malware & Monitoring C&C§5) Powershell–Download§Path: \\Windows\\CurrentVersion\\Screensavers§Name: ScreenRibbonsDomain§Value: primary-help.esy.es§S§Ddddddd§Dddddddd§Ddddd\n71/155\nTracking Malware & Monitoring C&C§[CASE 1-2] Camouflaged as HWP documents§Return! (2019.04.01.)72/155\nTracking Malware & Monitoring C&C§[CASE 1-2] Camouflaged as HWP documents§Return! (2019.04.01.)\n73/155\nTracking Malware & Monitoring C&C§[CASE 1-2] Camouflaged as HWP documents§Return! (2019.04.01.)§Directory Listing àMailer +_+\n74/155\nTracking Malware & Monitoring C&C§[CASE 1-2] Camouflaged as HWP documents§Return! (2019.04.01.)§Mailer –shape & core\n75/155\nTracking Malware & Monitoring C&C§[CASE 1-2] Camouflaged as HWP documents§Return! (2019.04.01.)§Mailer –shape & core\n76/155\nTracking Malware & Monitoring C&C§[CASE 1-2] Camouflaged as HWP documents§Return! (2019.04.01.)§Mailer –shape & core\n77/155\nTracking Malware & Monitoring C&C§[CASE 1-2] Camouflaged as HWP documents§Self-Testing using My Email\n78/155\nTracking Malware & Monitoring C&C§[CASE 1-2] Camouflaged as HWP documents§Self-Testing using My Email=> Sending normally\n79/155\nTracking Malware & Monitoring C&C§[CASE 1-2] Camouflaged as HWP documents§Check Email (Sent by mailer)\n80/155\nTracking Malware & Monitoring C&C§[CASE 1-2] Camouflaged as HWP documents§Check Email§Attachment from Daum: 시사회.zip (시사회.vbs)§Web Beacon: hxxp://[C&C]/_log/reading.php?uid=[E-mail]\n81/155\nTracking Malware & Monitoring C&C§OPSEC FAIL CASES§1) Directory Listing => Detect New Malware & Mailer82/155\nTracking Malware & Monitoring C&C§OPSEC FAIL CASES§1) Directory Listing : Detect New Malware & Mailer§2) Leaked FTP Access Information83/155\nRelated Toolset§Toolsets\nReference : NameNo.Type (Tag)ContentsMailer (shape)1MailerMailer (just shape)Mailer (core)2MailerMailer (actual function) 1) Attachment malware 2) Link to phishing page for account takeoverBeaconer3Web-BeaconBeacon to check whether mail is being viewedPhisher4Account StealerPhishingPhishing Toolkit(lod) Phishing Page for Account StealLogger5LoggingPhishingLogging for Phishing Target InformationMalicious HWP6DropperSprear-PhishingMalicious HWP DocumetsCamouflaged HWP7DropperSprear-PhishingCamouflaged HWP Documents (Ex. sfx, exe ...)Script8DownloaderLoggingDownload additional malware and logging (Ex. *.vbs, *.wsf, *.jse, *.ps1)Info Stealer9C&C / DLL / FTPDownloaderLoggingSteal Information of Infected Target and Download additional malware (Ex. Some case using FTP)84/155\nRelated Toolset§Toolsets\nReference : NameNo.Type (Tag)ContentsMailer (shape)1MailerMailer (just shape)Mailer (core)2MailerMailer (actual function) 1) Attachment malware 2) Link to phishing page for account takeoverBeaconer3Web-BeaconBeacon to check whether mail is being viewedPhisher4Account StealerPhishingPhishing Toolkit(lod) Phishing Page for Account StealLogger5LoggingPhishingLogging for Phishing Target InformationMalicious HWP6DropperSprear-PhishingMalicious HWP DocumetsCamouflaged HWP7DropperSprear-PhishingCamouflaged HWP Documents (Ex. sfx, exe ...)Script8DownloaderLoggingDownload additional malware and logging (Ex. *.vbs, *.wsf, *.jse, *.ps1)Info Stealer9C&C / DLL / FTPDownloaderLoggingSteal Information of Infected Target and Download additional malware (Ex. Some case using FTP)85/155\nTracking Malware & Monitoring C&C§[CASE 2] Leaked FTP Access Information§Malicious Script (Delivered-Email.wsf)\nReference : https://twitter.com/anyrun_app/status/1115513990711521280\n86/155\nTracking Malware & Monitoring C&C§[CASE 2] Leaked FTP Access Information§Malicious Script (Delivered-Email.wsf)§1) Additional Malware download from C&C§2) Open Email (Normal file)§3) Execute Malware (Info Stealer)§4) FTP Upload\n87/155\nTracking Malware & Monitoring C&C§[CASE 2] Leaked FTP Access Information§Malicious Script (Delivered-Email.wsf)§1) Additional Malware download from C&C§2) Open Email (Normal Email)§3) Execute Malware (Info Stealer)§4) FTP Upload\n88/155\nTracking Malware & Monitoring C&C§[CASE 2] Leaked FTP Access Information§Malicious Script (Delivered-Email.wsf)§1) Additional Malware download from C&C§2) Open Email (Normal file)§3) Execute Malware (Info Stealer)§4) FTP Upload\n89/155\nTracking Malware & Monitoring C&C§[CASE 2] Leaked FTP Access Information§Malicious Script (Delivered-Email.wsf)§1) Additional Malware download from C&C§2) Open Email (Normal file)§3) Execute Malware (Info Stealer)§4) FTP Upload\n90/155\nTracking Malware & Monitoring C&C§[CASE 2] Leaked FTP Access Information§OPSEC FAIL!§4) FTP Upload\n91/155\nTracking Malware & Monitoring C&C§[CASE 2] Leaked FTP Access Information§C&C : FTP Upload §Free Hosting Service (Hostinger) §Compromised website in South Korea§Love victory&rhdwn(공주->princess)92/155\nTracking Malware & Monitoring C&C§[CASE 2] Leaked FTP Access Information§OPSEC FAIL!§4) FTP Upload\n93/155\nTracking Malware & Monitoring C&C§[CASE 2] Leaked FTP Access Information§OPSEC FAIL!§4) FTP Upload\n94/155\nTracking Malware & Monitoring C&C§[CASE 2] Leaked FTP Access Information§OPSEC FAIL!§4) FTP Upload\n95/155\nTracking Malware & Monitoring C&C§[CASE 2] Leaked FTP Access Information§Free Hosting Service (Hostinger)§Love victory&rhdwn(공주->princess)\n96/155\nTracking Malware & Monitoring C&C§[CASE 2] Leaked FTP Access Information§Free Hosting Service (Hostinger)§Love victory -> WebshellPassword\n97/155\nTracking Malware & Monitoring C&C§OPSEC FAIL CASES§1) Directory Listing : Detect New Malware & Mailer§2) Leaked FTP Access Information=> Get Server-side toolkit98/155\nTracking Malware & Monitoring C&C§OPSEC FAIL CASES§1) Directory Listing : Detect New Malware & Mailer§2) Leaked FTP Access Information : Get Server toolkit§3) File Download vulnerability99/155\nRelated Toolset§Toolsets\nReference : NameNo.Type (Tag)ContentsMailer (shape)1MailerMailer (just shape)Mailer (core)2MailerMailer (actual function) 1) Attachment malware 2) Link to phishing page for account takeoverBeaconer3Web-BeaconBeacon to check whether mail is being viewedPhisher4Account StealerPhishingPhishing Toolkit(lod) Phishing Page for Account StealLogger5LoggingPhishingLogging for Phishing Target InformationMalicious HWP6DropperSprear-PhishingMalicious HWP DocumetsCamouflaged HWP7DropperSprear-PhishingCamouflaged HWP Documents (Ex. sfx, exe ...)Script8DownloaderLoggingDownload additional malware and logging (Ex. *.vbs, *.wsf, *.jse, *.ps1)Info Stealer9C&C / DLL / FTPDownloaderLoggingSteal Information of Infected Target and Download additional malware (Ex. Some case using FTP)100/155\nRelated Toolset§Toolsets\nReference : NameNo.Type (Tag)ContentsMailer (shape)1MailerMailer (just shape)Mailer (core)2MailerMailer (actual function) 1) Attachment malware 2) Link to phishing page for account takeoverBeaconer3Web-BeaconBeacon to check whether mail is being viewedPhisher4Account StealerPhishingPhishing Toolkit(lod) Phishing Page for Account StealLogger5LoggingPhishingLogging for Phishing Target InformationMalicious HWP6DropperSprear-PhishingMalicious HWP DocumetsCamouflaged HWP7DropperSprear-PhishingCamouflaged HWP Documents (Ex. sfx, exe ...)Script8DownloaderLoggingDownload additional malware and logging (Ex. *.vbs, *.wsf, *.jse, *.ps1)Info Stealer9C&C / DLL / FTPDownloaderLoggingSteal Information of Infected Target and Download additional malware (Ex. Some case using FTP)101/155\nTracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§EML –HWP Attachment\n102/155\nTracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§EML –HWP Attachment§Distribution Server : member-authorize[.]com\n103/155\nTracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§EML –HWP Attachment§Distribution Server : member-authorize[.]com\n104/155\nTracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§1) HWP§EPS(Encapsulated Postscript), Summary Information (X)\n105/155\nTracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§2) Powershell§Get Malicious Script from ddlove[.]kr\n106/155\nTracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§3) 1.wsf§(a) Set var§(b) Check Extract Util–WinRAR / ALZip§(c) Check Response§(d) Save File & Extract§(e) or Save File & Decoding §(f) Execute file107/155\nTracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§3) 1.wsf§(a) Set var§(b) Check Extract Util–WinRAR / ALZip§(c) Check Response§(d) Save File & Extract§(e) or Save File & Decoding §(f) Execute file\n108/155\nTracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§4) Freedom.dll§Timestamp : Tue Jan 08 09:02:00 2019§Export : GrapHouse§Check Env (32/64)§64bit : /bbs/data/font/exts.fmt§Process Hollwing(explorer.exe)§[SND]: /register.php?WORD=com_XXXXXXXX&NOTE=§[GET]: /bbs/data/ariaK[T]_XXXXXXXX§[DEL]: /join.php?file=109/155\nTracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§4) Freedom.dll§Timestamp : Tue Jan 08 09:02:00 2019§Export : GrapHouse§Check Env (32/64)§64bit : /bbs/data/font/exts.fmt§Process Hollwing(explorer.exe)§[SND]: /register.php?WORD=com_XXXXXXXX&NOTE=§[GET]: /bbs/data/ariaK[T]_XXXXXXXX§[DEL]: /join.php?file=\n110/155\nTracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§4) Freedom.dll§Timestamp : Tue Jan 08 09:02:00 2019§Export : GrapHouse§Check Env (32/64)§64bit : /bbs/data/font/exts.fmt§Process Hollwing(explorer.exe)§[SND]: /register.php?WORD=com_XXXXXXXX&NOTE=§[GET]: /bbs/data/ariaK[T]_XXXXXXXX§[DEL]: /join.php?file=\n111/155\nTracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§EML –HWP Attachment§Distribution Server : member-authorize[.]com\n112/155\nTracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing (OPSEC FAIL –CASE #01)§/security/downloads\n113/155\nTracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing (OPSEC FAIL –CASE #01)§/security/downloads/download.php\n114/155\nTracking Malware & Monitoring C&C§Like Sherlock Holmes … again§fontchk.jse(f22db1e3ea74af791e34ad5aa0297664)§C&C : suppcrt-seourity[.]esy.es(185.224.138[.]29, NL)\n115/155\nTracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Try to File download§/security/downloads/download.php?fileName=dowonload.php\n116/155\nTracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Try to file download§/security/downloads/download.php?fileName=dowonload.php\n117/155\nTracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing + File download§../../../../../../../home/u385698457/public_html/ \n118/155\nTracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing + File download§../../../../../../../home/u385698457/public_html/ \n119/155\nTracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing + File download§../../../../../../../home/u385698457/public_html/ \n120/155\nTracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing + File download§../../../../../../../home/u385698457/public_html/ §Languagesused only inNorth Korea\n121/155\nTracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing + File download§../../../../../../../home/u385698457/public_html/ \n122/155\nTracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing + File download§../../../../../../../home/u385698457/public_html/ \n123/155\nTracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing + File download§github.com/ostoc/http2_php/miniProxy.php\n124/155\nTracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing + File download§/security/mailer\n125/155\nTracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing + File download§/security/mailer\n126/155\nTracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing + File download§/security/mailer\n127/155\nTracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing + File download§/security/mailer\n128/155\nTracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing + File download§/security/mailer\n129/155\nTracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing + File download§1) mail.php\n130/155\nTracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing + File download§2) mail_ok.php-attachFileName\n131/155\nTracking Malware & Monitoring C&C§[CASE 3] File Download vulnerability§Directory Listing + File download§2) mail_ok.php–Phishing (Previous)\n132/155\nContents§Introduction§Related Cases§Toolset characteristics§Tracking Malware & Monitoring C&C§Relationships§Recent Trends§Conclusion133/155\nRelationships§Like Sherlock Holmes …§fontchk.jse(f22db1e3ea74af791e34ad5aa0297664)§C&C : suppcrt-seourity[.]esy.es(185.224.138[.]29, NL)\n134/155\nRelationships§[CASE 1-1] Directory Listing –HWP Malware§fontchk.jse(f22db1e3ea74af791e34ad5aa0297664)§C&C : suppcrt-seourity[.]esy.es(185.224.138[.]29, NL)\n135/155\nRelationships§BetweenToolsetsand C&C server§Compromised website in South Korea§Cooperation with the police and investigation agency§Respond about C&C server\n136/155\nRelationships§Toolsets\nReference : NameNo.Type (Tag)ContentsMailer (shape)1MailerMailer (just shape)Mailer (core)2MailerMailer (actual function) 1) Attachment malware 2) Link to phishing page for account takeoverBeaconer3Web-BeaconBeacon to check whether mail is being viewedPhisher4Account StealerPhishingPhishing Toolkit(lod) Phishing Page for Account StealLogger5LoggingPhishingLogging for Phishing Target InformationMalicious HWP6DropperSprear-PhishingMalicious HWP DocumetsCamouflaged HWP7DropperSprear-PhishingCamouflaged HWP Documents (Ex. sfx, exe ...)Script8DownloaderLoggingDownload additional malware and logging (Ex. *.vbs, *.wsf, *.jse, *.ps1)Info Stealer9C&C / DLL / FTPDownloaderLoggingSteal Information of Infected Target and Download additional malware (Ex. Some case using FTP)137/155\nRelationships§Between Toolsets and C&C server§fontchk.jse(f22db1e3ea74af791e34ad5aa0297664)§C&C : suppcrt-seourity[.]esy.es(185.224.138[.]29, NL)\n138/155\nRelationships§Between Toolsets and C&C server§fontchk.jse(f22db1e3ea74af791e34ad5aa0297664)§C&C : suppcrt-seourity[.]esy.es(185.224.138[.]29, NL)\n139/155\nRelationships§Between Toolsets and C&C server§fontchk.jse(f22db1e3ea74af791e34ad5aa0297664)§C&C : suppcrt-seourity[.]esy.es(185.224.138[.]29, NL)\n140/155\nRelationships\n§BetweenToolsetsand C&C server§Some of the results of analyzing§gyjmc[.]com (KR) → member-authorize[.]com (HOSTINGER) → ddlovke[.]kr(KR) → military[.]co.kr(KR) ← suppcrt-seourity[.]esy.es(HOSTINGER)\nFull ver. : http://bit.ly/VB2019_Kimsuky_Maltego141/155\nContents§Introduction§Related Cases§Toolset characteristics§Tracking Malware & Monitoring C&C§Relationships§Recent Trends§Conclusion142/155\nRecent Trends§[CASE 3] File Download vulnerability§Directory Listing (OPSEC FAIL –CASE #01)§/security/downloads\n143/155\nRecent Trends§[CASE 3] File Download vulnerability§Directory Listing (OPSEC FAIL –CASE #01)§/security/downloads\n144/155\nRecent Trends§[CASE 3] File Download vulnerability§Directory Listing : New Malware§F:\\PC_Manager\\Utopia_v0.1\\bin\\AppleSeed.pdb\n145/155\nRecent Trends§[CASE 1-1] Directory Listing –HWP Malware§HanyangUpload_script.dll–GetName(2018.07.13)§3) C&C : www.military[.]co.kr(211.202.2[.]51, KR)\n146/155\nRecent Trends§[CASE 1-1] Directory Listing –HWP Malware§Another Logs (2019.07.)=>NUCLEAR§3) C&C : www.military[.]co.kr(211.202.2[.]51, KR)\n147/155\n§Related Threat GroupsThreat GroupTargetPurposeActivity TimeMajor IncidentKimsukyInfrastructure, Government, North Korean defectors and politiciansInformation gathering and social confusion2013 ~KHNP cyber terrorism (2014)\nRecent Trends148/155\nContents§Introduction§Related Cases§Toolset characteristics§Tracking Malware & Monitoring C&C§Relationships§Recent Trends§Conclusion149/155\nConclusion§Incidents Response in advance §Geopolitical location in South Korea§Tracking&Monitoring+ @§REMEMBER -Obtained various information through like OPSEC FAIL CASES§Share Information§Cooperate with Relevant agency for Response150/155\nThank you :)Special Thanks:SeongsuPark(@unpacker) @GReATamur84 @National Police Agencyhypen1117E –mail : jack2@fsec.or.krTwitter @2runjack2Q&A"
}