{
    "title": "the equation giveaway _ securelist",
    "text": "Share post on:\nTHERE ARE 4 COMMENTS\nRare implementation of RC5/RC6 in\n‘ShadowBrokers’ dump connects them to Equation\nmalware\nAugust 13, 2016 saw the beginning of a truly bizarre episode. A new identity going under the name ‘ShadowBrokers’ came\nonto the scene claiming to possess files belonging to the apex predator of the APT world, the Equation Group  [PDF]. In their\ninitial leak, the ShadowBrokers claimed the archive was related to the Equation group, however, they didn’t provide any\ntechnical details on the connections.\nAlong with some non-native rants against ‘Wealthy Elites’, the ShadowBrokers provided links to two PGP-encrypted\narchives. The first was provided for free as a presumptive show of good faith, the second remains encrypted at the time of\nwriting. The passphrase is being ‘auctioned’, but having set the price at 1 million BTC (or 1/15th of the total amount of\nbitcoin in circulation), we consider this to be optimistic at best, if not ridiculous at face value.\nThe first archive contains close to 300MBs of firewall exploits, tools, and scripts under cryptonyms like BANANAUSURPER,\nBLATSTING, and BUZZDIRECTION. Most files are at least three years old, with change entries pointing to August 2013 the\nnewest timestamp dating to October 2013.\nAs researchers continue to feast on the release, some have already begun to test the functional capabilities of the exploits\nwith good results .\nHaving originally uncovered the Equation group in February 2015, we’ve taken a look at the newly released files to check for\nany connections with the known toolsets used by Equation, such as EQUATIONDRUG, DOUBLEFANTASY, GRAYFISH and\nFANNY.\nWhile we cannot surmise the attacker’s identity or motivation nor where or how this pilfered trove came to be, we can state\nthat several hundred tools from the leak share a strong connection with our previous findings from the Equation group.\nThe Devil’s in the Crypto\nThe Equation group uses the RC5 and RC6 encryption algorithms quite extensively throughout their creations. RC5 and RC6\nare two encryption algorithms designed by Ronald Rivest in 1994 and 1998. They are very similar to each other, with RC6\nintroducing an additional multiplication in the cypher to make it more resistant. Both cyphers use the same key setup\nmechanism and the same magical constants named P and Q.\nThe particular RC5/6 implementation from Equation group’s malware is interesting and deserves special attention because\nof its specifics. Inside the Equation group malware, the encryption library uses a subtract operation with the constant\n0x61C88647 . In most publicly available RC5/6 code, this constant is usually stored as 0x9E3779B9 , which is basically\n-0x61C88647 . Since an addition is faster on certain hardware than a subtraction, it makes sense to store the constant in its\nnegative form and adding it instead of subtracting. In total, we’ve identified 20 different compiled versions of the RC5/6\ncode in the Equation group malware.\nEncryption-related code in a DoubleFantasy (actxprxy32.dll) sample\nIn the screenshot above, one can observe the main loop of a RC6 key setup subroutine extracted from one of the Equation\ngroup samples. The ShadowBrokers’ free trove includes 347 different instances of RC5/RC6 implementations. As shown in\nthe screenshot below, the implementation is functionally identical including the subtraction of the inverted constant\n0x61C88647 .\nSpecific RC6 implementation from “BUSURPER-2211-611.exe” (md5: 8f137a9100a9fcc8b512b3729878a373\nComparing the older, known Equation RC6 code and the code used in most of the binaries from the new leak we observe\nthat they are functionally identical and share rare specific traits in their implementation.\nIn case you’re wondering, this specific RC6 implementation has only been seen before with Equation group malware. There\nare more than 300 files in the Shadowbrokers’ archive which implement this specific variation of RC6 in 24 different forms.\nThe chances of all these being faked or engineered is highly unlikely.\nThis code similarity makes us believe with a high degree of confidence that the  tools from the ShadowBrokers leak are\nrelated to the malware from the Equation group . While the ShadowBrokers claimed the data was related to the Equation\ngroup, they did not provide any technical evidence of these claims. The highly specific crypto implementation above\nconfirms these allegations.\nMore details about the ShadowBrokers leak and similarities with Equation group are available to Kaspersky\nIntelligence Services reports’ subscribers. For more information, email intelreports@kaspersky.com\nAPT CYBER ESPIONAGE  SHADOW BROKERS  TARGETED ATTACKS  VULNERABILITIES AND EXPLOITS  \nZERO-DAY VULNERABILITIES\nRelated Posts\nDaniel\nPosted on August 17, 2016. 9:44 pm\nRemarkable piece\nREPLY\nNielsen family\nPosted on August 19, 2016. 10:03 am\nMega file not working\nREPLY\nJohn Smith\nPosted on August 20, 2016. 1:11 pm\nAlthough the dates in tar can be manipulated, are we confident it’s not from Snowden’s backups?\nREPLY\nEvgeny Yakovlev\nPosted on August 23, 2016. 2:39 pm\nYou’ve probably already seen this, but anyway: https://www.cs.uic.edu/~s/musings/equation-group-rc6/\nI’ve done some research and\nGCC replaces add reg, imm with sub reg, -imm because -imm can be encoded in less space than imm. Here’s a commit\nthat introduced that for addsi_1 mnemonic: https://github.com/gcc-\nmirror/gcc/commit/c356ea4c37dbf32f7f40706f5eb2bf5d5129c77a\nREPLY\nLEAVE A REPLY\nYour email address will not be published.  Required fields are marked *\nEnter your comment here\nName *\nEmail *\nSave my name, email, and website in this browser for the next time I comment.\n \nSUBMIT\nI'm not a robot\nreCAPTCHA\nPrivacy  - Terms\n APT REPORTS  INCIDENTS\nThe Equation giveaway\nBy GReAT  on August 16, 2016. 7:22 pm\n \nNotify me when new comments are added.\ndirect connection to local network\n© 2020 AO Kaspersky Lab.  All Rights Reserved. \nRegistered trademarks and service marks are the property of their respective owners.\nContact us  | Privacy Policy  | License AgreementEmail\n I agree to provide my email address to “AO Kaspersky Lab” to\nreceive information about new posts on the site. I understand\nthat I can withdraw this consent at any time via e-mail by\nclicking the “unsubscribe” link that I find at the bottom of any e-\nmail sent to me for the purposes mentioned above.\nSUBSCRIBE\nHunting APTs with YARA\n Mokes and Buerak\ndistributed under the guise\nof security certificates\nOperation AppleJeus Sequel\nTHREATS\n CATEGORIES\n TAGS\n STATISTICS ENCYCLOPEDIA DESCRIPTIONS KSB 2019\n English\nSolutions\n Industries\n Products\n Services\n Resource Center\n Contact Us GDPR GET IN TOUCH\n "
}