{
    "title": "insider information_ an intrusion campaign targeting chinese language news sites - the citizen lab",
    "text": " \nPrivacy Policy  Unless otherwise noted this site and its contents are licensed under a Creative Commons Attribution 2.5 Canada  license. \nResearch Targeted Threats\nInsider Information\nAn intrusion campaign targeting Chinese language\nnews sites\nBy Jakub Dalek , Geo rey Alexander , Masashi Crete-Nishihata , and Matt Brooks  July 5, 2017\n“内幕消息”：一起针对中文新闻媒体的入侵行 动\nKey Findings\nThis report reveals a campaign of reconnaissance, phishing, and malware operations\nthat use content and domains made to mimic Chinese language news websites.\nWe confirm the news portal China Digital Times was the target of a phishing operation\nand show how content and domains were made to mimic four other newsgroups in\nreconnaissance and malware operations: Mingjing News, Epoch Times, HK01, and\nBowen Press. We cannot confirm if these other groups were directly targeted. These\nnews websites report on issues sensitive to the government of China and are blocked in\nthe country. However, this report does not conclusively attribute the campaign to a\npublicly reported threat actor or state sponsor.\nThe malware operation made e orts to evade detection and frustrate analysis. The\noperation combined obfuscated, packed executables and custom shellcode with an\nadditional step of using compromised servers to host the malicious payload. We\nidentify the payload as NetWire, a commodity remote access trojan typically seen used\nin cybercrime activities and not commonly observed in Asia.\nWe connect the infrastructure used in the campaign to previous malware operations\ntargeting a Tibetan radio station and the Thai government. We also connect one of the\ncode signing certificates we observed to a campaign targeting gaming companies. It is\nnotable that NetWire was also used as a payload in that campaign.\nSummary\nA journalist at China Digital Times  (CDT), (an independent Chinese and English language\nnews portal), receives an email from a source claiming to have a tip on a sensitive story: “I\nhave insider information that is di erent from what you’ve published”. The email includes a\nlink to an article from the news portal. Clicking on the link displays the article with a pop-up\nmessage asking the journalist to enter their username and password in prompt designed to\nlook like a WordPress login page. What is normally a routine interaction for the journalist\nhas become increasingly threatening. The tip from the source is actually an attempt to steal\nthe journalist’s WordPress credentials used to manage and publish content to the news\nportal.\nThe rouse used in the phishing email was clever, but it did not work. The journalist was\nimmediately suspicious of the phishing attempts and shared them with researchers at the\nCitizen Lab to analyze, which led to the  discovery of a wider campaign targeting Chinese\nlanguage news sites using various tactics including reconnaissance, phishing, and malware.\nThe campaign used domains and copied content that masqueraded as Epoch Times ,\nMingjing News , HK01, and Bowen Press . It is not clear if these other news groups were\ndirectly targeted. These organizations o en report on issues that are politically sensitive to\nthe government of China and their websites are blocked in the country. Our analysis of the\ninfrastructure used in this campaign reveals connections to previous malware operations\ntargeting Tibetan journalists and the Thai government. These incidents includes targets that\nare generally within the geopolitical interest of the government of China. However, this\nreport does not conclusively attribute the campaign to a publicly reported threat actor or\nstate sponsor.\nThere are numerous incidents of journalists and news organizations reporting on China\nbeing targeted by digital espionage operations. In 2009, as part of the GhostNet\ninvestigation, Citizen Lab found that China-based operators had infiltrated the mail servers\nof Associated Press o ices in London and Hong Kong. Another investigation  in 2009, by Nart\nVilleneuve and Greg Walton uncovered a targeted malware campaign against China-based\njournalists working at Reuters, the Straits Times, Dow Jones, Agence France Presse, and\nAnsa. In recent years other major news organizations, including the The New York Times ,\nthe Wall Street Journal , and the Washington Post , have reported intrusions of their\nnetworks and systems by China-based operators. In each incident, the operators were\nsuspected to be sponsored by the government of China with the motivation of gathering\ninformation on China-related reporting that the newspapers were covering.\nThese historical incidents and the campaign we analyze in this report serve as a general\nreminder that the media are targets for digital espionage and, as a result, news\norganizations and journalists need to reflect on their business practices and behaviours and\nadopt a more systematic approach to information security.\nThis report proceeds in five parts outlined below:\nPart 1: Phishing Operation Targeting China Digital Times\nThis section describes phishing messages sent to China Digital Times and our subsequent\ninvestigation into the tactics and server infrastructure used in the operation.\nPart 2: Uncovering a Wider Campaign\nThis section reveals how the operation against China Digital Times was part of a wider\ncampaign of phishing, reconnaissance, and malware operations that used domains and\ncontent made to mimic four other Chinese-language news organizations, Epoch Times,\nMingjing News, HK01, and Bowen Press.\nPart 3: Malware Operation\nThis section describes a malware operation that used content and domains made to mimic\nChinese-language news organizations HK01 and Bowen Press. The malware operation made\ne orts to evade detection and frustrate analysis. The operation combined obfuscated,\npacked executables and custom shellcode with an additional step of using compromised\nservers to host the malicious payload. We identify the payload as NetWire, a commodity\nremote access trojan that is not commonly observed in Asia and typically seen used in\ncybercrime activities.\nPart 4: Campaign Connections\nThis section links infrastructure used in the campaign against Chinese-language news site to\n previous malware campaigns targeting a Tibetan radio station and the Thai government. It\nalso shows the same certificate information used to sign the malware in this campaign was\nused by other malware operations targeting gaming companies.\nPart 5: Discussion and Conclusions\nThis section summarizes the characteristics of the campaign and how it reflects wider\ninformation security challenges for news organizations and journalists.\nPart 1: Phishing Operation Targeting China\nDigital Times\nThis section describes a phishing messages sent to China Digital Times and our subsequent\ninvestigation into the tactics and server infrastructure used in the operation.\nA Suspicious Tip: “I Have Insider Information”\nChina Digital Times is a multi-language news portal that reports on political issues in China\nand aggregates Internet content that has been censored in the country. It was founded by\nXiao Qiang, a Professor at the University of California, Berkeley who has been engaged in\nhuman rights activism  since the 1989 Tiananmen Square Massacre.\nOn February 12, 2017, a CDT sta  member received an email from a person claiming to be a\nUC Berkeley student with “insider information” on claims made by 郭云贵 (Guo Yungui) on\n“hacker attacks” against the Chinese language news site Mingjing News. The characters 郭\n云贵 (Guo Yungui) appears to be a slight variation of Guo Wengui ( 郭文贵), a Chinese\nbillionaire who has gained notoriety a er voicing allegations  that high ranking o icials in\nthe Communist Party of China are engaged in corruption.  In January 2017 he had an\ninterview with Mingjing News in which he made further unconfirmed allegations regarding\no icial corruption and abuse. Following this interview, the editor of Minjing News, claimed\n“several sites and channels of Mingjing were attacked by vicious groups controlled by\ncorrupt parties.”\nThe email sent to CDT included a link that directly referenced an IP address rather than a\ndomain name. The sta  member was immediately suspicious and did not click on the link\n(see below):\nOriginal Email Text\nFrom: papa papa hellomice@mail.com\nDate: February 13 2017\nSubject: 我是伯克利加州大学的学生，我想 认识一下您,我有爆料\nTo: [REDACTED]我想向您爆料，关于郭云 贵说中国黑客攻 击明镜具体内幕，\nhXXp://43.240.14.37/asdasdasadqddd12222111[.]php/article.asp=search.php\nEnglish Translation\nFrom: papa papa hellomice@gmail.com\nDate: February 13 2017\nSubject: I am a student of UC Berkeley. I want to get to know you and I have some explosive revelations for you\nTo: [REDACTED]I’d like to reveal some detailed insider information on Guo Yungui’s claims that Chinese hackers\nattacked Mingjing News\nwebsite.hXXp://43.240.14.37/asdasdasadqddd12222111[.]php/article.asp=search.php\nThree days later, the sta  member received another email o ering insider information on\nthe Mingjing attacks. This email included a link that, at first glance, appeared to be the\ndomain of China Digital Times, but with a slight misspelling. Instead of chinadigitaltimes.net\nthe link sent was chinadagitaltimes[.]net  with an added ‘a’ instead of an ‘i’ in the word\ndigital. A day a er this email was sent, other sta  members at CDT received similar emails\nwith the same link (see below).\nOriginal Email Text\nFrom: sda daaa <aisia.anminda8@mail.com>\nDate: February 14 2017\nSubject: 您好，我想向您爆料相关内幕\nTo: [REDACTED] 您好：\n我有关于中国 时代日报上的一篇文章最新的消息，中国黑客攻 击的后续事件以及最近明 镜网被攻击的内幕\n信息\n文章地址:hXXp://www.chinadagitaltimes[.]net/2016/07/chinese-hackers-blamed-multiple-breaches-fdic/ 文\n中写的与我 这边得到的消息有些差异点\nEnglish Translation\nFrom: sda daaa <aisia.anminda8@mail.com>\nDate: February 14 2017\nSubject: hi, I'd like to offer you some insider information.\nTo: [REDACTED]I have the latest information on an article published by China Daily. It’s about follow-ups on the\nincident of Chinese hackers and some insider information on the recent attacks against Mingjing News.\nLink to the article.\nhXXp://www.chinadagitaltimes[.]net/2016/07/chinese-hackers-blamed-multiple-breaches-fdic/ The\ninformation presented in the article is slightly di erent from the information I know.\nThe link connects to a web page that mirrors content from the real CDT website displaying\nan article related to hacker groups from China (see Figure 1 for comparison of the real and\nfake content).\nFigure 1: Comparison of the real and fake CDT webpages.\nVisually, the content is identical. The only substantive di erence between the real and fake\ncontent is a few lines of javascript code (see Figure 2).\nFigure 2: Snippet of Javascript code in the source of the fake China Digital Times webpage.\nThe function of this code is to pop a window on the screen that says “ 您的登录已失效,请重\n新登录!” [Your login has expired, please log in again!] (see Figure 3).\nFigure 3: Screenshot of the fake China Digital Times webpage and the popup message displayed.\nIf the OK button is clicked, the user is forwarded to what appears to be a WordPress login\npage (see Figure 4).\nFigure 4: Fake WordPress Login page\nCredentials entered into this page are sent to the operators. Following entry of credentials,\nusers are forwarded to the real CDT site. The real CDT website runs on WordPress, and\ntherefore the purpose of this phishing campaign is to steal credentials to the actual CDT\nwebsite and gain access. The operators customized a fake domain to host real content and\ndeveloped custom phishing pages for stealing the WordPress credentials demonstrating a\nsubstantial level of e ort.\nPhishing Operation Timeline\nThrough analysis of the server used to host the phishing pages and the phishing emails sent\nto CDT we documented the activities and timeline of the operation, which lasted for\napproximately 20 days (see Figure 5). The operation began with the operators scanning the\nreal CDT website for vulnerabilities. Five days later the first phishing email was sent. The\nnext day the operators registered the domain mimicking the CDT site, set up the fake site,\nand sent out phishing emails with links to it. Over the next week further phishing emails\nwere sent to CDT. Through analysis of log files found on the server we observed what\nappears to be the operators testing the phishing page during this period. The last phishing\nemail sent to CDT was on February 20. Eight days later the fake CDT website was taken down\nand no further phishing emails were sent.\nFigure 5: Timeline of the phishing operation targeting China Digital Times\nReconnaissance and phishing server\nThis section provides analysis of the server used for reconnaissance and phishing activities.\nWe find fake domains and content related to China Digital Times and Mingjing News on this\nserver.\nThe links sent in the emails to CDT are both on the same IP address: 43[.]240[.]14[.]37 ,\nhosted by Cloudie, a hosting provider based in Hong Kong. The link provided in the first\nphishing email sent to CDT included the full IP address of the server.\nhXXp://43.240.14.37/asdasdasadqddd12222111[.]php/article.asp=search.php\nFour days a er the first phishing email was sent to CDT we accessed the content on the page\nand found it served content copied from a Mingjing News article about illicit sales of Chinese\nvisas (See Figure 6 for comparison of the real and fake content).\nFigure 6: Comparison of the real and fake Mingjing news site\nThe fake page did not render correctly and was missing content, which may be due to\nimproper mirroring of the content, or possibly because the page relies on external content\nin a location that changed since the initial copy. Comparing the legitimate page to the fake\npage finds no addition of code by the operator on the fake page.\nReconnaissance Server Log Analysis\nWe investigated the directory of the fake Minjing News page and found the content was\nmodified on February 14, 2017 and discovered a file ‘log.txt’. This file is a custom log that\ncaptures three pieces of information from every visitor to the page: IP address, web browser\nuser agent, and time visited (see Figure 7). There is no malicious content on the page. We\nsuspect that the purpose of this page is to perform reconnaissance of targets by testing if\nusers will click on the link, and by retrieving IP addresses and user agent information.\nFigure 7: Server directory containing the log.txt file.\nThe first visit in the log file is on February 2, 2017 from the IP address 45[.]124[.]24[.]39\nwhich is also hosted on Cloudie. This visit is likely from the operators because it was the first\nvisit and from the same provider on which the server is hosted. There are also two visits in\nthe logs within seconds of each other, from the IP address 125[.]86[.]123[.]47  (ChinaNet,\nChongqing China)\nExamining the email headers from the phishing emails reveals two IP addresses, including\nthe same Cloudie IP and another ChinaNet Chongqing IP (see below):\n45[.]124[.]24[.]39 Cloudie HK\n141[.]08[.]99[.]155: ChinaNet Chongqing\nWe shared these IP addresses with CDT to check if the addresses had visited the real CDT\nwebsite around the period of the phishing emails. We found that the Cloudie IP address\n(45[.]124[.]24[.]39 ) visited the real CDT web site 42,000 times on February 8 2017, during a\nfour hour period. The rate of the requests, user agents utilized, and information requested\nindicates that these visits were attempts to enumerate HTTP paths on the website to test\nfor vulnerabilities. This scan occurred less than a week before the operators staged the\nphishing page sent to CDT.\nPhishing Server Log Analysis\nBetween February 14 and 28, 2017, a direct visit to the URL hXXp://43[.]240[.]14[.]37\nreturned a copy of the CDT homepage (see Figure 8).\nFigure 8: Comparison of the real frontpage of CDT (as seen on day the emails were sent) and the fake\nwebpage\nThis fake homepage was not included in the emails sent to CDT. The operators potentially\nincluded this homepage if users clicked the link in the email and then viewed the top level\nURL to ensure they were on the right site (see below).\nEmail Link: chinadagitaltimes[.]net/2016/07/chinese‐hackers‐blamed‐multiple‐breaches‐fdic\nHome page: chinadagitaltimes[.]net\nThe directory of chinadagitaltimes[.]net/2016/07  shows the content listed on the server\nand lists the last modified date of the content as February 15, 2017 (see Figure 9).\nFigure 9: An index listing on the phishing server.\nWe found a file ‘log.txt’ on the fake CDT home page and article web pages. This log file\nrecords the IP address, browser user agent, and timestamp of visitors to the pages. We\nfound an additional log in the URL of the fake WordPress login page that captures\nusername, password and date to record credentials that are entered.\nThe logs only included what we suspect to be fake credentials, which demonstrates the\nphishing attempts were unsuccessful. The first entry on February 16, 2017 may be a record\nof the operator testing the phishing page.\nusername:1111‐‐‐‐password:1111‐‐‐‐2017‐02‐16 09:26:14\nOn February 28, we again see what appear to be test credentials added.\nusername:12312‐‐‐‐password:1232131‐‐‐‐2017‐02‐28 10:25:33\nPhishing Operation Final Stages\nOn February 20, the CDT sta  member who received the original phishing email was sent a\nfollow-up email that responded to an auto away message from the sta  member and\nreminded the recipient about the link that was sent. This was the last phishing email sent to\nCDT (see below):\nOriginal Email Text\nFrom: papa papa hellomice@mail.com\nTo: [REDACTED]\nDate: February 20 2017\nSubject: Fwd: 我是伯克利加州大学的学生，我想 认识一下您,我有爆料[REDACTED] 您好:\n我想发一篇文章， 该如何注册与登 录:) thxSent: February 14 2017\nFrom: [REDACTED]\nTo: \"papa papa\"hellomice@mail.com\nSubject: Re: 我是伯克利加州大学的学生，我想 认识一下您,我有爆料\n谢谢来信。非常抱歉我本月 20号之前都没有 时间，请月底和我再 联系。谢谢。2017‐02‐13 18:34 GMT‐08:00 papa papa\nhellomice@mail.com\n我想向您爆料，关于郭云 贵说中国黑客攻 击明镜具体内幕，\nhXXp://43.240.14.37/asdasdasadqddd12222111[.]php/article.asp=search.php\nEnglish Translation\nFrom: papa papa hellomice@mail.com\nTo: [REDACTED]\nDate: February 20 2017\nSubject: Fwd: I am a student at UC Berkeley. I want to get to know you and I have some exclusive information to expose. I would like to publish an\narticle. How do I register and log in? thx Sent: Tuesday, February 14, 2017 at 1:35 PM\nFrom: [REDACTED]\nSubject: Re: I am a student at UC Berkeley. I want to get to know you and I have some exclusive information to\nexpose.\nTo: “papa papa” hellomice@mail.com\nThanks for the email. Unfortunately I don’t have time before 20th this month. Please contact me again at the\nend of this month. Thank you. 2017-02-13 18:34 GMT-08:00 papa papa hellomice@mail.com\nI would like to expose some materials to you. It is about the insider information of Guo Yungui’s claim that\nChinese hackers attacked Ming Jing News.\nhXXp://43.240.14.37/asdasdasadqddd12222111[.]php/article.asp=search.php\nLater on the same day, the phishing pages and log files were taken o line serving a 404 error\nif visited. The bare IP of the server ( 43[.]240[.]14[.]37 ) also switched to returning a default\nCentOS test page. A er the site was taken down on February 28 no additional phishing\nemails were sent and we observed no other activity.\nAnalysis of passive DNS records and WHOIS registration information associated with the\nserver infrastructure used to host the fake CDT page led to the discovery that the phishing\noperation targeting CDT was part of a wider campaign.\nPart 2: Uncovering a Wider Campaign\nThis section reveals how the operation against China Digital Times was part of a wider\ncampaign of phishing, reconnaissance, and malware operations that used domains and\ncontent made to mimic four other Chinese language news organizations.\nInfrastructure Connections\nA er examining the server used to host the fake CDT page and referencing passive DNS\nrecords and WHOIS registration information, we found other fake domains registered by the\nsame entity with copied content from Chinese-language news sites. Our analysis shows that\nthe operators are using the fake domains for at least three di erent purposes:\nreconnaissance, phishing, and malware. We were only able to collect phishing emails sent to\nCDT and cannot confirm if the other media organizations were direct targets or if the fake\ndomains were used to target other groups. Table 1 provides an overview of groups that the\noperator attempted to mimic through fake domains and / or copied content.\nOrganization Fake Domain Registered Site contents copied Confirmed targeting Purpose\nChina Digital Times X X X Phishing\nMingjing News X Recon\nHK01 X Malware\nBowen Press X X Unknown\nEpoch Times X Unknown\nThe fake domains are linked by common WHOIS registration information, which shows they\nwere all registered by the same entity. The WHOIS registration information used to register\nthe fake CDT domain is as follows:\nName: free tibet\nMailing Address: Uniter states, Phoenix Arizona 86303 US\nPhone: +1.2126881188\nEmail: aobama_5@yahoo.com\nWe found a series of domains registered with the same information. The majority of these\ndomains are designed to mimic domains of Chinese-language news sites. We resolved each\ndomain to determine if they are active and which IP they resolve to (see Table 2).\nDomainRegistration\nDateReal OrganizationHosting Status (As of March\n15th)\nsecuerserver[.]com 2015-08-31 GoDaddy (secureserver.com) Not resolving\nbowenpres[.]com 2015-10-07 Bowen Press (bowenpress.com) Parked Page (GoDaddy)\nbowenpress[.]net 2015-10-07 Bowen Press (bowenpress.com) Parked Page (GoDaddy)\nbowenpress[.]org 2015-10-07 Bowen Press (bowenpress.com) Parked Page (GoDaddy)\nbowenpross[.]com 2015-10-07 Bowen Press (bowenpress.com) Parked Page (GoDaddy)\ndatalink[.]one 2016-07-07 n/a Gorillaservers\nchinadagitaltimes[.]\nnet2017-02-14China Digital Times\n(chinadigitaltimes.net)Cloudie HK\nepochatimes[.]com 2017-02-27 Epoch Times (theepochtimes.com) Cloudie HK\nThe registration dates show the operators have been registering fake domains that mimic\nChinese language news websites since 2015, when they registered domains made to look\nlike the real domain of news site Bowen Press ( bowenpress[.]com ).\nWe investigated the servers hosting the domains and found the operators use two servers\nfor di erent purposes: one for phishing and reconnaissance activities and another to serve\nmalware.\nThe phishing and reconnaissance server hosted the fake CDT domain, the fake Mingjing\npage, and a domain made to look like the legitimate domain of Epoch Times (a multilingual\nmedia organization started by Chinese-American Falun Gong supporters.\nOn February 26 2017, the operators registered a fake domain mimicking the main Epoch\nTimes domain (epochtimes[.]com), which adds an additional ‘a’ a er ‘epoch’\n(epochatimes[.]com ).\nFollowing our discovery of the fake Epoch Times domain we notified the organization and\nshared indicators of compromise. Epoch Times found a Cloudie IP ( 103.200.31[.]164 ) that\nsent 24,183 requests during a 12 hour period on March 8, 2017 to the subscription page of\nEpoch Times at the URL subscribe.epochtimes.com . These requests appear to be attempts to\nenumerate HTTP paths, similar to the requests sent to China Digital Times on February 8.\nGiven the timeframe of the registration of the fake Epoch Times domain, we suspect the\noperators may have moved from targeting CDT to Epoch Times. The fake Epoch Times\ndomain was hosted on the same server as the fake CDT and Mingjing pages ( 43.240.14[.]37 ).\nHowever, we did not find content copied from any Epoch Times websites on the operator’s\ninfrastructure during the investigation and did not have any phishing emails reported to us.\nIt is possible that the fake Epoch Times domain is being used for phishing or\nreconnaissance, but we are unable to confirm.\nIn addition to phishing and reconnaissance activities the operators are also engaged in\nmalware operations and have a dedicated server for this purpose. We discovered the\nmalware server by resolving the domain: datalink[.]one , and found it hosted NetWire, a\ncommodity remote access trojan, and included bait content and domains designed to\nmimic Chinese-language news organizations HK01 and Bowen Press.\nPart 3: Malware Operation\nThis section describes a malware operation that used content and domains made to mimic\nChinese-language news organizations HK01 and Bowen Press. The malware operation made\ne orts to evade detection and frustrate analysis. The operation combined obfuscated,\npacked executables, and custom shellcode with an additional step of using compromised\nservers to host the malicious payload. We identify the payload as NetWire, a commodity\nremote access trojan that is not commonly observed in Asia and typically seen used in\ncybercrime activities.\nMalware server and analysis\nOur investigation of the malware operation began with analysis of the server used to host\nthe malware. The malware server is on the IP address: 23[.]239[.]106[.]119  hosted by\nGorillaServers, a provider based in the United States. We found the server by resolving the\ndomain datalink[.]one, which was one of the domains registered by the operators.\nOn the server we found domains and copied content mimicking HK01 and Bowen Press, but\ncannot confirm if these groups were direct targets of the malware operation or if the\ncontent was used as lures to target other groups.\nPassive DNS records for the IP address: 23[.]239[.]106[.]119  show a number of other\ndomains that we have connected to the operators including:\nDomains\ndatalink[.]one\nget.adobe.com.bowenpress[.]org\nhk.secuerserver[.]com\npop.secuerserver[.]com\nsmtpout.secuerserver[.]com\nwww.bowenpress[.]org\nwww.mail.secuerserver[.]com\nwww.secuerserver[.]com\nwww.vnews[.]hk\nWe found that some of these domains were used as command and control servers for the\nmalware we found hosted on the domain.\nHK01 Lure\nWhen we first investigated the malware server on March 6, 2017 we found it was hosting\nwhat appears to be a copy of the frontpage of HK01, a Hong Kong-based news site (see\nFigure 10).\nFigure 10: Comparison of real and fake HK01 webpages\nThe copied version of the HK01 site is missing the centre content displayed on the real site.\nInstead it shows a link with the following text: “Adobe Flash Player 版本過低，請點擊 ”\n[Adobe Flash Player this version is outdated. Please click].\nThe link connects to:\nhXXp://get.adobe.com.bowenpress.org/Adobe/update/20161201/AdobeUpdate[.]html\nClicking this link initiates a download of an executable and then forwards the user to the\nlegitimate Adobe update site. These action are done through the following HTML code:\nWe browsed the directory of 23[.]1239[.]1106[.]119/adobe/update  and found three di erent\nsub directories that each served three di erent executables (see Figure 11). A fourth sub\ndirectory and fourth executable appeared on March 12, 2017.  Analysis of these executables\nshows they are malware.\nFigure 11: Server directory containing malicious executables.\nMalware Analysis\nThe malicious binaries combined obfuscated, packed executables, and custom shellcode\nwith an additional step of using compromised servers to host the malicious payload. We\nidentify the final payload as NetWire, a commodity remote access trojan that is not\ncommonly observed in Asia and typically seen used in cybercrime activities.\nThe four executables we found in the “Adobe update” directory are named to appear as an\nupdate for Adobe Flash followed by a date stamp (e.g., AdobeUpdate20160703.exe ).\nEach malware file was digitally signed:\nFile Certificate Details\nAdobeUpdate20160703.exe无锡凯扬电 子科技有限公司\nSerial: 57 be 1a 00 d2 e5 9b db d1 95 24 aa a1 7e d9 3b\nValid From:  Thursday, November 19, 2015 5:45:01 PM\nValid To: Saturday, November 19, 2016 5:45:01 PM\nAdobeUpdate20160812.exe深圳市乐途儿科技有限公司\nSerial: 68 be c5 c0 26 4c c9 09 6d 2f b2 0a 98 86 e9 4d\nValid From:  Monday, June 15, 2015 4:00:00 PM\nValid To: Thursday, June 15, 2017 3:59:59 PM\nAdobeUpdate20161201.exe\nAdobeUpdate20170312.exeElex do Brasil Participações Ltda\nSerial: 06 71 ee 52 6a cb 6f 9b e2 01 f5 a8 e2 03 c4 1c\nValid From:  Sunday, April 12, 2015 4:00:00 PM\nValid To: Wednesday, July 12, 2017 3:59:59 PM\nAll four samples are packed with VMProtect, so ware used to obfuscate source code to\nmake anaylsis and reverse engineering more di icult. When executed the samples unpack\nand drop a second VMProtect-packed DLL to the following location:\nC:\\Program Files\\Common Files\\Microsoft Shared\\VGX\\Stub.dll\nBefore executing the dropped DLL via rundll32 as shown:\nrundll32.exe C:\\Program Files\\Common Files\\Microsoft Shared\\VGX\\Stub.dll,Install\nThis stub DLL unpacks itself and then gains persistence by creating a new autorun service:\nCOM+ Event Log . The DLL edits the following registry keys to create this new service:\nHKLM\\Software\\Microsoft\\Windows NT\\CurrentVersion\\SvcHost\\EventSystemLog\nHKLM\\System\\CurrentControlSet\\Services\\EventSystemLog\nHKLM\\System\\CurrentControlSet002\\Services\\EventSystemLog\nHKLM\\System\\CurrentControlSet003\\Services\\EventSystemLog\nOnce the DLL has gained persistence it starts the newly created service. When run as part of a\nservice, the DLL unpacks itself and attempts to download what appears to be a jpg file\nhosted on one of three websites: a Chinese-language news organization, a University, and a\nso ware company.\nEach of the 4 samples uses a di erent URL. Each of these files begins with a 631 byte jpg\nheader followed by encrypted shellcode. The malware first decrypts the payload\nimmediately a er the jpg header using the following algorithm:\nfor i = 0; i < len(payload); i++ payload[i] = (16 * ~((((payload[i] ^ 0x50) >> 4) ^ i) & 0xf) & 0xef) ^\npayload[i]\nThe decrypted payload begins with a short header consisting of an unsigned 32 bit integer\nthat is the size of the stage 2 payload, an unsigned 32 bit integer used as a checksum, and 64\nbytes of padding. This header is followed by a block of shellcode and a second encrypted\npayload (see Figure 12). The shellcode decrypts the stage 2 payload using RC4 with di erent\n256-bit keys for each sample.\nFigure 12: Hex code showing jpg header followed by encrypted shellcode\nThis decrypted data contains additional shellcode followed by a PE file. We identify the PE\nfile as the Netwire RAT . The final stage shellcode acts as a loader and maps the RAT into\nmemory and resolves the RAT’s imports before jumping to the RAT’s entrypoint.\nNetwire RAT is a multi-platform RAT (Remote Access Tool) that first appeared in 2012. Since\nits appearance, Netwire RAT has been used in a variety of attacks ranging from stealing\ncredit card data  to targeted campaigns  against health care and banking sectors. The Netwire\nsamples we analyzed are capable of a wide-range of behavior including:\nReading stored usernames and passwords from common apps including:\nWeb Browsers\nEmail Clients\nInstant Messaging Clients\nKeylogging\nTaking Screenshots\nAudio capture\nScreen recording\nProcess listing, creation, killing, etc.\nUploading and downloading files\nEach of the 4 fake jpg files contains a Netwire sample containing di erent configuration\nsettings. A er analyzing the samples we recovered the configuration settings for each\nsample (see Appendix A ). The use of multiple layers of packed or obfuscated payloads is\nlikely an attempt to evade detection and analysis. Downloading the RAT each time the\nmalware runs could be an attempt to hide the final payload, as the Netwire samples are\nnever written to disk. This process makes direct analysis di icult without memory images or\nan understanding of the payload decryption and shellcode routines to decrypt the RAT\nmanually. Using di erent configurations for each sample could be an attempt to use specific\ndomains tailored to each target, or to allow for the use of multiple domains as fallbacks in\ncase previously used domains are discovered and blocked.\nEach of the four binary samples we analyzed downloaded a copy of the Netwire RAT as a\ndi erent “ jpg” file. The three hosts used are all legitimate servers with active web pages. In\neach case, the jpg downloaded by the malware is noticeably larger than other files in the\nsame directory on the server and was last modified more recently. We believe that each of\nthe three servers used to host the “ jpg” files have been compromised and that the operator\nis using these legitimate servers to host their payload in an e ort to hide their activities.\nLike the phishing operation, the malware setup shows a significant level of e ort. We\nobserve custom shellcode paired with an additional step of using likely-compromised\nservers to host the payload. While Netwire has been seen in some targeted intrusions, it has\nprimarily been used in cybercrime activities and is not common in Asia.\nBowen Press Lures\nThe earliest domains registered by the operators that follow the pattern of mimicking China\nrelated news organizations were decoys for Bowen Press. The real Bowen Press domain is\nbowenpress[.]com , the operators registered bowenpress[.]org. We were unable to retrieve the\ncontent that originally appeared on the domains in 2015. However, we were able to find\ncopied Bowen Press content on the malware server through Google searches on the “news”\nsubdirectory of the server. The content was an iframe of the front page of Bowen Press and\nresults in rendering additional error messages (See Figure 13). The existence of Bowen\nPress content on this server suggests that the operators may have been using Bowen Press\nlures to serve malware.\nFigure 13: Comparison of real and fake Bowen Press webpages\nAdditionally,we found the Netwire samples in a directory under the URL\nwww.bowenpress[.]org/Adobe/update , even though the website serving the sample was a copy\nof HK01. The use of this URL path further suggests that the fake Bowen Press domain and\ncontent were used to serve malware at some point. The operators may have simply reused\nthe domain for the HK01 related campaign.\nOn March 15, 2017, the front page of the malware server was changed to a copy of the\nBowen Press website that mirrored content from the same day (see Figure 14). The copied\npage did not contain any malicious code and we were unable to find a log.txt file on the\nserver.\nFigure 14: Screenshot of the malware server on March 15 2017 showing copied content from Bowen\nPress.\nThe only change to the content of the page was the removal of a bot check supplied by\nWordFence, a security plugin for the WordPress blogging platform. On March 21, the content\nwas removed and the server returned a blank page.\nWe cannot confirm what was the purpose of the recently copied Bowen Press content.\nHowever, it shows that the operators have had a continued interest in using Bowen Press\ncontent as lures potentially to serve malware.\nPart 4: Campaign Connections\nThis section links infrastructure used in the campaign against the Chinese-language news\nsites to previous malware campaigns targeting a Tibetan Radio Station and the Thai\ngovernment. It also highlights connections between certificate information used to sign the\nNetwire samples we analyzed and malware used in campaigns targeting gaming\ncompanies.\nInfrastructure Connections to Malware Operations against\nTibetan Radio Station\nDomain registration information for some of the infrastructure used in the campaign have\nlinks to earlier targeted malware operations against civil society and government groups in\nAsia.\nThe WHOIS records for the domains used in the phishing and malware operations include\nthe phone number ( 12126881188 ). Searching other WHOIS records for this number reveals a\nknown command and control server with a Tibet theme. The WHOIS information for this\ndomain matches all the fields with the exception of the email address. All other fields used\nmatch including the same address and misspelling of United States as ‘Uniter States’.\nDomain: www.tibetonline[.]info\nName: free tibet\nMailing Address: Uniter states, Phoenix Arizona 86303 US\nPhone: +1.2126881188\nEmail: rooterit@outlook.com (admin)\nfightfortibet@ymail.com (billing)\nThe registrant e-mail is linked to another domain in addition to tibetonline[.]info  which is\nrooter[.]tk . Both these domains are linked to a 2013 campaign targeting Voice of Tibet, an\nindependent radio station reporting on Tibetan issues. In this campaign, the two domains\nwere reported by ThreatConnect  as being used as a command and control server\n(rooter[.]tk ) and hosting an Adobe Flash heap spray vulnerability ( tibetonline[.]info ) as\nwell as an IE exploit (CVE-2013-1347).\nInfrastructure Connections to Malware Operations against Thai\nGovernment\nThe domain tibetonline[.]info  was also identified by Palo Alto Networks  as a command\nand control server used for FFRAT malware recently described by Cylance. This\ninfrastructure overlapped with servers used by a threat actor targeting Thai government\nentities with the Bookworm trojan in 2015. The general tactics, techniques, and procedures\nused by this threat actor also show similarities to the campaign we analysed. Both used the\nsame hosting provider on one IP: Cloudie HK  ( 103.226.127[.]47 ), and used fake Adobe\nupdates to lure targets into installing malware. The threat actor documented by Palo Alto\nalso used fake news site domains  ( e.g., vancouversun[.]us , yomiuri[.]us , voanews[.]hk , and\nnhknews[.]hk )  Finally, both operations leveraged compromised web servers for command\nand control.\nCertiﬁcate Connections to Malware Targeting Gaming\nCompanies\nIn October 2016 Cylance disclosed information on a threat actor called “PassCV”, which\ntargeted the gaming industry and used stolen code signing certificates to sign malware.\nThe disclosure was an update to information published by Symantec in July 2014 and\nKaspersky’s 2013 view into Winnti.\nCylance lists three malware samples signed with one of the same certificates used to sign\none of the Netwire dropper files in the operation we report on:\n57 BE 1A 00 D2 E5 9B DB D1 95 24 AA A1 7E D9 3B\nIn addition, Cylance also notes the discovery of Netwire being used in the same campaign.\nThe use of Netwire is notable as it is the only other mention of it being used in Chinese-\nnexus malware operations of which we are aware.\nThe disclosure was an update to information published by Symantec in July 2014 and\nKaspersky’s 2013 view into Winnti.\nExplaining the Connections\nThese overlaps point to a number of potential scenarios. The campaign we analyzed may\nhave been conducted by the same threat actors as the previous operations. Alternatively the\noverlap may be an artifact of resource sharing between separate but unrelated threat actors\n— potentially through the use of a “ digital quartermaster ” (a group that supplies operators\nwith malware and other resources), or more informal means. While the first scenario is\npossible, we do not have enough information to fully substantiate it. We suspect that at the\nleast there is some level of sharing and reuse of infrastructure by the same operator or\ngroup of operators. The targets in most of these other campaigns (ethnic minority groups,\ngovernment in Southeast Asia, and news sites reporting on China) generally fall into the\ngeopolitical interests and strategic concerns of the government of China. However, we have\ninsu icient information to conclusively attribute the campaign to a specific threat actor or\nstate sponsor.\nPart 5: Discussion and Conclusion\nThis section summarizes the characteristics of the campaign and how it reflects wider\ninformation security challenges for news organizations and journalism.\nA Patient and Persistent Operator\nWhile the tactics used in these campaigns are technically simple, the operators demonstrate\npatience and persistence. They have been using content and domains mimicking Chinese-\nlanguage news sites as lures since at least 2015, and appear to carefully move from one\ntarget to another. The phishing campaign against China Digital Times was stood up and\ntaken down in the span of 20 days. In this period, the operators scanned the CDT site for\nvulnerabilities, registered a lookalike domain, created a fake CDT decoy site, and sent the\ngroup a wave of customized phishing emails. When these e orts were not successful the\noperators quickly shut down the campaign and moved on to new targeting. The malware\noperation also showed e orts to bypass detection and analysis. The operators combined\nobfuscated, packed executables and custom shellcode with an additional step of using\ncompromised servers to host the payload.\nThe news sites used for lures and targeting in the operation all report on topics seen as\npolitically sensitive by the government of China, and follow a general pattern of news\norganizations reporting on China being targeted by digital espionage. While there are\nconnections between these targets and the geopolitical concerns of the Chinese\ngovernment we cannot conclusively attribute this operation to a state sponsor. What we can\nclearly determine is that this operation was conducted by a threat actor active for at least 2\nyears that targets Chinese language news organizations with intrusion attempts and\nappears to carefully move from target to target.\nInformation Security Challenges for Journalism\nThis campaign reflects general information security challenges for news organizations and\njournalists. Journalists operate in high-paced environments under intense time pressures.\nAs part of their practice, they regularly receive information from unknown sources in a\nvariety of media ( e.g., social media, email, chat messages, etc). Gathering sources and\nmaterial requires journalists to be open and accessible online. Journalists also may handle\nsensitive information and contacts. Ideally, information security should be part of their\nstandard work process, but information security is but one consideration out of many other\ncompeting priorities . Journalists and management may not have the same level of\nawareness or concern  for information security threats.  Bridging these gaps, balancing\nconflicting necessities for openness, availability, and security all within a resource-\nconstrained environment are major challenges. Nonetheless, information security needs to\nbe addressed.\nThe case we analyzed (and many others like it) shows journalists and news groups are being\ntargeted by digital espionage operations designed to access confidential information and\nsystems. The threat is not only against journalists reporting on China. Previous research has\nfound digital espionage operations targeting journalists reporting on the  Middle East,  Latin\nAmerica, Russia, and elsewhere.  More work is needed to understand the nature of the\nthreats and ways to mitigate them that are sensitive to the practicalities and realities of\njournalism.\nAcknowledgements\nWe are grateful to China Digital Times, Epoch Times, Bowen Press, and HK01 for their\nparticipation.\nThanks to our colleagues for review and assistance: John Scott-Railton, Lotus Ruan, Je rey\nKnockel, Lokman Tsui, Valkyrie-X Security Research Group, Andrew Hilts, Ron Deibert, and\nTNG.\nThis project was supported by the John T. and Catherine D. MacArthur Foundation.\nAppendix A: Malware Con guration Settings\nFile name: 7.jpg\nConnectionString: email23.secuerserver[.]com:443;\nProxyString: ‐\nPassword: Password\nHostId: HostId‐%Rand%\nMutex: ‐\nInstallPath: ‐\nStartupKeyName1: ‐\nStartupKeyName2: ‐\nKeyLoggerFilePath: ‐\nBoolSettingsByte: 000\nConnectionType: 000\nFile name: 8.jpg\nConnectionString: hk.secuerserver[.]com:443;\nProxyString: ‐\nPassword: Password\nHostId: HostId‐%Rand%\nMutex: ‐\nInstallPath: ‐\nStartupKeyName1: ‐\nStartupKeyName2: ‐\nKeyLoggerFilePath: ‐\nBoolSettingsByte: 000\nConnectionType: 001\nFile name: HHBcampus.jpg\nConnectionString: HK.SECUERSERVER[.]COM:443;\nProxyString: ‐\nPassword: Password\nHostId: HostId‐%Rand%\nMutex: ‐\nInstallPath: ‐\nStartupKeyName1: ‐\nStartupKeyName2: ‐\nKeyLoggerFilePath: ‐\nBoolSettingsByte: 000\nConnectionType: 001\nFilename: icon_sad.jpg\nConnectionString: dns.bowenpress[.]org:443;\nProxyString: ‐\nPassword: Password\nHostId: HostId‐%Rand%\nMutex: ‐\nInstallPath: ‐\nStartupKeyName1: ‐\nStartupKeyName2: ‐\nKeyLoggerFilePath: ‐\nBoolSettingsByte: 000\nConnectionType: 001\nAppendix B: Indicators Of Compromise\nIndicators of compromise for this report can be found on our github page .\nMedia Mentions\nGizmodo, China Digital Times , Threat Post , Epoch Times , Times of India , Democracy Now\nSocial Engineering Attacks on Government Opponents\nམི་མང་གི་ཚ གས་ ེ་ཁག་ལ་ ན་མ ད་པའི་ ོག་ ད་ ི་ ་འ འི་ ོལ་ ང་འ ད་བཞིན་པ།Ron Deibert on this post:\nMore than meets the eyeTags:\nChina, journalists , Malware, Surveillance , Targeted ThreatsRelated: Share:XRESEARCH\nTargeted Threats\nFree Expression\nOnline\nTransparency and\nAccountability\nApp Privacy and\nControls\nGlobal Research\nNetwork\nTools & Resources\nAll Publications NEWS\nIn the Media\nEvents\nOpportunities\nNewsletter Archives ABOUT\nAbout the Citizen Lab\nPeople\nMedia Resources\nTeaching\nDonate\nCONNECT\nNEWSLETTER\nYour email address Sign up\n "
}