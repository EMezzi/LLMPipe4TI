{
    "title": "hidden cobra – fastcash campaign _ cisa",
    "text": "Official website of the Department of Homeland Security\nHome    Site Map    FAQ    Contact Us    Traffic Light Protocol    PCII    Accountability    Disclaimer    Privacy Policy    FOIA    No Fear Act    Accessibility Plain Writing Plug-\nins    Inspector General    The White House    USA.gov\n \nCISA is part of the Department of Homeland Security\nAbout Us Alerts and Tips Resources Industrial Control Systems Report\nNational Cyber Awareness System  > Alerts  > HIDDEN COBRA – FASTCash Campaign\nMore AlertsAlert (TA18-275A)\nHIDDEN COBRA – FASTCash Campaign\nOriginal release date: October 02, 2018 | Last revised : December 21, 2018\nSystems Affected\nRetail Payment Systems\nOverview\nThis joint Technical Alert (TA) is the result of analytic efforts between the Department of Homeland Security (DHS), the Department of the Treasury (Treasury), and the\nFederal Bureau of Investigation (FBI). Working with U.S. government partners, DHS, Treasury, and FBI identified malware and other indicators of compromise (IOCs) used\nby the North Korean government in an Automated Teller Machine (ATM) cash-out scheme—referred to by the U.S. Government as “FASTCash.” The U.S. Government refers\nto malicious cyber activity by the North Korean government as HIDDEN COBRA. For more information on HIDDEN COBRA activity, visit https://www.us-\ncert.gov/hiddencobra .\nFBI has high confidence that HIDDEN COBRA actors are using the IOCs listed in this report to maintain a presence on victims’ networks to enable network exploitation. DHS,\nFBI, and Treasury are distributing these IOCs to enable network defense and reduce exposure to North Korean government malicious cyber activity.\nThis TA also includes suggested response actions to the IOCs provided, recommended mitigation techniques, and information on reporting incidents. If users or\nadministrators detect activity associated with the malware families associated with FASTCash, they should immediately flag it, report it to the DHS National Cybersecurity\nand Communications Integration Center (NCCIC) or the FBI Cyber Watch (CyWatch), and give it the highest priority for enhanced mitigation.\nNCCIC conducted analysis on 10 malware samples related to this activity and produced a Malware Analysis Report (MAR). MAR-10201537, HIDDEN COBRA FASTCash-Related\nMalware, examines the tactics, techniques, and procedures observed in the malware. Visit the MAR-10201537 page for the report and associated IOCs.\nDescription\nSince at least late 2016, HIDDEN COBRA actors have used FASTCash tactics to target banks in Africa and Asia. At the time of this TA’s publication, the U.S. Government has\nnot confirmed any FASTCash incidents affecting institutions within the United States.\nFASTCash schemes remotely compromise payment switch application servers within banks to facilitate fraudulent transactions. The U.S. Government assesses that\nHIDDEN COBRA actors will continue to use FASTCash tactics to target retail payment systems vulnerable to remote exploitation.\nAccording to a trusted partner’s estimation, HIDDEN COBRA actors have stolen tens of millions of dollars. In one incident in 2017, HIDDEN COBRA actors enabled cash to be\nsimultaneously withdrawn from ATMs located in over 30 different countries. In another incident in 2018, HIDDEN COBRA actors enabled cash to be simultaneously\nwithdrawn from ATMs in 23 different countries.  \nHIDDEN COBRA actors target the retail payment system infrastructure within banks to enable fraudulent ATM cash withdrawals across national borders. HIDDEN COBRA\nactors have configured and deployed malware on compromised switch application servers in order to intercept and reply to financial request messages with fraudulent\nbut legitimate-looking affirmative response messages. Although the infection vector is unknown, all of the compromised switch application servers were running\nunsupported IBM Advanced Interactive eXecutive (AIX) operating system versions beyond the end of their service pack support dates; there is no evidence HIDDEN COBRA\nactors successfully exploited the AIX operating system in these incidents.\nHIDDEN COBRA actors exploited the targeted systems by using their knowledge of International Standards Organization (ISO) 8583—the standard for financial transaction\nmessaging—and other tactics. HIDDEN COBRA actors most likely deployed ISO 8583 libraries on the targeted switch application servers. Malicious threat actors use these\nlibraries to help interpret financial request messages and properly construct fraudulent financial response messages.\nFigure 1: Anatomy of a FASTCash scheme\nA review of log files showed HIDDEN COBRA actors making typos and actively correcting errors while configuring the targeted server for unauthorized activity. Based on\nanalysis of the affected systems, analysts believe that malware—used by HIDDEN COBRA actors and explained in the Technical Details section below—inspected inbound\nfinancial request messages for specific primary account numbers (PANs). The malware generated fraudulent financial response messages only for the request messages\nthat matched the expected PANs. Most accounts used to initiate the transactions had minimal account activity or zero balances.\nAnalysts believe HIDDEN COBRA actors blocked transaction messages to stop denial messages from leaving the switch and used a GenerateResponse* function to\napprove the transactions. These response messages were likely sent for specific PANs matched using CheckPan() verification (see figure 1 for additional details on\nCheckPan() ).\nTechnical Details\nHIDDEN COBRA actors used malicious Windows executable applications, command-line utility applications, and other files in the FASTCash campaign to perform\ntransactions and interact with financial systems, including the switch application server. The initial infection vector used to compromise victim networks is unknown;\nhowever, analysts surmise HIDDEN COBRA actors used spear-phishing emails in targeted attacks against bank employees. HIDDEN COBRA actors likely used Windows-\nbased malware to explore a bank’s network to identify the payment switch application server. Although these threat actors used different malware in each known incident,\nstatic analysis of malware samples indicates similarities in malware capabilities and functionalities.\nHIDDEN COBRA actors likely used legitimate credentials to move laterally through a bank’s network and to illicitly access the switch application server. This pattern\nsuggests compromised systems within a bank’s network were used to access and compromise the targeted payment switch application server.\nUpon successful compromise of a bank’s payment switch application server, HIDDEN COBRA actors likely injected malicious code into legitimate processes—using\ncommand-line utility applications on the payment switch application server—to enable fraudulent behavior by the system in response to what would otherwise be normal\npayment switch application server activity. NCCIC collaborated with Symantec cybersecurity researchers to provide additional context on existing analysis [1] . Malware\nsamples analyzed included malicious AIX executable files intended for a proprietary UNIX operating system developed by IBM. The AIX executable files were designed to\ninject malicious code into a currently running process. Two of the AIX executable files are configured with an export function, which allows malicious applications to\nperform transactions on financial systems using the ISO 8583 standard. See MAR-10201537 for details on the files used. Figure 1 depicts the pattern of fraudulent\nbehavior.\nDuring analysis of log files associated with known FASTCash incidents, analysts identified the following commonalities:\nExecution of .so (shared object) commands using the following pattern: /tmp/.ICE‐unix/e <PID> /tmp.ICE‐unix/<filename>m.so <argument>\nThe process identifier, filename, and argument varied between targeted institutions. The tmp directory typically contains the X Window System session\ninformation.\nExecution of the .so  command, which contained a similar, but slightly different, command: ./sun <PID>/tmp/.ICE‐unix/engine.so  <argument>\nThe file is named sun and runs out of the /tmp/.ICE‐unix directory .\nAdditionally, both commands use either the inject (mode 0) or eject (mode 1) argument with the following ISO 8583 libraries:\nm.so [with argument “0” or “1”]\nm1.so [with argument “0” or “1”]\nm2.so [with argument “0” or “1”]\nm3.so [with argument “0” or “1”]\nDetection and Response\nNCCIC recommends administrators review bash history logs of all users with root privileges. Administrators can find commands entered by users in the bash history logs;\nthese would indicate the execution of malicious code on the switch application server. Administrators should log and monitor all commands.\nThe U.S. Government recommends that network administrators review MAR-10201537 for IOCs related to the HIDDEN COBRA FASTCash campaign, identify whether any of\nthe provided IOCs fall within their organization’s network, and—if found—take necessary measures to remove the malware.\nImpact\nA successful network intrusion can have severe impacts, particularly if the compromise becomes public. Possible impacts to the affected organization include\nTemporary or permanent loss of sensitive or proprietary information,\nDisruption to regular operations,\nFinancial costs to restore systems and files, and\nPotential harm to an organization’s reputation.\nSolution\nMitigation Recommendations for Institutions with Retail Payment Systems\nRequire Chip and Personal Identification Number Cryptogram Validation\nImplement chip and Personal Identification Number (PIN) requirements for debit cards.\nValidate card-generated authorization request cryptograms.\nUse issuer-generated authorization response cryptograms for response messages.\nRequire card-generated authorization response cryptogram validation to verify legitimate response messages. \nIsolate Payment System Infrastructure\nRequire two-factor authentication before any user can access the switch application server.\nVerify that perimeter security controls prevent internet hosts from accessing the private network infrastructure servicing your payment switch application server.\nVerify that perimeter security controls prevent all hosts outside of authorized endpoints from accessing your system.\nLogically Segregate Operating Environments\nUse firewalls to divide operating environments into enclaves.\nUse Access Control Lists (ACLs) to permit or deny specific traffic from flowing between those enclaves.\nGive special considerations to enclaves holding sensitive information (e.g., card management systems) from enclaves requiring internet connectivity (e.g., email).\nEncrypt Data in Transit\nSecure all links to payment system engines with a certificate-based mechanism, such as mutual transport layer security, for all traffic external or internal to the\norganization.\nLimit the number of certificates used on the production server, and restrict access to those certificates.\nMonitor for Anomalous Behavior as Part of Layered Security\nConfigure the switch application server to log transactions. Routinely audit transactions and system logs.\nDevelop a baseline of expected software, users, and logons. Monitor switch application servers for unusual software installations, updates, account changes, or other\nactivity outside of expected behavior.\nDevelop a baseline of expected transaction participants, amounts, frequency, and timing. Monitor and flag anomalous transactions for suspected fraudulent activity.\nRecommendations for Organizations with ATM or Point-of-Sale Devices\nImplement chip and PIN requirements for debit cards.\nRequire and verify message authentication codes on issuer financial request response messages.\nPerform authorization response cryptogram validation for Europay, Mastercard, and Visa transactions.\nMitigation Recommendations for All Organizations\nNCCIC encourages users and administrators to use the following best practices to strengthen the security posture of their organization’s systems:\nMaintain up-to-date antivirus signatures and engines.\nKeep operating system patches up-to-date.\nDisable file and printer sharing services. If these services are required, use strong passwords or Active Directory authentication.\nRestrict users’ ability (i.e., permissions) to install and run unwanted software applications. Do not add users to the local administrators group unless required.\nEnforce a strong password policy and require regular password changes.\nExercise caution when opening email attachments, even if the attachment is expected and the sender appears to be known.\nEnable a personal firewall on organization workstations, and configure it to deny unsolicited connection requests.\nDisable unnecessary services on organization workstations and servers.\nScan for and remove suspicious email attachments; ensure the scanned attachment is its “true file type” (i.e., the extension matches the file header).\nMonitor users’ web browsing habits; restrict access to sites with content that could pose cybersecurity risks.\nExercise caution when using removable media (e.g., USB thumb drives, external drives, CDs).\nScan all software downloaded from the internet before executing.\nMaintain situational awareness of the latest cybersecurity threats.\nImplement appropriate ACLs.\nFor additional information on malware incident prevention and handling, see the National Institute of Standards and Technology (NIST) Special Publication (SP) 800-83:\nGuide to Malware Incident Prevention and Handling for Desktops and Laptops .[2]\nResponse to Unauthorized Network Access\nContact DHS or your local FBI office immediately. To report an intrusion and request resources for incident response or technical assistance, contact NCCIC at\n(NCCICCustomerService@hq.dhs.gov  or 888-282-0870), FBI through a local field office, or the FBI’s Cyber Division ( CyWatch@fbi.gov  or 855-292-3937).\nReferences\n[1] Symantec: FASTCash: How the Lazarus Group is Emptying Millions from ATMs\n[2] NIST SP 800-83: Guide to Malware Incident Prevention and Handling for Deskt…\nRevisions\nOctober 2, 2018: Initial version\nDecember 21, 2018: Added link to Symantec blog\nThis product is provided subject to this Notification  and this Privacy & Use  policy.\nWas this document helpful?  Yes  |  Somewhat   |  No\nContact Us\n(888)282-0870\nSend us email\nDownload PGP/GPG keys\nSubmit website feedbackSubscribe to Alerts\nReceive security alerts, tips, and other updates.\n Enter your email address\nSign Up  \n HSINReport\nSearch\n "
}