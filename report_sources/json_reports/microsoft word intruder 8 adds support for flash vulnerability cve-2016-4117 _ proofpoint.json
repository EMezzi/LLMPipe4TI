{
    "title": "microsoft word intruder 8 adds support for flash vulnerability cve-2016-4117 _ proofpoint",
    "text": "About Threat Center Products Resources Connect\nSupport\n/Blog /Threat Insight /Microsoft Word Intruder 8 Adds Support for Flash Vulnerability CVE-2016-4117\nNOVEMBER 07, 2016  | PROOFPOINT STAFF\nAnalysis\nMicrosoft Word Intruder (MWI) is a kit designed for building malicious Microsoft Word documents for use in targeted attacks. The most\nrecent iteration of MWI - Version 8 - supports a wide variety of vulnerabilities that actors can exploit via crafted Microsoft Word documents.\nAvailable on underground markets since 2013, we first identified MWI in March 2015 [1]. FireEye [2] and Sophos [3] provided additional\ndocumentation of the kit later that year.\nIn the mid-July 2016, an advertisement for MWI on an underground site stated that this exploit document builder integrated CVE-2016-4117\n(Adobe Flash Player up to 21.0.0.213). At the end of August, MWI incremented to version 8, with the message “MICROSOFT WORD\nINTRUDER 8 (MWI8): CVE-2016-4117 + CVE-2015-2545 + CVE-2015-1641 + CVE-2012-0158” in an advertisement for the new version\n(see Appendix).\nWe were able to observe this updated version in the wild dropping various payloads; for example, we saw it dropping RTM Banker on\nOctober 21. In this case, the document “business project laveco price.doc.rtf” was delivered via email and targeted at retail, financial, and\nmanufacturing verticals.\nFigure 1: Network traffic for MWI and its RTM Banker payload network traffic on October 21\nNote that we observed the same instance of RTM fed by Empire Pack (RIG variant [4]) in multiple infection vectors (both compromised sites\nand malvertising) in multiple countries (the Netherlands, Norway, Germany, Spain, Switzerland, Sweden, Austria, and Ireland).\nAnother observed MWI document “Изменения условий взаимодействия.doc” (translated from Russian as “Changes of conditions of\ncooperation.doc”) dropped a TeamViewer-based RAT on September 7.\nFigure 2: MWI document installing a TeamViewer-based RAT and reporting to C&C\nThe Adobe Flash Player zero-day CVE-2016-4117 zero-day was discovered by FireEye [5], and was first used by an APT actor named\n“ScarCruft”, as described by Kaspersky [6]. The exploit was later integrated into multiple exploits kits [7].\nWhen we examined the MWI CVE-2016-4117 addition, it appears that this exploit document builder reused the original exploit code without\nmodifying anything except the shellcode. The first Flash file decrypts a second Flash file, which triggers the vulnerability. In fact, the MWI\nauthor maintained the same decryption routine and the XOR key for this second file.\nFigure 3: Original sample on the left, MWI exploit integration on the right\nThis second Flash file appears to be the exact same file from the original exploit, without any modification by the MWI author.\nFigure 4: ActiveScript code triggering the vulnerability\nConclusion\nMicrosoft Word Intruder is an example of the sort of sophisticated crimeware used to develop attacks on a variety of targets. By\nincorporating new vulnerabilities in vectors such as Adobe Flash, MWI users increase the likelihood that their malicious documents will\nsuccessfully infect target devices. This particular vulnerability has also been incorporated in a number of web-based exploit kits, making it\nimperative that users and organizations who choose to maintain Flash on their systems update to the latest versions.\nReferences\n[1] https: //threatintel.proofpoint.com /sid/2020700\n[2] https://www.fireeye.com/blog/threat-research/2015/04/a_new_word_document.html\n[3] https://www.sophos.com/en-us/medialibrary/PDFs/technical[20papers]/sophos-microsoft-word-intruder-revealed.pdf?la=en\n[4] http://malware.dontneedcoffee.com/2016/10/rig-evolves-neutrino-waves-goodbye.html\n[5] https://www.fireeye.com/blog/threat-research/2016/05/cve-2016-4117-flash-zero-day.html\n[6] https://securelist.com/blog/research/75100/operation-daybreak/\n[7] http://malware.dontneedcoffee.com/2016/05/cve-2016-4117-flash-up-to-2100213-and.html\nIndicators of Compromise (IOCs)\nsha256 Comment\na02b009929079af6b3ebe26305765aa469c41f703b3836b170ee16bc6b43\n223cMWI8 document “business project laveco price.doc.rtf”dropping RTM\nBanker\nfe41a918e38abe4de2108357c8a7ab87658abf68a457e59473052443038\n638d9MWI8 document “Изменения условий взаимодействия.doc” dropping a\nTeamViewer-based RAT\n \nDomain/IP Comment\ntake5market[.]com|82.146.37.202 MWI8 C2\npink.publicvm[.]com|5.45.80.32 MWI8 C2\nbibi[.]pro MWI8 C2\n188.138.71.117 RTM C2\nSelect ET Rules\n2022008 || ET TROJAN MWI Maldoc Stats Callout Oct 28\n2821723 || ETPRO TROJAN Possible MWI Stage 2 Beacon\n2815288 || ETPRO TROJAN RTM Banker CnC M2\n2820286 ETPRO WEB_CLIENT Adobe Flash Uncompressed Possible (CVE-2016-4117)\n2820272 ETPRO WEB_CLIENT Microsoft Rich Text File download with embedded Flash File Possible (CVE-2016-4117)\nAppendix\n2016-07-13 - Update to MWI advertisement\nэксплойт под уязвимость CVE-2016-4117 (удаленное выполнение кода в Adobe Flash Player) вошел в состав эксплойт-пака MWI.\nтеперь пак атакует сразу несколько векторов:\n1) атака на компоненты MS Windows\n2) атака на компоненты MS Office\n3) атака на сторонние приложения и их компоненты (Adobe Flash Player)\nпомимо только Remote Code Execution эксплойтов, новый MWI включает в себя модуль для проведения DLL-planting/DLL-hijacking\nатак. и работают они все в комбинации друг с другом. на первом этапе проводится DLL-planting атака. если подгрузить свою DLL\nиз текущей директории не удалось, то в дело вступает уже целый ряд RCE-эксплойтов.\n2016-07-13 - Update to MWI advertisement - English Translation via Google Translate\nAn exploit for the vulnerability CVE-2016-4117 (remote code execution in Adobe Flash Player) became part of the exploit pack-MWI. Now\npack attack multiple vectors:\n1) The attack on the components of MS Windows\n2) attack on MS Office components\n3) attack on third-party applications and their components (Adobe Flash Player)\nBesides just Remote Code Execution Exploit new MWI includes a module for DLL-planting / DLL-hijacking attacks. and they all work in\ncombination with each other. on the first stage of a DLL-planting attack. if to load a DLL could not be in the current directory, it comes in has\na number of RCE-exploits.\n2016-08-31 - MWI8 announced:\nMICROSOFT WORD INTRUDER 8 (MWI8): CVE-2016-4117 + CVE-2015-2545 + CVE-2015-1641 + CVE-2012-0158\nна данный момент эксплойт-кит содержит следующий набор RCE эксплойтов:\nЦитата\nCVE-2010-3333 [MS10-087]: RTF pFragments Stack Buffer Overflow\nCVE-2012-0158 [MS12-027]: MSComCtlLib.ListView Stack Buffer Overflow \nCVE-2013-3906 [MS13-096]: TIFF Heap Overflow via Integer Overflow (heap-spray based)\nCVE-2014-1761 [MS14-017]: RTF ListOverrideCount Object Confusion (Memory Corruption)\nCVE-2015-1641 [MS15-033]: XML SmartTag Use After Free (heap-spray based)\nCVE-2015-2545 [MS15-099]: Microsoft Office Malformed EPS File Vulnerability\nCVE-2016-4117 [MS16-064]: Adobe Flash Player Type Confusion Overflow Vulnerability\nMWI содержит две основные комбинации эксплойтов:\nЦитата\nMWI8: CVE-2016-4117 + CVE-2015-2545 + CVE-2015-1641 + CVE-2012-0158\nMWI4: CVE-2014-1761 + CVE-2013-3906 + CVE-2012-0158 + CVE-2010-3333 (old)\nэто единственный эксплойт на рынке, который включает в себя подобную комбинацию эксплойтов. как правило, все эти эксплойты\nможно встретить только по отдельности. а CVE-2015-2545 вообще выполнен в альтернативном формате (RTF вместо\nстандартного DOCX), что позволяет ему быть менее детектируемым различными generic сигнатурами.\nтакже MWI8 включает в себя следующие DLL-planting эксплойты:\nЦитата\nCVE-2016-0041 [MS16-014]: oci.dll     \nCVE-2015-6132 [MS15-132]: mqrt.dll\nCVE-2016-0016 [MS16-007]: mfplat.dll  \nCVE-2015-6128 [MS15-132]: elsext.dll\nCVE-2015-6128 [MS15-132]: spframe.dll \nCVE-2016-0018 [MS16-007]: api-ms-win-core-winrt-l1-1-0.dll\nCVE-2015-6132 [MS15-132]: wuaext.dll\nDLL-planting эксплойты работают в комбинации с RCE-эксплойтами. если DLL-planting эксплойт не сработал и подгрузить ту или\nиную динамическую библиотеку из текущей директории не удалось, то в дело следом уже в вступают RCE эксплойты.\nотныне MWI поддерживает несколько альтернативных методов запуска EXE/DLL файлов, кроме того, добавлена поддержка\nзапуска VBS-скриптов:\nЦитата\n1) EXE (start process using COM/WMI and kernel32.CreateProcessA)             \n2) DLL (load library using kernel32.LoadLibraryA from WINWORD.EXE process context)\n3) DLL (start rundll32.exe process using COM/WMI and kernel32.WinExec)\n4) VBS (start wscript.exe  process using COM/WMI and kernel32.WinExec)\nкроме того, была добавлена поддержка отображения decoy документа, добавление текста, продвинутый обход safe-mode - все,\nчто нужно для красивой визуальной сработки эксплойта без лишнего шума.\nс недавних пор у MWI появился удобный web-интерфейс, позволяющий быстро, удобно и легко собрать эксплойт с необходимой\nконфигурацией буквально в несколько кликов. больше никакой скучной командной строки и редактирования конфигов. а удобный\nменеджер билдов поможет вам мониторить AV-ресурсы вроде virustotal.com / malwr.com / hybrid-analysis.com на появление вашего\nсэмпла в аверских базах. + автоматическая проверка билда антивирусами на ресурсе viruscheckmate.com.\nвцелом изменилась концепция работы продукта. мы предоставляем доступ к web-билдеру, который регулярно обновляется,\nчистится и поддерживается. для получения обновления более не требуется просить выслать новый апдейт. вы можете приобрести\nкак сам исходный код билдера, так и просто доступ к его web-интерфейсу.\nведется работа над новыми эксплойтами и модулями. продукт на самом деле подвергся множеству различных обновлений и\nмодификаций, вскоре распишу все подробнее, обновлю шапку топика, а также приложу скриншоты и видео.\n2016-08-31 - MWI8 announced - English translation via Google Translate:\nMICROSOFT WORD INTRUDER 8 (MWI8): CVE-2016-4117 + CVE-2015-2545 + CVE-2015-1641 + CVE-2012-0158\nCurrently exploit kit contains the following set of RCE exploits:\nQuote\nCVE-2010-3333 [MS10-087]: RTF pFragments Stack Buffer Overflow\nCVE-2012-0158 [MS12-027]: MSComCtlLib.ListView Stack Buffer Overflow \nCVE-2013-3906 [MS13-096]: TIFF Heap Overflow via Integer Overflow (heap-spray based)\nCVE-2014-1761 [MS14-017]: RTF ListOverrideCount Object Confusion (Memory Corruption)\nCVE-2015-1641 [MS15-033]: XML SmartTag Use After Free (heap-spray based)\nCVE-2015-2545 [MS15-099]: Microsoft Office Malformed EPS File Vulnerability\nCVE-2016-4117 [MS16-064]: Adobe Flash Player Type Confusion Overflow Vulnerability\nMWI has two main combinations of exploits:\nQuote\nMWI8: CVE-2016-4117 + CVE-2015-2545 + CVE-2015-1641 + CVE-2012-0158\nMWI4: CVE-2014-1761 + CVE-2013-3906 + CVE-2012-0158 + CVE-2010-3333 (old)\nThis is the only exploit the market, which includes a combination of such exploits. As a rule, all of these exploits can be found only separately.\nCVE-2015-2545 and is generally performed in an alternate format (RTF instead of the standard DOCX), allowing it to be less detectable by\nvarious generic signatures.\nMWI8 also includes the following DLL-planting exploits:\nQuote\nCVE-2016-0041 [MS16-014]: oci.dll     \nCVE-2015-6132 [MS15-132]: mqrt.dll\nCVE-2016-0016 [MS16-007]: mfplat.dll  \nCVE-2015-6128 [MS15-132]: elsext.dll\nCVE-2015-6128 [MS15-132]: spframe.dll \nCVE-2016-0018 [MS16-007]: api-ms-win-core-winrt-l1-1-0.dll\nCVE-2015-6132 [MS15-132]: wuaext.dll\nDLL-planting exploits work in combination with RCE-exploits. if the DLL-planting exploit did not load and load a particular dynamic library\nfrom the current directory fails, then the case should have come in RCE exploits.\nMWI now supports several alternative EXE / DLL files, startup methods, in addition, added support for launch VBS-scripts:\nQuote\n1) EXE (start process using COM/WMI and kernel32.CreateProcessA)             \n2) DLL (load library using kernel32.LoadLibraryA from WINWORD.EXE process context)\n3) DLL (start rundll32.exe process using COM/WMI and kernel32.WinExec)\n4) VBS (start wscript.exe  process using COM/WMI and kernel32.WinExec)\nIn addition, support has been added to display the decoy document, adding text, bypassing the advanced safe-mode - everything you need\nfor a beautiful visual drawdown exploit without fanfare.\nRecently it appeared in MWI convenient web-based interface that enables fast, convenient and easy to collect the necessary configuration to\nexploit just a few clicks. no more tedious command line and editing config files. and convenient builds Manager helps you monitor AV-kind\nresources virustotal.com / malwr.com / hybrid-analysis.com the appearance of your sample in averskih bases. + Automatic check antivirus\nbuild on the resource viruscheckmate.com.\nProduct as a whole has changed the concept of work. we provide access to the web-Builder, which is updated regularly cleaned and\nmaintained. to obtain the update is no longer required, please send a new update. You can purchase the source code itself builder and easy\naccess to its web-based interface.\nAre working on new exploits and modules. product actually underwent a number of different upgrades and modifications, will soon sign for all\nthe details, update the topic cap and attach screenshots and videos.\nOverview\nWhy Proofpoint\nCareers\nLeadership Team\nNews Center\nInvestors CenterLatest Threat Report\nHuman Factor Report\nThreat Glossary\nThreat Blog\nDaily RulesetEmail Protection\nAdvanced Threat Protection\nSecurity Awareness Training\nCloud App Security\nArchive & Compliance\nInformation Protection\nDigital Risk Protection\nProduct Bundles\nNexus PlatformWhitepapers\nWebinars\nDatasheets\nEvents\nCustomer Stories\nBlog\nFree Trial+1-408-517-4710\nContact Us\nOffice Locations\nRequest a Demo\nSupport Login\nSupport Services\nIP Address Blocked?\n   © 2020. All rights reserved. Terms and conditions  Privacy Policy  Sitemap\n \nMicrosoft Word Intruder 8 Adds Support for\nFlash Vulnerability CVE-2016-4117Continua a vedere i contenuti per la tua posizione Continua United States\nProducts Solutions Partners Resources CompanyCONTACT LOGIN\n "
}