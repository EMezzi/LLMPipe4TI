{
    "title": "sednit espionage group now using custom exploit kit _ welivesecurity",
    "text": "Menu\nSednit espionage group now\nusing custom exploit kit\nFor at least five years the Sednit group has been relentlessly attacking various institutions, most\nnotably in Eastern Europe. The group used several advanced pieces of malware for these targeted\nattacks, in particular the one we named Win32/Sednit, also known as Sofacy.\nESET Research  8 Oct 2014 - 08:49AM\nShare\n\n\nFor at least five years the Sednit group has been relentlessly attacking various institutions, most notably in\nEastern Europe. The group used several advanced pieces of malware for these targeted attacks, in particular the\none we named Win32/Sednit , also known as Sofacy.\nWe recently came across cases of legitimate financial websites being redirected to a custom exploit kit. Based on\nour research and on some information provided by the Google Security Team, we were able to establish that it\nis used by the Sednit group. This is a new strategy for this group which has relied mostly on spear-phishing\nemails up until now.\nIn this blog, we will first examine on recent cases of spear-phishing emails using the CVE-2014-1761  Microsoft\nWord exploit. We will then focus on the exploit kit, which appears to still be in development and testing phase,\nand briefly describe the actual payload.\nFrom Spear-Phishing Emails …\nBack in April 2014, the Win32/Sednit malware was being delivered through a 0-day vulnerability in Microsoft\nWord RTF documents, CVE-2014-1761. It was amongst a small number of malware families being delivered\nthrough this vulnerability, like BlackEnergy  and MiniDuke , which are also used for targeted attacks.\nHere are two decoy documents showed to the victims while the vulnerability was silently exploited on their\ncomputer. Both of these documents present NATO views on the Ukrainian conflict.\n …to custom Exploit Kit\nWe observed redirections to the exploit kit from websites belonging to a large financial institution in Poland. The\nexploit kit is loaded through a simple IFRAME that is added near the end of the HTML document; for example\nhXXp://defenceiq.us/2rfKZL_BGwEQ in the screenshot below. We can also see a very similar looking IFRAME\nloading the URL hXXp://cntt.akcdndata.com/gpw?file=stat.js, whose domain name was registered on\nSeptember 18 . We were not able to retrieve the content of this page but we suspect that its purpose is to\ncollect statistics about the number of redirections.\nWhen directly visiting the URL hXXp://defenceiq.us, we were redirected to defenceiq.com , a legitimate website\nthat describes itself as “an authoritative news source for high quality and exclusive commentary and analysis on\nglobal defense and military-related topics”.\nThe domain defenceiq.us was found to resolve to 76.73.47.90. Other suspicious domains also resolved to this IP\naddress and displayed the same redirection behavior when visited, which is a strong indication of the sectors the\ngroup is currently targeting. The redirection from Polish financial websites to a defense-related domain name\nseems less than optimal for a targeted attack and was probably due to the mixing of two ongoing campaigns.\nExploit kit domain Redirects to Website content\ndefenceiq.us defenceiq.com Military news\narmypress.org armytime.com Military news\nmfapress.org foreignaffairs.com Foreign Affairs magazine\nmfapress.com foreignaffairs.com Foreign Affairs magazine\ncaciltd.com caci.com CACI International, defense & cyber security contractor\nThe exploit kit, which we named Sedkit  as a reference to Sednit, behaves in a similar fashion to others\ncommonly used today, such as the Angler or Nuclear exploit kits. A sample exploitation chain is shown below.\nThe browser is first sent to the landing page which uses JavaScript to detect the browser and installed plugin\nversions.\nInterestingly we can see that the call to DetectJavaForMSIE() is commented out. This follows the current trend\nin exploit kits of not targeting Java, because recent versions of Java and browsers warnings before loading\napplets. At the moment only Internet Explorer seems to be targeted: when we tested with Chrome and Firefox\nwe were always redirected to localhost.\nThe browser then sends back the plugin information via a POST request. Based on this information, the exploit\nkit redirects the browser either to another URL containing an exploit, or to http://localhost. The kit only\nattempts one exploit per visit.\nWe recovered 3 different exploits used by the kit, all targeting Internet Explorer. They are listed below, with the\nspecific version of IE each one targets. Interestingly, CVE-2014-1776  has not yet been seen in any popular exploit\nkits, and the other two have also seen only limited adoption.th\n Figure 1 From CVE-2013-3897 exploit code\nFigure 2 From CVE-2014-1776 exploit codeCVE Targeted IE version Microsoft Security Bulletin\nCVE-2013-1347 Internet Explorer 8 MS13-038\nCVE-2013-3897 Internet Explorer 8 MS13-080\nCVE-2014-1776 Internet Explorer 11 MS14-021\nHowever other aspects of the kit lack refinement. Unlike most contemporary exploit kits, it does not use\nJavaScript obfuscation. We even found comments in the JavaScript code related to the exploits’ ROP chains. This\nleads us to believe that the kit is still in its testing phase.\nWhen uncompressing the Flash file used\nfor the CVE-2014-1776, a path is visible.\nThis information is not found in previous\nsamples of this exploit in our collection.\nUpon successful exploitation the payload is downloaded; whether it is encrypted depends on the exploit.\nPayload\nThe binary deployed on the infected machine is named “runrun.exe”. Its sole purpose is to deploy a second\nprogram – initially encrypted and compressed — on the machine and ensure its persistence on the system. The\nsecond program is a Windows library named “splm.dll”. According to our data, this malware has been employed\nin targeted attacks since at least 2009.\nRoughly summarized, this payload has been created with a C++ framework. Thanks to the Run-Time Type\nInformation (RTTI) , a part of the program architecture can be reconstructed with the names chosen by the\nprogrammer. The malware contains agent modules  implementing malicious activities, and channels for\ncommunications between modules and remote controllers. In this sample, we found the following agent\nmodules, identified by a 16-bit ID:\nModule Name ID Purpose\nAgentKernal 0x0002 Execution manager\nModuleRemoteKeyLogger 0x1002 Keystroke logging\nModuleFileSystem 0x1102 File system accesses\nProcessRetranslatorModule 0x1302 Provides communication means\nIt also instantiates one external communication channel named WinHttp , which decrypts three domain names\nused as command and control: msonlinelive.com, windows-updater.com and azureon-line.com.\nConclusion\nIn recent years, exploit kits have become a major method employed to spread crimeware, malware intended for\nmass-scale distribution to facilitate financial fraud and abuse of computing resources for purposes such as\nsending spam, bitcoin mining, credentials harvesting etc.\nSince 2012, we observed this strategy being used for espionage purposes in what has become known as\n“watering-hole attacks ” or “ strategic web compromises ”. A Watering-hole attack can be described is redirecting traffic\nfrom websites likely to be visited by members of a specific organization or industry being targeted. In ESET’s\nretrospective on Windows exploitation in 2013 , Artem Baranov wrote  “the past year can rightly be called the year of\ntargeted attacks and watering hole attacks” .\nWhile many instances of watering-hole attacks have been documented for related actors in cases such as noted\nby Symantec in their Elderwood Project  report, we are now seeing this strategy being adopted by another\n group and it seems likely that others will follow them.\nIndicators of compromise\nHere are some indicators that could help to identify the payload sample dropped by the exploit kit described in\nthis blog post:\nPresence of the CLSID {d702b440-b130-47f7-a94c-c1fae33d2820} under the registry key\nHKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\ShellServiceObjectDelayLoad\nMutex named “XSQWERSystemCriticalSection_for_1232321”\nMailslot named “\\\\.\\mailslot\\check_mes_v5555”\nFiles in temporary folder (as returned by GetTempPath()) named “edg6EF885E2.tmp” and “edg6E85F98675.tmp”\nNetwork communications with the domains named msonlinelive.com, windows-updater.com, or azureon-line.com\nHashes\nSHA-1 Role Detection name\n86092636E7FFA22481CA89AC1B023C32C56B24CF Word exploit Win32/Exploit.CVE-2014-1761.D\n12223F098BA3088379EC1DC59440C662752DDABD Word exploit Win32/Exploit.CVE-2014-1761.D\nD61EE0B0D4ED95F3300735C81740A21B8BEEF337 Dropper Win32/Agent.WLF\nD0DB619A7A160949528D46D20FC0151BF9775C32 Payload Win32/Agent.WLF\n\nESET Research  8 Oct 2014 - 08:49AM\nTracking Turla: New backdoor\ndelivered via Armenian\nwatering holesGuildma: The Devil drives\nelectricUp close and personal with\nLinux malwareLinux and malware: Should\nyou worry?\nHome\nAbout Us\nContact UsSitemap\nOur Experts\nESETResearch\nHow To\nCategoriesRSS Configurator\nNews WidgetSimilar Articles\nMALWARE\n MALWARE\n MALWARE\n MALWARE\nDiscussion\n Cookies make a website a better place\nWe use cookies to give you the best optimized online experience and consistent information. You can agree to the collection of all cookies\nby clicking on the Accept & Close button or adjust your cookies settings by clicking on Manage Cookies. For more information please see\nour Cookie Policy.ACCEPT AND CLOSE\nMANAGE COOKIES\n "
}