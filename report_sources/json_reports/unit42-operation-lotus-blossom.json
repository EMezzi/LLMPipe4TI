{
    "title": "unit42-operation-lotus-blossom",
    "text": "PALO ALTO NETWORKS | 4401 Great America Parkway | Santa Clara, CA 95054\nwww.paloaltonetworks.com\n OPERATION  \nLOTUSBLOSSOM  REPORT BY – ROBERT FALCONE, JOSH GRUNZWEIG,  \nJEN MILLER-OSBORN, RYAN OLSONIntroduction   3\nOperation Details   3\nVietnam    4Philippines   10Taiwan and Hong Kong   11\nIndonesia   12\nElise Backdoor Analysis   12\nVariant A   13 Variant B   17 \nVariant C   20\nPrevious Research   23\nConclusion   24\nAppendix   25\nElise Sample Details   25\nElise Executable SHA256 values   33Elise Delivery Document SHA256 values   34\nElise Command and Control Servers   35\nTABLE OF CONTENTSPALO ALTO NETWORKS   +    Operation Lotus Blossom     3Introduction\nOperation Lotus Blossom describes a persistent cyber espionage campaign against \ngovernment and military organizations in Southeast Asia, stretching back over three \nyears. Nations we have identified as targeted in this campaign include Hong Kong, \nTaiwan, Vietnam, the Philippines and Indonesia. The Lotus Blossom group deploys a \nbackdoor Trojan, named Elise, after the sports car made by Group Lotus PLC of the \nUnited Kingdom.  \nThe group relies on spear phishing attacks to infect its users, often using a malicious \noffice document and decoy file containing content relevant to the target’s occupation or \ninterests. The spear phishing attachment typically includes exploit code for a well-known \nMicrosoft® Office® vulnerability, CVE-2012-0158, which is used to install the Trojan \non the system and then display the decoy file, tricking the user into thinking the file opened correctly. Example decoy files include:\n• A spreadsheet listing high-level officers in the Philippine Navy, along with their \ndates of birth and mobile phone numbers.\n• The operational humanitarian and disaster response (HADR) plan for the Armed Forces of the Philippines, stamped “Secret. ”\n• An invitation to the screening of a film at the Norwegian embassy.\nWhile we have not identified specific individuals responsible for these attacks, the \nevidence suggests a nation state with a strong interest in Southeast Asia. Elise \nis a custom backdoor Trojan, not readily available online. The tool appears to be \nused exclusively by Lotus Blossom and was likely developed specifically for their \noperations. The targets attacked by this group are almost exclusively military and government organizations, whose data is most valuable to other nation states, rather \nthan criminal actors. The fact that this campaign has been ongoing for over three \nyears indicates the individuals behind the attack are well-resourced. \nUsing the Palo Alto Networks\n® AutoFocus™ platform, which enables analysts to \ncorrelate the results of the hundreds of millions of reports generated by the WildFire™ \nservice, Unit 42 has linked over 50 individual attacks to this campaign. The Operational Details section of this report provides details on specific attacks \nagainst the targeted governments. The Elise Backdoor Analysis section contains \ndescriptions of how the three different variants of Elise operate and how they \nchanged over time. Domain names and IP addresses used for command and control, as well as hashes of the files used in the attacks are included in the appendix.  \nOperation Details\nOperation Lotus Blossom repeatedly targeted several Southeast Asian countries’ militaries and government agencies, beginning in 2012 and continuing through 2015. The \nbulk of the activity discussed in this paper involves heavy targeting against both Vietnam \nand the Philippines during 2013 and 2014.  PALO ALTO NETWORKS   +    Operation Lotus Blossom     4All of the attacks use the custom backdoor \nTrojan named Elise, which gives the Lotus \nBlossom group their initial foothold in a \nnetwork. From there, they can install additional \ntools, move laterally, and exfiltrate data from \nthe network. Elise is described in more detail \nlater in this report. \nThe operation relies heavily on spear \nphishing as the initial attack vector, with \nenticing subject lines and legitimate-looking \ndecoy documents meant to trick users into believing they are opening a legitimate file, \nas opposed to malware. A popular theme for \nthe decoy documents was personnel rosters, \nlargely claiming to be for specific military or \ngovernment offices.  Another theme was the \nuse of attractive pictures of Asian women that \nwere sourced from the Internet. Some of the information contained in the decoys could be \nfound on the Internet; however, it is worth \nnoting none of the military or government \nthemed decoys could be found. \nIn particular, the decoys used against the \nPhilippines were exclusively military and \ngovernment themed, with the bulk purporting \nto be related to the Navy.  As we were unable \nto find any of the decoys online, and they \npurport to contain sensitive information, we have not included images of them, in case the information is legitimate. One document is even stamped “Secret. ” \nWhile all of the Lotus Blossom attacks appear to be the work of a single group, the \ninfrastructure used to target each nation is largely separate (Figure 1). Each Trojan binary \nin this diagram is connected to command and control (C2) IP addresses and domains \nthat are defined in the Trojan’s configuration file. Additionally, the domains are connected to email addresses used to register them, as well as IP addresses they resolve to at the \ntime of the attack. These links create a visual map of the attacks, which shows that, while \nthe infrastructure is not identical in each attack, they are all connected. In the following \nsections, we will take a closer look at the attacks on each nation.\n  \nVietnam\nThe Lotus Blossom campaign against the Vietnamese government was the most \npersistent and consisted of 11 waves of spear phishing, primarily during November \n2014. There were a total of eight droppers — one Microsoft Excel® document and five \nMicrosoft Word® documents. All included a decoy document intended to trick users \ninto believing they had opened a legitimate file rather than malware, and the content of each was different. FIGURE 1  +  Elise backdoor samples and C2 infrastructure \nin distinct but overlapping groups.\nVietnam\nIndonesia PhilippinesHong Kong \n& TaiwanPALO ALTO NETWORKS   +    Operation Lotus Blossom     5The attacks on Vietnam break into two distinct groups. All but three samples used \noverlapping C2 infrastructure (Figure 2), including two domains registered by \n“2759931587@qq.com, ” which was also used registered C2 domains used in attacks \nagainst other Southeast Asian countries.  This group of attacks used the following \ncampaign codes to identify their infections, many of which include the string “ Alice, ” \nwhich may have a significance we have not yet identified. \n• Alice_erpas\n• Alice_rosey\n• Alice_15A\n• Alice_Spider\n• Alice_vishipel\n• jessica-cpt-app\n• oyf\n• ooo\nFIGURE 2  +  Elise samples and infrastructure used to target the Vietnamese government.PALO ALTO NETWORKS   +    Operation Lotus Blossom     6The second group of attacks (Figure 3) used a different registrant not seen elsewhere in \nthis activity, but overlap with targeting, campaign code structure, and one C2 IP address. \nWhile the other domains maintained the information they were originally registered \nwith, one domain used here was registered by ‘paulzz@yeah.net’ and then updated to \n‘studywindows123@outlook.com’. The initial registrant also registered other domains \ndetailed in this paper, targeting other Southeast Asian countries prior to their updating, \nindicating this may be a reseller favored by particular APT group(s). It could also be a \nsimple matter of actor preference, but we cannot say for sure one way or the other. The other domain used a registrar that does not show any registration information. The three \ncampaign codes used with these samples are below. \n• QY030610\n• KITY01232\n• KITY090901\nFIGURE 4  + Instructions on how to install and use LogFusion, a legitimate tool used to parse log files.\nFIGURE 3  +  Diagram of second group of Vietnam attacks.\nMost of the attachments used in this campaign had a technical theme, shown in figures two \nthrough four. Additionally, all were written in Vietnamese. We are not including an image of \none sample, as it claims to be a certification test for a particular type of VSAT terminals. It is \nunknown how the actors obtained a test for this course, assuming the questions are legitimate. PALO ALTO NETWORKS   +    Operation Lotus Blossom     7\nFIGURE 5  + The agenda for Vietnam’s Ministry of Information and Communication \nworkshop with Vibrand, which was held on 4 December 2014. The purpose of the \nworkshop was promoting the development of products and IT services in Vietnam.\nFIGURE 6  + Excel spreadsheet titled “VPTW Transfer Network Phase 2” and lists a \nnumber of provinces in Vietnam as well as Taiyuan in China.\nPALO ALTO NETWORKS   +    Operation Lotus Blossom     8The final four sample decoy documents had very different themes. One was an \ninvitation to an event at the Norwegian Embassy in Vietnam commemorating the \nanniversary of the Kon-Tiki voyage (Figure 7). Of note, the date of the invitation is \nincorrect — the actual event took place 11 and 12 December 2014. The requested \nemail address accepting RSVPs also seems just slightly suspicious, and they helpfully \ninstructed the recipients to forward the invitation, if they were unable to attend. Two \nof the decoys contained one or more images of attractive Asian women taken from \nthe Internet, one of which (shown in Figure 8) was used multiple times. The final decoy contained a Merry Christmas image with broken English text. \nFIGURE 7  + Fake invitation \nto an event \ncommemorating \nthe Kon-Tiki \nvoyage.\nFIGURE 8  + Photo of Hoàng Thùy Linh,  \na Vietnamese actress and singer .\nFIGURE 9  + A Merry Christmas image with broken English text.PALO ALTO NETWORKS   +    Operation Lotus Blossom     9The second group of attacks also used decoy documents written in Vietnamese. One \ndocument purported to be a contact roster and contains the names and Vietnamese \nwebmail email addresses for multiple high-level Vietnamese officials. The first page of \nthe second decoy is shown below (Figure 10) and claims to be an IT upgrade plan for \n2015 for the Vietnamese government. The final sample also appears to be related to \nan IT upgrade plan, with implementation dates and responsible individuals (Figure 11 .) \nFIGURE 10  + Claims to be an IT upgrade plan for 2015 for the Vietnamese government.\nFIGURE 11  + Also appears to be related to an IT upgrade plan, with implementation dates and \nresponsible individuals. PALO ALTO NETWORKS   +    Operation Lotus Blossom     10Philippines\nThe Lotus Blossom operation has \ntargeted the Philippine government, \nwith a particular focus on the \nmilitary, since at least 2013. We \nidentified six unique Elise droppers, \neach with its own decoy document \nand content. These samples all \nhad overlapping command and control infrastructure (Figure 12). \nAll six decoy documents were \nrelated to the Philippine military \nor government, primarily claiming \nto contain contact information for high-level officers and officials. \nWe are not including images, as \nit is possible the information is \nlegitimate, but the subject lines \nwith brief descriptions are included \nin Table 1 below.\nFIGURE 12  + \nConnections between \nElise samples and C2 \nservers used in attacks \non the Philippines. \nDecoy Name Decoy Description\nDFA GAD Directory Claims to be a directory of personnel in the Philippine Department of Foreign Affairs Gender and Development, including private emails and cellphones. \nHADR PLAN 29 May 14 Claims to be the operational humanitarian and disaster response (HADR) plan for the Armed Forces of the Philippines and is stamped “Secret. ”\nC,1AD NR 03-0226-313-14 Claims to document a problem logging into an account for a specific real-time aircraft tracking system and appears to be a Philippine Air Force document. \nRQST MOUTPIECE \nLOUD HAILERClaims to be a requisition form for a mouthpiece for a specific hailer for a specific unit.\nPN KEYPOSITION with CELL NrsClaims to be a roster of high-level officers at the Philippine Naval Headquarters and is dated 23 June 2014. It has birth dates and cellphone number as well as \ncurrent job roles. \nCellphone Number Claims to be a roster of high-level officers at the Philippine Naval Headquarters and is dated February 2015. It contains job roles as well as cellphone numbers. \nTable 1  +  Names and descriptions of decoy documents included in attacks on the Philippine government and military.PALO ALTO NETWORKS   +    Operation Lotus Blossom     11In contrast to the Vietnamese targeting, this activity involves a mix of actor-registered \nand dynamic DNS (DDNS) domains use for C2. However, the actor-registered domain \nalso used the same initial registrant, ‘paulzz@yeah.net, ’ as the final two Vietnamese \nsamples discussed above, and most campaign codes also appear to end with a date. \nAlso of note, all but two of these samples used campaign codes that started with \n‘340‘ .  The text within three of the campaign codes refers to the decoy contents. The \ncampaign codes we saw with the Philippines’ activity are below.\n• 340_typhoon\n• 340-0226\n• 340-dfa-520\n• 340-0528\n• phone\n• key0730\nTaiwan and Hong Kong\nWe uncovered three droppers that targeted Taiwan and one \nthat targeted Hong Kong. One of these claimed to be a \ncurrent staff contact list, but when opened, did not contain \nany information. As this is the only roster-themed decoy \nthat did not contain any information, it may indicate this \nwas a mistake on the threat actor’s part. We were unable to \nrecover decoy documents for the other two. \nThe sample targeting Hong Kong contains earthquake \nsafety information in long form Chinese, copied from \nthe Internet and widely circulated in multiple languages, \nsince at least 2009.  It has its own entry on Snopes.com evaluating the accuracy of the information\ni. This sample is \nalso an outlier, in that it targeted a science and technology \nuniversity, in contrast to most of the other targeting that had \na government or military focus. \nThis activity shows the clearest striation (Figure 13), with the \ncluster on the left using the first two campaign codes below.\n•  310-pyq\n•  mm-0807\n•  cyd-zc\nIt is possible this represents two sub-groups targeting Taiwan and Hong Kong with \nthe same malware over the same period of time. Interestingly, the cluster in the \nupper left uses some infrastructure used in the Vietnamese activity, as well as a registrant seen in the Philippines’ activity.\nFIGURE 13  + Connections between Elise samples and C2 servers used in attacks on Taiwan and Hong Kong. PALO ALTO NETWORKS   +    Operation Lotus Blossom     12Indonesia\nWe identified one Elise dropper carrying a decoy \ndocument written in Indonesian that contains \ninformation about health foods to avoid the flu, including \na picture of a sweet potato. It appears to have been \ncopied directly from the Internet. The campaign code \nused in this attack was “36-SC-0115, ” as well as the \nfollowing C2 servers.  \n• 122.10.89.84\n• beckhammer.xicp.net\nThe campaign code and C2s are shown below, and \nthe C2 matches up with one of the Philippine-targeted \nsamples in the previously discussed activity. In addition, \nthe campaign code format and numbers at the end of the campaign code appear to be a date, which is also \nsimilar to the Philippines’ activity.\nElise Backdoor Analysis\nOver the course of our research, Unit 42 has identified over 50 samples belonging to \nthe Elise malware family. Through analysis of these files, we have grouped them into \nthree distinct variants. Compile timestamps for these samples ranged from June 2012 to \nMarch 2015. The naming of the three Elise malware variants coincides with their original \ncompile timestamps, starting with the oldest. Please note that these variant labels may \nnot coincide with naming conventions created by the antivirus industry.\nWhile each variant uses distinct mechanisms for infecting the system and remaining \npersistent between reboots, all three variants share the following common attributes:  \n• An encrypted binary configuration data structure containing a list of C2 \nservers to contact.\n• A campaign identifier, such as ‘jessica-cpt-app’ or ‘370my0216’, which identifies the specific malware reporting to the C2 server. \n• C2 communications using a custom format delivered over HTTP or HTTPS.\n• Performs basic network reconnaissance upon installation and reports findings to C2 server.\nEach variant of Elise contains the functionality to perform the following tasks:\n• Execute commands, DLLs, or executables\n• Write Files\n• Read Files \n• Update Configuration\n• Upload Configuration DataFIGURE 14  + Decoy document written in Indonesian, \nwhich describes foods that help fend off the flu. \nPALO ALTO NETWORKS   +    Operation Lotus Blossom     13Variant A\nThe first variant of Elise identified by Unit 42 has a compile date set in mid-2012. \nThis particular variant has a configuration size of 1480 and the ability to install itself \nas either a service or executable. Variant ‘ A ’ is delivered via a dropper executable file, \nwhich differs from later variants that are typically deployed with a malicious Microsoft \nOffice document. \nWhen executed, the malware will configure itself for deletion upon reboot, using the \nMoveFileExA function, as seen below.\nMoveFileExA(self, 0, MOVEFILE_DELAY_UNTIL_REBOOT); \nReaders may recall seeing this technique used by the Microsoft Excel shellcode identified in the Vietnam campaign. The malware proceeds to extract and decrypt an \nembedded DLL to the following location.\n•   %APPDATA%\\Microsoft\\Network\\mssrt32.dll\nThe following algorithm is used to encrypt/decrypt the embedded DLL:\nvoid decrypt_string(char *encrypted, int size) \n{    int i;  if ( encrypted )  {    for ( i = size - 1; i > 0; --i )      encrypted[i] ^= encrypted[i - 1];    *encrypted ^= 0x15;  }}   \nPrior to writing this DLL to disk, the malware will write the encrypted configuration to \nthis DLL. The following Python code may be used to decrypt this configuration:\nfrom ctypes import *\nfrom struct import *\nimport sys\nfh = open(sys.argv[1], ‘rb’)\nfd = fh.read()\nfh.close()\ncdll.msvcrt.srand(2014)\nout = “”\nfor x in fd:\n    out += chr(ord(x) ^ (cdll.msvcrt.rand() % 128))\nprint repr(out)PALO ALTO NETWORKS   +    Operation Lotus Blossom     14The malware proceeds to configure the mssrt32.dll DLL as a service. This service \nis configured with properties specified in the malware’s configuration. The following \nexample was identified in one of the samples analyzed.\nThis service is then manually started using a call to the StartServiceA function. \nShould the installation of this newly created service fail, the malware will instead \nwrite an executable to the following location:\n•  %APPDATA%\\Microsoft\\Network\\svchost.exe\nThe name of this executable is specified within the malware’s configuration data. This file is embedded and dropped in the same manner the mssrt32.dll file was \npreviously. Persistence for this executable is set via the following registry key:\n• HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\svchost : %APPDATA%\\Microsoft\\Network\\svchost.exe\nFinally, this executable is run via a call to the ShellExecuteW function.\nThis dropped DLL or executable contains the actual Elise malware. When run, it will \nbegin by deleting the following file should it exist:\n• %TEMP%\\000ELISEA350.TMP \nThis file will be used going forward to store any log data generated by Elise. The malware writes its encrypted configuration to one of the following locations: \n• %APPDATA%\\Microsoft\\Network\\6B5A4606.CAB  \n• %APPDATA%\\Microsoft\\Network\\6B5A4607.CAB  Service Name MSCM\nDisplay Name Microsoft Security Compliance Manager\nDescription The service provides centralized security baseline management features, a baseline portfolio, customization capabilities, and security baseline export \nflexibility to accelerate your organization¡¯s ability to efficiently manage \nthe security and compliance process for the most widely used Microsoft \ntechnologies.\nImage Path %SystemRoot%\\System32\\svchost.exe -k MSCM\nService DLL %APPDATA%\\Microsoft\\Network\\mssrt32.dll\nService Main ESEntryPALO ALTO NETWORKS   +    Operation Lotus Blossom     15The following script can decrypt and parse the CAB file:  \nimport sys\nfrom struct import *from ctypes import *\ndef decrypt(data):\n cdll.msvcrt.srand(2014) out = “”\n for x in data:\n     out += chr(ord(x) ^ (cdll.msvcrt.rand() % 128))\n return out\ndef parse_config(out): identifier, \\\n compile_time, \\\n unknown1, \\\n sleep_timer, \\\n unknown_bool, \\\n campaign, \\\n c1, c2, c3, c4, c5, \\\n unknown_bool2, \\\n unicode_exe_name, \\\n service_name, \\\n registry_service_name, \\\n display_name, \\\n service_description = unpack(“40siiib20s50s50s50s50s50sb40s20s20s50\ns700s” ,  out[0:1154]) print “Config Identifier      : %s” % identifier\n print “Compile Time           : %s” % compile_time\n print “Unknown DWORD          : %s” % unknown1\n print “Sleep Timer            : %s” % sleep_timer\n print “Unknown Bool Value     : %s” % unknown_bool\n print “Campaign               : %s” % campaign\n print “Command and Control    : %s” % c1\n print “Command and Control    : %s” % c2\n print “Command and Control    : %s” % c3\n print “Command and Control    : %s” % c4\n print “Command and Control    : %s” % c5\n print “Unknown Bool Value 2   : %s” % unknown_bool2\n print “Service Executable     : %s” % unicode_exe_name.replace(“\\x00” ,’’)\n print “Service Name           : %s” % service_name\n print “Registry Service Name  : %s” % registry_service_name\n print “Service Display Name   : %s” % display_name\n print “Service Description    : %s” % service_description\nfh = open(sys.argv[1], ‘rb’)data = fh.read()fh.close()parse_config(decrypt(data))PALO ALTO NETWORKS   +    Operation Lotus Blossom     16The malware proceeds to enter in a loop, where it will attempt to communicate with the specified URLs via \nHTTP or HTTPS. It initially sends the following GET request to the C2 servers specified in its configuration:\nGET /<param1>/page_<param2>.html HTTP/1.1\nAccept: */*\nUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Win32)\nHost: <C2 Server>\nConnection: Keep-Alive\nCache-Control: no-cache\nPragma: no-cache\nIn the request above, the <param1> parameter is determined using the last four octets of the victim’s MAC \naddress. For example, if the victim’s MAC address was 00-11-22-33-44-55-66, this parameter would become \n‘2233445566’. The <param2> parameter is randomly generated using the current time as a seed. This results in a unique request being made every time. \nWhen an initial communication is made to the remote server, the malware will execute the following \ncommands to conduct basic network reconnaissance:  \n• net user\n•\t ipconfig\t/all\n• net start \n• systeminfo  \nElise uses a series of cookie values in order to exfiltrate data, as seen below.\nFIGURE 15  + Elise Variant A POST Request.PALO ALTO NETWORKS   +    Operation Lotus Blossom     17Data contained within these cookies is Base64-encoded. Once decoded and joined, \nthe data has the following structure. \nVariant B\nThe second variant (B) of Elise has compile timestamps dating back to July 2012. Variant B has a configuration data structure size of 324 bytes. It is often delivered via \na file exploiting a client-side vulnerability, such as CVE-2012-0158. \nWhen originally installed on a victim machine, the client-side exploit shellcode will \ndrop two files — an executable file and a DLL. The executable is then run in a newly \nspawned process. This executable file loads the second exported function of the DLL via the function’s ordinal value. This exported function is commonly called either \n‘CsOptionsHandle’ or ‘ESHandle’. \nWhen this function is called, this Elise variant will begin by decrypting its 324-byte \nconfiguration structure. The following Python code may be used to decrypt and parse \nthis configuration:\nimport sys\nfrom struct import *from ctypes import *\ndef decrypt(data):\n cdll.msvcrt.srand(2014) out = “”\n for x in data:\n     out += chr(ord(x) ^ (cdll.msvcrt.rand() % 128))\n return out\ndef parse_config(out): compile_time, \\\n unknown1, \\\n sleep_timer, \\\n unknown_bool, \\\n campaign, \\\n c1, c2, c3, c4, c5, \\\n unknown_bool2, \\\n unknown_string = unpack(“iiib20s50s50s50s50s50sb40s” , out)\n print “Compile Time           : %s” % compile_time\n print “Unknown DWORD          : %s” % unknown1\n print “Sleep Timer            : %s” % sleep_timer\n print “Unknown Bool Value     : %s” % unknown_bool\n print “Campaign               : %s” % campaign\nFIGURE 16  + Elise Variant A Data Encoding.PALO ALTO NETWORKS   +    Operation Lotus Blossom     18 print “Command and Control    : %s” % c1\n print “Command and Control    : %s” % c2\n print “Command and Control    : %s” % c3\n print “Command and Control    : %s” % c4\n print “Command and Control    : %s” % c5\n print “Unknown Bool Value 2   : %s” % unknown_bool2\n print “Unknown Unidoce String : %s” % unknown _string.replace(“\\\nx00” ,’’)\nfh = open(sys.argv[1], ‘rb’)\ndata = fh.read()fh.close()\nparse_config(decrypt(data))\nAs we can see, this variant of Elise uses the same encryption/decryption routine \nfor its configuration data as variant A. The malware proceeds to create one of the \nfollowing files that will be used to store this configuration data:\n• %APPDATA%\\Microsoft\\IMJP8_1\\8S3N0PW7.dat\n• %APPDATA%\\\\Microsoft\\IMJP8_1\\26TXNK4F.dat\nOne of the more interesting features of this variant is its ability to detect either a \nVMware\n® or VirtualPC virtual environment, as we see below.\nShould the malware detect it is running within either of these environments, it will not perform any malicious activity going forward. Otherwise, it proceeds to configure \npersistence across reboots by setting the following registry key:\n• HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\imejp : [self]\nFIGURE 17  + Elise Variant B virtual environment check.PALO ALTO NETWORKS   +    Operation Lotus Blossom     19When initially run, Elise variant B will also execute the following commands on the \nvictim machine:\n•\t ipconfig\t/all\n• net start\n•\t dir\tC:\\progra~1\n• systeminfo\nThese command strings are obfuscated within the malware, using the following \nalgorithm:\nchar* decrypt_string(char *encrypted, int size)\n{\n  int i; \n  char *result;\n  for ( i = 0; i < size; ++i )\n  {\n    result = &encrypted[i];\n    *result ^= 0x1Bu;  }\n  return result;\n}\nExfiltration for variant B uses the same technique used in variant ‘ A ’. Base64-encoded \ncookie values are used to exfiltrate data, as seen below.\nThe structure of this base64-decoded data remains the same as well. The following \nstructure is used in variant ‘B’.\nFIGURE 18  + Elise Variant B POST RequestPALO ALTO NETWORKS   +    Operation Lotus Blossom     20Variant C\nThe third variant of Elise has its earliest compile timestamp in mid-2013 and has been \nused in attacks periodically since that time. This variant has been the most prevalent \noverall, accounting for roughly 75 percent of all samples identified by Unit 42. The \nmost recent sample of variant C was compiled in late March of 2015. Additionally, \nvariant C uses a 336-byte configuration structure.  \nSimilar to variant B, variant C is often delivered via a file exploiting a client-side \nvulnerability, such as CVE-2012-0158. This particular variant is delivered as a single \nDLL with two exported functions — ‘Setting’ and ‘Update’\nWhen the ‘Setting’ export is called, the malware will copy itself to the following \nlocation:  \n• %APPDATA%\\Microsoft\\Network\\rasphone.dll  \nThis new file is then called via the following command:  \n• Rundll32.exe %APPDATA%\\Microsoft\\Network\\rasphone.dll,Update \nWhen the ‘Update’ export is called on rasphone.dll, the malware will begin by checking \nif a debugger is attached via a call to IsDebuggerPresent(). In the event it is not \ndetected, the malware will then check to ensure the DLL has been loaded by Rundll32.\nexe by comparing the current filename against ‘dll32’.  rasphone.dll uses a simple string encryption routing. The following code can decrypt encountered strings:   \nvoid decrypt_string(char *encrypted, int size)  \n{  \n  int i;\n  if ( encrypted )\n  {\n    for ( i = size - 1; i > 0; --i )\n      encrypted[i] ^= encrypted[i - 1];\n    *encrypted ^= 0xA0;\n  }\n}   FIGURE 19  + Elise Variant B Data Encoding\nPALO ALTO NETWORKS   +    Operation Lotus Blossom     21The malware continues to identify the location of iexplore.exe (%PROGRAM FILES%\\\nInternet Explorer\\iexplore.exe) and spawn a new instance of this process. The malware \nwill proceed to inject itself into iexplore.exe. Finally, the malware will decrypt an \nembedded DLL located in its resource section (‘XDATA ’) and write this DLL to a new \nsection of memory in iexplore.exe. A configuration blob of 336 bytes is subsequently \nwritten to this DLL, and the DLL is loaded into iexplore.exe via a call to LoadLibraryA.   \nThe injected DLL (hereafter referred to as xdata) begins by spawning a new \nthread where all further actions will be taken. The malware writes its encrypted \nconfiguration to the following location:  \n• %APPDATA%\\Microsoft\\Network\\6B5A4606.CAB  \nThe following script can be used to decrypt this CAB file. \nimport sys\nfrom struct import *\ndef decrypt(data):\n str_len = len(data) - 1\n out = “”\n while(str_len > 0):\n  str_len -= 1\n  if str_len == 0:\n   break\n  out = chr(ord(data[str_len]) ^ ord(data[str_len-1])) + out\n out = chr(ord(data[0]) ^ 0xA0) + out\n return out\ndef parse_config(out): compile_time, \\\n unknown1, \\\n sleep_timer, \\\n unknown_bool, \\\n campaign, \\\n c1, c2, c3, c4, c5, c6 = unpack(“iiib20s50s50s50s50s50s50s” , out[0:333])\n print “Compile Time           : %s” % compile_time\n print “Unknown DWORD          : %s” % unknown1\n print “Sleep Timer            : %s” % sleep_timer\n print “Unknown Bool Value     : %s” % unknown_bool\n print “Campaign               : %s” % campaign\n print “Command and Control    : %s” % c1\n print “Command and Control    : %s” % c2\n print “Command and Control    : %s” % c3\n print “Command and Control    : %s” % c4\n print “Command and Control    : %s” % c5\n print “Command and Control    : %s” % c6\nfh = open(sys.argv[1], ‘rb’)\ndata = fh.read()\nfh.close()\nparse_config(decrypt(data))PALO ALTO NETWORKS   +    Operation Lotus Blossom     22Additionally, this CAB file is “time stomped” to a Create/Modify time of Sunday, \nNovember 21, 2010, 10:29:33 UTC. This malware also writes to a log file located at \nthe following path.\n• %TEMP%\\00EL225AF.TMP  \nData in this file is not obfuscated or encrypted in any way. The malware proceeds to enter in a loop, where it will attempt to communicate with the specified URLs \nvia either HTTP or HTTPS. The following has been identified about the structure of \nthe binary data submitted via POST requests. This structure is consistent with all \nprevious Elise variants discussed.    \nWhen an initial communication is made to the remote server, the malware will \nexecute the following commands to conduct basic network reconnaissance:   \n• net user\n•\t ipconfig\t/all\n• net start \n• systeminfo  \nThis data is exfiltrated using a POST request, as seen below. \nIn the above example, the ‘2320’ value in the URI is generated using the victim’s \nMAC address. The ‘00320511’ value in the URI is generated using the current time. This allows each request to be unique and also identify the victim machine. FIGURE 20  + Elise Variant C Data Encoding.\nFIGURE 21  + Elise Variant C POST Request.PALO ALTO NETWORKS   +    Operation Lotus Blossom     23Previous Research\nMultiple research groups have mentioned the Elise backdoor in publicly available \nreports. This section highlights some of those to help readers connect this campaign \nto previously known attacks. \nIn 2013, Xecure Labs and Academia Sinica published a joint paper, and they delivered \na presentation at BlackHat in which they identified Elise as part of a larger group of \ntools they referred to as the “LStudio, ” “ST Group” and “ APT0LSTU. ” The research team noted that Elise and other related tools had been used primarily in attacks on \nTaiwan (Figure 22), but also against the United States, Canada and other nations.\nTrend Micro refers to Elise as BKDR_ESILE, making a slight modification to the \nauthor’s chosen name. Trend Micro first reported on Elise in their 2013 2H targeted Attack Trends report\n ii. Since then, they have referenced that paper in multiple blogs \nand reports iii iv v. This research indicates that the majority of attacks using Elise also \ntargeted government organizations in the Asia Pacific region.\nFireEye refers to Elise as the “Page” malware, because early versions of the Trojan \nuse the word “page” in their Command and Control URLs. FireEye first noted an \nElise attack in September 2012, which involved a targeted spear phishing attack \nagainst the aviation defense industry vi. FireEye later noted Elise was delivered in an \nattack using a lure related to the crash of Malaysian Airlines flight 370 vii.FIGURE 22  + Slide 30 from BlackHat presentation showing Elise target.\nPALO ALTO NETWORKS   +    Operation Lotus Blossom     24 Conclusion\nOperation Lotus Blossom represents a long-term campaign targeting government \nand military organizations in several nations of Southeast Asia conducted by a \npersistent attack group. We traced the earliest of these attacks to 2012, and the most \nrecent occurred during the course of writing this paper. In one case, the targeted \norganization received 20 separate email attacks carrying Elise exploit files over the \ncourse of eight weeks. \nWhile we cannot attribute these attacks to those of a specific nation state, the \npattern indicates a highly persistent adversary with the ability to develop custom \ntools, and maintain command and control infrastructure, over a long period of time. \nThis evidence is consistent with a nation state adversary with a strong interest in the \nmilitaries of Southeast Asian nations.\nLotus Blossom may deploy additional tools beyond the Elise backdoor detailed in this \nreport, after the group has achieved a foothold in the network. Related tools used by \nthe group include those known as “LStudio, ”  and Evora.\nUnit 42 initially identified the attacks described in this report using Palo Alto Networks \nAutoFocus platform, which quickly enables analysts to find connections between \nmalware samples analyzed by our WildFire system. We combined this data with open \nsource intelligence to gather additional samples, which broadened the scope of our \nanalysis. We have tagged all of these samples, and the infrastructure used in this \ncampaign, within AutoFocus, using the tags Elise and LotusBlossom respectively.\nWildFire correctly identifies Elise executables, as well as the exploit files used in \nLotus Blossom attacks, as malicious. We have released IPS signature 14358 in \nresponse, which detects command and control traffic generated by Elise. PALO ALTO NETWORKS   +    Operation Lotus Blossom     25Appendix\nElise Sample Details\nSHA256 a28d6d7ac530753bb2ebfe1a9e9bd60269e6d227dec555e538cc36a6decf29f\nCampaign Code PYQ\nCommand and Control 59.6.2[.]16 \ncpcl2006.dyndns-free[.]com shotacon.dyndns[.]info petto.mooo[.]com kid.dyndns[.]org\nSHA256 949c9457a6c77e7e7f1519435149183c56eb53f7d74439fb848b5d6d91196a73\nCampaign Code PYQ\nCommand and Control 59.6.2[.]16 cpcl2006.dyndns-free[.]com shotacon.dyndns[.]info petto.mooo[.]com kid.dyndns[.]org\nSHA256 712c488950f27e98bc4ebe5b63e5775498236a179cb4576bf021f8e6e6de0df4\nCampaign Code MYGHOST\nCommand and Control 50.7.11[.]10 www3.bkav2010[.]net\nSHA256 b9681c178e087140344e6aec2630c61f6a7be92e97ebbe7ce10528f6f0e6028f\nCampaign Code yxz-tw\nCommand and Control 184.22.44[.]209 kjd.dyndns[.]org 202.82.202[.]228 wsi.dyndns[.]org cpcl2006.dyndns-free[.]com\nSHA256 dc61e089eebf6fa1b3abf637ce105e0d20666aa52d9001f5fd5034815331cd61\nCampaign Code 340_typhoon\nCommand and Control beckhammer.xicp[.]net 122.10.89[.]84\nSHA256 6eae10f0b9a62a26b19897f7ba627f92e93e458034939f55f2001835c0e1f1be\nCampaign Code llmacau\nCommand and Control 202.82.91[.]139 218.103.16[.]153 203.218.138[.]30 103.246.245[.]146PALO ALTO NETWORKS   +    Operation Lotus Blossom     26SHA256 8c2cd914de7c125e49019f3826918511150ee4fff8a923da350a99c102b36455\nCampaign Code yxz-kjhkjsxy\nCommand and Control 184.22.44[.]209 \nkjd.dyndns[.]org 202.82.202[.]228 wsi.dyndns[.]org cpcl2006.dyndns-free[.]com\nSHA256 a8e0ab6b19400eccd3c9aceb183fe7626d5bde7bdf9b8ec8825aa17cc3a213a3\nCampaign Code 340_typhoon\nCommand and Control beckhammer.xicp[.]net 122.10.89[.]84\nSHA256 e9971de22a922678fc216e9e3923c7e6b21455ddfbb24eb46e50e1cc7ceacc31\nCampaign Code demo\nCommand and Control 122.10.89[.]84 beckhammer.xicp[.]net 122.10.89[.]85\nSHA256 0752bbdb0c51a519f17a62dd30a033c224c82168522f2c88949b1a0afc8f9037\nCampaign Code 340-0226\nCommand and Control harryleed.dyndns[.]org verolalia.dyndns[.]org jackyson.dyndns[.]info scristioned.dyndns-web[.]com 173.231.49[.]98\nSHA256 4780442f3cc8d3e1888aa6cecbb05d0c49a6755964eba7a8a6a36d6d2a0ef881\nCampaign Code yxz-tw\nCommand and Control cpcl2006.dyndns-free[.]com wsi.dyndns[.]org 202.82.202[.]228 kjd.dyndns[.]org 184.22.44[.]209\nSHA256 bae07b0c3e4e96731360dc4faa49c0d4abe4d3705e768393f21661c82dea13f3\nCampaign Code Alice_vishipel\nCommand and Control www.serchers[.]net 142.91.252[.]130 www.aliancesky[.]com 58.64.183[.]92\nSHA256 7e386ff64be78af18f8a79d01cb75b0438cbcee4647e0a928100bd52ee56db76\nCampaign Code G140509ZA01\nCommand and Control 46.251.237[.]59 www.tintuchoahau[.]comPALO ALTO NETWORKS   +    Operation Lotus Blossom     27SHA256 866c698073e4deb66dd83c1ec9567ec03eca9f03775deadb81cc59fdb6cfd446\nCampaign Code 310-pyq\nCommand and Control cybertunnel.dyndns[.]info \nnewshappys.dyndns-blog[.]com www.imonju[.]com www.serchers[.]net 202.82.202[.]228\nSHA256 edb45f03dfd52ab58f163ad2ca48f4bc9c4bcb72ea9181d0e0a1d87859f707a6\nCampaign Code 370mymm\nCommand and Control 122.10.89[.]84 122.10.89[.]85\nSHA256 3d2c6d48425212eabb886c2e7e89249e4aa8cf4ad9ec3dd22cafb4f879683d8b\nCampaign Code 340-dfa-520\nCommand and Control phil-gov.gotdns[.]org scristioned.dyndns-web[.]com asean-star[.]com aseansec.dynalias[.]org 113.10.136[.]18\nSHA256 d9174d6bbcb51d3df186794109cd6b2036f6231cf8733290eadd399bf8137055\nCampaign Code 340-0528\nCommand and Control phil-army.gotdns[.]org scristioned.dyndns-web[.]com asean-star[.]com aseansec.dynalias[.]org 113.10.136[.]18\nSHA256 30f1f7e848c79212f70794d718d0f3929c24e0f3d28695a7c85a85c77ab7aac9\nCampaign Code 310-pyq\nCommand and Control cybertunnel.dyndns[.]info newshappys.dyndns-blog[.]com www.imonju[.]com www.serchers[.]net 202.82.202[.]228\nSHA256 39dd2381bcd0f47dadf23399254bf1b51a837179e5634328afafe07510f5888a\nCampaign Code 340-0528\nCommand and Control phil-army.gotdns[.]org scristioned.dyndns-web[.]com asean-star[.]com aseansec.dynalias[.]org 113.10.136[.]18\nSHA256 e2181b3d47feb5a321fe3b85b08a0245a1e0824b213e568fa4736d529fd5f8c2\nCampaign Code 731\nCommand and Control usa-moon[.]net 23.234.63[.]197PALO ALTO NETWORKS   +    Operation Lotus Blossom     28SHA256 c19d3242d43c71f03f5873231444c12a6a11892dd7f0142ff10479f1f718382d\nCampaign Code key0730\nCommand and Control usa-moon[.]net \n23.234.63[.]197\nSHA256 24bb8e48f37cbd71b2195cff4f52ec304a2ed9d60c28d2afd785e6f32639325f\nCampaign Code bio\nCommand and Control usa-moon[.]net 23.234.63[.]197\nSHA256 65c901b19e2eec6b8392100c1073253641a95dd542f39c9ca95755e8a2afde14\nCampaign Code Alice_Spider\nCommand and Control www.aliancesky[.]com 58.64.183[.]92 www.serchers[.]net 162.211.181[.]107\nSHA256 34943d8718d35a633bafefb6f113b3486945ec7dcd19bde11ca3c29feed44af3\nCampaign Code HKDLS\nCommand and Control 101.55.121[.]47 27.255.64[.]231 www.iascas[.]net 59.188.247[.]32\nSHA256 400148084474b709a060b844966cf75301d5f2c2b8ae1048f37f634073ead630\nCampaign Code FUCKU\nCommand and Control 101.55.121[.]47 118.193.212[.]61 www.seachers[.]net\nSHA256 61a66afac2702276f6bba2cfcab58198fced893ad1da27aef228259869f5383f\nCampaign Code FUCKU\nCommand and Control 101.55.121[.]47 118.193.212[.]61 www.seachers[.]net\nSHA256 6f039f217d8b3bf6686e298416f084884b9a7ec0ee51f334ecc3f5a2da9145a8\nCampaign Code FUCKU\nCommand and Control 101.55.121[.]47 118.193.212[.]61 www.seachers[.]net\nSHA256 eae4b429b0b732d49750400e70caef579450d0651373440f536de71d6134c173\nCampaign Code FUCKU\nCommand and Control 101.55.121[.]47 118.193.212[.]61 www.seachers[.]netPALO ALTO NETWORKS   +    Operation Lotus Blossom     29SHA256 8f7c74a9e1d04ff116e785f3234f80119d68ae0334fb6a5498f6d40eee189cf7\nCampaign Code HKDLS\nCommand and Control 101.55.121[.]47 \n27.255.64[.]231 www.iascas[.]net 59.188.247[.]32\nSHA256 a462085549f9a1fdeff81ea8190a1f89351a83cf8f6d01ecb5f238541785d4b3\nCampaign Code FUCKU\nCommand and Control 101.55.121[.]47 118.193.212[.]61 www.seachers[.]net\nSHA256 a8e0ab6b19400eccd3c9aceb183fe7626d5bde7bdf9b8ec8825aa17cc3a213a3\nCampaign Code mm-0807\nCommand and Control www.imonju[.]net 61.58.31[.]102 202.77.181[.]179\nSHA256 96356db43d7e9a5c3c4e3f9f7ee9a3dba14ad1c7db7367b7f6d664db4f0ef5d7\nCampaign Code jessica-cpt-app\nCommand and Control www.serchers[.]net www.aliancesky[.]com 162.211.181[.]107 58.64.183[.]92\nSHA256 bd78e106f208cbb8ea9e5902d778514f1fc2d15876fca292971c6695541889a3\nCampaign Code jessica-cpt-app\nCommand and Control www.serchers[.]net www.aliancesky[.]com 162.211.181[.]107 58.64.183[.]92\nSHA256 96410865d46cda89c7c34c60d485c2378a98acbba7ead5ada90daa02a94ba299\nCampaign Code Alice_erpas\nCommand and Control www.boshman09[.]com www.chris201[.]net 58.64.183[.]92\nSHA256 a98db2098fe9e3e203bed8318ae1d71e8a7b68f801613be10f3917baad7b49b2\nCampaign Code jessica-cpt-app\nCommand and Control www.serchers[.]net www.aliancesky[.]com 162.211.181[.]107 58.64.183[.]92PALO ALTO NETWORKS   +    Operation Lotus Blossom     30SHA256 233af642b3e22613551e087a7cefcf2a530752da6613efc52da7cb957cb8f0f3\nCampaign Code KITY090901\nCommand and Control 46.251.237[.]59 \nwww.tintuchoahau[.]com\nSHA256 b1e30dd3ad2c3290adad848f7199e03f365ecf484c44c6c7eaf42f6b323cd30b\nCampaign Code KITY090901\nCommand and Control 46.251.237[.]59 www.tintuchoahau[.]com\nSHA256 9a226eeae1fc51a2bc2e72b098d5654238d0cc8eae29c0cdaacb49ae9d997d04\nCampaign Code QY030610\nCommand and Control 95.154.195[.]152 www.vienclp[.]com\nSHA256 463c6c6ffb8ecf2df44e294818dd500457807ff126dd658c5fe329c09f43a6e0\nCampaign Code KITY01232\nCommand and Control 95.154.195[.]152 www.vienclp[.]com\nSHA256 3a806f8efa338c871b1338a5db8af4128012559d09b06ab997db50a0f90434b1\nCampaign Code KITY01232\nCommand and Control 95.154.195[.]152 www.vienclp[.]com\nSHA256 8ce0b29202f3df23ce583040e2ffe79af78e0bb375ce65ec37a6ffe7d49b5bb5\nCampaign Code QY030610\nCommand and Control 95.154.195[.]152 www.vienclp[.]com\nSHA256 2551f95845ad83ebc56853442bb75c11517e99fe0196ecb30f80e5b203c9a9ff\nCampaign Code QY030610\nCommand and Control 95.154.195[.]152 www.vienclp[.]com\nSHA256 e4a460db653c8df4223ec466a0237943be5de0da92b04a3bf76053fa1401b19e\nCampaign Code QQQQQ\nCommand and Control boshman09[.]com chris201[.]net 58.64.183[.]92PALO ALTO NETWORKS   +    Operation Lotus Blossom     31SHA256 49bf19bd2381f5c78eb2d00a62e1b377620705dba0fa843fb8c8d26d92ec52e4\nCampaign Code 36-SC-0114\nCommand and Control 103.244.91[.]16 \n162.211.181[.]26 101.55.120[.]165 beckhammer.xicp[.]net newinfo32.eicp[.]net\nSHA256 9e5c286fcc47c8346267574ea805cde24b04915f5372f03923c0d6a13290e0ea\nCampaign Code 36-SC-0127\nCommand and Control www.interhero[.]net 101.55.120[.]165 101.55.120[.]153 www.babysoal[.]com beckhammer.xicp[.]net\nSHA256 0201aaa8eda6dedc6c90381e225620cd33fb7b244f76bf229c3dd43feb9bdeaf\nCampaign Code Alice_rosey\nCommand and Control 210.209.127[.]8 www.boshman09[.]com www.chris201[.]net 45.64.113[.]130\nSHA256 f0304a1f7d87ac413f43a815088895872be0045a33c5f830b4b392a7ce5b8c46\nCampaign Code 340-dfa-1007\nCommand and Control usa-moon[.]net aseaneco[.]org 103.28.46[.]96\nSHA256 fd6302a152b0a2eff84b6ef219db5d79b6039043dfd5799ac9a4a0cced58e8bd\nCampaign Code 370my0216\nCommand and Control 113.10.222[.]157 www.tgecc[.]org\nSHA256 00c0e0c14835c08d220ef27ef6324df86880167d416ff7183d7df241ffebc3f8\nCampaign Code ooo\nCommand and Control www.boshman09[.]com www.chris201[.]net 210.209.79[.]29SHA256 0adbf0f6a5c21054e569b2ef68c8c6ae7834a0700672c1f3ec6e50daf49a3a94\nCampaign Code oyf\nCommand and Control www.boshman09[.]com www.chris201[.]net 210.209.79[.]29PALO ALTO NETWORKS   +    Operation Lotus Blossom     32SHA256 093e394933c4545ba7019f511961b9a5ab91156cf791f45de074acad03d1a44a\nCampaign Code Alice_rosey\nCommand and Control 210.209.127[.]8 \nwww.boshman09[.]com www.chris201[.]net 45.64.113[.]130\nSHA256 8e7c198e1eaa5be2d1415be3001c217634ae207b8f912e9a84af6c6016aa467e\nCampaign Code ooo\nCommand and Control www.boshman09[.]com www.chris201[.]net 210.209.79[.]29\nSHA256 97d6699e449ddad97cc33e380a4873a7ceb0e8f0f50b5c8f72e6a4ff3dd1009f\nCampaign Code phone\nCommand and Control usa-moon[.]net aseaneco[.]org 103.252.19[.]13\nSHA256 b53f98c113e7f72ff5170dcdb2ab2b1c15a02aadb72b2d2710d899aea9b875bd\nCampaign Code phone\nCommand and Control usa-moon[.]net aseaneco[.]org 103.252.19[.]13\nSHA256 b2232492776267599307309e9d8874aac25e7cb31b155b0ca05349312690372f\nCampaign Code cyd-zc\nCommand and Control 101.55.121[.]47 118.193.212[.]61\nSHA256 64ffe128c61289bec90057c7bf3ff869c329ffcb1afa4c4cd0daed1effabf105\nCampaign Code cyd-zc\nCommand and Control 101.55.121[.]47 118.193.212[.]61SHA256 b0ffb80762f25935415a7ffd6b9402a23c2b6b4dc4921419ef291160cf7f023b\nCampaign Code Alice_15A\nCommand and Control 210.209.127[.]8 www.boshman09[.]com www.chris201[.]netSHA256 8e180a9d7f233c189519bbfa2b649ca410c4869457e0cf8396beb82ffbffd05c\nCampaign Code ooo\nCommand and Control www.boshman09[.]com www.chris201[.]net 210.209.79[.]29PALO ALTO NETWORKS   +    Operation Lotus Blossom     33Elise Executable SHA256 values\n0201aaa8eda6dedc6c90381e225620cd33fb7b244f76bf229c3dd43feb9bdeaf\n1333a300b03fb2d7bf028f4dee3d9b1f9c97267266faec9e02064862fbb6acb4\n135e37122c23f26fed98b3bc884171c91c370250a73c6660b20416497b66a750\n24bb8e48f37cbd71b2195cff4f52ec304a2ed9d60c28d2afd785e6f32639325f2c2eb2eaadf9253a78265ac4655a6ec5935aa2673ff5e4fe3bb6753803c7fe592c512b50f8aa0881120d844b0bbbf7baa33465083fdc85755d51d1b5721bc057\n2d43632953b511e1f1c7698de3c21b2ba7c27b75bb6079f51dcf9376e05e42b7\n376c3ea59411380ab5146b3bc39ee79cf7f78b08dd712ef1cc5327bda5a2e46b39dd2381bcd0f47dadf23399254bf1b51a837179e5634328afafe07510f5888a3eb115f4eb62c4404be1a318afa3837bdba8fd66938efe15664741d942a85add\n49bf19bd2381f5c78eb2d00a62e1b377620705dba0fa843fb8c8d26d92ec52e4\n4de470147d90efbb440aa4420a5832b4f22f9f6128183568fe604df6427cc06b4ff70adad080095421f34873e491c9da2e798f8db96a984f87efb9889d246fcb5960d8f8b26edb453926efbd424332eabc0e1a74e25dbc1e9a570cc5920c8830\n64ffe128c61289bec90057c7bf3ff869c329ffcb1afa4c4cd0daed1effabf105\n712c488950f27e98bc4ebe5b63e5775498236a179cb4576bf021f8e6e6de0df47b2d470b9c6159c97cef2634493be0e4f2994f43501605a14d4c5a7efdeac3ba7e386ff64be78af18f8a79d01cb75b0438cbcee4647e0a928100bd52ee56db76\n840d18698ff0b114ee587f57231001d046fbd1eb22603e0f951cbb8c290804ed\n866c698073e4deb66dd83c1ec9567ec03eca9f03775deadb81cc59fdb6cfd446899730962e10546c9d43a9ffa79d900fd37c0d17f95aa537b67d31aa737447b5\n8b4446cfaee549072c5da2468af7b9fec711f2d28851a3e8076fcfb53393a415\n8c2cd914de7c125e49019f3826918511150ee4fff8a923da350a99c102b364558ce0b29202f3df23ce583040e2ffe79af78e0bb375ce65ec37a6ffe7d49b5bb58f7c74a9e1d04ff116e785f3234f80119d68ae0334fb6a5498f6d40eee189cf7\n90296f0ecacc017bcf289297f5743660dd18bbc2842e631e9be4b2dc51732412\n96356db43d7e9a5c3c4e3f9f7ee9a3dba14ad1c7db7367b7f6d664db4f0ef5d797d6699e449ddad97cc33e380a4873a7ceb0e8f0f50b5c8f72e6a4ff3dd1009f9e5c286fcc47c8346267574ea805cde24b04915f5372f03923c0d6a13290e0ea\na462085549f9a1fdeff81ea8190a1f89351a83cf8f6d01ecb5f238541785d4b3\na8e0ab6b19400eccd3c9aceb183fe7626d5bde7bdf9b8ec8825aa17cc3a213a3b5a1f7e9d0d6d3bec17674610a3b26991083e1e3cb81729714b69c18038a902fbd78e106f208cbb8ea9e5902d778514f1fc2d15876fca292971c6695541889a3\nd68a90fbe579a8199d78ef9ca001301e2c55a3015d4e3df3c238c276ed7cc1ce\ndc06012b4aef457efb0ecb9cdca579bb573823a1a63bb7a2ba92c7ce0c2ddbfbe2181b3d47feb5a321fe3b85b08a0245a1e0824b213e568fa4736d529fd5f8c2e4a460db653c8df4223ec466a0237943be5de0da92b04a3bf76053fa1401b19e\nedb45f03dfd52ab58f163ad2ca48f4bc9c4bcb72ea9181d0e0a1d87859f707a6\nf0304a1f7d87ac413f43a815088895872be0045a33c5f830b4b392a7ce5b8c46f307280077b2a60d991a68c5700cbc57fe0ab6ec005caba0b0bcca4dbc5a1e2f\nfb506b8dd4025e247ac2fa12ffd46fd1cb6a06a138995a5cbda49074d567f615\nfd2d9011ec860ba211d169063248d13d17425f210ff87a6c5a610b4704866339PALO ALTO NETWORKS   +    Operation Lotus Blossom     34Elise Delivery Document SHA256 values\n9a226eeae1fc51a2bc2e72b098d5654238d0cc8eae29c0cdaacb49ae9d997d04\n7e917319e2af9457c35afbb539c09233da2e02d6a64f970706dae9f6c3c791eb\nc19d3242d43c71f03f5873231444c12a6a11892dd7f0142ff10479f1f718382d\ndc61e089eebf6fa1b3abf637ce105e0d20666aa52d9001f5fd5034815331cd61fd6302a152b0a2eff84b6ef219db5d79b6039043dfd5799ac9a4a0cced58e8bde9971de22a922678fc216e9e3923c7e6b21455ddfbb24eb46e50e1cc7ceacc31\nd9174d6bbcb51d3df186794109cd6b2036f6231cf8733290eadd399bf8137055\nb53f98c113e7f72ff5170dcdb2ab2b1c15a02aadb72b2d2710d899aea9b875bdb2232492776267599307309e9d8874aac25e7cb31b155b0ca05349312690372f463c6c6ffb8ecf2df44e294818dd500457807ff126dd658c5fe329c09f43a6e0\n3d2c6d48425212eabb886c2e7e89249e4aa8cf4ad9ec3dd22cafb4f879683d8b\n093e394933c4545ba7019f511961b9a5ab91156cf791f45de074acad03d1a44ab0ffb80762f25935415a7ffd6b9402a23c2b6b4dc4921419ef291160cf7f023b8e180a9d7f233c189519bbfa2b649ca410c4869457e0cf8396beb82ffbffd05c\n8e7c198e1eaa5be2d1415be3001c217634ae207b8f912e9a84af6c6016aa467e\n00c0e0c14835c08d220ef27ef6324df86880167d416ff7183d7df241ffebc3f80adbf0f6a5c21054e569b2ef68c8c6ae7834a0700672c1f3ec6e50daf49a3a9496410865d46cda89c7c34c60d485c2378a98acbba7ead5ada90daa02a94ba299\na98db2098fe9e3e203bed8318ae1d71e8a7b68f801613be10f3917baad7b49b2\nb1e30dd3ad2c3290adad848f7199e03f365ecf484c44c6c7eaf42f6b323cd30b4780442f3cc8d3e1888aa6cecbb05d0c49a6755964eba7a8a6a36d6d2a0ef881\nbae07b0c3e4e96731360dc4faa49c0d4abe4d3705e768393f21661c82dea13f3\n65c901b19e2eec6b8392100c1073253641a95dd542f39c9ca95755e8a2afde1430f1f7e848c79212f70794d718d0f3929c24e0f3d28695a7c85a85c77ab7aac90752bbdb0c51a519f17a62dd30a033c224c82168522f2c88949b1a0afc8f9037\nb9681c178e087140344e6aec2630c61f6a7be92e97ebbe7ce10528f6f0e6028f\n6eae10f0b9a62a26b19897f7ba627f92e93e458034939f55f2001835c0e1f1be\n PALO ALTO NETWORKS   +    Operation Lotus Blossom     35Lotus Blossom Command and Control Servers\n101 .55.120.153 \n101 .55.120.165\n101 .55.121 .47\n103.244.91 .16103.246.245.146103.252.19.13\n103.28.46.96\n113.10.136.18113.10.222.157118.193.212.61\n122.10.89.84\n122.10.89.85142.91 .252.130162.211 .181 .107\n162.211 .181 .26\n173.231 .49.98184.22.44.209202.77 .181 .179\n202.82.202.228\n202.82.91 .139203.218.138.30\n210.209.127 .8\n210.209.79.29218.103.16.15323.234.63.197\n27 .255.64.231\n45.64.113.13046.251 .237 .5950.7 .11 .10\n58.64.183.92\n59.188.247 .3259.6.2.1661 .58.31 .102\n95.154.195.152\nasean-star.comaseaneco.orgaseansec.dynalias.org\nbeckhammer.xicp.net\nboshman09.com chris201 .net\ncpcl2006.dyndns-free.com\ncybertunnel.dyndns.infoharryleed.dyndns.orgjackyson.dyndns.infokid.dyndns.org\nkjd.dyndns.org\nnewinfo32.eicp.net\nnewshappys.dyndns-blog.competto.mooo.comphil-army.gotdns.org\nphil-gov.gotdns.org\nscristioned.dyndns-web.comshotacon.dyndns.infousa-moon.net \nverolalia.dyndns.org\nwsi.dyndns.orgwww.aliancesky.comwww.babysoal.com\nwww.boshman09.com \nwww.chris201 .netwww.iascas.netwww.imonju.com\nwww.imonju.net\nwww.interhero.net www.seachers.net\nwww.serchers.net\nwww.tgecc.orgwww.tintuchoahau.comwww.vienclp.com\nwww3.bkav2010.net\ni     Triangle of Life. Snopes. December, 2009. http://www.snopes.com/inboxer/household/triangle.asp\nii   Targeted Attack Trends 2013 2H. Trend Micro Inc. May 19, 2014. \nhttp://www.itu.int/en/ITU-D/Cybersecurity/Documents/2H_2013_Targeted_Attack_Campaign_Report.pdf\niii   Targeted Attack Trends in Asia-Pacific. Trend Micro Inc. Nov. 20, 2014.  http://www.trendmicro.co.in/in/\ncloud-content/apac/pdfs/security-intelligence/reports/rpt-1h-2014-targeted-attack-trends-in-asia-pacific.pdf\niv   BKDR_ESILE.SMEX. Trend Micro Inc. May 28, 2013. \nhttp://www.trendmicro.com/vinfo/us/threat-encyclopedia/malware/BKDR_ESILE.SMEX\nv   ESILE Targeted Attack Campaign Hits APAC Governments. Trend Micro Inc. July 28, 2014. \nhttp://www.trendmicro.com.my/vinfo/my/security/news/cyber-attacks/ \nesile-targeted-attack-campaign-hits-apac-governments\nvi  Analysis of Malware Page. Singh, Abhishek. Sept. 12, 2012. \nhttps://www.fireeye.com/blog/threat-research/2012/09/analysis-of-malware-page.html\nvii Spear Phishing the News Cycle: APT Actors Leverage Interest in the Disappearance of Malaysian Flight \nMH 370. Moran, Ned & Lanstein, Alex https://www.fireeye.com/blog/threat-research/2014/03/ spear-phishing-the-news-cycle-apt-actors-leverage-interest-in-the-disappearance-of-malaysian-flight-mh-370.html\n4401 Great America Parkway\nSanta Clara, CA 95054\nMain: +1.408.753.4000\nSales: +1.866.320.4788   \nSupport: +1.866.898.9087\nwww.paloaltonetworks.comCopyright ©2015, Palo Alto Networks, Inc. All rights reserved. Palo Alto Networks,  \nthe Palo Alto Networks Logo, PAN-OS, App-ID and Panorama are trademarks of  \nPalo Alto Networks, Inc. All specifications are subject to change without notice.  \nPalo Alto Networks assumes no responsibility for any inaccuracies in this document  \nor for any obligation to update information in this document. Palo Alto Networks  \nreserves the right to change, modify, transfer, or otherwise revise this publication  \nwithout notice. PAN_WP_U42_OLB_061515"
}