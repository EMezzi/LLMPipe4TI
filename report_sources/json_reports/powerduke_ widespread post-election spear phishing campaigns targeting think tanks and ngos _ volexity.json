{
    "title": "powerduke_ widespread post-election spear phishing campaigns targeting think tanks and ngos _ volexity",
    "text": "BLOG\nPowerDuke: Widespread Post-Election Spear\nPhishing Campaigns Targeting Think Tanks and\nNGOs\nNOVEMBER 9, 2016\nby Steven Adair\n    \nIn the wake of the 2016 United States Presidential Election, not even six hours after Donald Trump became\nthe nation’s President-Elect, an advanced persistent threat (APT) group launched a series of coordinated and\nwell-planned spear phishing campaigns. Volexity observed five different attack waves with a heavy focus on\nU.S.-based think tanks and non-governmental organizations (NGOs). These e-mails came from a mix of\nattacker created Google Gmail accounts and what appears to be compromised e-mail accounts at Harvard’s\nFaculty of Arts and Sciences (FAS). These e-mails were sent in large quantities to different individuals across\nmany organizations and individuals focusing in national security , defense , international affairs , public\npolicy , and European and Asian studies . Two of the attacks purported to be messages forwarded on from\nthe Clinton Foundation  giving  insight and perhaps a postmortem analysis into the elections. Two of the\nother attacks purported to be eFax links or documents pertaining to the election’s outcome being revised or\nrigged. The last attack claimed to be a link to a PDF download on “ Why American Elections Are Flawed. ”\nVolexity believes a group it refers to as The Dukes  (also known as APT29 or Cozy Bear) is responsible for\npost-election attack activity.\nBackground\nSince August of this year, Volexity has been actively involved in investigating and tracking several attack\ncampaigns from the Dukes. Most notably the Dukes have previously been tied to the breach  of the\nDemocratic National Committee (DNC) and intrusions  into multiple high-profile United States Government\norganizations. In July 2015, the Dukes started heavily targeting  think tanks and NGOs. This represented a\nfairly significant shift in the group’s previous operations and one that continued in the lead up to and\nimmediately after the 2016 United States Presidential election.\nOn August 10, 2016 and August 25, 2016, the Dukes launched several waves of highly targeted spear\nphishing attacks against several U.S.-based think tanks and NGOs. These spear phishing messages were\nspoofed and made to appear to have been sent from real individuals at well-known think tanks in the United\nStates and Europe. These August waves of attacks purported to be from individuals at Transparency\nInternational , the Center for a New American Security (CNAS) ,  the International Institute for Strategic Studies\n(IISS) , Eurasia Group , and the Council on Foreign Relations (CFR) .\nThe Dukes are known for launching their attacks by sending links to ZIP files, that contain malicious\nexecutables, hosted on legitimate compromised web servers. However, each of the e-mail messages from\nthe August attacks contained a Microsoft Office Word (.doc) or Excel (.xls) attachment. These attachments,\nwhen viewed, contained legitimate report content from each of the organizations they appeared to have\nbeen sent from. However, the attackers inserted macros into the documents designed to install a malware\ndownloader on the system. Successful exploitation would result in the download of a PNG image file from a\ncompromised webserver. These attack campaigns leveraged steganography in the PNG files by hiding\ncomponents of a backdoor that would exist only in memory after being loaded into rundll32.exe. Volexity\nhas dubbed this backdoor PowerDuke . Similar attack campaigns using documents with macros dropping\nPowerDuke were further observed through October, where Universities, and not think tanks appear to have\nbeen the primary targets. Details of these attacks have been provided to Volexity customers. Concerned\nNGO’s and Universities that may have been targeted by these attacks campaigns are welcome to reach out\nfor additional details.\nNovember 9 – Post-Election Spear Phishing\nWaves\nThe post-election attacks launched by the Dukes on November 9 were very similar to previous attacks seen\nfrom the Dukes in both 2015 and 2016. The PowerDuke malware, first seen in August 2016, was once again\nused in these most recent attacks. Three of the five attack waves contained links to download files from\ndomains that the attackers appear to have control over. The other two attacks contained documents with\nmalicious macros embedded within them. Each of these different attack waves were slightly different from\none another and are detailed below.\nAttack Wave 1: eFax – The “Shocking” Truth About Election\nRigging\nThe first attack wave is similar to much older attacks from the Dukes that purport to be an electronic Fax.\nThis message claims to have been sent from Secure Fax Corp. and has a link to a ZIP file that contains a\nMicrosoft shortcut file (.LNK). This shortcut file contains PowerShell commands that conduct anti-VM checks,\ndrop a backdoor, and launch a clean decoy document. The e-mail message was sent from the attacker\ncontrolled e-mail account industry.faxsolution@gmail.com . The screen shot below shows the e-mail that\nwas sent.\nMicrosoft Exchange Control Panel\n(ECP) Vulnerability CVE-2020-0688\nExploited\nVulnerable Private Networks:\nCorporate VPNs Exploited in the\nWild\nDigital Crackdown: Large-Scale\nSurveillance and Exploitation of\nUyghurs\nActive Exploitation of Newly Patched\nColdFusion Vulnerability (CVE-2018-\n15961)\nMagecart Strikes Again: Newegg in\nthe Crosshairs\nMarch 2020\nSeptember 2019\nNovember 2018\nSeptember 2018\nAugust 2018\nJuly 2018\nJune 2018\nApril 2018\nNovember 2017\nJuly 2017\nMarch 2017\nNovember 2016\nOctober 2015\nJuly 2015\nJune 2015\nApril 2015\nOctober 2014\nSeptember 2014\ndigital surveillance  crimeware  APT  Dukes\nJapan  VPN Scanbox  elections  java\nvulnerabilities  exploits\nScanning  spear phishing  Drupal\nAfghanistan  Gh0st  Cisco  Hong Kong  China\nAdobe FlashSEARCH\nRECENT POSTS\nARCHIVES\nTAGS\nREQUEST A DEMO  BREACH ASSISTANCE\nPRODUCTS SERVICES COMPANY BLOG CONTACT\n The e-mail contained links pointing to the following URL:\nhxxp://efax.pfdweek[.]com/eFax/message0236.ZIP\nInside of this password (1854) protected ZIP file is a Microsoft shortcut file named:\n37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk\nNote that pfdweek[.]com  appears to be under the control of the attackers but may be a hijacked domain.\nDetails on each of the files are included below.\nFilename:  message0236.ZIP\nFile size:  643843 bytes\nMD5 hash:  bea0a6f069bd547db685698bc9f9d25a\nSHA1 hash:  ee09bec09388338134d47fa993d5e0f86efe5bd4\nNotes: Password protected ZIP file containing malicious Microsoft shortcut file (37486-the-shocking-\ntruth-about-election-rigging-in-america.rtf.lnk)\nFilename:  37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk\nFile size:  724003 bytes\nMD5 hash:  c272aebc661c54cc960ba9a4a3578952\nSHA1 hash:  52d62213c66a603e33dab326bf4fa29d6ac681c4\nNotes: Microsoft shortcut file with embedded PowerShell, PowerDuke backdoor (hqwhbr.lck), and clean\ndecoy document.\nFilename: kxwn.lock\nFile size:   10752 bytes\nMD5 hash: 28b95a2c399e60ee535c32e73860fbea\nSHA1 hash:  bf4ce67b6e745e26fcf3a2d41938a9dff1395076\nNotes: Primary PowerDuke backdoor (DLL) loader (leverages kxwn.lock:schemas) dropped to\n“%APPDATA\\Roaming\\Microsoft\\” with persistence via HKCU Run Key “WebCache”\n(rundll32.exe %APPDATA\\Roaming\\Microsoft\\kxwn.lock , #2). Connects directly to 173.243.80.6:443  for\ncommand and control.\nFilename:  kxwn.lock:schemas\nFile size:   609853 bytes\nMD5 hash: 4e1dec16d58ba5f4196f6a76a0bca75c\nSHA1 hash:  a7c43d7895ecef2b6306fb00972c321060753361\nNotes: Alternate data stream (ADS) PNG  file with the PowerDuke backdoor component hidden and\nencrypted within using Tiny Encryption Algorithm (TEA).\nAttack Wave 2: eFax – Elections Outcome Could Be revised\n[Facts of Elections Fraud]\nThe second attack wave that Volexity observed leveraged a Microsoft Word document with a malicious\nembedded macro. This appears to be consistent with several previous Dukes attack campaigns, such as\nthose on August 25, 2016. The Macros contain several anti-VM checks designed to avoid executing in\nvirtualized environments. The e-mail message was sent from the attacker controlled e-mail account\nsecurefaxsolution@gmail.com .\nThe screen shot below shows the e-mail that was sent.\nDetails on the malware components of this attack wave are included below.\nFilename:  election-headlines-FTE2016.docm\nFile size:  835072 bytes\nMD5 hash:  a8e700492e113f73558131d94bc9ae2f\nSHA1 hash:  b5684384c8028f0324ed7119f6abf379f2789970\nNotes: Document containing malicious macro that drops\nFilename:  fywhx.dll\nFile size:  10752 bytes\nMD5 hash:  ad6723f61e10aefd9688b29b474a9323\nSHA1 hash:  dd766876b3be5022bfb062f454f878abfbc670b8\nNotes: PowerDuke backdoor file dropped to “%APPDATA\\Roaming\\HP\\” with persistence via HKCU Run\nKey “ToolboxFX” (rundll32.exe %APPDATA\\Roaming\\HP\\fywhx.dll #2). Connects directly to\n185.132.124.43:443  for command and control.\nFilename:  fywhx.dll:schemas\nFile size:   608854 bytes\nMD5 hash: 8c53ee9137a7d540fcff0d523f7d0822\nSHA1 hash:  ab32c09c46e0c9dbc576fefee68e5a2f57e0482e\nNotes: Alternate data stream (ADS) PNG  file with the PowerDuke backdoor component hidden and\nencrypted within using Tiny Encryption Algorithm (TEA).\nAttack Wave 3: Why American Elections Are Flawed\nVolexity believes the following e-mail received the widest distribution among the targeted organizations. The\ne-mail purports to have been sent from Harvard’s “PDF Mobile Service” or “PFD Mobile Service”. The spelling\nof this non-existent service is inconsistent in the e-mail.  The latter spelling appears to be a typographical\n error that is consistent with the domain names registered by the attackers. The screen shot below shows the\ne-mail that was sent.\nThe e-mail contained links pointing to the following URL:\nhxxp://efax.pfdresearch[.]org/eFax/RWP_16-038_Norris.ZIP\nInside of this password (8734) protected ZIP file is an executable named:\nRWP16-038_Norris.exe\nNote that pfdresearch[.]org  appears to be under the control of the attackers but may be a hijacked domain.\nDetails on the malware components of this attack wave are included below.\nFilename:  RWP_16-038_Norris.ZIP\nFile size:  854996 bytes\nMD5 hash:  8b3050a95e3ce00424b85f6e9cc3ccec\nSHA1 hash:  d5dcf445830c54af145c0dfeaebf28f8ec780eb5\nNotes: Password protected ZIP file with malicious executable inside (RWP16-038_Norris.exe).\nFilename:  RWP16-038_Norris.exe\nFile size:  1144832 bytes\nMD5 hash:  3335f0461e5472803f4b19b706eaf4b5\nSHA1 hash:  5cc807f80f14bc4a1d6036865e50d576200dfd2e\nNotes: Dropper for PowerDuke backdoor and clean decoy document\nFilename:  gwV46iIc.idx\nFile size:   10752 bytes\nMD5 hash: ae997d2047705ff46a0c228f7b5d7052\nSHA1 hash:  1067ddd5615518e0cbac7389a024b32f119a3229\nNotes: Primary PowerDuke backdoor (DLL) loader (leverages gwV46iIc.idx:schemas) dropped to\n“%APPDATA\\Roaming\\Apple\\” with persistence via HKCU Run Key “ConnectionCenter”\n(rundll32.exe %APPDATA\\Roaming\\Apple\\gwV46iIc.idx, #2). Connects directly to 185.124.86.121:443\nfor command and control.\nFilename:  gwV46iIc.idx:schemas\nFile size:   580968 bytes\nMD5 hash: 7b9b51cb44cd6a7af1cd28faeeda04a7\nSHA1 hash:  e3bd7bdfe0026cf4ee39fd75a771eac52ffea095\nNotes: Alternate data stream (ADS) PNG  file with the PowerDuke backdoor component hidden and\nencrypted within using Tiny Encryption Algorithm (TEA).\nAttack Wave 4: Clinton Foundation FYI #1\nThe fourth attack wave that Volexity observed leveraged a Microsoft Word document with a malicious\nembedded macro. This appears to be consistent with several previous Dukes attack campaigns, such as\nthose on August 25, 2016. The Macros contain several anti-VM checks designed to avoid executing in\nvirtualized environments. The screen shot below shows the e-mail that was sent.\n Details on the malware components of this attack wave are included below.\nFilename:  harvard-iop-fall-2016-poll.doc\nFile size:  2808832 bytes\nMD5 hash:  ead48f15ebc088384a4bd6190c2343fa\nSHA1 hash:  0b9dccfcb2cc8bced343b9d930e475f1d0e5d966\nNotes: Document containing malicious macro that drops impku.dat and impku.dat:shemas.\nFilename:   impku.dat\nFile size:  10752 bytes\nMD5 hash:  9f420779c90e118a0b5fd904380878a1\nSHA1 hash:  11523d859e9a818c2628d7954502cbdb5eeb2199\nNotes: PowerDuke backdoor file dropped to “%APPDATA\\Roaming\\Dell\\” with persistence via HKCU Run\nKey “Communicator” (rundll32.exe %APPDATA\\Roaming\\Dell\\impku.idat, #2). Connects directly to\n185.26.144.109:443  for command and control.\nFilename:  impku.dat:schemas\nFile size:   608854 bytes\nMD5 hash: b774f39d31c32da0f6a5fb5d0e6d2892\nSHA1 hash:  ae3ff39c2a7266132e0af016a48b97d565463d90\nNotes: Alternate data stream (ADS) PNG  file with the PowerDuke backdoor component hidden and\nencrypted within using Tiny Encryption Algorithm (TEA).\nAttack Wave 5: Clinton Foundation FYI #2\nThe fifth attack wave that Volexity observed once against leveraged a download link and a new domain that\nappears to be under control of the attackers. The link in the e-mail points to a ZIP file that has a Microsoft\nshortcut file (.LNK) inside of it. This shortcut file contains PowerShell commands that conduct anti-VM checks,\ndrop a backdoor, and launch a clean decoy document. Like Attack Wave #3, this e-mail message also\npurported to be forwarded from Laura Graham at the Clinton Foundation. The message body contained\ndozens of e-mail addresses to which the message originally claims to have been sent, with organizations\nsimilar to Attack Wave #3. The e-mail message from this attack wave, with identifying information removed,\nis shown below.\nAs seen in the screen shot above, the e-mail contained links pointing to the following URL:\nhxxp://efax.pfdregistry[.]net/eFax/37486.ZIP\nInside of this password (6190) protected ZIP file a Microsoft Shortcut file named:\n37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk\nNote that pfdregistry[.]net appears to be under the control of the attackers but may be a hijacked domain.\nDetails on the malware components of this attack wave are included below.\nFilename:  37486.ZIP\nFile size:  580688 bytes\nMD5 hash:  f79caf27a99c091e6c1775b306993341\nSHA1 hash:  a76c02c067eae26d78f4b494274dfa6aedc6fa7a\n Notes: Password protected ZIP file containing malicious Microsoft shortcut file 37486-the-shocking-\ntruth-about-election-rigging-in-america.rtf.lnk.\nFilename:  37486-the-shocking-truth-about-election-rigging-in-america.rtf.lnk\nFile size:  661782 bytes\nMD5 hash:  f713d5df826c6051e65f995e57d6817d\nSHA1 hash:  68ce4c0324f03976247ff48803a7d988f9f9f43f\nNotes: Microsoft shortcut file with embedded PowerShell, PowerDuke backdoor (hqwhbr.lck), and clean\ndecoy document.\nFilename:  hqwhbr.lck\nFile size:  10752 bytes\nMD5 hash:  57c627d68e156676d08bfc0829b94331\nSHA1 hash:  4bcbf078a78ba0e842f78963ba9dd71240ab6a6d\nNotes: PowerDuke backdoor file dropped to “%APPDATA\\Roaming\\Skype\\” with persistence via HKCU\nRun Key “IAStorIcon” (rundll32.exe %APPDATA\\Roaming\\Apple\\hqwhbr.lck, #2).  Connects directly to\n177.10.96.30:443  for command and control.\nFilename:  hqwhbr.lck:schemas\nFile size:  547636 bytes\nMD5 hash: cbf96820dc74a50a91b2b8b94376682a\nSHA1 hash:  5f105801a1abb398dadc756480713f9bd7a4aa73\nNotes: Alternate data stream (ADS) PNG  file with the PowerDuke backdoor component hidden and\nencrypted within using Tiny Encryption Algorithm (TEA).\nThe PowerDuke Backdoor\nThe PowerDuke backdoor boasts a pretty extensive list of features that allow the Dukes to examine and\ncontrol a system. Volexity suspects the feature set that has been built into PowerDuke is an extension of\ntheir anti-VM capabilities in the initial dropper files. Several commands supported by PowerDuke facilitate\ngetting information about the system.\nA previous analysis of PowerDuke showed it supported the following commands.\ncomp get the NetBIOS name via GetComputerNameEx\ndomain get the computer’s domain via NetWkstaGetInfo\ndrives get logical drives, drive type, free space, serial number, etc.\nfsize get the size of a file via GetFileAttributesExW or failing that, by mapping the file and\ngetting the size\nkill stop a process via TerminateProcess\nmemstat get memory usage status via GlobalMemoryStatusEx, total RAM, percent used, etc.\nosdate get the time the machine was built (via InstallDate registry key)\nosver get OS info via registry, such as ProductName, CurrentBuild, CurrentVersion,\nCSDBuildNumber, etc.\npslist list processes via CreateToolhelp32Snapshot\npwd get current directory via GetCurrentDirectoryW\nrun start a process via CreateProcessW\n# runs cmd.exe /c and gets the output via Named Pipe and sends the data back\nsiduser gets the current user’s SID via GetTokenInformation and LookupAccountSidW\ntime the time + timezone (GetLocalTime and GetTimeZoneInformation)\nuptime number of seconds since the last boot\nuser the user’s name via GetUserNameExW\nwipe writes random data across a file, then deletes the file\nwnd gets the text of the current foreground window\nfgetp download file\nfputp upload file\npower reboot or shutdown (via previously loaded PowrProf.dll)\ncdt change to temporary directory\nreqdelay sleep for specified time\nVolexity has not fully examined the PowerDuke instances from these campaigns but has noted the malware\nappears to support the following additional commands not described above:\nsidcomp\nbuzy\nexit\ncopy\ndetectav\nmkdir\nsoftware\nshlist\nshinfo\nshdel\nshadd\nsetpng\nconn\nsetsrv\nVolexity may update this post following further PowerDuke analysis.\nNetwork Indicators\nBelow are network indicators associated with download URLs for the aforementioned Dukes attack\ncampaigns.\n Hostname IP Address ASN Information\nefax.pfdresearch.org 81.82.196.162 6848 | 81.82.0.0/15 | TELENET | BE | telenet.be | Telenet\nOperaties N.V.\nefax.pfdregistry.net 65.15.88.243 7018 | 65.15.64.0/19 | ATT-INTERNET4 | US |\nbellsouth.net | Bellsouth.net Inc.\nefax.pfdweek.com 84.206.44.194 31581 | 84.206.0.0/16 | KOPINT | HU | ekg.kopdat.hu |\nNational Infocommunications Service Company Limited by\nShares\nBelow are network indicators associated with command and control servers for the aforementioned Dukes\nattack campaigns.\nIP Address ASN Information\n185.124.86.121 43260 | 185.124.86.0/24 | DGN | TR | – | –\n185.132.124.43 43260 | 185.132.124.0/24 | DGN | TR | – | –\n185.26.144.109 60721 | 185.26.144.0/24 | BURSABIL | TR | bursabil.com.tr | Bursabil\nKonfeksiyon Tekstil Bilisim Teknoloji insaat Sanayi ve Ticaret Limited Sirketi\n173.243.80.6 14979 | 173.243.80.0/24 | AERONET-WIRELESS | PR | aeronetpr.com | Aeronet\nWireless\n177.10.96.30 262848 | 177.10.96.0/21 | Naja | BR | najatel.com.br | Naja Telecomunicacoes\nLtda.\n \nConclusion\nThe Dukes continue to launch well-crafted and clever attack campaigns. They have had tremendous success\nevading anti-virus and anti-malware solutions at both the desktop and mail gateway levels. The group’s anti-\nVM macros and PowerShell scripts appear to have drastically reduced the number of sandboxes and bots\nthat the group has to deal with on their command and control infrastructure. This combined with their use of\nsteganography to hide their backdoor within PNG files that are downloaded remotely and loaded in memory\nonly or via alternate data streams (ADS) is quite novel in its approach. Volexity believes that the Dukes are\nlikely working to gain long-term access into think tanks and NGOs and will continue to launch new attacks\nfor the foreseeable future.\nFollow us on Twitter: @Volexity , @stevenadair , @5ck , @imhlv2,  @attrc\nAPT , Dukes , elections , spear phishing\n© 2020 Volexity. All Rights Reserved.About\nAbout UsSolutions\nRequest A DemoContact\n11654 Plaza America Dr #774Connect\n\nThis Website uses cookies, which are necessary to its functioning and required to achieve the purposes illustrated in our Cookie Policy . By clicking the button, you consent to our use of cookies. AGREE & CLOSE\n "
}