{
    "title": "rpt-apt41-2019",
    "text": "Double Dragon\nAPT41, a dual espionage and  \ncyber crime operation\nAPT41\n2       SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION 2 SPECIAL REPORT | APT40       2\nTable of Contents\nOverview  .......................................................................................... 4\nTargeting  .......................................................................................... 6\nOperations Over Time  ................................................................ 8\nCyber Espionage Activity  ....................................................... 10\nCase Study: Healthcare Sector Targeting  .................. 12\nFinancially Motivated Activity .............................................. 14\nCase Study: Video Game Industry Targeting  ............ 17\nThird-Party Access .................................................................... 20\nHistory of Supply Chain Compromises  .............................. 21\nDecember 2014 .................................................................... 22\nMarch 2017  ............................................................................ 23\nJuly 2017  ................................................................................ 24\nJune 2018  ............................................................................... 25\nJuly 2018  ............................................................................... 26\nOverlaps Between Espionage and Financial \nOperations  .................................................................................... 27\nAttribution .................................................................................... 30\nStatus as Potential Contractors  .......................................... 33Links to Other Known Chinese Espionage  \nOperators  ...................................................................................... 34\nCertificate Overlap  ............................................................ 35\nLauncher Overlap  .............................................................. 36\nCode Family Overlap  ........................................................ 36\nUse of Code-Signing Certificates  ....................................... 39\nOutlook and Implications  ....................................................... 41\nTechnical Annex: Attack Lifecycle  ..................................... 42\nInitial Compromise  ............................................................ 43\nEstablish Foothold  ............................................................ 44\nEscalate Privileges ............................................................. 45\nInternal Reconnaissance  ................................................. 45\nLateral Movement  .............................................................. 46\nMaintain Presence .............................................................. 47\nComplete Mission  .............................................................. 48\nTechnical Annex: MITRE ATT&CK Mapping  .................... 49\nTechnical Annex: Code-Signing Certificates Used by \nAPT41  ............................................................................................... 51\nTechnical Annex: Additional Malware Overlaps  ........... 52\nBackground  ........................................................................... 52\nHIGHNOON  ........................................................................... 52\nHIGHNOON.BIN and HIGHNOON.LITE  ....................... 52\nHIGHNOON.LINUX and HIGHNOON  .......................... 54\nCROSSWALK and CROSSWALK.BIN  ......................... 54\nTechnical Annex: Malware Used by APT41  ..................... 60\nTechnical Annex: APT41 IOCs  .............................................. 63SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION        3\nExecutive Summary\nFireEye Threat Intelligence assesses with high confidence that APT41 is a Chinese  \nstate-sponsored espionage group that is also conducting financially motivated activity for \npersonal gain.\nAPT41 espionage operations against the healthcare, high-tech, and telecommunications \nsectors include establishing and maintaining strategic access, and through mid-2015, the \ntheft of intellectual property.\nThe group's operations against higher education, travel services, and news/media firms \nprovide some indication that the group also tracks individuals and conducts surveillance.\nFireEye Threat Intelligence assesses with high confidence that APT41 carries out an array \nof financially motivated intrusions, particularly against the video game industry, including \nstealing source code and digital certificates, virtual currency manipulation, and attempting \nto deploy ransomware.\nAPT41 has executed multiple software supply chain compromises, gaining access to \nsoftware companies to inject malicious code into legitimate files before distributing updates.4 SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nFireEye Threat Intelligence assesses with high confidence that APT41 is \na prolific cyber threat group that carries out Chinese state-sponsored \nespionage activity in addition to financially motivated activity potentially \noutside of state control. Activity traces back to 2012 when individual \nmembers of APT41 conducted primarily financially motivated operations \nfocused on the video game industry before expanding into likely state-\nsponsored activity. This is remarkable because explicit financially motivated \ntargeting is unusual among Chinese state-sponsored threat groups, and \nevidence suggests these two motivations were balanced concurrently from \n2014 onward.OverviewSPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION        5\nOverview\n• APT41 is unique among tracked China-based actors in \nthat it leverages non-public malware typically reserved \nfor espionage operations in what appears to be activity \nthat falls outside the scope of state-sponsored missions.\n• Based on early observed activity, consistent behavior, \nand APT41's unusual focus on the video game industry, \nwe believe the group's cyber crime activities are most \nlikely motivated by personal financial gain or hobbyist \ninterests.\nThis contrasts with the state-sponsored goals that likely \ndrive the group's healthcare, high-tech, and politically \nrelated targeting.\n• We believe that APT41 is highly sophisticated and \ninnovative. Its history of financially motivated targeting \nof the video game industry has ultimately supported the \ngroup's state-sponsored activity.• The group's distinct use of supply chain compromises to \ntarget select individuals, consistent use of compromised \ndigital certificates, and deployment of bootkits (rare \namong APT operators), highlight a creative and well-\nresourced adversary.\n• Some of the early operations driven by personal gain \nused techniques that would later be pivotal in executing \nsupply chain compromises.\n• Learning to access video game production environments \nenabled APT41 to develop the tactics, techniques, and \nprocedures (TTPs) that were later leveraged against \nsoftware companies to inject malicious code into \nsoftware updates. \nAPT41 campaigns include most of the incidents previously \nattributed in FireEye Threat Intelligence reporting to \nGREF Team and a number of additional clusters that were \npreviously unnamed.6       SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nLike other Chinese espionage operators, APT41 targets \nindustries in a manner generally aligned with China's \nFive-Year economic development plans. However, some \ncampaigns attributed to APT41 indicate that the group is \nalso deployed to gather intelligence ahead of imminent \nevents, such as mergers and acquisitions (M&A) and \npolitical events. Directly targeted verticals include:\n• Healthcare: including medical devices and diagnostics\n• High-tech: including semiconductors, advanced \ncomputer hardware, battery technology, and electric \nvehicles\n• Media: including news organizations\n• Pharmaceuticals\n• Retail\n• Software companies: which were compromised in \nsupply chain operations potentially affecting large \nnumbers of victims\n• Telecoms\n• Travel services\n• Education \n• Video games: including development studios, \ndistributors/publishers, and activities enabling supply \nchain compromises\n• Virtual currencies: including in-game currencies, \ncryptocurrencies, and related services\nAPT41 has targeted organizations in 14 countries (and \nHong Kong) over seven years, including: France, India, \nItaly, Japan, Myanmar, the Netherlands, Singapore, South \nKorea, South Africa, Switzerland, Thailand, Turkey, the \nUnited Kingdom, and the United States (Figure 1). APT41 \nespionage operations against entities in these countries \nfollow targeting of verticals consistent with Chinese \nnational policy priorities.Targeting\nSPECIAL REPORT |  DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION        7\nFigure 1: \nCountries and \nindustries targeted \ndirectly by APT41.\nIndustries Targeted\nAutomotive Financial Pharmaceuticals\nBusiness Services Healthcare Retail\nCryptocurrency High-Tech Telecommunications\nEducation Intergovernmental Travel\nEnergy Media and Entertainment\n8       SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nOperations Over Time\nThe duality of APT41's state-sponsored activity and its own cyber crime \noperations is demonstrated in the group's simultaneous operations. Throughout \nthe group’s observable history, APT41 has consistently run its own financially \nmotivated campaigns concurrently with espionage operations. In contrast, \nAPT41 espionage targeting has changed significantly over time, suggesting \nshifts in assigned missions or new contracts to complete. A breakdown of \nindustries targeted by APT41 over time can be found in Figure 2.\n• We believe that like other Chinese espionage operators, APT41 has moved \ntoward strategic intelligence collection and establishing access, but away from \ndirect intellectual property theft. This shift, however, has not affected the group's \nconsistent interest in targeting the video game industry for financially motivated \nreasons.\n –We have not observed evidence of IP theft since late 2015.\n –In 2014, APT41 was observed carrying out espionage campaigns \nconcurrently with financially motivated intrusions, demonstrating that they \ncould balance different objectives simultaneously. \n• Espionage operations occurred while the group was still carrying out \nfinancially motivated campaigns, including longer-term intrusions, which \ntypically extended for more than a year. \n –In one instance, APT41 was attempting to steal data from a healthcare target \nwhile also attempting to deploy ransomware at a video game studio.\n• Compromising organizations in different sectors concurrently provides some \nindication that they are fulfilling specific assigned tasks. \n –Campaigns have expanded into additional industries including telecoms, \nthe automotive sector, higher education, and travel services.\n –In 2015, we observed a time period in which eight organizations in six \ndifferent industries were compromised simultaneously. \n• Since 2017, APT41's activities have included a series of supply chain \ncompromises. The operation injects malware into legitimate server software \npackages used by hundreds of companies worldwide but limits deployment \nof additional payloads to select targets.SPECIAL REPORT |  DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION        9\nHi-TechEducation\nTelecom\n Telecom\nFinance\nHealthcareTravel\nAutomotive\nTelecom\nVideo Game\nVideo Game\nRelated\nVideo Game\nRelated\nVideo Game\nRelated\n2012 2013 2014 2015 2016 2017 2018 2019\nVideo Game Video Game Video Game Video Game Video Game Retail\nHi-Tech Hi-Tech Hi-Tech Hi-Tech Hi-Tech\nIntergovernmental Media\n Media\n Media\nHealthcare\n Healthcare\nPharmaceutical\nHealthcare\nEnergy Software\n Software\nVideo Game\nRelated\nFigure 2:  Timeline \nof industries \ntargeted by APT41.\nINDUSTRIES TARGETED BY  APT 4110       SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nCyber Espionage Activity\nObserved APT41 targeting is consistent with China's \nnational strategies to move production capabilities \nupmarket into research and development (R&D)-heavy \nfields. These initiatives were especially highlighted with \n\"Made in China 2025,\" a plan announced in 2015 that aims \nto shift China's economy toward higher value products \nand services, including pharmaceuticals, semiconductors, \nand other high-tech industries. \n• We assess that the targeting of high-tech firms that \nproduce computer components aligns with Chinese \ninterests in domestically developing high-end \ntechnologies as outlined in the 12th (2011) and  13th \n(2016) Five-Year plans, as well as the Made in China  \n2025 (2015) initiative.\n –Since 2013, APT41 has targeted organizations involved \nin the research, development, and sale of computer \ncomponents used for machine-learning, autonomous \nvehicles, medical imaging, and the consumer market. \nThe group also targeted companies involved in \nproducing motherboards, processors, and server \nsolutions for enterprises.\n –In April 2013, the group targeted an enterprise \ncloud-computing provider. Developing domestic \ncloud-computing technologies was a goal in the 12th \nFive-Year Plan.\n –In a 2014 compromise, APT41 targeted a European \nconglomerate and specifically focused on systems \nphysically located in China.\n• The timing of multiple intrusions attributed to the group \nindicate a focused interest in strategic business decisions, \nincluding entry into the Chinese market, partnerships/\nM&A, and expansion into other regional markets. \n –In October 2017, an intrusion into a retailer targeted \nstrategic investment plans at the same time as the \nfirm was beginning to negotiate a partnership with a \nChinese company (although this potential deal was \nnot publicized). \n –In spring 2015, APT41 targeted information related \nto two entities undergoing a merger announced the \nprevious year. This included data related to a senior \nexecutive, as well as payroll and communications \nintegration issues. • Since 2017, APT41 has consistently targeted \ntelecommunications companies, possibly a crucial first \nstep to establish a foothold in targeting a particular region.\n –Targeted telecom companies spanned several \ncountries, and recently identified intrusions were \nconcentrated in countries where we had not identified \nany prior APT41 activity. \n –APT41 has targeted large telecom companies and \ntheir subsidiaries in various locations, demonstrating \nconsistent interest in obtaining access to these \ntargets. \n –The group has also repeatedly targeted call record \ninformation at telecom companies, supporting \nindications of their wider intelligence collection efforts.\nIn addition to specifically targeting industries of \nstrategic value, we suggest that APT41 is also given \nmore tactical assignments, including reconnaissance and \nidentifying dissidents.\n• A hotel was targeted two weeks ahead of a diplomatic \nvisit in which high-ranking Chinese officials stayed \nthere. Personal data within the reservations system was \ndirectly accessed, suggesting the group was potentially \ntasked to reconnoiter the facility.\n• We assess with moderate confidence that APT41 \ngathered intelligence on pro-democracy dissidents \nin Hong Kong based on the targets and timing of \noperations.\n –In July and August 2016, APT41 sent spear-phishing \nemails to Hong Kong media organizations known for \npro-democracy editorial content.\n –The timing and targeting of this activity suggests \npossible interest in the pro-democracy Umbrella \nMovement candidates who were running  for seats in \nHong Kong's legislative council. \n –A spear-phishing email with the subject-line \"help\" \nwas later sent to one of the previously targeted \norganizations in October 2017, coinciding with the \nsentencing  of pro-democracy Occupy activists. The \nruling placed a five-year ban on the activists from \nholding public offices in Hong Kong.SPECIAL REPORT |  DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION        11\n –This was the first instance we have observed of APT41 \ntargeting pro-democracy groups in Hong Kong. \nAPT41 frequently leverages timely news stories as the \nlure content in their spear-phishing emails, although \nsocial engineering content does not always correlate with \ntargeted users or organizations.• In 2015, APT41 targeted a Japanese media organization \nwith a lure document (Figure 3) titled “ 中東呼吸器症候\n群(MERS) の予防 ,” which translates to \"Prevention of \nMiddle East Respiratory Syndrome (MERS).\" The fear of \nrespiratory infections and a potential pandemic provide \nparticularly effective lure material against targets in the \nAsia-Pacific region that had first-hand experience with \nprior SARS and avian flu outbreaks.\nFigure 3:  \nMERS-themed lure document leveraging  for C&C (MD5: 5e87b09f9a3f1b728c9797560a38764b).\n12       SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nHealthcare Sector TargetingCASE STUDY\nAPT41 activity aimed at medical device companies \nand pharmaceuticals is demonstrative of the group's \ncapacity to collect sensitive and highly valuable \nintellectual property (IP), although we have not observed \nevidence of IP theft since late 2015. The healthcare \nsector was targeted in a manner that is highly specific \nand most likely indicative of focused taskings from \nsponsoring organizations with a stake in the healthcare \nmarket. Targeted information included pharmaceutical \ndevelopment, clinical trial data, and intelligence \nregarding a medical subsidiary's parent company.SPECIAL REPORT |  DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION        13\nThe targeting of these organizations just ahead of the \nrelease of products requiring a long R&D cycle can confer \na significant market advantage to a competitor. The \nobserved activities are indicative of ongoing efforts to \nsupport China's own R&D efforts in support of Made in \nChina 2025.\n• Between July 2014 and May 2016, APT41 targeted a \nmedical devices subsidiary of a large corporation. \n –Although APT41 initially targeted the parent company, \n30 percent of the victimized hosts were related to \na subsidiary specialized in manufacturing medical \ndevices. Password strings and spoofed domains \nleveraged in the operation signify a narrow tasking \nto target the subsidiary instead of the parent \ncorporation.\n –We have some indication based on the nature of hosts \ntargeted that APT41 was interested in information \ntechnology employees and software used by the \nmedical device subsidiary. –A keylogger dubbed GEARSHIFT was first deployed at \nthe medical device company. A digital certificate from \nthe victim was compromised and used to sign malware \nused in an operation against a separate biotech \ncompany detailed below. \n• A biotech company undergoing acquisition was \ntargeted by APT41 in May 2015. Highly sensitive \ninformation about corporate operations, including \nhuman resources data, tax information, and acquisition-\nrelated documents, were targeted.\n –Clinical trials data of developed drugs, academic data, \nand R&D funding-related documents were exfiltrated.\n –The time frame, use of the same GEARSHIFT sample, \nand a digital certificate from the aforementioned \nmedical device company provide some indication that \nthese two campaigns were conducted by the same \noperator concurrently.\n• In 2018, we observed APT41 target a third healthcare \ncompany, although their goals during this compromise \nwere unclear.\n14\nSPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nFinancially Motivated Activity\nUnlike other observed Chinese espionage operators, APT41 conducts explicit \nfinancially motivated activity, which has included the use of tools that are \notherwise exclusively used in campaigns supporting state interests. The late-\nnight to early morning activity of APT41's financially motivated operations \nsuggests that the group primarily conducts these activities outside of their \nnormal day jobs. However, the group compiled malware for use in cyber crime \nactivity even during espionage-focused working hours.\n• As demonstrated in Figure 4, operational times for APT41 espionage \noperations over all observed activity are relatively close to Chinese work hours \n(in UTC +8, China's time zone). \n• In contrast, the group's financially motivated activity targeting the video game \nindustry tends to occur much later in the night.\nOperational times at gaming targets are most frequent between 18:00 and \n07:00 (UTC +8), providing some indication that the group is moonlighting. Note \nthat this is based on data collected over years and does not represent a daily \nschedule.\n• The typical working hours in China for tech workers is a \"996\" work schedule  \n(9:00 a.m. to 9:00 p.m., six days a week), which is consistent with APT41's \noperational activity observed over time.\n• Operational times at targets not related to video games (and therefore, almost \ncertainly in support of state-sanctioned missions) are more frequent between \n14:00 and 22:00 (China Standard Time (CST), UTC +8), closer to conventional \nworking hours (Figure 4).\n• Analysis of compile times for all portable executable (PE) files suggests that  \nAPT41's average working hours fall between 10:00 to 23:00 (UTC +8), \nhighlighting that the financially motivated activity is most likely extraneous  \nto their espionage operations.\n• Compile times for samples used in suspected financial gain missions are skewed \ntoward later in the evening, roughly 19:00 to 00:00 (UTC +8). However, there \nis significant overlap with the compile times of PE files deployed at espionage \ntargets between 15:00 to 19:00 (UTC +8).SPECIAL REPORT |  DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION        15\n0 12 3 4 5 6 7 8 910 1112 13 14 15 16 17 18 1920 2122 23Figure 4:  \nOperational \nactivity for gaming \nversus non-\ngaming-related \ntargeting based \non observed \noperations since \n2012.\nThe group has also targeted cryptocurrencies, including at \nleast one case in which there was a connection between \ncryptocurrency and an online video gaming platform.\n• In June 2018, APT41 sent spear-phishing emails using an \ninvitation lure to join a decentralized gaming platform \nlinked to a cryptocurrency service (Figure 5) that had \npositioned itself as a medium of exchange for online \ngames and gambling sites. The malicious emails were \nsent from an email address listed with the name Tom Giardino, which is likely a reference to an employee at \nValve, an American video game developer responsible \nfor the software distribution platform Steam and \nvarious video games. The body of the email (Figure 6) \nalso mentions gaming offerings. This provides another \nconnection between the targeting of the cryptocurrency \norganizations and video game targeting.\n• In October 2018, the group compiled an instance \nof XMRig, a Monero cryptocurrency mining tool, \ndemonstrating a continued interest in cryptocurrency.Operational Times at \nGaming Targets\nOperational Times at \nNon-Gaming TargetsAPT41 Operational Times UTC +816       SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nFigure 5:  \nScreenshot of \ninvitation to join \nthe FairWin online \ngaming platform.\nFigure 6:  \nEnglish translation \nof invitation to join \nthe FairWin online \ngaming platform.\nFrom: Tom Giardino < >\nDate: <redacted>\nSubject: Project (FairWin) online application!\nProject Introduction:\nFairWin is a decentralized online gaming platform.\nBe sure to win fairness because our special FairChannel guarantees accurate RTP rates.\nThe system is based on a blockchain, which means that the gameplay process is open. The \npayment of the bonus is automatic. Not dependent on the organizer. In addition to this, we \nalso offer fun generous games with fascinating graphics. It can be run on any device and any \nbrowser so that all players can enjoy these experiences.\nPlease refer to the attachment for other details!\nSPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION        17\nVideo Game Industry Targeting\nAPT41 continuously returns to targeting the video game \nsector and seems to have matured its campaigns through \nlessons learned in operations against the industry. We \nbelieve these operations include broadly malicious \nactivity that can enable further operations, such as \ntargeting game source code and compromising digital \ncertificates, while other activities are explicitly financially \nmotivated, such as abusing in-game currency mechanics. \nAPT41 campaigns focused on the video game sector \nhave largely affected studios and distributors in East and \nSoutheast Asia, although global companies based in the \nUnited States have also been targeted.CASE STUDY18\nSPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nThe group leverages many TTPs during the targeting \nof video game-related organizations, which are likewise \nemployed in their espionage operations. \n• Since at least 2012, APT41 has repeatedly gained access \nto game development environments within affected \ncompanies, including online multiplayer networks, as \nwell as targeting of production database administrators. \n –The group is competent in both Linux and Windows \nenvironments and can pivot easily between \nboth environments within a single operation, \nincluding compromising intermediary servers that \nprovide access to separated Windows and Linux \nenvironments. \n –In October 2012, APT41 used captured credentials to \ncompromise a jump server and access a production \nenvironment where they deployed a Linux version of \nPHOTO. Based on the machines targeted, we have \nsome indication that APT41 specifically sought to \naccess production machines used in the development \nof an upcoming online game.\n –In 2014, APT41 used a variant of SOGU that is capable \nof connecting to Windows and Linux systems via SSH \nand Samba/CIFS. \n –APT41 has been observed inserting malicious code \ninto legitimate video game files to distribute malware. \nIn 2018, the group inserted CRACKSHOT malware into \ngame files that were signed with legitimate code-\nsigning certificates, most likely indicating access \nto the production environment, which facilitated a \nsupply chain compromise. \n §A highly similar incident in 2014 suggests that \nAPT41 (or a closely affiliated actor) has a history \nof carrying out such operations against the video \ngame industry. \n –APT41's experience gaining access to production \nenvironments may have been a precursor to more \nrecent supply chain compromises. The insertion of \nmalware into a build environment for later distribution \nwith legitimate software is a natural extension of \nthe group's earliest activities. Additional details are \nprovided in the section \"History of Supply Chain \nCompromises.\"• We have also observed APT41 limitedly deploy rootkits \non Linux systems and Master Boot Record (MBR) \nbootkits, such as ROCKBOOT, on Windows systems to \nhide their malware and maintain persistence on victim \nsystems. Selective deployment of ROCKBOOT suggests \nthat APT41 reserves more advanced TTPs and malware \nonly for high-value targets.\n –Bootkits are a stealthy means of installing malware \nbecause the code resides outside of the OS. Because \nbootkits are initialized prior to the OS and operate in \nkernel mode, OS applications and security tools may \nhave great difficulty detecting bootkits.\n –The use of bootkits among threat actors, however, \nis rare. It is more common for threat actors to rely \non techniques such as DLL search order hijacking \nor modifying Windows registry keys to achieve \npersistence. \n –The group used the Adore-NG rootkit on older Linux \noperating systems to hide their Linux backdoor \nADORE.XSEC. Note that the Adore-ng rootkit is \nno longer in development and would likely not run \nsuccessfully on modern Linux systems, but APT41 \ndeployed this on a legacy game server.\nAPT41 is well-known for leveraging compromised digital \ncertificates from video game studios to sign malware. The \ngroup has abused at least 19 different certificates in this \nway. Additional details on code-signing certificates are \nprovided in the section \" Use of Code Signing Certificates.\"\n• In 2012, APT41 used a code-signing certificate from \nMgame, a South Korean game publisher, against other \ngaming industry entities. The serial number for this \ncertificate was:\n01:00:00:00:00:01:30:73:85:f7:02\n19 SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\n4e:eb:08:05:55:f1:ab:f7:09:bb:a9:ca:e3:2f:13:cd\nFigure 7:  \nScreenshot of \nransomware note.\nATTENTION!\nThe files on your computer have been securely encrypted.\nTo get access to your files again, follow the instructions at:\nACHTUNG!\nDie Dateien auf Ihrem Computer wurden ischer verschluesselt.\nUm den Zugriff auf Ihre Dateien wiederzuerlangen, folgen Sie der Anleitung auf :• A different Mgame digital certificate has been used \nby several other Chinese operators, including APT17, \nAPT20, and APT31. It is unclear if this certificate \nwas compromised at the same time as the one used \nby APT41 (or if it was stolen by APT41 and shared \nwith these other groups). The serial number for this \ncertificate was: \nAPT41 has blatantly engaged in financially motivated \nactivity targeting the video game industry, including \nmanipulating virtual currencies. These activities \ndemonstrate established connections to underground \nmarketplaces and familiarity with monetization and \nlaundering techniques.\n• Using its access to a game production environment, in \nless than three hours the group generated tens of millions \nof dollars of a popular game's virtual currency. The \nmoney was credited to more than 1,000 accounts and \nmost likely sold and laundered in underground markets. \n• APT41 has targeted payment services specializing in \nhandling in-game transactions and real money transfer \n(RMT) purchases.\n• In a highly unusual case, APT41 attempted to extort \na game company by deploying the Encryptor RaaS ransomware. We suggest that APT41 sought to target \nin-game currency but found they could not monetize \nthe specific targeted game, so the group resorted to \nransomware to attempt to salvage their efforts and \nprofit from the compromise. \n –This ransomware was sold via a Ransomware-as-\na-Service (RaaS) operation that was available via a \nTor (.onion) website. Users of the ransomware were \ncharged a 20 percent fee for any collected ransom. \n –Since this was not the group's typical method \nof choice for collecting money from a victim \nenvironment, it is possible that APT41 turned to a pay-\nfor-service ransomware to avoid having to develop \nsuch a tool or set up the associated payment and \ninfrastructure associated with collecting the ransom.\n –APT41 attempted to deploy the ransomware through \na group policy (GPO) scheduled task. However, the \nmalware was unsuccessfully deployed because of a \nsimple typo. \n –Figure 7 shows the ransom note associated with \nEncryptor RaaS, which contains default messages in \nboth English and German (the instruction links have \nbeen redacted). Given that this is the default message, \nthe languages in the note should not be considered \nwhen determining actor origin or location.20       SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nThird-Party Access\nIn multiple instances, APT41 targeted third parties and leveraged this access to \ntarget additional victims. APT41's exploitation of third parties varied. In some \ninstances, APT41 moved laterally from one victim environment to another in \norder to initiate compromise. APT41 has also used credentials compromised in \nprevious operations.\n• In 2014, APT41 compromised an online billing/payment service using VPN \naccess between a third-party service provider and the targeted payment \nservice. The payment service was likely targeted because it provided access \nto multiple gaming companies.\n• Although we do not have first-hand evidence of APT41's compromise of \nTeamViewer, we have observed APT41 use compromised TeamViewer \ncredentials as an entry point at multiple organizations. \n –During a 2017 compromise, APT41 initiated a TeamViewer session and \ntransferred files that were later deleted. Filenames and creation times \nindicate that these may have been the HIGHNOON backdoor. \n –According to statements  by a TeamViewer's spokesperson, the company \nwas targeted in fall 2016. The company stated that they conducted a \ncomprehensive security audit of its IT architecture and added additional \nsecurity measures to help strengthen its security posture.SPECIAL REPORT |  DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION        21\nHistory of Supply Chain  \nCompromises\nSupply chain compromises are most likely an extension \nof APT41's tactics used in gaining access to gaming \ndevelopment environments and to other gaming \norganizations via third-party service providers. Public \nreports of supply chain compromises linked to APT41 date \nback to at least 2014, and technical evidence associated \nwith these incidents was used to determine a relationship, \nif any, with APT41. Our assessment in each of these cases \nis noted in Table 1.\n• As demonstrated in operations targeting the video \ngame industry, APT41 leverages a variety of TTPs to \naccess production environments where they can inject \nmalicious code into legitimate files. The files are signed \nwith valid code-signing certificates and distributed \nwidely to end users.\n• Supply chain targeting requires more effort than \ntypically observed mass targeting methods, such as \nestablishing a strategic web compromise (SWC) or \nconducting large spear-phishing campaigns.Although APT41 supply chain compromises affect very \nlarge numbers of victims, the group limits follow-on \nactivity to select victims most likely to reduce detection \nand ensure any additional malware is delivered only \nto intended victims. Counterintuitively, supply chain \noperations add an additional layer of obscurity to the \ngroup's operations because it is difficult to pinpoint the \ndesired target set. \n• In a June 2018 supply chain compromise, APT41 \nleveraged MAC addresses and C:\\ drive volume serial \nnumbers to identify specifically targeted victims for \nfollow-on activity. This significantly obfuscates the \ntargeted sector or victim set; in a typical spear-phishing \ncampaign, for example, desired targeting can be \ndiscerned based on recipients' email addresses. \nTable 1. Supply chain compromises.\nDate Compromised Entities FireEye Attribution Assessment\nDecember 2014Online games distributed by a Southeast  \nAsian video game distributor\n• Path of Exile\n• League of Legends\n• FIFA Online 3Possibly APT41 or a close affiliate\nMarch 2017 CCleaner Utility Unconfirmed APT41\nJuly 2017 Netsarang software packages (aka ShadowPad) Confirmed APT41\nJune 2018 - November 2018 ASUS Live Update utility (aka ShadowHammer)Stage 1 unconfirmed APT41  \nReported Stage 2 confirmed APT41\nJuly 2018Southeast Asian video game distributor\nInfestation \nPointBlank Confirmed APT41\n22       SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nDecember 2014\nIn December 2014, installers for three online games \npublished by a Southeast Asian video game distributor \nwere injected with the SOGU backdoor. The installer for \nthese popular games was replaced by a malicious file \nthat dropped the SOGU backdoor along with the normal \ngame installer.\n• The video game distributor operates servers in East \nand Southeast Asia for some of the most popular \nonline games, including the three games that were \ncompromised: Path of Exile, League of Legends, and \nFIFA Online 3 (Table 2).\nWe have observed many similarities between TTPs \ninvolved in this compromise and APT41, including:\n• Targeting the same victim organization 31 days apart\n• Use of code-signing certificates from the same video \ngame-related issuer organizations\nTable 2. 2014 compromised games.\nGame File MD5 Malware C&C• Use of the same malware families (HIGHNOON.BIN, \nHIGHNOON.LITE, EASYNIGHT, FRONTWHEEL)\n• Use of HIGHNOON.BIN samples with the same  \ncompile times\n• Overlap in domain resolution to the same IP netblock \n(61.38.186.0/24) during the same time frame in 2012 \n• Video game-related supply chain targeting\nDespite these compelling overlaps, the actors responsible \nfor this compromise leverage additional unique tools not \nobserved with APT41 or any other Chinese espionage \ngroup, suggesting that they are either part of APT41 and \nmaintain their own toolset, or a close affiliate of APT41 that \nshares both tools and taskings.\nSPECIAL REPORT |  DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION        23\nIn March 2017, suspected Chinese espionage operators \ntargeted CCleaner, a utility that assists in the removal of \nunwanted files from a computer. According to  the parent \ncompany, Avast, the infected CCleaner was downloaded \nby 2.27 million customers. While we have identified some \noverlaps between the CCleaner activity and APT41, we do \nnot have enough information to attribute the CCleaner \ncompromise to APT41 at this time.\n• Both APT41 and the actors in the CCleaner incident \nused TeamViewer during initial compromise. According \nto Avast, the actors used TeamViewer to compromise a \ndeveloper workstation and used VBScript (x64.vbs) to \ndrop a malicious payload. \n• The compromised CCleaner update (which we call \nDIRTCLEANER) is believed to download a second-stage \nloader (MD5: 748aa5fcfa2af451c76039faf6a8684d) that \ncontains a 32-bit and 64-bit COLDJAVA DLL payload. \nThe COLDJAVA payload contains shellcode that loads a \nvariant of BLACKCOFFEE (Figure 8).\n –While COLDJAVA has been used by APT41, \nBLACKCOFFEE has been used by other Chinese \ncyber espionage groups, including APT17  and APT40. \nIt is possible that COLDJAVA may also be shared \nbetween distinct cyber espionage operators.\n• Malware samples identified in the CCleaner incident \nincluded notable shared design decisions observed in \nAPT41 malware, including the use of domain generation \nTable 3. BLACKCOFFEE DDR websites.\nFile MD5 Legitimate DDR Websites Used for C&C\n3ca2a13f646690481 \ndc15d78bac6d829 \n Figure 8:  Malware \ndownloaded by \nDIRTCLEANER.\nDIRTCLEANER COLDJAVA BLACKCOFFEEalgorithms (DGA) for C&C, use of dead drop resolvers \n(DDR ), and use of shellcode as primary payloads. \nHowever, FireEye malware analysis of the compromised \nCCleaner samples and associated COLDJAVA samples \ndid not reveal shared code with the POISONPLUG and \nPOISONPLUG.SHADOW malware samples used in \nsimilar supply chain incidents by APT41.\n –DIRTCLEANER uses DGA to generate new C&C \ndomains each month. This is similar to first-stage \nmalware used in the Netsarang compromise described \nbelow. \n –The BLACKCOFFEE sample reaches out to actor-\ncontrolled profiles hosted on legitimate websites to \nretrieve encoded commands for C&C, a technique \nknown as DDR. The malware parses the content of \nthe websites (listed in Table 3), looking for 12 bytes \ncontained between the tags: \"BSM1cr0S0ft\" and \n\"SBM1cr0Soft.\" APT41 POISONPLUG samples have \nalso used DDR for C&C.\n –The POISONPLUG and POISONPLUG.SHADOW \nsamples in similar supply chain incidents use a \nshellcode format that resembles PE files, while the \nBLACKCOFFEE backdoor that was delivered in the \nCCleaner compromise uses a traditional PIC blob. \nAdditionally, there is apparent code reuse between \nobserved POISONPLUG and POISONPLUG samples \nnot observed in the CCleaner samples.March 2017\n24       SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nIn July 2017, APT41 injected malicious code into a software \nupdate package maintained by Netsarang and signed it \nwith a legitimate Netsarang certificate in an operation \nreferred to as \"ShadowPad\"  by Kaspersky. The software \npackage is reportedly used by hundreds of companies \nworldwide. \n• We observed numerous opportunistic infections \nassociated with POISONPLUG.SHADOW spanning 13 \ncountries and a variety of industries, demonstrating the \nbroad impact of this operation. However, we have not \nobserved the associated second-stage at any victim \norganizations. Open-source reporting indicated one \nvictim was identified in Hong Kong. \n• Signing the malicious update with a legitimate \nNetSarang certificate is consistent with APT41's pattern \nof using legitimate certificates. In this case, all updates \nwere required to be signed by Netsarang, which means \nAPT41 had to use the code-signing certificate to subvert \nthe update mechanism. –Alternatively, it is also possible that APT41 injected \nmalicious code into the package prior to compilation, \ncircumventing the need to steal the code-signing \ncertificate and compile it on their own. \n• The first stage of the malware uses DGA, which changes \nits C&C servers monthly. The use of shifting network \ninfrastructure is most likely intended to add operational \nrobustness and to reduce detection.\n• The second-stage shellcode is initialized only after it \nis activated using a decryption key retrieved from the \nfirst-stage DNS communications. This likely allows \nAPT41 to selectively activate the payload on specific \nvictim systems. The second-stage payload contains the \ndefault C&C server, notped.com, which overlaps with \nother APT41 C&C infrastructure. Other reported APT41 \ndomains that may also be related to the second-stage \npayload can be found in Table 4.\nTable 4. Reported APT41 domains associated with POISONPLUG.SHADOW.\nDomain Associated Malware FamilyJuly 2017\nSPECIAL REPORT |  DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION        25\nIn June 2018, a utility used to update ASUS \ncomputers was compromised in an operation dubbed \n\"ShadowHammer\"  by Kaspersky. Open-source \nreporting  indicated  that more than 50,000 systems \ninstalled the malicious update, yet the malware was \nonly designed to execute and retrieve second-stage \nmalware on a designated list of approximately 600 \nsystems, demonstrating this was a targeted campaign. \nPublic reporting  on the incident noted that many of the \ntargeted MAC addresses were associated with wireless \nadapters from various vendors, partially indicating the \noperation's targeting strategy.\n• Although we have limited visibility into the intended \ntargets of this operation, we observed one of the \nwhitelisted MAC addresses on a system at a telecom \ncompany.\n• Kaspersky's analysis of the infected machines revealed \nthat a POISONPLUG backdoor was installed as a result \nof the malicious update. While we have been unable to \nattribute the DAYJOB malware used in the incident to \nAPT41 due to an inability to independently confirm this sequence of events, we confirm the reported stage-\ntwo POISONPLUG backdoor is attributed to APT41, \ncontained several gaming references, and was likely \nused to target the gaming industry. \n• The POISONPLUG sample (MD5: \n37e100dd8b2ad8b301b130c2bca3f1ea) attempts to \nconnect to a Google document that was created under \nthe same name and email address (Tom Giardino and \n) that was used to target the \ncryptocurrency organization. It also attempts to connect \nto a Steam community page (Table 5). \n• The POISONPLUG payload uses DDR and parses the \nGoogle document for a C&C command. The Steam \ncommunity page is likely used as a fallback mechanism. \n• FireEye malware analysis of the POISONPLUG sample \nindicates the malware is likely designed to run only \none system with a C: drive volume serial number of \n0xc25cff4c.\n• Additional POISONPLUG samples located in Table 6 also \nleverage Google Document and Steam Community Pages \nfor C&C.\nTable 5. \"ShadowHammer\" stage-two POISONPLUG sample.\nFile MD5 C&C Domain\n37e100dd8b2ad8b301b130c2bca3f1ea\nTable 6. POISONPLUG samples leveraging dead drop resolving.\nFile MD5 C&C Domain\n557ff68798c71652db8a85596a4bab72\nff8d92dfbcda572ef97c142017eec658\nb0877494d36fab1f9f4219c3defbfb19\nffd0f34739c1568797891b9961111464June 2018\n26       SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nBeginning in July 2018, APT41 appeared to have directly \ntargeted several East and Southeast Asia-based video \ngame developers and distributors to inject legitimate \nexecutables with the CRACKSHOT backdoor.\n• Like other high-profile supply chain compromises \nattributed to APT41, these incidents included the \nincorporation of malicious code into legitimate \nexecutables and the signing of these files using \nlegitimate digital certificates from the same \ncompromised organization.• APT41 used a C&C domain that masquerades as \nXigncode, , in the \ncompromise of the video game PointBlank. Ironically, \nXigncode is a service intended to prevent hacking and \ncheating in online games. \n• We attribute these compromises (also reported by both \nESET  and Kaspersky ) to APT41 based on the unique \nuse of the CRACKSHOT backdoor and tactics consistent \nwith APT41 operations. A list of related indicators is in \nTable 7.\nTable 7. Video games industry targeting in July 2018.\nTargeted Game / Platform MD5 Hashes Malware C&C Domain\nSoutheast Asian video game platform 04fb0ccf3ef309b1cd587f609ab0e81e CRACKSHOT\nInfestation game fcfab508663d9ce519b51f767e902806 CRACKSHOT\nPointBlank game0b2e07205245697a749e422238f9f785\n272537bbd2a8e2a2c3938dc31f0d2461\ndd792f9185860e1464b4346254b2101bCRACKSHOTJuly 2018\nSPECIAL REPORT |  DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION        27\nOverlaps Between Espionage  \nand Financial Operations\nIdentified overlaps across various incidents attributed \nto APT41 demonstrate the group's dual nature. Figure \n9 and Figure 10 illustrate crossover between espionage \nand financially motivated activity, as well as technical \nsimilarities in tools used across both types of operations.\n• The email address  was used to \nsend spear-phishing emails to a Taiwanese newspaper \nwith the subject lure \"I have a little surprise for you :)\" in \nan espionage campaign in August 2016 (Figure 9). \n• The same email address was later used to target a \ncryptocurrency exchange in June 2018, demonstrating \nemail reuse between espionage operations and \nfinancially motivated activity.  –The lure used to target the cryptocurrency exchange \n(displayed in Figure 5 and translated in Figure 6) \nreferenced an online gaming platform, tying the \ncryptocurrency targeting to APT41's focus on video \ngame-related targeting.\n –As depicted in Figure 10, hrsimon59@gmail.\ncom was used to create a Google document \nbeing used as a POISONPLUG (MD5: \n37e100dd8b2ad8b301b130c2bca3f1ea) C&C. As \npreviously mentioned, this sample also connected \nto a Steam page. \nFigure 9:  \nEmail overlaps \nbetween \nespionage and \nfinancial activity.\nCyber Espionage\nPhishing email to Taiwanese newspaper \nSubject: I have a little surprise for you :)\nATTACHMENT\nDocuments.7z\n8c6cceae2eea92deb6f7632f949293f0Probable Financial Motivation\nPhishing email to European  \nbitcoin exchange  \n Subject: 项目 (FairWin) 上线申请 !\nInvitation to join a decentralized \ngambling platform\nATTACHMENT\nFairWin.chm\n223e4cc4cf5ce049f300671697a17a01JUNE 2018 AUGUST 201628\nSPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\n  SHARED CODEFigure 10:  \nMalware \noverlaps across \nsupply chain \ncompromises.\n1\nTelecom\nVictim\nStage 2\nshellcode loader\n72584d6b7dd10c82d9118567b548b2b1\nC&C C&C\nSTAGE 2\nactivated atIdentified at\n1\nunknown \nvictim in \nHong KongStage 1\nshellcode loader\na6c7db170bc7a4ee2cdb192247b59cd6POISONPLUG\nStage 1 Loader\n830a09ff05eac9a5f42897ba5176a36aASUS SUPPLY CHAIN\n(AKA “SHADOWHAMMER”)\nNETSARANG SUPPLY CHAIN\n(AKA “SHADOWPAD”)COMPROMISE OF A  \nU.S. COMPANY\n \n \n \nPOISONPLUG\n37e100dd8b2ad8b301b130c2bca3f1eaPOISONPLUG.SHADOW\nTrojanized Sotware Package\n(DLL Loader)\n97363d50a279492fda14cbab53429e75\n100s\nof victims\nCompromise of a  \nU.S. Video Game CompanyJULY 2017 MAY 2016DAYJOB\nTrojanized ASUS Update Utility\n0f49621b06f2cdaac8850c6e9581a594\n>50K\nvictimsJUNE–NOV 2018\nConfirmed ConnectionSpeculated Connection\nUnconfirmed\nConfirmed\nVideo Game Related\nGoogle Document AuthorSPECIAL REPORT |  DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION        29\n• FireEye malware analysis identified source code overlaps \nbetween malware used by APT41 in May 2016 targeting \nof a U.S.-based game development studio and the \nmalware observed in supply chain compromises in 2017 \nand 2018. \n –In May 2016, APT41 deployed a POISONPLUG \nsample at a U.S.-based game development studio. \nThe stage-one loader for this sample (MD5: \n830a09ff05eac9a5f42897ba5176a36a) shares code \noverlaps with the stage-one shellcode loader (MD5: \na6c7db170bc7a4ee2cdb192247b59cd6) used in the \nNetsarang compromise, first reported by Kaspersky \nas ShadowPad. These connections, illustrated in \nFigure 10, led us to identify the malware used in the \nNetsarang incident as a variant of POISONPLUG \n(therefore: POISONPLUG.SHADOW).\n –The POISONPLUG and POISONPLUG.SHADOW \nvariants share the observed commonalities:\n§ The entrypoint functions for both loaders use the \nsame instructions, constants, and structures to pass \ncontrol to loading routines. \n§ The layout of functions and data within the \nloaders are the same; for example, following the \nentrypoint, both loaders contain an unusual region \nof structured data 0x60 bytes long. § Both loaders use the same API hashing algorithm \nto resolve routines from system libraries (Figure \n11 and Figure 12). The routine uses byte-wise \noperations to compute a hash, including byte-wise \nrotate-right by eight bits, byte-wise binary, OR \nwith 0x20, and byte-wise XOR using the four-byte \nkey 0x7C35D9A3. Using this routine, the hash for \nkernel32.dll, a common DLL provided by Microsoft \nWindows, is 0xFD5B1261.\n• FireEye analysis of a separate POISONPLUG payload \n(MD5: c8403fabda4d036a55d0353520e765c9) \ncompiled in July 2017 and the POISONPLUG.\nSHADOW stage-two shellcode loader (MD5: \n72584d6b7dd10c82d9118567b548b2b1) identified \nmultiple additional plug-in similarities.\n –Core plug-in IDs between the samples are the same, \nincluding 100, 101, 102, 103, 104, and 201.\n –Core plug-in names are the same including Plugins, \nOnline, Config, Install, and HTTP.\n –C&C plug-in IDs and names between both samples \nare the same, including 200/TCP, 201/HTTP, 202/UDP, \n203/DNS, 204/HTTPS, and 205/SSL.\n –Both samples parse the C&C response by searching \nfor \"$\" characters and decoding the result.\nFigure 11:  \nPOISONPLUG  \nAPI hashing (MD5: \n830a09ff05eac9a5 \nf42897ba5176a36a).seg000:00010246 movzx edi, byte ptr [eax]\nseg000:00010249 ror esi, 8\nseg000:0001024C or edi, 20h\nseg000:0001024F add esi, edi\nseg000:00010251 add eax, 2\nseg000:00010254 xor esi, 7C35D9A3H\nseg000:0001025A cmp [eax], dx\nseg000:0001025D jnz short loc_10246\nseg000:0001025F cmp esi, 0FD5B1261h\nFigure 12:  \nPOISONPLUG.\nSHADOW API \nhashing (MD5: \na6c7db170bc7a4 \nee2cdb192247b5 \n9cd6).\ng000:0000F55C 0F B6 0E movzx ecx, byte ptr [esi]\ng000:0000F55F  8B 45 F4 mov eax, [ebp- 0Ch]\ng000:0000F562  C1 C8 08 ror eax, 8\ng000:0000F565  83 C9 20 or ecx, 20h\ng000:0000F568  03 C1 add eax, ecx\ng000:0000F56A  35 A3 D9 35 7C xor eax, 7C35D9A3H\ng000:0000F56F  83 C6 02 add esi, 2\ng000:0000F572  89 45 F4 mov [ebp-0Ch], eax\ng000:0000F575  66 39 3E cmp [esi], di\ng000:0000F578  75 DD jnz short loc_F557\ng000:0000F57A  3D 61 12 5B FD cmp eax, 0FD5B1261h30       SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nAttribution\nWe assess with high confidence that APT41 is attributable \nto Chinese individuals who are working on behalf of the \nChinese state in conducting cyber espionage operations, \nand that these actors are also running financially \nmotivated campaigns for personal gain. \nTwo identified personas using the monikers \"Zhang \nXuguang\" and \"Wolfzhi\" linked to APT41's operations \nhave also been identified in Chinese-language forums. \nAttribution to these individuals is backed by identified \npersona information, the previous work of these \nindividuals, their apparent expertise in programming skills, \nand their targeting of Chinese market-specific games. \nIt is uncertain how many other individuals may also be \nassociated with APT41.\n• Multiple domains leveraged by early APT41 activity \nwere registered by emails and names associated with \nboth Zhang Xuguang and Wolfzhi (or their alternative \nmonikers). Registrant information also included \nreferences to Beijing and Chinese phone numbers (+86 \ncountry code).\nZhang Xuguang ( 张旭光 ) registered more than a dozen \ndomains masquerading as video games or companies \nwith trusted relationships with video game developers/\ndistributors. Long-running activity provides a catalog of \nZhang's efforts to improve his skills and expertise over time.\n• Additional names include: kbkxlp, akbkxlp, injuriesa, \nravinder10, Addison Lau, and addison jack\n• Associated email addresses: \n –  \n –  \n –  \n –  \n –  \n –  \n –   –  \n –  \n –  \n –  \n –\n• Examples of domains registered to known aliases (some \nof these may have since been re-registered legitimately):\n –\n \n \n \n \n \n \n \n \n \n –\n \nIn 2005, Zhang posted personal information on “ 华夏黑\n客同盟 ” (Chinese Hackers Alliance), a popular Chinese \nonline forum, that listed his date of birth as 1989, that he \npreviously lived in Inner Mongolia, and that he specialized \nin script hacking (Figure 13). Zhang's profile indicated \nhe was 16, going on 17, and he was applying to be the \nadministrator of a script hacking forum.\n• Spoofed domains most likely targeted players of games \nsuch as \"Age of Wuxia,\" a massively multiplayer online \nrole-playing game (MMORPG) themed on cultural \nreferences to dynastic China. Zhang Xugang's interest \nin these games is also apparent in his registration and \nposting on a forum dedicated to the Age of Wuxia \n(Figure 14).SPECIAL REPORT |  DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION        31\nFigure 13:  \nScreenshot of \nZhang's profile, \nwith \"Zhang \nXuguang\" \nhighlighted in \norange.\nFigure 14:  \nZhang posting \nto Age of Wuxia \nforum, with his \nalias \"injuriesa\" \nhighlighted in \nyellow.\n32       SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nWolfzhi is linked to a 2017 profile on a data science \ncommunity page, which indicated that he had 10 years \nworking experience at the time of the posting, with \nsignificant experience in Oracle and Python. Other \ndocuments linked to his email accounts also highlight his \nprogramming skills and database experience.\n• Additional aliases include: wolf_zhi, wolfjiao, jiaozhiq, \nand jiaozhiqiang• Examples of domains registered under the wolf_zhi alias: \n –  \n –\n –\n• Posts in a forum provide some indication he is from \nBeijing or Hebei, the surrounding Chinese province. This \nis also consistent with information found in early domain \nregistrations created by Wolfzhi (Figure 15). \nFigure 15:  \nDomain \nregistration by \nWolfzhi.\nAdditional indicators of Chinese attribution include: the \nreliance on malware used exclusively by Chinese espionage \noperators, the use of Chinese-language strings, time zone \nand operational time analysis, and targeting consistent \nwith Beijing's interests.\n• The use of tools leveraged only by several other \nChinese operators such as HOMEUNIX and HIGHNOON \nprovides some indication that APT41 relies on the similar \nresources and support as these other Chinese groups. \nAPT41 also leverages PHOTO (aka \"Derusbi\") and SOGU \n(aka \"Destroy RAT\" and \"PlugX\"), tools shared much \nmore widely among Chinese espionage groups. See the \nsection \"Links to Other Known Chinese Operators\"  for \nmore details.\n• An APT41 HIGHNOON sample (MD5: \n36711896cfeb67f599305b590f195aec) from 2012 \ncontained a process debugging path (.pdb) with the \nChinese-language directory \"D:\\ 桌面\\木马,\" which \ntranslates to \"D:\\Desktop\\trojan.\"• Compiled HTML (.chm) files used in targeting contained \na language code set to \"Chinese (Simplified)\" despite \nthe lure content being in the target region's language \n(English or otherwise).\n• Compile and operational times of APT41 activity \nsuggest the bulk of the group's work hours, 10:00 \nand 23:00 (UTC +8), are consistent with the Chinese \nworkday, especially for tech sector employees on a \"996 \nschedule.\" \n –Figure 4 shows a breakdown of all of the operational \nactivity within victim environments, separated \nbetween gaming and espionage (non-gaming) \nactivity. Analysis of the times where APT41 modified \nor accessed a file within a victim environment, shows \na concentration between 10:00 and 18:00 (UTC+8).\n• Targeting of healthcare, semiconductors, and telecoms \nis consistent with Chinese state interests and parallels \nactivity from other Chinese espionage groups.Domain: \nRegistrant\n Wolfzhi\n Wolfzhi ( )\n beijingxxxdaxia\n beijing\n beijing, 100000\n US\n Tel. +86.2011111111\nCreation Date:  2011-08-23  15:23:29\nExpiration Date:  2011-08-23  15:23:29SPECIAL REPORT |  DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION        33\nFigure 16:  \nOcean injection \ntool posted by \nZhang.\nStatus as Potential Contractors\nWe assess with moderate confidence that APT41 is \nconstituted of contractors tasked by the Chinese state \nto conduct espionage operations. Individuals attributed \nto the group have previously indicated that they \ncould be hired and advertised their skills and services. \nAPT41's use of the same malware in both financial- and \nespionage-related operations could support their status \nas contractors; state employees are less likely to use such \ntools for personal financial gain over multiple years given \nthe potential for greater scrutiny or punishment.\n• APT41 cyber crime activity includes the use of \nespionage-only malware, indicating two possible \nconclusions: either APT41 is operating outside of \nstate control but still working with other Chinese APT \nmalware actors, tools, and infrastructure on a part-\ntime or contractual basis, or APT41 is a full-time, state-\nsponsored APT actor but is also working outside of \nstate control or direction for supplemental income.\n –Tools used by APT41 in financially motivated \noperations include the use of HOMEUNIX and PHOTO, \nwhich are non-public malware used only by other \nChinese espionage actors.\n –A loose time separation between espionage and \ncyber crime activities provides some indication that \nthe group divides its work hours between both types \nof operations. For additional details, see Figure 4 and \nthe previous section \"Financially Motivated Activity.\"• Public reports  on Chinese hackers highlight that skilled \nactors opt to work for private sector entities that have \ngovernment contracts because of better pay.\n• Underground activity dating back to 2009 indicated \nthat Zhang Xuguang is a hacker for hire. Zhang \nadvertised on forums that he was available for \nprofessional penetration and hacking services. \n –Zhang listed his online hours from 4:00 p.m. – 6:00 \na.m., which are similar to the operational times \nobserved at gaming targets displayed in Figure 4.\n• He was also observed sharing an injection tool named \nOcean hysi ( 海洋hysi 注入工具 ) to demonstrate his skills, \nas displayed in Figure 16.\nChina has previously relied on contractors to bolster state \nresources dedicated to cyber espionage activity. Increased \nintegration between government units and civilian entities, \nincluding contractors and freelancers, is believed to be a \nkey feature of Chinese cyber policy.  \n• According to indictments unsealed by the U.S. \nDepartment of Justice (USDOJ) in December 2018, \nAPT10 was operated by contractors working for the \nChina's Ministry of State Security (MSS).\n• In a USDOJ indictment unsealed in November 2017, \nindividual contractors responsible for APT3 were found \nto be working for an MSS front company. \n34       SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nLinks to Other Known Chinese \nEspionage Operators\nAPT41 uses many of the same tools and compromised \ndigital certificates that have been leveraged by other \nChinese espionage operators. Initial reports about \nHIGHNOON and its variants (reported publicly as \n\"Winnti\") dating back to at least 2013 indicated the \ntool was exclusive to a single group, contributing to \nsignificant conflation across multiple distinct espionage \noperations.• APT41 overlaps at least partially with public reporting \non groups including BARIUM (Microsoft)  and Winnti \n(Kaspersky , ESET , Clearsky ). In some cases, the \nprimary observed similarity in the publicly reported \nWinnti activity was the use of the same malware—\nincluding HIGHNOON—across otherwise separate \nclusters of activity.\n• Previous FireEye Threat Intelligence reporting on the \nuse of HIGHNOON and related activity was grouped \ntogether under both GREF and Mana, although we \nnow understand this to be the work of several Chinese \ncyber espionage groups that share tools and digital \ncertificates.\n• APT41 reflects our current understanding of what was \npreviously reported as GREF, as well as additional \nindicators and activity gathered during our extensive \nreview of our intelligence holdings. 35\nSPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nCertificate Overlap\nA digital certificate issued by YNK \nJapan that was publicly reported \nas being used by Winnti has been \nused by multiple Chinese espionage \noperators, including APT17, and \nAPT20, and APT41.Issuer: CN=VeriSign Class 3 Code Signing 2009-2 CA\nSubject: CN=YNK JAPAN Inc \nSerial Number: 67:24:34:0d:db:c7:25:2f:7f:b7:14:b8:12:a5:c0:4d\nIssue-Date: 11/27/09 , Expiration-Date: 11/27/11\nIssuer: CN=Microsoft Certificate Authority \nSubject: CN=Microsoft Certificate Authority \nSerial Number: (Negative)77:62:e5:c6:c9:c2:75:59:b0:b8:f5:56:60:61:d8:78 \nIssue-Date: 12/31/2009, Expiration-Date: 12/30/2035A self-signed digital certificate \npurporting to be from the Microsoft \nCertificate Authority has been used \nby both APT41 and APT40 to sign \nsamples of the PHOTO backdoor.\nThe overlaps in groups observed using \nthese certificates is illustrated in  \nTable 8.\nTable 8. Example of shared certificates between APT groups.\nSerial Number Subject APT17 APT20 APT40 APT41\n67:24:34:0d:db:c7:25:2f:7f:b7:14:b8:12:a5:c0:4d YNK JAPAN Inc X X X\n(Negative)77:62:e5:c6:c9:c2:75:59:b0:b8:f5:56:60:61:d8:78 Microsoft Certificate Authority X X36       SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nLauncher Overlap\nCode Family OverlapThe use of DLL side-loading has been a source of \ncontinued confusion when used as an indicator for distinct \noperations. This technique  uses a legitimate and often \ndigitally signed executable to essentially trick a system \ninto launching a malicious DLL because it has been given \nthe same name as a legitimate DLL normally loaded by \nthe executable. The use of a valid and digitally signed \nA significant number of non-public tools used by \nAPT41 are shared with other distinct Chinese espionage \noperators. Source code overlaps between observed \ncode families indicate potential access to shared code \nrepositories or common developers between groups.\n• APT41 has used several malware families that have \nalso been used by other Chinese espionage operators, \nincluding variants of HIGHNOON, HOMEUNIX, PHOTO, \nSOGU, and ZXSHELL, among others. Table 10 illustrates \nsome of overlap between malware families used by \nAPT41 and other APT groups. Note that this is only for \nillustration purposes and is not indicative of all observed \nmalware families used by these APT groups or all groups \nthat have used those families. executable allows actors to bypass host-based security \nmeasures. For this reason, it continues to be popular \nmechanism used by multiple groups. This also explains \nwhy the use of these DLL filenames is not a unique \nindicator for distinct APT operators. Table 9 contains \nlegitimate executables used by APT41 and selected other \nChinese cyber espionage groups for DLL side-loading:\nTable 9.  Legitimate files used by different APT groups for DLL side-loading.\nFile MD5 Hash Filename APT9 APT10 APT20 APT41\n09b8b54f78a10c435cd319070aa13c28 nvSmartEx.exe X X X X\n26a196afc8e6aff6fc6c46734bf228cb form.exe X X\n –HIGHNOON, one of the main code families observed \nbeing used by APT41, was also used by APT17 in 2015 \nto target semiconductor and chemical manufacturers. \n –HOMEUNIX, another popular backdoor used by \nAPT41, has been used by at least 14 separate Chinese \nespionage groups, including APT1, APT10, APT17, \nAPT18, and APT20. \n –JUMPALL is a dropper that has been observed \ndropping variants of the HIGHNOON, ZXSHELL, and \nSOGU code families attributed to APT17 and APT41.SPECIAL REPORT |  DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION        37\nTable 11.  CLASSFON sample with internal name \"DrvDll.dll\" and contains reference to \"PlusDll.dll\".\nFile MD5 Hash Malware Internal Filename Device Driver Name\n9e1a54d3dc889a7f0e56753c0486fd0f CLASSFON DrvDll.dll PlusDll.dll\nTable 12.  APT41 HIGHNOON.BIN samples that reference \"PlusDll.Dll\".\nFile MD5 Hash Malware Process Debugging Path\n36711896cfeb67f599305b590f195aec HIGHNOON.BIN D:\\桌面\\木马\\Anti_winmm\\AppInit\\AppInit\\Release\\AppInit.pdb\na0a96138b57ee24eed31b652ddf60d4e HIGHNOON.BIN H:\\RBDoor\\Anti_winmm\\AppInit\\AppInit\\Release\\AppInit.pdbTable 10.  Code family overlap among different Chinese espionage groups.\nMalware APT1 APT3 APT10 APT17 APT18 APT19 APT40 APT41\nBLACKCOFFEE X X X\nCHINACHOP X X X\nCOLDJAVA X\nHIGHNOON X X\nHIGHNOON.BIN X X\nHIGHNOON.LITE X\nHOMEUNIX X X X X X\nJUMPALL X X\nPHOTO X X X X X\nSOGU X X X X X X\nZXSHELL X X X X\n• APT41 has not only shared the same tools with other \nChinese espionage operators but also appears to have \naccess to shared source code or developers as well. \n –APT41 has used CROSSWALK.BIN, a kernel driver, \nto circumvent firewalls and covertly send data. \nAnother Chinese espionage group used a similar \ntool, CLASSFON, to covertly proxy network \ncommunications in 2011. \n §CLASSFON (MD5: \n9e1a54d3dc889a7f0e56753c0486fd0f) has an \ninternal name of DrvDll.dll and an embedded device \ndriver that is internally named PlusDll.dll (Table 11). \nThe PlusDll.dll filename has also been identified in \nAPT41 HIGHNOON.BIN samples (Table 12). –PDB paths identified in related APT41 HIGHNOON.\nBIN samples contain the name \"RBDoor,\" which \nhas also been identified in samples of HIGHNOON, \nHIGHNOON.LITE, HIGHNOON.CLI, and GEARSHIFT \n(Figure 17). APT41 files containing PDB paths \nreferencing \"RBDoor\" are listed in Table 13. At least \ntwo of these malware families, HIGHNOON.CLI and \nGEARSHIFT, have been used by APT17 and another \nsuspected Chinese espionage group.\n• Further information regarding code family overlaps \nbetween variants can be found in \"Technical Annex: \nAdditional Malware Overlaps.\"38       SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nFigure 17:  \nPDB paths \ncontaining \n\"RBDoor\".\nH:\\Double-V1\\stone_srv\\Bin\\RbDoor64.pdb\nH:\\Double\\Door_wh\\AppInit\\x64\\Release\\AppInit.pdb\nH:\\Double\\Door_wh\\RbDoorX64\\x64\\Release\\RbDoorX64.pdb\nH:\\Double\\door_wh_kav\\Bin\\RbDoor64.pdb\nH:\\RBDoor\\Anti_winmm\\AppInit\\AppInit\\Release\\AppInit.pdb\nH:\\RBDoor\\Anti_winmm\\AppInit\\AppInit\\x64\\Release\\AppInit.pdb\nH:\\RBDoor\\Anti_winmm\\AppInit\\ShutDownEvent\\x64\\Release\\ShutDownEvent.pdb\nH:\\RbDoor\\Anti_winmm\\AppInit\\AppInit\\Release\\AppInit.pdb\nH:\\RbDoor\\Anti_winmm\\AppInit\\RbDoorX64\\Release\\RbDoor.pdb\nH:\\RbDoor\\Anti_winmm\\AppInit\\ShutDownEvent\\Release\\ShutDownEvent.pdb\nH:\\RbDoor\\Lib\\WMI_SSL\\RemoteLib\\bin\\TestRjLib.pdb\nH:\\Svn\\Double-V1\\stone_srv\\Bin\\RbDoor64.pdb\nTable 13.  APT41 samples with PDB paths containing \"RBDoor\".\nFile MD5 Hash Malware\n46a557fbdce734a6794b228df0195474 HIGHNOON\n77c60e5d2d99c3f63f2aea1773ed4653 HIGHNOON\na0a96138b57ee24eed31b652ddf60d4e HIGHNOON.BIN\n7d51ea0230d4692eeedc2d5a4cd66d2d HIGHNOON.BIN\n849ab91e93116ae420d2fe2136d24a87 HIGHNOON.BIN\nba08b593250c3ca5c13f56e2ca97d85e JUMPALL\nf8c89ccd8937f2b760e6706738210744 GEARSHIFT\n5b26f5c7c367d5e976aaba320965cc7f GEARSHIFTSPECIAL REPORT |  DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION        39\nUse of Code-Signing Certificates\nAPT41 regularly leverages code-signing certificates to \nsign malware when targeting both gaming and non-\ngaming organizations. Notably, most of the digital \ncertificates being used in this manner are valid unrevoked \ndigital certificates stolen from East Asia-based game \ndevelopment studios. APT41 likely signs their malware \nto ensure compatibility with the targeted systems and to \npotentially avoid detection.\n• Microsoft requires  all kernel-mode drivers to be signed \nin order to run on operating systems running Windows \nVista or later. \n• The use of code-signing certificates can also \nsignificantly decrease the likelihood that a malicious \npayload is detected.\nAlthough we do not have direct evidence of APT41 \nspecifically targeting and stealing code-signing certificates, \nwe have some indication from targeting of affected \norganizations within the same time frame that digital \ncertificates are first compromised and used to sign malware.\n• Stealing private keys or compromising an organization's \ninfrastructure to access and steal digital certificates \nabuses trust relationships between firms and certificate \nauthorities. Malicious files signed with valid digital \ncertificates can circumvent automated scanning/ \nblocking solutions and bypass Windows group policies \nwhich restrict unsigned code from running. \n –Even when detected, malicious files signed by \na digital certificate from a trusted partner or \nassociated business are less likely to draw suspicion. \nAccording to an advertisement in an underground \nmarketplace, the success rate of installing a payload \nincreases by as much as 50 percent when signing \nfiles with valid digital certificates.  –In most cases, multiple digital certificates are issued to \nan organization using the same public name, making \nit more difficult to identify a compromised certificate \namong others with identical names.\n –Certificate authorities are responsible for revoking \ncompromised digital certificates, although response \ntimes can vary greatly, and digital certificates can \ncontinue to be abused even long after they are first \nidentified being misused.\n• Several malware samples were signed very close to the \ncertificate issue date, suggesting that APT41 or a related \nactor had access to the private key or build environment \nat that time. It is also possible the group acquired the \nprivate keys soon after they were issued.\n• In some cases, digital certificates were used to sign \nmalware samples just before they expired, most likely \nindicating the actors were actively managing a library of \ndigital certificates for this purpose.\n• Figure 18 depicts compile times of malware signed with \ncompromised digital certificates within the time frame \nthat the certificates were valid. All of the certificates \nlisted in the graphic have either been revoked or are \ncurrently expired. Indicators associated with these \ncertificates are listed in \"Technical Annex: Code Signing \nCertificates Used by APT41.\"\n• Alternatively, it is possible APT41 may have purchased \nthe digital certificates used for signing malware within \nan underground market. FireEye researchers found that \ncode signing certificates are currently available for sale \nin underground marketplaces for as little as $399 USD, \nalthough ones that go through rigorous vetting can be \nsold for $1,699 USD.40 SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nFigure 18:  First observed malware \nsamples signed with digital certificates \n(white) in relation to valid certificate \ndates (blue).\n11/27/09 4/11/11 8/23/12 1/5/14 5/20/15 10/1/16 2/13/18 6/28/19Electronics Extreme Limited\nZepetto Co.\nEn Masse Entertainment\nGameUS Inc.\nShanda Games\nNetSarang Computer\nWemade Entertainment Co.\nXL Games Co.\nNanjing Ranyi Technology Co.\nGuangzhou YuanLuo Technology Co.\nFuqing Dawu Technolofy Co.\nMgame Corp\nNeowix Corporationxlgames\nWebzen Inc.\nGuangzhou YuanLuo Technology Co.\nYNK JAPAN Inc.Observed Use Of Code Signing Certificates\nCertificate Validity Dates\nFirst Observed Malware Sample Signed  \nwith Compromised Certificate\nSPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION        41\nOutlook and Implications\nAPT41 is a dual threat demonstrating creativity \nand aggressiveness in carrying out both espionage \ncampaigns and financially motivated operations. The \ngroup's capabilities and targeting have both widened \nover time, signaling the potential for additional supply \nchain compromises affecting more victims in additional \nverticals.\nAPT41's links to both underground marketplaces and \nstate-sponsored activity may indicate the group enjoys \nprotections that enables it to conduct its own for-profit \nactivities, or authorities are willing to overlook them. It \nis also possible that APT41 has simply evaded scrutiny \nfrom Chinese authorities. Regardless, these operations \nunderscore a blurred line between state power and \ncrime that lies at the heart of threat ecosystems and is \nexemplified by APT41.\n42       SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nTECHNICAL ANNEX\nAttack Lifecycle\nFigure 19:  \nAPT41 attack \nlifecycle.\nInitial Compromise Establish Foothold Escalate Privilege Internal Reconnaisance Complete MissionMove Laterally Maintain Presence\n• CHINACHOP\n• Credential theft\n• CVE-2019-3369\n• Spear-phishing\n• Stolen credentials\n• TeamViewer\n• ADORE.XSEC\n• CROSSWALK\n• CROSSWALK.BIN\n• FRONTWHEEL\n• HIGHNOON\n• HIGHNOON.BIN\n• HIGHNOON.LINUX\n• HOMEUNIX\n• PACMAN\n• PHOTO\n• POISONPLUG\n• POWERSPLOIT\n• ROCKBOOT\n• SOGU\n• Scheduled tasks\n• Startup ﬁles\n• Sticky Keys Vulnerability\n• Windows Registry\n modiﬁcations• HIGHNOON\n• SOGU\n• Brute-force local \n admin account\n• Creation of user accounts\n added to User and\n Admin groups\n• Modiﬁcation of the \n legitimate WMI \n Performance Adapter\n• RDP\n• Scheduled tasks\n• Stolen credentials\n• ACEHASH\n• ASPXSpy\n• Beacon\n• CHINACHOP\n• COLDJAVA\n• CRACKSHOT\n• CROSSWALK\n• DEADEYE\n• DOWNTIME\n• EASYNIGHT\n• Gh0st\n• HIGHNOON\n• HIGHNOON.LITE\n• HIGHNOON.PASTEBOY\n• HKDOOR\n• HOTCHAI\n• JUMPALL\n• LATELUNCH\n• LIFEBOAT\n• LOWKEY\n• njRAT\n• PHOTO\n• POISONPLUG\n• POISONPLUG.SHADOW\n• POTROAST\n• SAGEHIRE\n• SOGU\n• SWEETCANDLE\n• TERA\n• TIDYELF\n• WINTERLOVE\n• XDOOR\n• ZXSHELL\n• PowerShell\n• Sticky Keys Vulnerability• ACEHASH\n• GEARSHIFT\n• Mimikatz\n• NTDSDump\n• PHOTO\n• PwDump\n• WINTERLOVE\n• Bypass User Account \n Control\n• Password hash\n dumping\n• Windows Credential\n Editor (WCE)• HIGHNOON\n• SOGU\n• WIDETONE\n• Built-in Windows\n commands\n (ping, nestate, etc.)• Encryptor RaaS\n• XMRIG\n• Clear “.bash_history”\n ﬁles\n• Clear Windows \n security and system \n event logs\n• Compress data \n using RAR\n• Credential theft\n• Delete Scheduled \n tasks\n• Intellectual property \n theft\n• Modify DNS \n management to avoid \n anti-virus detection\n• Steal in-game \n currenciesSPECIAL REPORT |  DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION        43\nInitial \nCompromiseAPT41 leverages a variety of techniques to perform an initial compromise, including spear-\nphishing, moving laterally from trusted third parties, leveraging stolen credentials, using the \nCHINACHOP web shell, and accessing victim organizations using remote desktop sharing \nsoftware, such as TeamViewer. APT41 often relies on the use of simple spear-phishing email \nwith attachments such as compiled HTML (.chm) files to initially compromise their victims. \nHowever, once in a victim organization, the operation can leverage more sophisticated TTPs \nand deploy additional malware tools.\n• In a campaign running almost one year, APT41 compromised hundreds of systems and \nused close to 150 unique pieces of malware including backdoors, credential stealers, \nkeyloggers, and rootkits.\n• We have observed TeamViewer credentials used as an entry point in multiple intrusions \nacross industries. In these instances, APT41 leveraged TeamViewer to transfer malware \ninto the compromised environment, although we do not have direct evidence of APT41 \ncompromising TeamViewer.\n –In July 2017, APT41 initiated a TeamViewer session and transferred files that were \nlater deleted. Filenames and creation times indicate that these may have been the \nHIGHNOON backdoor. \n –In May 2018, APT41 used TeamViewer for initial entry in the compromise of a healthcare \ncompany. During this intrusion, APT41 started a TeamViewer session and shortly \nafter transferred DLL files associated with the CROSSWALK backdoor to the victim \nenvironment before deploying CROSSWALK.\nThe group has leveraged several exploits in their operations. Notably, APT41 was observed \nusing proof-of-concept exploit code for CVE-2019-3396 within 23 days after the \nConfluence vulnerability was announced.\nObserved Vulnerabilities\n• CVE-2012-0158 \n• CVE-2015-1641 \n• CVE-2017-0199 \n• CVE-2017-11882 \n• CVE-2019-3396 \nAPT41 compromised one organization and moved to a client environment.44       SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nEstablish \nFootholdAPT41 uses a variety of malware and tools, both public and unique to the group, to \nestablish a foothold with a victim's environment, including:\n• ASPXSpy\n• ACEHASH\n• Beacon\n• CHINACHOP\n• COLDJAVA\n• CRACKSHOT\n• CROSSWALK\n• DEADEYE\n• DOWNTIME\n• EASYNIGHT\n• Gh0st• HIGHNOON.LITE\n• HIGHNOON.PASTEBOY\n• HOTCHAI\n• HKDOOR\n• JUMPALL\n• LATELUNCH\n• LIFEBOAT\n• LOWKEY\n• njRAT\n• POISONPLUG• POISONPLUG.SHADOW\n• POTROAST\n• SAGEHIRE\n• SOGU\n• SWEETCANDLE\n• TERA\n• TIDYELF\n• XDOOR\n• WINTERLOVE\n• ZXSHELL\nAPT41 has been observed using Linux and Windows variants of the same malware families, \nsuch as PHOTO and HIGHNOON. The group often initially installs its backdoors to c:\\\nwindows\\temp.\nWe have observed APT41 attempting to masquerade their files and domains as popular \nanti-virus software:\n• \n• \n• \nAPT41 appears to use the commercially available Beacon backdoor that is part of the \nCobalt Strike pen-testing software platform. In at least one instance, a server used for \nBeacon C&C was also leveraged for CROSSWALK C&C.\nOn multiple occasions, APT41 leveraged the Sticky Keys vulnerability and PowerShell to \ndeploy malware families in victims' environments.SPECIAL REPORT |  DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION        45\nEscalate \nPrivilegesAPT41 escalates its privileges in systems by leveraging custom-made and publicly available \ntools to gather credentials and dump password hashes. The tools include:\n• ACEHASH\n• GEARSHIFT\n• GOODLUCK\n• Mimikatz• NTDSDump\n• PHOTO\n• PwDump\n• WINTERLOVE\nWindows Credential Editor (WCE)\nAPT41 frequently uses the Windows Credential Editor to dump password hashes from \nmemory and authenticate other user accounts.\nInternal \nReconnaissanceAPT41 conducts network reconnaissance after using compromised credentials to log on \nto other systems. The group leverages built-in Windows commands, such as \"netstat\" \nand \"net share,\" in addition to the custom and non-public malware families SOGU, \nHIGHNOON, and WIDETONE. \n• HIGHNOON includes the ability to collect host information by enumerating active \nRemote Desktop Protocol (RDP) sessions.\n• SOGU is capable of listing TCP and UDP network connections, respectively. \n• WIDETONE is capable of conducting port scans and password brute-force attacks and \ncollecting network information. It contains an embedded variant of a publicly available \nenumeration tool and can be run with the following options:\n –\"-hbs\" option runs a port scan on the specified subnet.\n –\"-hscan\" scans the specified IP range for IPC and SQL services.\n –\"-enum\" queries a Windows host for requested information, such as users, groups/\nmembers, policies, and more.46       SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nLateral \nMovementAPT41 assesses the network architecture of an organization and identifies pivotal systems \nfor enabling further access. The group has repeatedly identified intermediary systems that \nprovide access to otherwise segmented parts of an organization's network (as outlined \nin Case Study: Video Game Industry Targeting ). Once APT41 has identified intermediary \nsystems, it moves quickly to compromise systems. In one case, hundreds of systems across \nseveral geographic regions were compromised in as little as two weeks. \nAPT41 uses multiple methods to perform lateral movement in an environment, including \nRDP sessions, using stolen credentials, adding accounts to User and Admin groups, \nand password brute-forcing utilities. The group will also use a compromised account to \ncreate scheduled tasks on systems or modify legitimate Windows services to install the \nHIGHNOON and SOGU backdoors.\n• We observed APT41 using a compromised account to create a scheduled task on a \nsystem, write a binary component of HIGHNOON containing the payload and C&C \ninformation to disk, and then modify the legitimate Windows WMI Performance Adaptor \n(wmiApSrv) to execute the HIGHNOON payload.\nAPT41 frequently uses the publicly available utility WMIEXEC to move laterally across \nan environment. WMIEXEC is a tool that allows for the execution of WMI commands on \nremote machines. Examples of commands executed by the utility include:\ncmd.exe /c whoami > C:\\wmi.dll 2>&1\ncmd.exe /c del C:\\wmi.dll /F > nul 2>&1\ncmd.exe /c a.bat > C:\\wmi.dll 2>&1 SPECIAL REPORT |  DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION        47\nMaintain \nPresenceTo maintain presence, APT41 relies on backdoors, a Sticky Keys vulnerability, scheduled \ntasks, bootkits, rootkits, registry modifications, and creating or modifying startup files. \nAPT41 has also been observed modifying firewall rules to enable file and printer sharing to \nallow for inbound Server Message Block (SMB) traffic.\n• APT41 leveraged ROCKBOOT as a persistence mechanism for PHOTO and TERA \nbackdoors. The bootkit performs raw disk operations to bypass the typical MBR boot \nsequence and execute the backdoors prior to the host operating system. This technique \nwas implemented to ensure the malware would execute at system runtime and was \ndesigned to be difficult to detect and prevent. APT41 ROCKBOOT samples have been \nsigned with legitimate code-signing certificates from MGame and Neowiz, two South \nKorean video game companies.\n• APT41 leveraged ADORE.XSEC, a Linux backdoor launched by the Adore-NG rootkit, \nthroughout an organization's Linux environment. The group installed the backdoor and \nthe Adore-NG rootkit persistently by creating a hidden shell script in \"/etc/rc.d/init.d,\" \na directory that contains the startup scripts for many system services. The Adore-NG \nrootkit is used to hide the backdoor and authenticate any incoming connections using a \nprovided password.\n• The group also uses CROSSWALK.BIN, FRONTWHEEL, HIGHNOON.BIN, HIGHNOON.\nLINUX, HOMEUNIX, and PACMAN to maintain presence.\nIn some instances, APT41 leveraged POISONPLUG as a first-stage backdoor to deploy the \nHIGHNOON backdoor in the targeted environment. We observed APT41 use PowerSploit \nwith the capability to use WMI as a persistence mechanism. The group also deploys the \nSOGU and CROSSWALK malware families as means to maintain presence.\nAPT41 has demonstrated it is highly agile, responding quickly to changes in victim \nenvironments and incident responder activity.\n• Hours after a victimized organization made changes to thwart APT41, the group \nregistered a new C&C domain, compiled a new SOGU backdoor variant, and deployed \nthe new backdoor to several systems across multiple geographic regions. \n• APT41 sent spear-phishing emails to multiple HR employees three days after the \ncompromise had been remediated and systems were brought back online. Within hours \nof a user opening the malicious attachment dropping a HOMEUNIX backdoor, APT41 \nregained a foothold within the environment by installing PHOTO on the organization's \nservers across multiple geographic regions. 48       SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nComplete \nMissionAPT41 has been observed creating a RAR archive of targeted files for exfiltration. The group \nhas also manipulated in-game currencies using the targets' databases after compromising \nproduction environments. During multiple engagements, APT41 attempted to remove \nevidence of some of its activity by deleting Bash histories, clearing Windows security and \nsystem events, and modifying DNS management to avoid anti-virus detections.\nIn at least one instance, the group attempted to deploy Encryptor RaaS. However, an \noperator's typo prevented the ransomware from executing in the victim's environment.\nIn another instance, APT41 deployed XMRig, a Monero cryptocurrency mining tool in a \nvictim's environment.Avoiding C&C Detection\nAt times APT41 uses legitimate websites, such as GitHub, \nPastebin, and Microsoft TechNet, to avoid detection. \nInterestingly, some of the group's POISONPLUG malware \nsamples leverage the Steam Community website \nassociated with Valve, a video game developer and \npublisher. This technique of storing encoded or encrypted \nstrings, known as dead drop resolvers (DDR), on legitimate \nwebsites that can subvert network defenders as traffic to \nand from the sites is typically benign.\nThe group has also configured Linux backdoors to run \non ports used by legitimate applications within victim \nenvironments, enabling malicious traffic to bypass network \nsecurity measures and hide malicious activity within the \norganization's regular application traffic.Preventing Anti-Virus Updates\nBefore attempting to deploy the publicly available \nRansomware-as-a-Service (RaaS) Encryptor RaaS \nthrough group policy, APT41 blocked victim systems \nfrom retrieving anti-virus updates by accessing the DNS \nmanagement console and implementing a forward lookup \non the domain used for anti-virus updates to the park IP \naddress \"1.1.1.1.\" SPECIAL REPORT |  DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION        49\nTECHNICAL ANNEX\nMITRE ATT&CK Mapping\nInitial Access\nt1190 Exploit Public-Facing Application\nt1133 External Remote Services\nt1193 Spear-phishing Attachment\nt1195 Supply Chain Compromise\nt1199 Trusted Relationship\nt1078 Valid Accounts\nPrivilege Escalation\nt1134 Access Token Manipulation\nt1015 Accessibility Features\nt1038 DLL Search Order Hijacking\nt1034 Path Interception\nt1055 Process Injection\nt1078 Valid Accounts\nt1100 Web ShellExecution\nt1059 Command-Line Interface\nt1223 Compiled HTML File\nt1106 Execution through API\nt1129 Execution through Module Load\nt1203 Exploitation for Client Execution\nt1061 Graphical User Interface\nt1170 Mshta\nt1086 PowerShell\nt1053 Scheduled Task\nt1085 Rundll32\nt1064 Scripting\nt1035 Service Execution\nt1204 User Execution\nt1047 Windows Management InstrumentationPersistence\nt1015 Accessibility Features\nt1098 Account Manipulation\nt1067 Bootkit\nt1136 Create Account\nt1038 DLL Search Order Hijacking\nt1133 External Remote Services\nt1179 Hooking\nt1031 Modify Existing Service\nt1050 New Service\nt1034 Path Interception\nt1108 Redundant Access\nt1060 Registry Run Keys / Start Folder\nt1165 Startup Items\nt1078 Valid Accounts\nt1100 Web Shell50       SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nCollection\nt1119 Automated Collection\nt1213 Data from Information Repositories\nt1005 Data from Local System\nt1056 Input Capture\nt1113 Screen CaptureCredential Access\nt1098 Account Manipulation\nt1110 Brute Force\nt1003 Credential Dumping\nt1081 Credentials in Files\nt1056 Input Capture\nt1145 Private KeysDiscovery\nt1087 Account Discovery\nt1482 Domain Trust Discovery\nt1083 File and Directory Discovery\nt1069 Permission Groups Discovery\nt1057 Process Discovery\nt1063 Security Software Discovery\nt1082 System Information Discovery\nt1016 System Network Configuration Discovery\nt0149 System Network Connections Discovery\nt1033 System Owner/User Discovery\nt1124 System Time Discovery\nt1497 Virtualization and Sandbox Evasion\nCommand and Control\nt1043 Commonly Used Port\nt1090 Connection Proxy\nt1094 Custom Command and Control Protocol\nt1132 Data Encoding\nt1001 Data Obfuscation\nt1483 Domain Generation Algorithms\nt1219 Remote Access Tools\nt1105 Remote File Copy\nt1071 Standard Application Layer Protocol\nt1032 Standard Cryptographic Protocol\nt1095 Standard Non-Application Layer Protocol\nt1065 Uncommonly Used PortLateral Movement\nt1075 Pass the Hash\nt1076 Remote Desktop Protocol\nt1105 Remote File Copy\nExfiltration\nt1002 Data Compressed\nt1022 Data Encrypted\nt1041 Exfiltration Over Command and Control Channel\nImpact\nt1487 Data Encrypted for ImpactDefense Evasion\nt1134 Access Token Manipulation\nt1009 Binary Padding\nt1146 Clear Command History\nt1116 Code Signing\nt1140 Deobfuscate / Decode Files or Information\nt1089 Disabling Security Tools\nt1038 DLL Search Order Hijacking\nt1073 DLL Side-Loading\nt1107 File Deletion\nt1054 Indicator Blocking\nt1070 Indicator Removal on Host\nt1036 Masquerading\nt1112 Modify Registry\nt1170 Mshta\nt1027 Obfuscated Files or Information\nt1055 Process Injection\nt1014 Rootkit\nt1085 Rundll32\nt1064 Scripting\nt1045 Software Packing\nt1099 Timestomp\nt1078 Valid Accounts\nt1497 Virtualization and Sandbox Evasion\nt1102 Web ServiceSPECIAL REPORT |  DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION        51\nTECHNICAL ANNEX\nCode-Signing Certificates  \nUsed by APT41\nTable 14.  Code-signing certificates used by APT41.\nSerial Common Name Issue DateExpiry \nDateStatus\n0b:72:79:06:8b:eb:15:ff:e8:06:0d:2c:56:15:3c:35Guangzhou YuanLuo  \nTechnology Co.6/12/12 6/12/13 Revoked\n18:63:79:57:5a:31:46:e2:6b:ef:c9:0a:58:0d:1b:d2 Webzen Inc. 8/2/11 9/30/13 Revoked\n63:66:a9:ac:97:df:4d:e1:73:66:94:3c:9b:29:1a:aa xlgames 7/5/11 7/4/ 12 Revoked\n5c:2f:97:a3:1a:bc:32:b0:8c:ac:01:00:59:8f:32:f6 Neowiz CORPORATION 11/16/11 12/15/12 Expired \n01:00:00:00:00:01:30:73:85:f7:02 Mgame Corp 6/9/11 6/9/12 Expired\n4c:0b:2e:9d:2e:f9:09:d1:52:70:d4:dd:7f:a5:a4:a5 Fuqing Dawu Technology Co. 1/31/13 1/31/14 Revoked\n14:0d:2c:51:5e:8e:e9:73:9b:b5:f1:b2:63:7d:c4:78Guangzhou YuanLuo  \nTechnology Co.10/22/13 10/22/14 Revoked\n58:01:5a:cd:50:1f:c9:c3:44:26:4e:ac:e2:ce:57:30 Nanjing Ranyi Technology Co. 8/8/12 8/8/13 Revoked\n7b:d5:58:18:c5:97:1b:63:dc:45:cf:57:cb:eb:95:0b XL Games Co. 6/21/12 6/21/13 Revoked\n47:6b:f2:4a:4b:1e:9f:4b:c2:a6:1b:15:21:15:e1:fe Wemade Entertainment co. 3/2/14 1/9/16 Revoked\n53:0c:e1:4c:81:f3:62:10:a1:68:2a:ff:17:9e:25:80 NetSarang Computer 10/13/16 11/12/18 Revoked\n30:d3:c1:67:26:5b:52:0c:b8:7f:25:84:4f:95:cb:04 Shanda Games 10/29/13 12/27/16 Revoked\n54:c6:c1:40:6f:b4:ac:b5:d2:06:74:e9:93:92:c6:3e GameUS Inc 5/15/14 7/13/16 Expired\n1e:52:bb:f5:c9:0e:c1:64:d0:5b:e0:e4:16:61:52:5f En Masse Entertainment 2/3/15 4/5/17 Expired\nfd:f2:83:7d:ac:12:b7:bb:30:ad:05:8f:99:9e:cf:00 Zepetto Co. 5/10/18 7/1/19 Expired\n25:f8:78:22:de:56:d3:98:21:59:28:73:ea:09:ca:37 Electronics Extreme Limited 1/20/17 1/20/19 Expired\n67:24:34:0d:db:c7:25:2f:7f:b7:14:b8:12:a5:c0:4d YNK JAPAN Inc 11/27/09 11/27/11 Revoked52       SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nTECHNICAL ANNEX\nAdditional Malware Overlaps\nFigure 20:  HIGHNOON.\nBIN and HIGHNOON.LITE \nin memory DLL loading \nfunction.\nBackground\nThroughout the course of our analysis, we consolidated \nmultiple malware families into a single family with variants \nbased on identified overlaps. Some of the malware \nfamilies, such as HIGHNOON, are shared with other \nsuspected Chinese espionage groups. The malware \nfamilies contain similar functionalities, code overlaps, \nand encoding routines. Detailed descriptions on specific \nmalware families are listed as follows.HIGHNOON\nHIGHNOON variants include HIGHNOON.LITE, \nHIGHNOON.BIN, HIGHNOON.PASTEBOY, HIGHNOON.\nCLI, and HIGHNOON.LINUX. Some of the variants, such as \nHIGHNOON.BIN, were used by multiple suspected Chinese \ngroups, including APT41 and APT17.\nHIGHNOON.BIN and HIGHNOON.LITE\nHIGHNOON.BIN (MD5: \n2862c9bff365dc8d51ba0c4953869d5d) and HIGHNOON.\nLITE (MD5: b5120174d92f30d3162ceda23e201cea) contain \nan identical in memory DLL loading function, which can be \nseen in Figure 20.\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48  char *v7 ; // [esp+60h] [ebp-Ch]\n  _DWORD *v8 ; // [esp+68h] [ebp-4h]\n  if ( ! a1 )\n    return 0;\n  v7 = (char *)a1 + a1[15];\n  IpAddress  = (char *)VirtualAlloc (*((LPVOID * )v7 + 13), *(( _DWORD * )v7 + 20), 0x2000u, 0x40u);\n  if ( !IpAddress  )\n  IpAddress  = (char *)VirtualAlloc (0, *((_DWORD * )v7 + 20), 0x2000u, 0x40u);\n  if ( !IpAddress  )\n    return 0;\n  v2 = GetProcessHeap ():\n  v8 = HeapAlloc (v2, 0, 0x14u);\n  v8[1] = IpAddress ;\n  v8[3] = 0;\n  v8[2] = 0;\n  v8[4] = 0;\n  VirtualAlloc (IpAddress , *((_DWORD * )v7 + 20), 0x1000u, 0x40u);\n  Dst = (char *)VirtualAlloc (IpAddress , *((_DWORD * )v7 + 21), 0x1000u, 0x40u\n  memcpy( Dst, a1, *((_DWORD * )v7 + 21) + a1[15]);\n  *v8 = &Dst[a1[15]];\n  *(_DWORD * )(*v8 + 52) = IpAddress ;\n  sub_4020A0( a1, v7, v8);\n  v4 = (int)&IpAddress [-*((_DWORD * )v7 + 13)];\n  if ( v4 )\n    sub_402320( v8, v4);\n  if ( sub_402320( v8) )\n  {\n    sub_4021C0( v8);\n    if ( !*( _DWORD * )(*v8 + 40) )\n      return v8;\n    v3 = &IpAddress [*(_DWORD * )(*v8 + 40)];\n    if ( v3 && ((int (__stdcall *)(char *, int, _DWORD) )v3)(IpAddress , 1, 0) )\n    {\n      v8[4] = 1;\n      return v8;\n    }\n  }\n  sub_402740( v8);\n  return 0;\n}\n00002084 t_in_memory_DLL_loader;46 (402084)char *v8 ; // ecx\nint v9; // eax\nchar *v10;  // eax\nchar *v11;  // [esp+10h] [ebp-4h]\nv1 = (char *)a1 + a1[15];\nv2 = (char *)VirtualAlloc (*((LPVOID * )v1 + 13), *(( _DWORD * )v1 + 20), 0x2000u, 0x40u);\nv11 = v2;\nif ( !v2 )\n{\n  result = (char \")VirtualAlloc (0, *((_DWORD * )v1 + 20), 0x2000u, 0x40u);\n  v11 = result;\n  if ( !result )\n    return result;\n  v2 = result;\n}\nv4 = GetProcessHeap ();\nv5 = (int *)HeapAlloc (v4, 0, 0x14u);\nv5[1] = (int)v2;\nv5[3] = 0;\nv5[2] = 0;\nv5[4] = 0;\nVirtualAlloc (v2, *((_DWORD * )v1 + 20), 0x1000u, 0x40u);\nv6 = (char *)VirtualAlloc (v2, *((_DWORD * )v1 + 21), 0x1000u, 0x40u);\nqmemcpy( v6, a1, a1[15] + *(( _DWORD * )v1 + 21));\nv7 = (int)&v6[a1[15]];\n*v5 = v7;\n*(_DWORD * )(v7 + 52) = v11;\nsub_10002150(( int)a1, (int)v1, v5);\nv8 = (char *)*((_DWORD * )v1 + 13);\nif ( v11 != v8 )\n  sub_10002370( v5, v11 - v8);\nif ( !sub_100023F0( v5) )\n  goto LABEL_10;\nsub_100022B0( v5);\nv9 = *(_DWORD *)(*v5 + 40);\nif ( v9 )\n{\n  v10 = &v11[v9];\n  if ( !v10 || !((int (__stdcall *)(char *, int, _DWORD) )v10)(v11, 1, 0) )\n  {\nABEL _10\n    sub_100025B0(v5);\n    return 0;\n  }\n  v5[4] = 1;\n}\nreturn ( char *)v5;\n000021BF sub_1000020B0;52 (100021BF)53\nSPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nHIGHNOON (MD5: df143c22465b88c4bdb042956fef8121) \nuses an API hashing algorithm to resolve its imports at \nruntime, but the layout of the in-memory DLL loading \nfunctionality is identical between HIGHNOON, HIGHNOON.\nBIN, and HIGHNOON.LITE samples (Figure 21). The specific \nsamples of HIGHNOON, HIGHNOON.BIN, and HIGHNOON.\nLITE referenced previously are not attributed to APT41 but \nare instead used by other suspected Chinese groups.\nFigure 21:  \nHIGHNOON DLL \nloading function.\n  resolve_APIS ():\n  v3 = (_DWORD * )((char *)a1 + a1[15]);\n  v4 = (_DWORD * )VirtualAlloc (v3[13], v3[20]. 0x2000, 0x40);\n  if ( ! v4 )\n  {\n    result  = (_DWORD * )VirtualAlloc (0, v3[20], 0x2000, 0x40);\n    if ( ! result )\n      return result;\n    v4 = result;\n  }\n  v6 = (void *)GetProcessHeap (0, 0x14);\n  v7 = HeapAlloc (v6, v13, v14);\n  v7[1] = v4;\n  v7[3] = 0;\n  v7[2] = 0;\n  v7[4] = 0;\n  VirtualAlloc (v4, v3[20], 0x1000, 0x40);\n  v8 = (char *)VirtualAlloc (v4, v3[21], 0x1000, 0x40);\n  qmemcopy (v8, a1, a1[15] + v3[21]);\n  v9 = (int)&v8[*(_DWORD * )(a3 + 60)];\n  *v7 = v9;\n  *(_DWORD * )(v9 + 52) = a1;\n  sub_100016A0 (a3, v3, v7);\n  v10 = (char *)v3[13];\n  if ( a1 != (_DWORD * )v10 )\n     sub_10001830 (v7, (char *)a1 - v10);\n  if ( ! sub_10001770 (v7) )\n     return 0;\n  sub_10001770 (v7);\n  v11 = *(_DWORD * )(*v7 + 40);\n  if ( v11 )\n  {\n    v12 = (char *)a1 + v11;\n    if ( ! v12 || !((int (cdec1 *)(_DWORD *, int, _DWORD) )v12)(a1, 1, 0) )\n      return 0;\n    v7[4] = 1;\n  }\n  return v7;\n}• HIGHNOON and HIGHNOON.LITE also share the same \nconfiguration encoding routine.\n• HIGHNOON, HIGHNOON.LITE, and HIGHNOON.BIN \nstore a unique host identifier under the registry key \nHKLM\\SOFTWARE\\Microsoft\\HTMLHelp54       SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nHIGHNOON.LINUX and HIGHNOON\nHIGHNOON.LINUX is a Linux variant of HIGHNOON that \nshares multiple component overlaps with HIGHNOON.\n• HIGHNOON.LINUX and HIGHNOON share a message \ncomponent that use the same headers and XOR encoding.\n• The two share a transport component that provides \nHTTP, Fake TLS, and raw protocol options.\n• HIGHNOON.LINUX and HIGHNOON share a similar \ncommands component. The code for processing the \ncommands \"Tunnel\" and \"Plus\" (to add plugins) are \nnearly identical.\nCROSSWALK and CROSSWALK.BIN\nCROSSWALK and CROSSWALK.BIN share several notable \noverlaps. Significantly, the two code families share a large \namount of code in their respective shellcode components \n(Figure 22).Shellcode Component Overlaps\n• The shellcode that handles C&C messages uses the \nsame function in both families.\n –Interestingly, additional functions used for C&C in \nCROSSWALK.BIN are present within CROSSWALK \nbut unused. \n –This suggests the families are slightly different builds \noriginating from the same codebase. \n• CROSSWALK.BIN's user-mode shellcode and the \nshellcode appended at the end of CROSSWALK contain \napproximately three-fourths of the same code. \n• Both CROSSWALK and CROSSWALK.BIN's backdoors \nare implemented through user-mode shellcode.SPECIAL REPORT |  DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION        55\nFigure 22:  CROSSWALK (left) and CROSSWALK.BIN (right) shellcode.\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n76\n77\n78\n79\n80\n81\n82\n83\n84\n85\n86\n87\n88\n89\n90\n91\n92\n93\n94\n95\n96\n97\n98\n99\n100\n101\n102\n103\n104\n105\n106\n107\n108\n109\n110\n111\n112\n113\n114\n115\n116\n117\n118\n119\n120  __int64 v37 ; // [rsp+58h] [rbp+10h]\n  v37 = a2;\n  v2 = 0;\n  v3 = a1[47] == 1;\n  v4 = a1;\n  strcopy (&v36, \"ok1234\\n\" );\n  if ( v3 )\n  {\nLABEL_14:\n    if ( cgp_dyn_resolve_maybe_03 (v4) <= 0 )\n      return v2;\n    v24 = v4[24];\n    v25 = *(v4 + 13);\n    v26 = v4[48];\n    *(v4  + 11) = v4;\n    *(v4 +10) = v4 - v24;\n    v27 = v4 + v25 - v24;\n    v28 = (*(v4 + 31))(0i64, v26, 4096i64, 4i64);\n    *(v4 + 25) = v28;\n    if ( ! v28 )\n      return v2;\n    v29 = v4[25];\n    v30 = *(v4 + 28);\n    if ( v29 > 0 )\n    {\n      v31 = v27;\n      do\n      {\n        * v31++ ^= v30;\n        -- v29:\n      }\n      while ( v29 );\n    }\n    if ( sub_BBA0 (v4, v27) <= 0 )\n      return v2;\n    v32 = v4[25];\n    v33 = *(v4 + 28);\n    if ( v32 > 0 )\n    {\n      do\n      {\n        * v27++ ^= v33;\n        -- v32:\n      }\n      while ( v32 );\n    }\n    *(*( v4 + 25) + 2032i64) = *( v4 + 17) + * v4 + 10);\n    *(v4 + 35) = *( v4 + 17) + *( v4 + 10);\n    (*(*( v4 + 25) + 752i644))(32775i64);\n    v34 =  (*(*( v4 + 25) + 32i64))(0i64, 0i64, *( v4 + 10) + *( v4 + 95), v4, 0, 0i64);\n    (*(v4 + 35))(& v36);\n    (*(*( v4 + 25) + 272i64))( v34, 0xFFFFFFFFi64);\n    (*(*( v4 + 25) + 48i64))( v24);\n    v2 = 1;\n    return v2;\n  }\n  v5 = a1[12];\n  v6 = a1[13];\n  v7 = a1[11];\n  v8 = v4[24];\n  v9 = v4[19];\n  v10 = v4[25];\n  v4[12] = v7;\n  v11 = v10 + v9 + v8;\n  v4[13] = v7;\n  v12 = 0;\n  v13 = v10 + v9 + v8;\n  v14 = v4 - v8;\n  do\n  {\n    v15 = *v14++;\n    v12 = v15 + __ROR4__ (v12, v7);\n    --v13;\n  }\n  while ( v13 );\n  if ( v6 != v12 )\n    return v2;\n  v16 = v4 + 48;\n  v17 = v9 + v10 - 192;\n  v18 = v17;\n  if ( v17 > 0 )\n  {\n    v19 = v4[14];\n0000B60A cgp_decode_shellcode:62 (B60A)39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n76\n77\n78\n79\n80\n81\n82\n83\n84\n85\n86\n87\n88\n89\n90\n91\n92\n93\n94\n95\n96\n97\n98\n99\n100\n101\n102\n103\n104\n105\n106\n107\n108\n109\n110\n111\n112\n113\n114\n115\n116\n117\n118\n119\n120\n121\n122  __int64 v39 ; // [rsp+58h] [rbp+10h]\n  v39 = a2;\n  v2 = 0;\n  v3 = a1[47] == 1;\n  v4 = a1;\n  strcopy (&v38, \"ok1234\\n\" );\n  if ( v3 )\n  {\nLABEL_14:\n    if ( cgp_dyn_resolve_maybe_03 (v4) <= 0 )\n      return v2;\n    v24 = v4[24];\n    v25 = *(v4 + 13);\n    v26 = v4[48];\n    *(v4  + 11) = v4;\n    *(v4 +10) = v4 - v24;\n    v27 = v4 + v25 - v24;\n    v28 = (*(v4 + 31))(0i64, v26, 4096i64, 4i64);\n    *(v4 + 25) = v28;\n    if ( ! v28 )\n      return v2;\n    v29 = v4[25];\n    v30 = *(v4 + 28);\n    if ( v29 > 0 )\n    {\n      v31 = v27;\n      do\n      {\n        * v31++ ^= v30;\n        -- v29:\n      }\n      while ( v29 );\n    }\n    if ( sub_8C58 (v4, v27) <= 0 )\n      return v2;\n    v32 = v4[25];\n    v33 = *(v4 + 28);\n    if ( v32 > 0 )\n    {\n      do\n      {\n        * v27++ ^= v33;\n        -- v32:\n      }\n      while ( v32 );\n    }\n    *(*( v4 + 25) + 2032i64) = *( v4 + 17) + * v4 + 10);\n    *(v4 + 35) = *( v4 + 17) + *( v4 + 10);\n    (*(*( v4 + 25) + 752i644))(32775i64);\n    v34 =  (*(*( v4 + 25) + 32i64))(0i64, 0i64,\n    (*(v4 + 35))(& v38);\n    (*(*( v4 + 25) + 272i64))( v36, 0xFFFFFFFFi64);\n    (*(*( v4 + 25) + 48i64))( v36);\n    v2 = 1;\n    return v2;\n  }\n  v5 = a1[12];\n  v6 = a1[13];\n  v7 = a1[11];\n  v8 = v4[24];\n  v9 = v4[19];\n  v10 = v4[25];\n  v4[12] = v7;\n  v11 = v10 + v9 + v8;\n  v4[13] = v7;\n  v12 = 0;\n  v13 = v10 + v9 + v8;\n  v14 = v4 - v8;\n  do\n  {\n    v15 = *v14++;\n    v12 = v15 + __ROR4__ (v12, v7);\n    --v13;\n  }\n  while ( v13 );\n  if ( v6 != v12 )\n    return v2;\n  v16 = v4 + 48;\n  v17 = v9 + v10 - 192;\n  v18 = v17;\n  if ( v17 > 0 )\n  {\n    v19 = v4[14];\n00008590 cgp_decode_shellcode:49 (8590)56       SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nObfuscation and Anti-Analysis Overlaps \n• Both code families share the same function at the start \nof their shellcode to de-obfuscate subsequent shellcode.\n• A key function within the shellcode component that \ngenerates a semi-random XOR key and is used in \nmultiple code locations for decoding is identical in \nCROSSWALK and CROSSWALK.BIN.\n• Both use the same function for import resolution via an \nASCII hash.However, there are differences between the two malware \nfamilies, including how they communicate to C&C servers.\n• CROSSWALK beacons with HTTP GET and POST requests, \nwhile CROSSWALK.BIN uses a custom binary protocol.\n• CROSSWALK.BIN contains a driver component for \ncovert C&C, which CROSSWALK lacks.\n• Both families contain similar code to process identical \nmessage types, but their answers differ.\n –CROSSWALK.BIN answers to 0x78 and 0x7A \nmessage types by calling large functions wrapping \nthe business logic.\n –CROSSWALK has different, much shorter code \nembedded directly in the \"case\" statement.strcpy(&v22, \"r c:%d,l:%d\\n\" );\nv11 = 0i64;\nv12 = 0;\n(*(v3 + 2032))(& v22, v8, v5);\nswitch ( * msg_type  )\n{\n  case 0x64u:\n    if ( msg_type [1] != 216 )\n    {\n      v16 = 100;\n      goto LABEL_37;\n    }\n    v21 =  (*(v9 + 248))(0i64, 216i64, 4096i64, 4i64);\n    if ( ! v21 )\n      return 0;\n    (*(*( v9 + 200) + 1856i64))( v21, v7, msg_type [1]);\n    if ( (*(*( v9 + 200) + 928i64))(*( v9 + 832), 100i64, v21, msg_type [1]) > \n0 )\n      return 1;\n    v10 = 0;\n    v14 = (*(*( v9 + 200) + 320i64))();\n    v15 = 7021i64;\n    goto LABEL_42;\n  case 0x6Eu:\n    return 1;\n  case 0x78u:\n    if ( msg_type [1] != 16 )\n    {\n      v16 = 120;\n      goto LABEL_37;\n    }\n    v20 = (*(v9 + 248))(0i64, 16i64, 4096i64, 4i64);\n    if ( ! v20 )\n      return 0;\n    (*(*( v9 + 200) + 1856i64))( v21, v7, msg_type [1]);\n    if ( (*(*( v9 + 200) + 928i64))(*( v9 + 832), 100i64, v21, msg_type [1]) > \n0 )\n      return 1;\n    v10 = 0;\n    v14 = (*(*( v9 + 200) + 320i64))();\n    v15 = 7021i64;\n    goto LABEL_42;\n  case 0x7Au:\n    v19 = msg_type [1];\n    if ( v19 <= 0x1000 )\n    {\n      if ( v19 )\n      }\n        v11 = (*(v9 + 248))(0i64, 16i64, 4096i64, 4i64);\n        if ( ! v11 )\n          return 10;\n        (*(*( v9 + 200) + 1856i64))( v11, v7, msg_type [1]);\n        v12 = msg_type [1];\n      }\n      if ( (*(*( v9 + 200) + 928i64))(*( v9 + 832), 122i64, v11, v12) > 0 )\n        return 1;\n      v14 = (*(*( v9 + 200 + 320i64))();\n      v15 = 7023i64\n      goto LABEL_42\n    }\n    v16 = 122;\n    goto LABEL_37;\n  case 0x82u:  strcpy(&fmt_msg, \"r c%d,l:%d\\n\" ):\n  if ( ! v3  )\n    goto LABEL_48\n  v6 = sub_3398 ();\n  v2 = v6;\n  if ( v6 == 2 )\n    return 1;\n  if ( v6 <= 0 )\n    return v2;\nLABEL_48:\n  v7 = (msg_type  + 11);\n  (*(*(v5 + 200) + 1872i64))(& fmt_msg, *msg_type , msg_type [1]);\n  switch ( * msg_type  )\n  {\n    case 0x64u:\n      (*(*( v5 + 200 + 1872i64))( v5 + 1320, 22i64);\n      v13 = cgp_cb_msgtype_0x64_wrapper (v5, (msg_type + 11));\n      v9 = v5;\n      if ( v13 > 0 )\n      {\n        *( v5 + 760) = 1;\n        if ( sub_5F44 (v5) > 0 )\n          return 1;\n        v9 = v5;\n      }\n      v11 = 100;\n      goto LABEL_43;\n    case 0x6Eu:\n      return 1;\n    case 0x78u:\n      v10 = cgp_cb_msgtype_0x78 (v5, v8, msg_type  + 11);\n      goto LABEL_38;\n    case 0x7Au;\n      v10 = cgp_cb_msgtype_07A (v5, v8, (msg_type  + 11));\n      goto LABEL_38;\n  }Figure 23:  \nCROSSWALK (left) \nand CROSSWALK.\nBIN (right) code \nfor answering \ndifferent C&C \nmessage types.\nSPECIAL REPORT |  DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION        57\nTECHNICAL ANNEX\nMalware Used by APT41\nTable 15.  Malware used by APT41.\nMalware Description Detected as\nACEHASHACEHASH is a credential theft/password hash dumping \nutility. The code may be based in Mimikatz and appears to \nbe publicly available. FE_Trojan_AceHash\nADORE.XSECADORE.XSEC is a Linux backdoor that may be used with \nthe ADORE rootkit.FE_APT_Backdoor_Linux64_ADORE_1\nFE_APT_Rootkit_Linux64_ADORE_1\nFE_APT_Rootkit_ADORE\nASPXSPYASPXSPY is a publicly available web shell that may contain \nthe text \"ASPXSpy Ver: 2009.\"FE_Webshell_ASPX_ASPXSPY_1\nFE_Webshell_ASPX_ASPXSPY_2\nFE_Webshell_ASPX_ASPXSPY_3\nFE_Webshell_ASPX_ASPXSPY_4\nBEACONBEACON malware is a backdoor that is commercially \navailable as part of the Cobalt Strike software platform, \ncommonly used for pen-testing network environments. The \nmalware supports several capabilities, such as injecting \nand executing arbitrary code, uploading and downloading \nfiles, and executing shell commands. FE_Backdoor_Win_BEACON_1\nFE_Trojan_PS1_BEACON_1\nCHINACHOPCHINACHOP is a simple code injection web shell that can \nexecute Microsoft .NET code within HTTP POST commands. \nThis allows CHINACHOP to upload and download files, \nexecute applications with web server account permissions, \nlist directory contents, access Active Directory, access \ndatabases, and perform any other action allowed by the \n.NET runtime. CHINACHOP is composed of at least two \nparts: a small bit of code on a server and a client that \nprovides C&C.FE_Webshell_JSP_CHOPPER_1\nFE_Webshell_Java_CHOPPER_1\nFE_Webshell_MSIL_CHOPPER_1\nCOLDJAVACOLDJAVA is a backdoor that drops shellcode and a \nBLACKCOFFEE variant payload into the Windows registry. FE_APT_Trojan_COLDJAVA_Dropper\nFE_APT_Trojan_COLDJAVA_64\nFE_APT_Trojan_COLDJAVA_32\nFE_APT_Backdoor_COLDJAVA\nFE_APT_Trojan_COLDJAVA_Launcher\nCRACKSHOTCRACKSHOT is a downloader that can download files, \nincluding binaries, and run them from the hard disk or \nexecute them directly in memory. It is also capable of \nplacing itself into a dormant state.FE_Backdoor_Win32_CRACKSHOT_1\nBackdoor.Win.CRACKSHOT\nCROSSWALKCROSSWALK is a skeletal, modular backdoor capable of \nsystem survey and adding modules in response to C&C \nreplies.FE_APT_Backdoor_Win_CROSSWALK_1\nFE_APT_Loader_Win_CROSSWALK_1  \nAPT.Backdoor.Win.CROSSWALK\nCROSSWALK.BINCROSSWALK.BIN is a kernel driver that can implement \nfirewall-level filters to detect tasking packets and covertly \nsend data.FE_APT_Dropper_Win64_CROSSWALK_1\nFE_APT_Dropper_Win64_CROSSWALK_2\nFE_APT_Trojan_Win64_CROSSWALK_158       SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nTable 15.  Malware used by APT41.\nMalware Description Detected as\nDEADEYEDEADEYE is a downloader that is installed as a Service \nDLL. It can use RC5 encryption to decrypt and install \npayloads obtained from its C&C server.FE_APT_Loader_Win64_DEADEYE_1\nFE_APT_Loader_Win64_DEADEYE_2\nDOWNTIMEDOWNTIME is a backdoor dropped as an embedded PE file \nto a variety of locations on disk or loaded and executed in \nmemory. The final payload is a DLL used to install, manage, \nand execute plugin DLLs.FE_Dropper_Win32_DOWNTIME_1\nFE_Loader_Win32_DOWNTIME_1 \nEASYNIGHTEASYNIGHT is a loader observed used with several \nmalware families, including HIGHNOON and HIGHNOON.\nLITE. The loader often acts as a persistence mechanism via \nsearch order hijacking.FE_APT_Loader_Win_EASYNIGHT_1 \nENCRYPTORRAASENCRYPTORRAAS (Encryptor RaaS) is a ransomware that \nencrypts all files on the system that match an included \nfile extensions list. As is typical of most ransomware, \na combination of both public-key and symmetric-key \ncryptography is used to encrypt the data. File data is \nencrypted using RC6, with the RC6 key for each file being \nencrypted with RSA. A ransom note in the form of a text \nfile, typically named \"readme_liesmich_encryptor_raas.\ntxt,\" is dropped in every directory in which a file was \nencrypted. Encryptor RaaS was sold via a RaaS operation \nthat was available around the 2015–2016 time frame via a \nTor (.onion) website.FE_Ransomware_Win32_ENCRYPTORRAAS_1\nFE_Ransomware_Win32_ENCRYPTORRAAS_2\nFRONTWHEELFRONTWHEEL is a driver for the HIGHNOON.BIN \nbackdoor. FE_APT_Rootkit_Win64_FRONTWHEEL_1\nGEARSHIFTGEARSHIFT is a memory-only dropper for two keylogger \nDLLs. It is designed to replace a legitimate Fax Service \nDLL. FE_APT_Keylogger_GEARSHIFT\nGH0STGh0st is a remote access tool (RAT) derived from publicly \navailable source code. It provides threat actors with the \nability to perform screen and audio captures, enable a \nwebcam, list and kill processes, open a command shell, \nwipe event logs, and create, manipulate, delete, launch, \nand transfer files.Backdoor.APT.Gh0stRat \nBackdoor.APT.Gh0st Trojan.Ghost \nGOODLUCKGOODLUCK is a credential-stealing DLL that modifies the \nregistry, so it loads when a user logs on to the system. It \nsteals credentials from the logon screen and saves the \ninformation to a local file.Hacktool.APT.GOODLUCK\nHIGHNOONHIGHNOON is a backdoor that may consist of multiple \ncomponents. The components may include a loader, a \nDLL, and a rootkit. Both the loader and the DLL may be \ndropped together, but the rootkit may be embedded in the \nDLL. The HIGHNOON loader may be designed to run as a \nWindows service.FE_APT_Backdoor_Win64_HIGHNOON_1\nFE_APT_Dropper_HIGHNOON_B\nFE_APT_Loader_Win64_HIGHNOON_2\nFE_APT_Loader_Win64_HIGHNOON_3\nFE_APT_Rootkit_Win64_HIGHNOON_1\nFE_APT_Rootkit_Win64_HIGHNOON_2\nFE_APT_Rootkit_Win64_HIGHNOON_3SPECIAL REPORT |  DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION        59\nTable 15.  Malware used by APT41.\nMalware Description Detected as\nHIGHNOON.BINHIGHNOON.BIN is a modified version of the Windows DLL \napphelp.dll, which is loaded via search order hijacking. \nHIGHNOON.BIN contains a malicious shellcode backdoor \nthat is loaded into memory at runtime.FE_APT_Trojan_Win32_HIGHNOON_1\nFE_APT_Loader_Win32_HIGHNOON_1\nFE_APT_Loader_Win64_HIGHNOON_1\nFE_APT_Trojan_Win32_HIGHNOON_2\nAPT.Backdoor.Win.HIGHNOON\nAPT.Backdoor.Win.HIGHNOON\nHIGHNOON.LITEHIGHNOON.LITE is a standalone, non-persistent variant of \nthe HIGHNOON backdoor. This version accepts a hostname \nand port on the command line. If no port is specified, the \nmalware will use port 80 by default. HIGHNOON.LITE \ncan download and execute additional memory-resident \nmodules after it authenticates with the C&C server. FE_APT_Trojan_Win32_HIGHNOON_7\nHIGHNOON.LINUXHIGHNOON.LINUX is a Linux backdoor designed to \noperate with a rootkit and can launch and establish \npersistence for an sshd client whose presence and activity \nis hidden by the rootkit. FE_APT_Trojan_Linux64_HIGHNOON_1\nFE_APT_Rootkit_Linux64_HIG\nHNOON_1\nHIGHNOON.\nPASTEBOYHIGHNOON.PASTEBOY is a variant of HIGHNOON that \nutilizes legitimate websites hosting encoded base64 \nstrings that decode to the actual C2 address.TROJAN.APT.PASTEBOY\nHKDOORHKDOOR (aka Hacker's Door) is a remote administration \ntool designed as a DLL that can either run as a service \nor with rundll32.exe. HKDOOR drops and installs a \nkernel rootkit and has a variety of capabilities, including \nmanipulating files and processes, connecting to URLs, and \nshutting down the compromised system. All HKDOOR's \nstring resources are encoded with a transposition \nalgorithm.Backdoor.APT.HKDOOR\nHOMEUNIXHOMEUNIX is primarily a generic launcher for downloaded \nplugins. The plugins are stored in a memory buffer and \nthen loaded and linked manually by the malware, meaning \nthe plugins never have to touch disk. However, HOMEUNIX \nmay also store and save plugins. The plugins will run after \nthe system is rebooted without the actor having to send \nthem again to the victim system.FE_APT_HOMEUNIX_1\nFE_APT_HOMEUNIX_2\nFE_APT_HOMEUNIX_3\nFE_APT_HOMEUNIX_4\nFE_APT_HOMEUNIX_5\nFE_APT_HOMEUNIX_6\nFE_APT_HOMEUNIX_7\nFE_APT_HOMEUNIX_8\nFE_APT_HOMEUNIX_9\nFE_APT_HOMEUNIX_10\nFE_APT_HOMEUNIX_11\nFE_APT_HOMEUNIX_12\nFE_APT_HOMEUNIX_13\nFE_APT_HOMEUNIX_14\nFE_APT_HOMEUNIX_15\nFE_APT_HOMEUNIX_16\nAPT.Backdoor.Win.HOMEUNIX\nBackdoor.HOMEUNIX.SNK.DNS \nTrojan.APT.9002, Backdoor.APT.900260       SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nTable 15.  Malware used by APT41.\nMalware Description Detected as\nHOTCHAIHOTCHAI is a backdoor that receives and XOR-decodes a \nDNS response message to retrieve the true C&C IP address.FE_APT_Backdoor_HOTCHAI\nJUMPALLJUMPALL is a malware dropper that has been observed \ndropping HIGHNOON/ZXSHELL/SOGU.FE_Dropper_Win_JUMPALL_1\nFE_Dropper_Win_JUMPALL_2\nLATELUNCHLATELUNCH is a loader that decodes a file specified on the \ncommand line and loads and executes it in memory. FE_Loader_Win64_LATELUNCH_1\nLIFEBOATLIFEBOAT is a backdoor that has the capability to \ncommunicate with its C&C over HTTP.FE_APT_Dropper_Win32_LIFE\nBOAT_1 FE_APT_Downloader_Win32_\nLIFEBOAT_1 APT.Downloader.Win.LIFEBOAT\nLOWKEYLOWKEY is a passive backdoor that utilizes a user mode \nrootkit to provide covert communications with the \nbackdoor component by forwarding packets in between a \nTCP Socket and a named pipe.FE_APT_ROOTKIT_WIN64_LOWKEY_1\nFE_APT_LOADER_WIN64_LOWKEY_1\nFE_APT_BACKDOOR_WIN64_LOWKEY_1\nAPT.BACKDOOR.Win.LOWKEY\nNJRATnjRAT is a RAT project that was in development possibly \nas early as 2010, and it has seen a number of incremental \nupdates since that time. The author of njRAT is widely \nbelieved to be a Kuwaiti actor using the handle \"njq8.\" \nnjq8, whose real name is believed to be Naser Al Mutairi, \nand who has previously used the handles \"NJN\" and \n\"xNJQ8x,\" has been involved in the development of \nmultiple hacking tools, including RATs, worms, crypters, \nand binders. He is, however, primarily known as the \ndeveloper of njRAT, which he has distributed on private \nhacking forums and more visibly via Twitter.Trojan.Njrat \nBackdoor.Bladabindi \nTrojan.Bladabindi \nBackdoor.MSIL.Bladabindi \nTrojan.Bladabindi.F \nTrojan.Bladabindi.njRat \nTrojan.Bladabindi.DNS \nBackdoor.Bladabindi.DNS \nBackdoor.Ratenjay \nBackdoor.LV \nBackdooor.njRat.MVX \nBackdoor.njRat.MVX \nWin.Worm.Njrat-2 \nTrojan.NjRAT, Win.Worm.Njrat \nMalware.DTI.Bladabindi, \nTrojan.MSIL.Bladabindi \nHacktool.Bladabindi\nPACMANPACMAN is a backdoor designed to run as a service. Once \nactive, PACMAN calls out to a hard-coded C&C domain. \nPACMAN has the following capabilities: retrieve drive \ntypes, terminate processes, create directories, obtain a \ndirectory listing, move files, return file attributes, remove \ndirectories, create files, read files, and copy files. PACMAN \ncan also extract credentials from Internet Explorer. FE_Backdoor_Win32_PACMAN_1\nBackdoor.Win.PACMAN \nPHOTOPHOTO is a DLL backdoor that can obtain directory, file, \nand drive listings, create a reverse shell, perform screen \ncaptures, record video and audio, list, terminate, and create \nprocesses, enumerate, start, and delete registry keys and \nvalues, log keystrokes, return user names and passwords \nfrom protected storage, and rename, delete, copy, move, \nread, and write to files.Backdoor.APT.PHOTO \nFE_APT_Photos_MetadataSPECIAL REPORT |  DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION        61\nTable 15.  Malware used by APT41.\nMalware Description Detected as\nPOISONPLUGPOISONPLUG is a highly obfuscated modular backdoor \nwith plug-in capabilities. The malware is capable of registry \nor service persistence, self-removal, plug-in execution, and \nnetwork connection forwarding. POISONPLUG has been \nobserved using social platforms to host encoded C&C \ncommands.Backdoor.Win.POISONPLUG\nAPT.Backdoor.Win.POISONPLUG\nPOISONPLUG.\nSHADOWPOISONPLUG.SHADOW is a modular backdoor with plugin \ncapabilities. The first stage is shellcode, observed within \ncompromised legitimate software. It connects to a C&C \nserver for validation and configuration information to \ndownload the second stage. The second stage is a modular \nbackdoor that can download plugins for additional \nfunctionality. POISONPLUG.SHADOW is assessed as an \nevolution of the POISONPLUG family.FE_Backdoor_Win_POISONPLUG_1 \nFE_Backdoor_Win32_POISONPLUG_1\nFE_Backdoor_Win_POISONPLUG_2\nPOTROASTPOTROAST is a backdoor that connects to a hard-\ncoded C&C server. Its capabilities include downloading, \nuploading, and executing files and creating a reverse shell. FE_APT_Backdoor_Win_POTROAST_1 \nAPT.Backdoor.Win.POTROAST \nROCKBOOTROCKBOOT can access and write to the compromised \nsystem's hard disk drive beneath the operating system \nand file system to bypass the normal MBR boot sequence \nand execute malware prior to the host operating system \nbeing initialized. ROCKBOOT does not contain a malicious \npayload but relies on a secondary payload for malicious \nactivities, which is specified at install time.FE_APT_Backdoor_ROCKBOOT\nFE_Loader_Win_ROCKBOOT_1\nSAGEHIRESAGEHIRE is a multistage implant that decodes each stage \nusing shellcode and includes keylogging capabilities.FE_APT_Sunshop_Dialog\nSWEETCANDLESWEETCANDLE is a downloader that can download and \nexecute a payload received from the C&C server.FE_APT_Downloader_Win32_SWEETCANDLE_1\nFE_APT_Downloader_Win32_SWEETCANDLE_2\nAPT.Downloader.Win.SWEETCANDLE\nSOGUSOGU is a backdoor that is capable of file upload and \ndownload, arbitrary process execution, filesystem and \nregistry access, service configuration access, remote \nshell access, and implementing a custom VNC/RDP-like \nprotocol to provide the C&C server with graphical access \nto the desktop.Backdoor.APT.SOGU \nBackdoor.APT.Kaba\nTrojan.Plugx\nTERATERA is a backdoor that uses legitimate services, such \nas Google Translate and Yahoo! Babel Fish, as proxies to \ndownload C&C configurations. It also uses a rootkit to \nmask network activity. After resolving the IP address of \nits C&C server, TERA will provide an input output control \n(IOCTL) code to its driver (rootkit component). FE_APT_Backdoor_Win32_TERA_1\nFE_APT_Backdoor_Win32_TERA_2 \nFE_APT_Backdoor_Win32_TERA_3\nFE_APT_Backdoor_Win64_TERA_1\nFE_APT_Rootkit_Win64_TERA_1\nTIDYELFTIDYELF is a dropper for the WINTERLOVE backdoor. \nWINTERLOVE has been observed embedded within a \nresource within TIDYELF. TIDYELF will load the main \nWINTERLOVE component by injecting it into the iexplore.\nexe process. It will then create a registry key named \nHKLM\\SOFTWARE\\RAT to store configuration data for \nWINTERLOVE components to use.FE_APT_Dropper_Win32_TIDYELF_162\nSPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nTable 15.  Malware used by APT41.\nMalware Description Detected as\nWIDETONEWIDETONE is a command-line tool that can perform \nnetwork-based reconnaissance tasks, including port scans, \nservice banner scans, and pingscans. WIDETONE can \nbrute-force credentials for SQL servers and Inter-Process \nCommunication (IPC) shares. WIDETONE can also query \nWindows host information and perform dictionary and \nbrute-force attacks.FE_Trojan_Win_WIDETONE_1 \nFE_Trojan_Win32_WIDETONE_1\nWINTERLOVEWINTERLOVE is a backdoor used by suspected Chinese \ncyber espionage actors. WINTERLOVE attempts to load \nand execute remote code in a running process and can \nenumerate system files and directories.FE_APT_Loader_Win32_WINTERLOVE_1\nFE_APT_Keylogger_Win32_WINTERLOVE_1\nFE_APT_Loader_Win32_WINTERLOVE_2\nFE_APT_Trojan_Win32_WINTERLOVE_1\nFE_APT_Backdoor_Win32_WINTERLOVE_1\nXDOORX-Door is a full-featured remote administration tool (RAT) \nwith a configurable deployment and plug-in architecture. It \nis freely downloadable through a Chinese website, and the \ndeployment interface and server use the Chinese language. \nX-Door contains functionality for keylogging, audio and \nvideo capture, file transfers, acting as a proxy, retrieving \nsystem information, providing a reverse command \nshell, injecting DLLs, and downloading and launching \ncommands.FE_APT_Backdoor_XDOOR \nBackdoor.APT.XDOOR\nXMRIGXMRIG is an open-source Monero cryptocurrency miner. It \nhas variants for CPU, NVIDIA GPU, and AMD GPU mining.FE_Trojan_Win_XMRMiner_1 \nFE_PUP_Win_XMRig_1\nZXSHELLZXSHELL is a backdoor that can be downloaded from \nthe internet, particularly Chinese hacker websites. The \nbackdoor can launch port scans, run a keylogger, capture \nscreenshots, set up an HTTP or SOCKS proxy, launch a \nreverse command shell, cause SYN floods, and transfer/\ndelete/run files. The publicly available version of the tool \nprovides a graphical user interface that malicious actors \ncan use to interact with victim backdoors. Simplified \nChinese is the language used for the bundled ZXSHELL \ndocumentation.Backdoor.APT.ZXShell \nFE_APT_Backdoor_ZXShell \nFE_APT_ZXSHELL_1 \nFE_APT_ZXSHELL_2 \nFE_APT_ZXSHELL_3 \nFE_APT_ZXSHELL_4 \nFE_APT_ZXSHELL_5 \nFE_APT_ZXSHELL_6 \nBackdoor.APT.ZXShell.SYSINFO_Command \nBackdoor.APT.ZXShell.GETCMD_Command \nBackdoor.APT.ZXShell.FILEMG_Command \nBackdoor.APT.ZXShell.TRANSFILE_Command, \nZXSHELL RAT, Trojan.ZxShell \nBackdoor.APT.Viper \nFE_APT_VIPERSPECIAL REPORT |  DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION        63\nTECHNICAL ANNEX\nAPT41 IOCs\nTable 16.  CRACKSHOT\nFile MD5 File SHA1 File SHA256\n04fb0ccf3ef309b1cd587f609ab0e81e 44260a1dfd92922a621124640015160e621f32d5993d14d00b1463519fea78ca65d852966\n3f487cd76b67b3fd35440bcdf7a8e31\n0b2e07205245697a749e422238f9f785 dde82093decde6371eb852a5e9a1aa4acf3b56ba049a2d4d54c511b16f8bc33dae670736bf\n938c3542f2342192ad877ab38a7b5d\n272537bbd2a8e2a2c3938dc31f0d2461 a045939f53c5ad2c0f7368b082aa7b0bd7b116dad00b3edc3fe688fa035f1b919ef6e8f4\n51a9c2197ef83d9bac3fa3af5e752243\ndd792f9185860e1464b4346254b2101b a260dcf193e747cee49ae83568eea6c04bf93cb37096f1fdefa15065283a0b7928d1ab9792\n3688c7974f98a33c94de214c675567\nfcfab508663d9ce519b51f767e902806 8272c1f41f7c223316c0d78bd3bd5744e25c2e9fc667c9b2b9741247a56fcf0deebb4dc52\nb9ab4c0da6d9cdaba5461a5e2c86e0c\nTable 17.  GEARSHIFT\nFile MD5 File SHA1 File SHA256\n5b26f5c7c367d5e976aaba320965cc7f c2fb50c9ef7ae776a42409bce8ef1be464654a4e7e0c95fc64357f12e837112987333cdaf\n8c1208ef8c100649eba71f1ea90c1db\nf8c89ccd8937f2b760e6706738210744 f3c222606f890573e6128fbeb389f37bd6f6bda34aa6970cac04ace4a930de67d4c18106c\nf4004ba66670cfcdaa77a4c4821a213\nTable 18.  HIGHNOON\nFile MD5 File SHA1 File SHA256\n46a557fbdce734a6794b228df0195474 41bac813ae07aef41436e8ad22d605f786f9e09942d138d0938494fd64e1e919707e7201\ne6675b1122bf30ab51b1ae26adaec921\n77c60e5d2d99c3f63f2aea1773ed4653 ad77a34627192abdf32daa9208fbde8b4ebfb25c7566558469ede04efc665212b45786a\n730055770f6ea8f924d8c1e324cae8691\n849ab91e93116ae420d2fe2136d24a87 3f1dee370a155dc2e8fb15e776821d7697583c757cd17fc948eb5fa398b8554fea036bdb\n3c0045880e03acbe532f4082c271e3c564       SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nTable 21.  POISONPLUG\nFile MD5 File SHA1 File SHA256\n223e4cc4cf5ce049f300671697a17a01 1835c7751436cc199c55b42f34566d25fe6104cae65d39fa659f64a57ee13e8a638abd9\n031fa1486311d2782f32e979d5dee1ca5\n37e100dd8b2ad8b301b130c2bca3f1ea 32466d8d232d7b1801f456fe336615e6fa5e6ffb2eea29d83f485897e2bac9501ef000cc\n266ffe10019d8c529555a3435ac4aabd\n557ff68798c71652db8a85596a4bab72 971bb08196bba400b07cf213345f55ce0a6eedc85d971ed3947597fbb7e51d806647b37d\n64d9fe915b35c7c9eaf79a37b82dab90\n830a09ff05eac9a5f42897ba5176a36a 2366d181a1697bcb4f368df397dd0533ab8b5d2770c03ce5c80aca2d35a5555b0532eede\nde24d4cc6bdb32a2c8f7e630bba5f26e\nb0877494d36fab1f9f4219c3defbfb19 4dc5fadece500ccd8cc49cfcf8a1b59baee3382a3e6c4e97cc09d0432fbbbf3f3e424d4a\na967d3073b6002305cd6573c47f0341f\nc8403fabda4d036a55d0353520e765c9 d0429abec299ddfee7e1d9ccff1766afd4c0992b9283703dfbc642dd70c8c76675285526\n90e998bcb3f3374273c0b5c90c0d1366\nff8d92dfbcda572ef97c142017eec658 6f065eea36e28403d4d518b8e24bb7a915b612c3f4d57acde4bc546a10cd199c70cdad0\n9f576fdfe66a36b08a00c19ff6ae19661\nffd0f34739c1568797891b9961111464 82072cb53416c89bfee95b239f9a90677a0848df0055dfaccc952c99b1171ce431a02abf\nce5c6f8fb5dc39e4019b624a7d03bfcbTable 20.  JUMPALL\nFile MD5 File SHA1 File SHA256\nba08b593250c3ca5c13f56e2ca97d85eadde0644a572ed593e8b0566698d4e3de0fe\nfb8ac51c5bbc6f59407286276ce07f0f7ea9\n94e76216e0abe34cbf20f1b1cbd9446dTable 19.  HIGHNOON.BIN\nFile MD5 File SHA1 File SHA256\n36711896cfeb67f599305b590f195aec1036a7088b060250bb66b6de91f0c6ac462\ndc24c490c3e4af829e85751a44d21b25de1781\ncfe4961afdef6bb5759d9451f530994\n7d51ea0230d4692eeedc2d5a4cd66d2d 5ee7c57dc84391f63eaa3824c53cc10eafc9e38863e8ed9692810d562adb80f27bb1aeaf\n48849e468bf5fd157bc83ca83139b6d7\na0a96138b57ee24eed31b652ddf60d4e 03de2118aac6f20786043c7ef0324ef01dcf426579190925bd1c3fae65b0d11db40ac8e6\n1fb9326ccfed9b7e09084b891089602dSPECIAL REPORT |  DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION        65\nTable 22.  POISONPLUG.SHADOW\nFile MD5 File SHA1 File SHA256\n72584d6b7dd10c82d9118567b548b2b1 f067443c2c4d99dc6577006a2f105e51af731659faedf9fef6edac2f0565882112b2eae14e\ndda024239d3218a9fe9ac7e0b12db6\n97363d50a279492fda14cbab53429e75 f1a181d29b38dfe60d8ea487e8ed0ef30f064763462a02a8094e833fd456baf0a6d4e18\nbb7dab1a9f74d5f163a8334921a4ffde8\na6c7db170bc7a4ee2cdb192247b59cd6 5a85d1e19e0414fc59e454ccbaef0a3c6bb4126892cb362ae8d24c05f368d13036534fe01\n4344994d46031a0a8636a7ca0b792c6\nPhishing Payloads\nTable 23.  中東呼吸器症候群 (MERS) の予防 .7z\nFile MD5 File SHA1 File SHA256\n5e87b09f9a3f1b728c9797560a38764b 67c957c268c1e56cc8eb34b02e5c09eae62680f5354c174e583e968f0ecf86cc20d59ecd\n6e0f9d21800428453b8db63f344f0f22\nTable 24.  Documents.7z\nFile MD5 File SHA1 File SHA256\n8c6cceae2eea92deb6f7632f949293f0 b193ff40a98cd086f92893784d8896065faa3ee3bae8f4f5fc959bff980d6a6d12797b0d\n647e97cc811c5b9e827d0b985d87f68f66       SPECIAL REPORT | DOUBLE DRAGON: APT41, A DUAL ESPIONAGE AND CYBER CRIME OPERATION\nDomains\n• agegamepay[.]com\n• ageofwuxia[.]com\n• ageofwuxia[.]info\n• ageofwuxia[.]net\n• ageofwuxia[.]org\n• bugcheck.xigncodeservice[.]com\n• byeserver[.]com\n• dnsgogle[.]com\n• gamewushu[.]com\n• gxxservice[.]com\n• ibmupdate[.]com\n• infestexe[.]com\n• kasparsky[.]net\n• linux-update[.]net\n• macfee[.]ga\n• micros0ff[.]com\n• micros0tf[.]com\n• notped[.]com\n• operatingbox[.]com\n• paniesx[.]com\n• serverbye[.]com\n• sexyjapan.ddns[.]info\n• symanteclabs[.]com\n• techniciantext[.]com\n• win7update[.]net\n• xigncodeservice[.]com\nURLs\n \n \n \n \n \n Email Addresses\n• akbklxp@126[.]com\n• akbklxp@163[.]com\n• hackershby@126[.]com\n• hrsimon59@gmail[.]com\n• injuriesa@126[.]com\n• injuriesa@163[.]com\n• injuriesa@gmail[.]com\n• injuriesa@hotmail[.]com\n• injuriesa@qq[.]com\n• kbklxp@126[.]com\n• petervc1983@gmail[.]com\n• ravinder10@126[.]com\n• ravinder10@hotmail[.]com\n• ravinder10@sohu[.]com\n• wolf_zhi@yahoo[.]comFireEye, Inc.  \n601 McCarthy Blvd. Milpitas, CA 95035  \n408.321.6300/877.FIREEYE (347.3393)  \ninfo@FireEye.com  To learn more about FireEye, visit: www.FireEye.com\nAbout FireEye, Inc.  \nFireEye is the intelligence-led security company. Working as a \nseamless, scalable extension of customer security operations, FireEye \noffers a single platform that blends innovative security technologies, \nnation-state grade threat intelligence, and world-renowned Mandiant® \nconsulting. With this approach, FireEye eliminates the complexity and \nburden of cyber security for organizations struggling to prepare for, \nprevent, and respond to cyber attacks.© 2019 FireEye, Inc. All rights reserved. FireEye is \na registered trademark of FireEye, Inc. All other \nbrands, products, or service names are or may be \ntrademarks or service marks of their respective \nowners. SP.APT41. 2019.US-EN-000209-03\n"
}