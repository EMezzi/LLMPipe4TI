{
    "title": "a new exploit for zero-day vulnerability cve-2018-8589 _ securelist",
    "text": "Share post on:Yesterday, Microsoft published its security bulletin, which patches a vulnerability discovered by our technologies. We\nreported it to Microsoft on October 17, 2018. The company confirmed the vulnerability and assigned it CVE-2018-8589.\nIn October 2018, our Automatic Exploit Prevention (AEP) systems detected an attempt to exploit a vulnerability in\nMicrosoft’s Windows operating system. Further analysis revealed a zero-day vulnerability in win32k.sys. The exploit was\nexecuted by the first stage of a malware installer in order to gain the necessary privileges for persistence on the victim’s\nsystem. So far, we have detected a very limited number of attacks using this vulnerability. The victims are located in the\nMiddle East.\nKaspersky Lab products detected this exploit proactively using the following technologies:\nBehavioral Detection Engine and Automatic Exploit Prevention for endpoints\nAdvanced Sandboxing and Anti-Malware Engine for Kaspersky Anti Targeted Attack Platform (KATA)\nKaspersky Lab verdicts for the artifacts in this campaign are:\nHEUR:Exploit.Win32.Generic\nHEUR:Trojan.Win32.Generic\nPDM:Exploit.Win32.Generic\nMore information about the attack is available to customers of Kaspersky Intelligence Reports. Contact:\nintelreports@kaspersky.com\nTechnical details\nCVE-2018-8589 is a race condition present in win32k!xxxMoveWindow due to improper locking of messages sent\nsynchronously between threads.\nThe exploit uses the vulnerability by creating two threads with a class and associated window and moves the window of the\nopposite thread inside the callback of a WM_NCCALCSIZE message in a window procedure that is common to both threads.\nWM_NCCALCSIZE message in win32k!xxxCalcValidRects\nTermination of the opposite thread on the maximum level of recursion inside the WM_NCCALCSIZE callback will cause\nasynchronous copyin of the lParam structure controlled by the attacker.\nLack of proper message locking between win32k!xxxCalcValidRects and win32k!SfnINOUTNCCALCSIZE\nThe exploit populates lParam with pointers to the shellcode and after being successfully copyied to kernel inside\nwin32k!SfnINOUTNCCALCSIZE, the kernel jumps to the user level. The exploit found in the wild only targeted 32-bit\nversions of Windows 7.\nBSOD on an up-to-date version of Windows 7 with our proof of concept\nAs always, we provided Microsoft with a proof of concept for this vulnerability along with well-written source code.\nMICROSOFT WINDOWS  PROOF-OF-CONCEPT  VULNERABILITIES AND EXPLOITS  ZERO-DAY VULNERABILITIES\nRelated Posts\nLEAVE A REPLY\nYour email address will not be published.  Required fields are marked *\nEnter your comment here\nName *\nEmail *\nSave my name, email, and website in this browser for the next time I comment.\n \nSUBMIT\nI'm not a robot\nreCAPTCHA\nPrivacy  - Terms\n \nIN THE SAME CATEGORY\nAssessing the impact of protection from\nweb miners\nAgent 1433: remote attack on Microsoft\nSQL Server\nHow to steal a million (of your data)\nOn the IoT road: perks, beneﬁts and\nsecurity of moving smartly\nHow we hacked our colleague’s smart\nhome\nTHREATS\n CATEGORIES\n TAGS\n STATISTICS ENCYCLOPEDIA DESCRIPTIONS KSB 2019\nRESEARCH\nA new exploit for zero-day\nvulnerability CVE-2018-8589\nBy Boris Larin , Anton Ivanov , Vladislav Stolyarov  on November 14, 2018. 7:00 am\n \nNotify me when new comments are added.\n© 2020 AO Kaspersky Lab.  All Rights Reserved. \nRegistered trademarks and service marks are the property of their respective owners.\nContact us  | Privacy Policy  | License AgreementEmail\n I agree to provide my email address to “AO Kaspersky Lab” to\nreceive information about new posts on the site. I understand\nthat I can withdraw this consent at any time via e-mail by\nclicking the “unsubscribe” link that I find at the bottom of any e-\nmail sent to me for the purposes mentioned above.\nSUBSCRIBE\nMokes and Buerak\ndistributed under the guise\nof security certificates\nKaspersky Security Bulletin\n2019. Statistics\nWindows 0-day exploit CVE-\n2019-1458 used in\nOperation WizardOpium\nEnglish\nSolutions\n Industries\n Products\n Services\n Resource Center\n Contact Us GDPRCompanyAccount GET IN TOUCHSolutions for: Home Products  Small Business 1-50 employees Medium Business 51-999 employees Enterprise 1000+ employees\n "
}