{
    "title": "wp_ixeshe",
    "text": "Trend Micro Incorporated  \nResearch Paper  \n2012\nIXESHE\nAn APT Campaign\nBy: David Sancho, Jessa dela Torre, Matsukawa Bakuei,  \nNart Villeneuve, and Robert McArdlePAGE ii | iXESHE\nCONTENTS\nIntroduction  .................................................................................... 1\nVictims and Targets  ............................................................... 1\nContext ...................................................................................... 1\nAttack Vectors  ........................................................................ 2\nOperations  .............................................................................. 2\nTechnical Analysis ......................................................................... 2\nInitial Delivery Method  ......................................................... 2\nMalware Local System Effects  ............................................ 2\nC&C Communications  ........................................................... 3\nRelated AES Campaign  ........................................................ 4\nC&C Infrastructure  ........................................................................ 5\nReal C&C Location  ................................................................. 6Attribution and Unique Fingerprints  ........................................ 7\nUnique Fingerprints and Modus Operandi  ...................... 7\nRelationships Between Attack Components  .......................... 8\nTimeline  .......................................................................................... 12\nConclusion  ..................................................................................... 15\nDefending Against APTs  ............................................................. 15\nLocal and External Threat Intelligence  ........................... 15\nMitigation and Cleanup Strategy  ...................................... 16\nEducating Employees Against Social Engineering  .......16\nData-Centric Protection Strategy  ..................................... 16\nTrend Micro Threat Protection Against IXESHE  \nCampaign Components  .............................................................. 17PAGE 1 | iXESHEINTRODUCTION\nThe number of targeted attacks is undoubtedly on the \nrise. These highly targeted attacks focus on individual \norganizations in an effort to extract valuable information. \nIn many ways, this is a return to the “old hacking days” \nbefore more widespread attacks targeting millions of \nusers and the rise of computer worms came about. \nSometimes, these targeted attacks are allegedly linked to \nstate-sponsored activities but may also be carried out by \nindividual groups with their own goals.\nTrend Micro continues to track and analyze highly \ntargeted attacks, also known as “advanced persistent \nthreats (APTs).” We have, in fact, published two research \npapers on the Luckycat1 and Lurid2 campaigns. This \nresearch paper will delve into another prominent group of \nattackers referred to as “IXESHE” (pronounced “i-sushi”), \nbased on one of the more common detection names \nsecurity companies use for the malware they utilize. This \ncampaign is notable for targeting East Asian governments, \nelectronics manufacturers, and a telecommunications \ncompany.\nThe IXESHE campaign makes use of targeted emails with \nmalicious attachments to compromise victims’ systems. \nThe emails are often tailored for specific victims and \ncontain malicious attachments that are almost always \n“weaponized” .PDF files with known exploits that drop \nmalware executables onto targeted systems. In addition, \nthe IXESHE attackers conducted two specific attacks that \nleveraged zero-day exploits—one in 2009 and another in \n2011.\n1 http://www.trendmicro.com/cloud-content/us/pdfs/security-\nintelligence/white-papers/wp_luckycat_redux.pdf\n2 http://www.trendmicro.com/cloud-content/us/pdfs/security-\nintelligence/white-papers/wp_dissecting-lurid-apt.pdfThe IXESHE attackers almost always make use of \ncompromised servers as command-and-control (C&C) \nservers. In some cases, the compromised servers are \nhosted on target organizations’ networks after successful \ninfiltration so the attackers can increase their control \nof the victims’ infrastructure. Using this approach, the \nattackers amassed at least 60 C&C servers over time. \nThis technique also allows the attackers to cover their \ntracks, as having the C&C server in the victims’ corporate \nnetworks means very little C&C traffic leaves them. The \nattackers’ deliberate use of compromised machines and \ndynamic Domain Name System (DNS) services allows \nthem to hide traces of their presence by confusing their \nactivities with data belonging to legitimate individuals.\nLooking at threat intelligence derived from tracking APT \ncampaigns over time primarily based on the network \ntraffic generated by the malware used, we were able \nto develop indicators of compromise for the IXESHE \ncampaign. The malware samples used in this campaign \nwere not very complicated by nature but do give the \nattackers almost complete control over their targets’ \ncompromised systems.\nVictims and targets\nMost of the IP addresses of IXESHE’s victims are linked \nto DSL networks, which made it difficult to determine \ntheir identities. Careful research, however, allowed the \nidentification of some of the attackers’ victims:\n• East Asian governments\n• Taiwanese electronics manufacturers\n• A telecommunications company\nCampaign victims were identified by using Whois  records \nand open source research. Trend Micro generally notifies \ncustomers that are believed to have been specifically \ntargeted by APT campaigns.\ncontext\nThe IXESHE attackers have been actively launching highly \ntargeted attacks since at least July 2009.PAGE 2 | iXESHE\nattack Vectors\nAvailable data on the IXESHE campaign indicates that \ntargeted emails with malicious .PDF file attachments were \nthe attackers’ vector of choice. In most cases, the attacks \ninvolved Adobe Acrobat, Reader,  and Flash Player  exploits \nsuch as:\n• CVE-2009-43243\n• CVE-2009-09274\n• CVE-2011-06095\n• CVE-2011-06116\nIt should also be noted that this campaign used CVE-2009-\n43247 and CVE-2011-06098 exploits when these were still \nunpatched or considered zero-day vulnerabilities.\nThe IXESHE attackers also used an exploit that affected \nMicrosoft Excel—CVE-2009-3129.9\noperations\nThe IXESHE malware binary allowed the attackers to \neasily take over and maintain complete control of victims’ \nsystems to do the following:\n• List all services, processes, and drives\n• Terminate processes and services\n• Download and upload files\n• Start processes and services\n• Get victims’ user names\n• Get a machine’s name and domain name\n• Download and execute arbitrary files\n• Cause a system to pause or sleep for a specified \nnumber of minutes\n• Spawn a remote shell\n• List all current files and directories\n3 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-4324\n4 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0927\n5 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-0609\n6 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-0611\n7 http://contagiodump.blogspot.com/2009/12/dec-18-adobe-0-day-cve-\n2009-4324-pdf.html\n8 http://contagiodump.blogspot.ca/2011/03/cve-2011-0609-adobe-flash-\nplayer.html\n9 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3129TECHNICAL ANALYSIS\ninitial deliVery method\nEvery IXESHE case we examined revealed that the original \ninfection vector was a targeted email with a PDF exploit as \nattachment. Older versions also used an XLS exploit.\nOpening the .PDF file drops and executes a malware in a \nvictim’s system. The malware displays a blank .PDF file or a \ndecoy document related to the targeted attack. The emails \nnormally come from compromised personal accounts or \nare entirely spoofed. Emails from spoofed senders were \nusually sent via mail servers in the United States and \nChina.\nmalware  local system effects\nOnce dropped onto target systems by means of a \ndocument exploit attached to a tailored email, the malware \ndrops an executable file into one of the following folders:\n• %APPDATA%\\Locations\\\n• %APPDATA%\\Adobe\n• %TEMP%\nThe malware also sets the executable file’s attributes \nto “Hidden.” Some of the file names the attackers used \ninclude:\n• winhlps.exe\n• acrotry.exe\n• AcroRd32.exe\n• Updater.exe\nIn order for the malware to survive rebooting, it normally \ncreates the following registry run key:\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\\nCurrentVersion\\Run\nThe registry run key, in turn, points to the malware that \nhas been dropped. The value name of this entry varies \nfrom sample to sample. Some of the names the attackers \nused for it include:\n• Adobe Assistant\n• MigratedPAGE 3 | iXESHESome samples, however, do not use a registry run key as \nload point. Some of the more recent samples we observed \ncreate a shortcut (i.e., .LNK file) in the Startup  folder with \nnames such as adobe reader speed launch.lnk.\nThe malware also checks a system’s proxy settings for \nlater use in C&C communications:\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\\nCurrentVersion\\Internet Settings\nProxyEnable\nProxyServer\nc&c communications\nUpon installation, the malware starts communicating \nwith one of its C&C servers. Most of the samples \nappeared to have at least three C&C servers hard coded \nfor redundancy. The C&C communications are easy to \nidentify, as these tended to be coded in the following \npredetermined format:\nhttp://[C&C Server]/[ACD] [EW]S[Some Numbers].\njsp?[Encrypted Base64 Blob]\nSome samples alternatively use an FGKD.jsp  or an FPK.jsp  \nfile.\nThe Base64  blob is of particular interest. It makes use of a \ncustom Base64  alphabet. Once decoded, this blob reveals \na standardized structure of the information sent to the \nregistered C&C server, which includes the following details:\n• Computer name\n• Local IP address\n• Proxy server IP and port\n• Malware ID\nTo date, we have seen several custom Base64  alphabets, \nincluding:\n• +NO5RZaGHviIjhYq8b4ndQ=p012ySTcCDrs/xPgUz67F  \nM3wemKfkJLBo9VtWXlEuA\n• HZa4vjIiGndQ=p012y+NO5RST/xPgUz67FMhYq8b3we  \nmKfkJLBocCDrs9VtWXlEu\n• j4vpGZaHnIdQ=i012y+N/zPgUO5RSTx67FMhYb8q3we  \nmKckJLBofCDrs9VtWXlEu\n• p12kJLBofCDrs9VtWXlEuainyj4vd+=H0GZIQNO5RST/\nzPgUx67FMhYb8q3wemKc\n• aZHGviIj4ndQ=p012y+NO5RST/xPgUz67FMhYq8b3we  \nmKfkJLBocCDrs9VtWXlEu\n• ZvQIajHi4ndG=p012y+NO5RST/xPgUz67FMhYq8b3we  \nmKfkJLBocCDrs9VtWXlEu• ZaGHviIj4ndQ=p012y+NO5RST/xPgUz67FMhYq8b3we  \nmKfkJLBocCDrs9VtWXlEu\n• 4HIvZGjaiQdn=p012y+NO5RST/xPgUz67FMhYq8b3we  \nmKfkJLBocCDrs9VtWXlEu\n• pGIaHnZj0vdQ=i421y+NO5RSY /zMgUx67KPhTb8q3we  \nmFckBLJufWErs9VtCXlDo\n• QpaZIivj4ndG=H021y+NO5RST/xPgUz67FMhYq8b3we  \nmKfkJLBocCDrs9VtWXlEu\n• pGZaHnIj4vdQ=i012y+NO5RST/zPgUx67FMhYb8q3we  \nmKckJLBofCDrs9VtWXlEu\nSome similarities exist across different versions of the \nBase64  alphabet, which indicates that these are most \nlikely not completely randomly generated. Instead, the \nattackers manually cut and pasted older versions after \naltering some parts.\nThe malware ID seems to be a campaign code with a \ndifferent IP address for each attack. Some of the campaign \ncodes we have seen include:\n• 19\n• [0222]\n• [0713]\n• [0802]\n• [CR1008]\n• [CR1031]\n• [CZ0312]\n• [CZ0913]\n• [CZ0921]\n• [LY]MAIL_20090923\n• [LY]MAIL_20091015\n• [LY]MAIL_20091208\n• [LY0406]\n• [LY0420]\n• [LY0816]\n• [LY1207]\n• [TL1109]\n• [WH0827]\n• [WH1122]\n• [WL1013]\n• [WZ1011]\n• CRML_0505\n• CRML_MIL\n• Firebox4\n• JUST_0525\n• JUST_JP_6080\n• KA_1016• KS_0602\n• KSX_0520\n• LY_ML0430_30m\n• ly0610\n• MAIL_20091208\n• MAIL_JAP_0220\n• MAIL_JAP_0304\n• MAIL_JAP_0325\n• MAIL_JAP_0407\n• MAIL0524\n• manufact\n• ML_20091223\n• ML0419._30m\n• ML0623.LINK_10m\n• ML0628\n• ML_20091216\n• ML_20091223\n• MW0629\n• OM222\n• sandbox\n• sandbox4\n• sandbox6\n• success\n• UNKNOWN\n• wl0711\n• ZWJP_KS_1222\nIt appears that the numbers in the given campaign codes \nrefer to dates when the campaigns were launched in \n“MMDD” format. The letters are possibly related to the \ntarget industry or company.PAGE 4 | iXESHE\nIf the malware does not get a response from the C&C \nserver, it will choose another random number after the \nAWS part of the URL and try again.\nOnce connected, the malware specifically waits for the \nremote server to issue the following commands, which \nmay vary from one version to another:\n•\tdel\t[parameter]:  Allows a remote user to delete files.\n•\tdisk\t[parameter]:  Lists all available drives.\n•\tdos\t[parameter]:  Allows a remote user to execute \ncommands via cmd.exe.\n•\tget\t[parameter]:  Allows a remote user to download a \nfile from the remote server onto a local machine.\n•\tlist\t[parameter]:  Lists files on the victim’s machine.\n•\tls\t[parameter]:  Allows a remote user to display the \ncontents of a directory.\n•\tkill\t[parameter]:  Allows a remote user to terminate \nprocesses.\n•\tput\t[parameter]:  Allows a remote user to upload a file \nfrom a local machine to a remote server.\n•\trsh\t[parameter]:  Similar to the sh or dos [parameter]  \nexcept for the fact that this is an already-existing file \nor shell.\n•\trun\t[parameter]:  Allows a remote user to execute \nprograms.\n•\tsh\t[parameter]:  Allows a remote user to execute \ncommands via cmd.exe.\n•\tsleep\t[parameter]:  Causes a system to sleep for a \ncertain amount of time.related  aes c ampaign\nWe have also been tracking another campaign, which \nwe refer to as the “AES campaign,” which appears to be \nrelated to IXESHE. The main body of the malware related \nto the IXESHE campaign can be identified by its connection \nto a C&C server using a file such as AWS12345.jsp  and a \ncustom Base64  blob; the malware associated with the \nAES campaign operates very similarly. The samples used \nin the AES campaign slightly differed in terms of C&C \ncommunication but had significant similarities with IXESHE \nmalware, which used the format:\nhttp://[C&C Server]/[ACD] ES[Some Numbers].jsp\nEven though the network traffic format of the AES \ncampaign was slightly similar, instead of the more familiar \nAWS[random].jsp  format, it used several other formats for \ncertain commands or events such as:\n• AES: Initial beacon.\n• DES: Send the path of %systemdir%.\n• PES: Send the result of the “put” command.\n• SEU: Send the “error” or “invalid” command.\n• SUS: Send the system name, which is not encoded, \nupon receiving the “exit” command.\n• ZES: Send the result of the “dos” command.\nAnother difference in the traffic is that AWS uses the POST \nmethod with the format, “http://[C&C Server]/FPK [Some \nNumbers].jsp?[Base64 Blob],”  when the “get” command is \ninvoked. The Base64  blob contains the file specified in the \n“get” command.\nAnalysis of the binaries also revealed similarities between \nthe AES and AWS samples. These included the encoding \nalgorithm and commands used. Even though some \ncommands varied, the format and parameters used \nessentially remained the same.PAGE 5 | iXESHEC&C INFRASTRUCTURE\nThe majority of the IXESHE campaign’s C&C servers were based in Taiwan and the United States.\nFigure 1. Breakdown of C&C servers by country\nPAGE 6 | iXESHE\nThis is, however, not an indicator of attribution. It is not \npossible to determine where the attackers are based solely \non where their C&C infrastructures are located. In addition, \nnot all of the C&C servers are currently active. Many, if \nnot all of them, appear to be compromised machines. In \nfact, at least 11 of the C&C servers were hosted on the \ncompromised machines of an East Asian government, \nwhich made these very useful for launching targeted \nattacks against it.\nMost of the malware samples directly accessed an IP \naddress as a C&C server. Connections to domains did \nexist in some cases. The domains were usually registered \nusing free dynamic DNS service providers or compromised \nwebsites.\nOverall, this strategy was part of the attackers’ modus \noperandi. By choosing compromised machines to act as \nC&C servers, fewer clues were left for investigators to \nfollow in an attempt to find out who is behind the attacks \ncompared with those using bulletproof hosting services \nand registered domain names. To conduct research on \nthese servers, investigators need to differentiate between \ninformation related to malicious and legitimate use.\nreal c&c location\nOne very interesting error revealed more insights into \nthe C&C network’s setup. One of the malware samples we \ntested was designed to access xxx.xxawan.com  via port \n443, which, at that time, resolved to xx.xxx.114.87:443,  a \nserver located in the United States. The sample, however, \nreceived the following error message from the server:\n[SERVER]connection to xx.xx.x2.202:56413 errorThis indicated that the front-end servers actually \nfunctioned as proxy servers and that the true C&C servers \nwere hidden behind this initial group of C&C servers. \nThis made the network more resistant to takedown and \nanalysis. Due to a server error, however, the attackers \nrevealed the location of one of their back-end servers. We \ndiscovered that the IP address, xx.xx.x2.202,  is located in \nGuangdong, China.\nThe particular error returned looked very similar to errors \ngenerated by a tool called “HTran.”10 HTran  stands for \n“HUC Packet Transmit Tool,”  a connection bouncer that \nredirects TCP traffic destined for one host to an alternate \nhost, keeping the real host hidden from view. “HUC,” in \nthis case, stands for the hacking group, “Honker Union \nof China.” It was coded by a hacker who goes by the \nhandle “lion.” This tool’s error-checking code, however, is \nflawed. Assuming that everything properly works, the tool \nfunctions very well as a proxy server but if the real server \nis currently inaccessible, HTran  will send an error message, \nrevealing its whereabouts.\nRunning a port scan on this server revealed some open \nports shown in the table below.\nPort State Service\n80/tcp Open HTTP\n8080/tcp Open HTTP Alternative\nBased on OS fingerprinting, the server appears to be \nrunning Windows 7 Enterprise Server.  With only a few \nopen ports, however, it was very difficult to confirm this. In \naddition, we did not receive a response when we tried to \nconnect to these ports.\n10 http://www.secureworks.com/research/threats/htran/PAGE 7 | iXESHEATTRIBUTION AND UNIQUE \nFINGERPRINTS\nPrevious research on the IXESHE campaign indicated \nseveral connections to groups possibly from China. In \naddition, the IP address hiding behind the HTran  instance \nwas an IP range assigned to China.\nUpon further investigation of the “manufact” campaign, \nhowever, it appears that the gang behind it may be English \nspeakers. The name of the campaign, for one, is most likely \na shortened form of “manufacturing.” The OS the C&C \nserver uses is also an English install of Microsoft XP.  It is \nalso likely, of course, that the C&C server is a compromised \nmachine so it does not use the attackers’ first language.\nThe malware samples, which appear to have been \ndeveloped using C++,  had a number of strings and error \ncodes in English such as “Enter command” and “Receive \ncommand error!”\nThe date format used in the campaign codes (i.e., MMDD) \nalso provided us a clue as to where the attackers may be \nfrom. This date format is only commonly used in China, \nKorea, Iran, Japan, Hungary, Lithuania, and the United \nStates.\nBased on the limited amount of information we gathered \nabout the attackers, it was very difficult to pinpoint their \nexact location. \nunique fingerprints  and modus operandi\nAn attack can be considered associated with the gang \nbehind the IXESHE campaign if it exhibits the following \ncharacteristics:\n• Uses a specially crafted targeted email with a \nmalicious file attachment\n• Uses document exploits, primarily .PDF files, to drop \nmalware into target systems\n• Uses malware detected by security vendors as IXESHE \nvariants\n• Uses a malware that sends a GET request to the C&C \nserver in the following format:\nhttp://[C&C Server]/[ACD] [EW]S[Some \nNumbers].jsp?[Encrypted Base64 Blob]\n• Uses dynamic DNS services for or compromised \nmachines as C&C serversPAGE 8 | iXESHE\nRELATIONSHIPS BETWEEN ATTACK COMPONENTS\nFigure 2. IXESHE targeted campaign #1\nFigure 3. IXESHE targeted campaign #2\nPAGE 9 | iXESHEFigure 4. IXESHE targeted campaign #3\nPAGE 10 | iXESHEFigure 5. IXESHE targeted campaign #4\nFigure 6. IXESHE targeted campaign #5\nPAGE 11 | iXESHEPAGE 12 | iXESHE\nTIMELINE\nThis section lists known incidents exhibiting the same \nthreat actor behaviors and so may be from the same \ngroup behind IXESHE dating to as far back as July \n2009. With the exception of the samples described in \nContagioDump,  the dates for other samples refer to when \nthe respective sandboxes saw them for the first time. As \nsuch, these dates should be considered “at least by” and \nnot the actual date of the attack.\n• 15 October 2009\n• PDF name/Subject hook: 中共二炮部隊導彈之發展\n• MD5: 16a9f340c0d353332ba6f525376c93e1\n• C&C: xxxxxupsenter.byinter.net\n• Info: http://contagiodump.blogspot.com/2009/12/\noct-15-2009-attack-of-day-development.html\n• Campaign code: [LY]MAIL_20091015\n• 18 December 2009\n• PDF name/Subject hook: 女兵脫衣比中指 拍照PO\n上網\n• MD5: 8950bbedf4a7f1d518e859f9800f9347\n• C&C: xxxxxfo.athersite.com\n• Info: http://contagiodump.blogspot.com/2009/12/\ndec-18-adobe-0-day-cve-2009-4324-pdf.html\n• Campaign code: ML_20091216\n• 28 December 2009\n• PDF name/Subject hook: Consumer Welfare Table\n• MD5: c61c231d93d3bd690dd04b6de7350abb\n• C&C: xxx.xx6.148.42 or xxx.xx6.202.49\n• Info: http://contagiodump.blogspot.com/2009/12/\ndec-29-cve-2009-4324-adobe-0-day.html\n• Campaign code: ML_20091223\n• 26 April 2010\n•\tPDF\tname/Subject\thook:  [研討會]開南大學公共事\n務管理學系第五屆「全球化與行政治理」國際學術\n研討會\n•\tMD5:  58de08c1155a775b760049dff3f5abe4\n•\tC&C:  xxx.x.x5.26\n•\tInfo:  http://contagiodump.blogspot.com/2010/04/\napr-26-cve-2009-4324-w-low-detection.html\n•\tCampaign\tcode:  ML0419._30m• 6 May 2010\n•\tPDF\tname/Subject\thook:  蔡政文教授七十華誕系列\n活動簡報\n•\tMD5:  d80eb21cfe8ad1a710c8652b13f8b7ac\n•\tC&C:  xxx.xx9.124.13\n•\tInfo:  http://contagiodump.blogspot.com/2010/05/\nmay-6-cve-2010-0188-pdf-birthday.html\n•\tCampaign\tcode:  LY_ML0430_30m\n• 10 May 2010\n•\tXLS\tname/Subject\thook:  99下半年國防工業評鑑\n日期表\n•\tMD5:  d4b98bda9c3ae0810a61f95863f4f81e\n•\tC&C:  xxxxx.compreautos.com.br\n•\tInfo:  http://contagiodump.blogspot.com/2010/06/\nmay-10-cve-2009-3129-xls-schedule-of.html\n•\tCampaign\tcode:  CRML_0505\n• 8 June 2010\n•\tXLS\tname/Subject\thook:  天安艦後的朝鮮半島新\n局勢\n•\tMD5:  100cf902ac31766f7d8a521eeb6f8d68\n•\tC&C:  xxx.xx.187.130\n•\tInfo:  http://contagiodump.blogspot.com/2010/06/\njun-8-cve-2009-4324-korean-peninsula.html\n•\tCampaign\tcode:  MAIL0524\n• 27 June 2010\n•\tPDF\tname/Subject\thook:  Discussion on Cross-\nStrait Maritime Cooperation\n•\tMD5:  6e14c7a424c2eef7f37810ff65650837\n•\tC&C:  xxx.xx.128.71\n•\tInfo:  http://contagiodump.blogspot.com/2010/07 /\njun-27-cve-2009-0927-pdf-discussion-on.html\n•\tCampaign\tcode:  ML0628\n• 1 July 2010\n•\tPDF\tname/Subject\thook:  第五次江陳會談成果記者\n會本會賴主委講話稿\n•\tMD5:  949265ee1d3e587152a23311a85b3be9\n•\tC&C:  xxx.xx.128.71\n•\tInfo:  http://contagiodump.blogspot.com/2010/07 /\njul-01-cve-2009-4324-results-of-press.html\n•\tCampaign\tcode:  ML0628PAGE 13 | iXESHE• 28 July 2010\n•\tPDF\tname/Subject\thook:  Summary of Network \nIntelligence\n•\tMD5:  738af108a6edd46536492b1782589a04\n•\tC&C:  xxx.xx6.54.189\n•\tInfo:  http://contagiodump.blogspot.com/2010/08/\njul-28-cve-2009-4324-pdf-990729-romance.html\n•\tCampaign\tcode:  [0713]\n• 16 August 2010\n•\tPDF\tname/Subject\thook:  Communist China \nRemoves Missiles\n•\tMD5:  6227e1594775773a182e1b631db5f6bb\n•\tC&C:  xxxxxck.dnsrd.com or xxx.xx6.34.94 (appears \nto be a compromised computer of an East Asian \nuniversity)\n•\tInfo:  http://contagiodump.blogspot.com/2010/08/\ncve-2009-4324-cve-2010-1297-communist.html\n•\tCampaign\tcode:  [0802]\n• 17 August 2010\n•\tPDF\tname/Subject\thook:  [Unknown]\n•\tMD5:  36ee61663fc41496642850c4293fed01\n•\tC&C:  xxxxxck.dnsrd.com or xxx.xx6.34.94 (appears \nto be a compromised computer of an East Asian \nuniversity)\n•\tInfo:  http://www.threatexpert.com/report.aspx?md\n5=36ee61663fc41496642850c4293fed01\n•\tCampaign\tcode:  [0802]\n• 27 September 2010\n•\tPDF\tname/Subject\thook:  [Unknown]\n•\tMD5:  313158192d4442013f7bedeb9def01ec\n•\tC&C:  xx.xx.x3.102\n•\tInfo:  http://www.threatexpert.com/report.aspx?md\n5=313158192d4442013f7bedeb9def01ec\n•\tCampaign\tcode:  [WH0827]\n• 22 February 2011\n•\tPDF\tname/Subject\thook:  [Unknown]\n•\tMD5:  cd0eb6634ea684313389ddce553a6130\n•\tC&C:  xxx.xx.228.58\n•\tInfo:  http://xml.ssdsandbox.net/view/\ncd0eb6634ea684313389ddce553a6130\n•\tCampaign\tcode:  [0222]\n• 17 March 2011\n•\tXLS\tname/Subject\thook:  Japan Nuclear Radiation \nLeakage and Vulnerability Analysis\n•\tMD5:  7ca4ab177f480503653702b33366111f\n•\tC&C:  xx.xxx.114.44\n•\tInfo:  http://contagiodump.blogspot.com/2011/03/\ncve-2011-0609-adobe-flash-player.html\n•\tCampaign\tcode:  OM222• 10 April 2011\n•\tPDF\tname/Subject\thook:  [Unknown]\n•\tMD5:  711542d883f8fca4aeac62ee1b7df6ca\n•\tC&C:  xx.xx.x0.244\n•\tInfo:  http://www.threatexpert.com/report.aspx?md\n5=711542d883f8fca4aeac62ee1b7df6ca\n•\tCampaign\tcode:  [LY0406]\n• 20 April 2011\n•\tPDF\tname/Subject\thook:  China’s Charm \nDiplomacy in BRICS Summit\n•\tMD5:  ae39b747e4fe72dce6e5cdc6d0314c02\n•\tC&C:  xx.xx.x9.165\n•\tInfo:  http://contagiodump.blogspot.com/2011/04/\napr-20-cve-2011-0611-pdf-swf-chinas.html\n•\tCampaign\tcode:  [Removed due to privacy \nconcerns]\n• 20 April 2011\n•\tPDF\tname/Subject\thook:  The Obama \nAdministration and the Middle East\n•\tMD5:  2368a8f55ee78d844896f05f94866b07\n•\tC&C:  xx.xx.x9.165\n•\tInfo:  http://contagiodump.blogspot.com/2011/04/\napr-20-cve-2011-0611-pdf-swf-chinas.html\n•\tCampaign\tcode:  {Removed due to privacy \nconcerns]\n• 20 April 2011\n•\tPDF\tname/Subject\thook:  Russia’s profit from \ngeneral NATO disunity\n•\tMD5:  4065b98fdcb17a081759061306239c8b\n•\tC&C:  xx.xx.x9.165\n•\tInfo:  http://contagiodump.blogspot.com/2011/04/\napr-20-cve-2011-0611-pdf-swf-chinas.html\n•\tCampaign\tcode:  [Removed due to privacy \nconcerns]\n• 22 April 2011\n•\tPDF\tname/Subject\thook:  Marshall Plan for the \nNorth Africa\n•\tMD5:  6d5fb801b890bfa7cc737c018e87e456\n•\tC&C:  xx.xx.x9.165\n•\tInfo:  http://contagiodump.blogspot.com/2011/04/\napr-22-cve-2011-0611-pdf-swf-marshall.html\n•\tCampaign\tcode:  [Removed due to privacy \nconcerns]PAGE 14 | iXESHE\n• 28 April 2011\n•\tPDF\tname/Subject\thook:  [Unknown]\n•\tMD5:  14bf72167b4e801da205ecf9c0c55f9b\n•\tC&C:  xx.xx.x33.2\n•\tInfo:  http://xml.ssdsandbox.net/view/14bf72167b4e\n801da205ecf9c0c55f9b\n•\tCampaign\tcode:  [LY0420]\n• 1 June 2011\n•\tPDF\tname/Subject\thook:  [Unknown]\n•\tMD5:  6ee4e08e6ab51208757fdc41d0e72846\n•\tC&C:  xxxxxain.qpoe.com\n•\tInfo:  http://www.threatexpert.com/report.aspx?md\n5=6ee4e08e6ab51208757fdc41d0e72846\n•\tCampaign\tcode:  [LY]MAIL_20090923\n• 9 June 2011\n•\tPDF\tname/Subject\thook:  [Unknown]\n•\tMD5:  10f193f825ada183fcfd067434ca269e\n•\tC&C:  xxxxxfo.AtHerSite.com\n•\tInfo:  http://www.threatexpert.com/report.aspx?md\n5=10f193f825ada183fcfd067434ca269e\n•\tCampaign\tcode:  [LY]MAIL_20091208\n• 21 September 2011\n•\tPDF\tname/Subject\thook:  [Unknown]\n•\tMD5:  32522cdc17a145486e26f35bdd524e7e\n•\tC&C:  xxx.xx0.139.67\n•\tInfo:  http://www.threatexpert.com/report.aspx?md\n5=32522cdc17a145486e26f35bdd524e7e\n•\tCampaign\tcode:  [LY0816]\n• 12 October 2011\n•\tPDF\tname/Subject\thook:  [Unknown]\n•\tMD5:  8718ab5c1683a69c4e6092fdcb32cfa2\n•\tC&C:  xxx.xx0.63.1\n•\tInfo:  http://www.malware-control.com/statics-page\ns/8718ab5c1683a69c4e6092fdcb32cfa2.php\n•\tCampaign\tcode:  [CZ0921]\n• 19 October 2011\n•\tPDF\tname/Subject\thook:  [Unknown]\n•\tMD5:  80dad66d6224d18babd9ada4a26aee75\n•\tC&C:  xx.xxx.21.41 or king.pirat3.com\n•\tInfo:  http://xml.ssdsandbox.net/view/80dad66d62\n24d18babd9ada4a26aee75\n•\tCampaign\tcode:  [WZ1011]• 26 October 2011\n•\tPDF\tname/Subject\thook:  The Future Redefined \n2011 AOEC CEO Summit\n•\tMD5:  3d91d9df315ffeb9bb1c774452b3114b\n•\tC&C:  xxx.xxawan.com or xxx.xx4.230.120\n•\tInfo:  http://www.kahusecurity.com/2011/apec-\nspearphish-2/\n•\tCampaign\tcode:  19\n• 3 November 2011\n•\tPDF\tname/Subject\thook:  [Unknown]\n•\tMD5:  E25DBA0556124D7874D8416DE291CFE2\n•\tC&C:  xxxxxfo.sdti.tw or xxx.xx2.246.110\n•\tInfo:  http://www.threatexpert.com/report.aspx?md\n5=e25dba0556124d7874d8416de291cfe2\n•\tCampaign\tcode:  [CR1031]\n• 15 November 2011\n•\tPDF\tname/Subject\thook:  [Unknown]\n•\tMD5:  829b78f1d1e74c2c5343a0aebb51f519\n•\tC&C:  xxxxxaga.chickenkiller.com\n•\tInfo:  http://www.threatexpert.com/report.aspx?md\n5=829b78f1d1e74c2c5343a0aebb51f519\n•\tCampaign\tcode:  [TL1109]\n• 22 November 2011\n•\tPDF\tname/Subject\thook:  [Unknown]\n•\tMD5:  c4a05230a898d91b30c88d52b3f069b3\n•\tC&C:  xxx.xx6.54.150 or xxxxx.ItemDB.com\n•\tInfo:  http://www.threatexpert.com/report.aspx?md\n5=c4a05230a898d91b30c88d52b3f069b3\n•\tCampaign\tcode:  [WH1122]PAGE 15 | iXESHECONCLUSION\nThe IXESHE campaign has been successfully executing \ntargeted attacks since 2009. The attackers primarily \nuse malicious .PDF files that exploit vulnerabilities in \nAdobe Reader, Acrobat,  and Flash Player,  including the \nuse of two zero-day exploits—one in 2009 and another \nin 2011. While the attackers primarily targeted East \nAsian governments in the past, they have also started \ntargeting a telecommunications company and electronics \nmanufacturers. They kept track of their targeted attacks \nby embedding a “campaign tag” in the malware that \nappears to describe when each attack was launched and, \nin some cases, the nature of its target. We found more \nthan 40 of these campaign tags.\nThe IXESHE attackers are notable for their use of \ncompromised machines within a target’s internal network \nas C&C servers. This helped disguise their activities. In \naddition, the attackers’ use of the proxy tool, HTran,  also \nhelped mask their true location. While their identities \nremain unknown, the attackers behind the IXESHE \ncampaign demonstrated that they were both determined \nand capable. While the malware used in the attacks \nwere not very complicated by nature, these proved very \neffective. This campaign remains an active threat.DEFENDING AGAINST APTS\nSufficiently motivated threat actors can penetrate \neven networks that use moderately advanced security \nmeasures. As such, apart from standard and relevant \nattack prevention measures and mechanisms such as \nsolid patch management; endpoint and network security; \nfirewall use; and the like, enterprises should also focus \non detecting and mitigating attacks. Moreover, data \nloss prevention (DLP) strategies that identify the data \nan organization is protecting and take into account the \ncontext of data use should be employed.\nlocal and external  threat intelligence\nThreat intelligence refers to indicators that can be used \nto identify the tools, tactics, and procedures threat actors \nengaging in targeted attacks utilize. Both external and \nlocal threat intelligence is crucial for developing the \nability to detect attacks early. The following are the core \ncomponents of this defense strategy:\n• Enhanced\tvisibility:  Logs from endpoint, server, \nand network monitoring are an important and often \nunderused resource that can be aggregated to provide \na view of the activities within an organization that \ncan be processed for anomalous behaviors that can \nindicate a targeted attack.\n• Integrity\tchecks:  In order to maintain persistence, \nmalware will make modifications to the file system and \nregistry. Monitoring such changes can indicate the \npresence of malware.\n• Empowering\tthe\thuman\tanalyst:  Humans are best \npositioned to identify anomalous behaviors when \npresented with a view of aggregated logs from across \na network. This information is used in conjunction with \ncustom alerts based on the local and external threat \nintelligence available.\nTechnologies available today such as Deep Discovery  \nprovide visibility, insight, and control over networks to \ndefend against targeted threats.11 Deep Discovery  uniquely \ndetects and identifies evasive threats in real time and \nprovides in-depth analysis and actionable intelligence to \nprevent, discover, and reduce risks.\n11 http://www.trendmicro.com/us/enterprise/security-risk-management/\ndeep-discovery/index.htmlPAGE 16 | iXESHE\nmitigation  and cleanup  strategy\nOnce an attack is identified, the cleanup strategy should \nfocus on the following objectives:\n• Determine the attack vector and cut off \ncommunications with the C&C server.\n• Determine the scope of the compromise.\n• Assess the damage by analyzing the data and forensic \nartifacts available on compromised machines.\nRemediation should be applied soon afterward, which \nincludes steps to fortify affected servers, machines, or \ndevices into secure states, informed in part by how the \ncompromised machines were infiltrated.\neducating  employees  against  social \nengineering\nSecurity-related policies and procedures combined with \neducation and training programs are essential components \nof defense. Traditional training methods can be fortified \nby simulations and exercises using real spear-phishing \nattempts sent to test employees. Employees trained to \nexpect targeted attacks are better positioned to report \npotential threats and constitute an important source of \nthreat intelligence.data-centric  protection  strategy\nThe ultimate objective of targeted attacks is to acquire \nsensitive data. As such, DLP strategies that focus on \nidentifying and protecting confidential information are \ncritical. Enhanced data protection and visibility across \nan enterprise provides the ability to control access to \nsensitive data as well as monitor and log successful and \nunsuccessful attempts to access it. Enhanced access \ncontrol and logging capabilities allow security analysts to \nlocate and investigate anomalies, respond to incidents, and \ninitiate remediation strategies and damage assessment.PAGE 17 | iXESHETREND MICRO THREAT PROTECTION AGAINST IXESHE CAMPAIGN \nCOMPONENTS\nThe following table summarizes the Trend Micro solutions for the components of the IXESHE campaign. Trend Micro \nrecommends a comprehensive security risk management strategy that goes further than advanced protection to meet \nthe real-time threat management requirements of dealing with targeted attacks.\nAttack Component Protection Technology Trend Micro Solution\nPredetermined C&C communication \nformat:\nhttp://[C&C Server]/\n[ACD] [EW]S[Some Numbers].\njsp?[Encrypted Base64 Blob]Web Reputation Endpoint (Titanium, Worry-Free Business \nSecurity, OfficeScan)\nServer (Deep Security)\nMessaging (InterScan Messaging Security, \nScanMail Suite for Microsoft Exchange)\nNetwork (Deep Discovery)\nGateway (InterScan Web Security, \nInterScan Messaging Security)\nMobile (Mobile Security)\nTROJ_PIDIEF, BKDR_PROXY, TROJ_\nDROPR, and TROJ_DEMTRANC variantsFile Reputation\n(Antivirus/Anti-malware)Endpoint (Titanium, Worry-Free Business \nSecurity, OfficeScan)\nServer (Deep Security)\nMessaging (InterScan Messaging Security, \nScanMail Suite for Microsoft Exchange)\nNetwork (Deep Discovery)\nGateway (InterScan Web Security, \nInterScan Messaging Security)\nMobile (Mobile Security)\nCVE-2009-4324\nCVE-2009-0927\nCVE-2011-0609\nCVE-2011-0611\nCVE-2009-3129Vulnerability Shielding/Virtual Patching Server (Deep Security)\nEndpoint (OfficeScan with Intrusion \nDefense Firewall Plug-In)\nFor CVE-2009-4324:\n• Rule #1004008 (Adobe Reader  and \nAcrobat  ‘newplayer()’ JavaScript \nMethod Code Execution)\nFor CVE-2009-0927:\n• Rule # 1003405 (Adobe Acrobat  \nJavaScript getIcon Method Buffer \nOverflow)\nFor CVE-2011-0609:\n• Rule #1004615 (Adobe Flash Player  \nXLS Remote Code Execution)\nFor CVE-2011-0611:\n• Rule # 1004647 (Restrict Microsoft \nOffice  File with Embedded SWF)\nFor CVE-2009-3129:\n• Rule #1003817 (Excel  Featheader \nRecord Memory Corruption \nVulnerability)PAGE 18 | iXESHE\nAttack Component Protection Technology Trend Micro Solution\nxxx.x.x87.206\nxxx.xx2.36.5\nxxx.xx6.129.228\nxxx.xx0.139.67\nxxx.xx.39.184\nxx.xxx.12.18\nxxx.xxrver.us\nxxx.xxt-alice.de\nxxxxxbaby.mooo.com\nxxxxxlic.yahoobigdeals.com\nxx.xx.x1.252\nxxx.xx.228.58\nxxx.xx.183.86\nxxx.xx.128.71\nxxx.xx.13.148\nxxx.xx5.243.44\nxxx.xx2.216.5\nxxx.xx.151.190\nxxx.xx.63.113\nxxx.xx.58.110\nxxx.xx.111.151\nxxx.xx6.54.150\nxxx.xx4.230.120\nxxx.xx0.139.67\nxxx.xx2.246.110\nxx.xxx.223.3\nxx.xx.x3.102\nxx.xx.x9.165\nxx.xx.x0.244\nxx.xx.x33.2\nxxxxxa.2waky.com\nxxx.xxawan.com\nxxxxxmic.dyndns-wiki.com\nxxxxxain.qpoe.com\nxxx.xxrver.us\nxxxxxfo.AtHerSite.com\nxxxxxem.passingg.as\nxxx.xxset.com\nxxxxx.dnset.com\nxxxx.xirat3.com\nxxxxxaga.chickenkiller.com\nxxxxx.otzo.com\nxxxxxck.dnsrd.com\nxxxxx.portrelay.com\nxxxxx.FindHere.orgWeb, Domain, and IP Reputation Endpoint (Titanium, Worry-Free Business \nSecurity, OfficeScan)\nServer (Deep Security)\nMessaging (InterScan Messaging Security, \nScanMail Suite for Microsoft Exchange)\nNetwork (Deep Discovery)\nGateway (InterScan Web Security, \nInterScan Messaging Security)\nMobile (Mobile Security)\nPAGE 18 | iXESHEMay 2012   |   APT Campaign Quick Profile: IXESHE\nAdvanced persistent threats (APTs) refer to a category of threats that aggressively pursue and compromise specific \ntargets to maintain persistent presence within the victim’s network so they can move laterally and exfiltrate data. \nUnlike indiscriminate cybercrime attacks, spam, web threats, and the like, APTs are much harder to detect because \nof the targeted nature of related components and techniques. Also , while cybercrime focuses on stealing credit card \nand banking information to gain profit, APTs are better thought of as cyber espionage.\nIXESHE\n•\tFirst\tSeen\nIndividual targeted attacks are not one-off attempts. Attackers continually try to get inside the target’s network.\nThe IXESHE campaign has been actively staging targeted attacks since at least July of 2009.\n•\tVictims\tand\tTargets\nAPT campaigns target specific industries or communities of interest in specific regions.\nIXESHE has been found to target electronics manufacturers, a telecommunications company, and East Asian governments.\n•\tOperations\nFirst-stage computer intrusions often use social engineering. Attackers custom-fit attacks to their targets.\nIXESHE attacks used custom-fit targeted emails with PDF exploits for CVE-2009-4324, CVE-2009-0927 , CVE-2011-0609,  and CVE-2011-0611.  These \nwere used to drop malicious executable files that gave the attackers complete control of their targets’ systems.\nThe attackers used either dynamic Domain Name System (DNS) or compromised servers hosted on networks that they previously successfully  \ninfiltrated.\n•\tPossible\tIndicators\tof\tCompromise\nAttackers want to remain undetected as long as possible. A key characteristic of these attacks is stealth.\n »Enters networks via a specially crafted, targeted email with a malicious file attachment\n »Uses document exploits (primarily PDF exploits) to drop malware onto target systems\n »Uses malware detected as IXESHE by security companies\n »Sends a GET request to the command-and-control (C&C) server with the format:\nhttp://[C&C Server]/[ACD] [EW]S[Some Numbers].jsp?[Encrypted Base64 Blob]\n* The campaign codes we have seen so far are detailed in the Trend Micro research paper, “IXESHE: An APT Campaign.” The characteristics \n highlighted in this APT campaign quick profile reflect the results of our investigation as of May 2012.May 2012   |   APT Campaign Quick Profile: IXESHE\nAdvanced persistent threats (APTs) refer to a category of threats that aggressively pursue and compromise specific \ntargets to maintain persistent presence within the victim’s network so they can move laterally and exfiltrate data. \nUnlike indiscriminate cybercrime attacks, spam, web threats, and the like, APTs are much harder to detect because \nof the targeted nature of related components and techniques. Also , while cybercrime focuses on stealing credit card \nand banking information to gain profit, APTs are better thought of as cyber espionage.\nIXESHE\n•\tFirst\tSeen\nIndividual targeted attacks are not one-off attempts. Attackers continually try to get inside the target’s network.\nThe IXESHE campaign has been actively staging targeted attacks since at least July of 2009.\n•\tVictims\tand\tTargets\nAPT campaigns target specific industries or communities of interest in specific regions.\nIXESHE has been found to target electronics manufacturers, a German telecommunications company, and East Asian governments.\n•\tOperations\nFirst-stage computer intrusions often use social engineering. Attackers custom-fit attacks to their targets.\nIXESHE attacks used custom-fit targeted emails with PDF exploits for CVE-2009-4324, CVE-2009-0927 , CVE-2011-0609,  and CVE-2011-0611.  These \nwere used to drop malicious executable files that gave the attackers complete control of their targets’ systems.\nThe attackers used either dynamic Domain Name System (DNS) or compromised servers hosted on networks that they previously successfully  \ninfiltrated.\n•\tPossible\tIndicators\tof\tCompromise\nAttackers want to remain undetected as long as possible. A key characteristic of these attacks is stealth.\n »Enters networks via a specially crafted, targeted email with a malicious file attachment\n »Uses document exploits (primarily PDF exploits) to drop malware onto target systems\n »Uses malware detected as IXESHE by security companies\n »Sends a GET request to the command-and-control (C&C) server with the format:\nhttp://[C&C Server]/[ACD] [EW]S[Some Numbers].jsp?[Encrypted Base64 Blob]\n* The campaign codes we have seen so far are detailed in the Trend Micro research paper, “IXESHE: An APT Campaign.” The characteristics \n highlighted in this APT campaign quick profile reflect the results of our investigation as of May 2012.PAGE 19 | iXESHE©2012 by Trend Micro, Incorporated. All rights reserved. Trend Micro and the Trend Micro t-ball logo are trademarks or registered trademarks of Trend Micro, Incorporated. All other product or company \nnames may be trademarks or registered trademarks of their owners.TREND\tMICRO™\nTrend Micro Incorporated (TYO: 4704; TSE: 4704), a global cloud security \nleader, creates a world safe for exchanging digital information with its In -\nternet content security and threat management solutions for businesses \nand consumers. A pioneer in server security with over  \n20 years’ experience, we deliver top-ranked client, server and cloud-\nbased security that fits our customers’ and partners’ needs, stops \nnew threats faster, and protects data in physical, virtualized and cloud \nenvironments. Powered by the industry-leading Trend Micro™ Smart Pro -\ntection Network™ cloud computing security infrastructure, our products \nand services stop threats where they emerge—from the Internet. They are \nsupported by 1,000+ threat intelligence experts around the globe.\nTREND\tMICRO\tINC.\n10101\tN.\tDe\tAnza\tBlvd.\nCupertino,\tCA\t95014\nU.S.\ttoll\tfree:  1 +800.228.5651\nPhone:  1 +408.257.1500\nFax: 1 +408.257.2003\nwww.trendmicro.com\n"
}