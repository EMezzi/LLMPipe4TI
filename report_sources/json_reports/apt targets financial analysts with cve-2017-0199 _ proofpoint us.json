{
    "title": "apt targets financial analysts with cve-2017-0199 _ proofpoint us",
    "text": "About Threat Center Products Resources Connect\nSupport\n/Blog /Threat Insight /APT Targets Financial Analysts with CVE-2017-0199\nAPRIL 27, 2017  | AXEL F\nOn April 20, Proofpoint observed a targeted campaign focused on financial analysts working at top global financial firms operating in Russia\nand neighboring countries. These analysts were linked by their coverage of the telecommunications industry, making this targeting very\nsimilar to, and likely a continuation of, activity described in our “ In Pursuit of Optical Fibers and Troop Intel ” blog. This time, however,\nattackers opportunistically used spear-phishing  emails with a Microsoft Word attachment exploiting the recently patched CVE-2017-0199  to\ndeploy the ZeroT Trojan , which in turn downloaded the PlugX Remote Access Trojan (RAT).\nProofpoint is tracking this attacker, believed to operate out of China, as TA459. The actor typically targets Central Asian countries, Russia,\nBelarus, Mongolia, and others. TA549 possesses a diverse malware  arsenal including PlugX, NetTraveler, and ZeroT. [1][2][3]\nIn this blog, we also document other 2017 activity so far by this attack group, including their distribution of ZeroT malware and secondary\npayloads PCrat/Gh0st.\nAnalysis\nIn this campaign, attackers used a Microsoft Word document called 0721.doc, which exploits CVE-2017-0199. This vulnerability was\ndisclosed and patched days prior to this attack.\n \nFigure 1: Microsoft Word document 0721.doc\nThe document uses the logic flaw to first download the file power.rtf from hxxp://122.9.52[.]215/news/power.rtf. The payload is actually an\nHTML Application (HTA) file, not an RTF document.\nFigure 2: The first script downloaded by the exploit document is an HTA file\nAs shown in the figure above, the HTA’s VBScript changes the window size and location and then uses PowerShell to download yet another\nscript: power.ps1. This is a PowerShell script that downloads and runs the ZeroT payload cgi.exe.\nFigure 3: The second script downloaded by the exploit document is a PowerShell script\nFigure 4: Combined network traffic showing the document downloading its payloads\nZeroT and other payloads\nThe attack group has made incremental changes to ZeroT since our last analysis. While they still use RAR SFX format for the initial\npayloads, ZeroT now uses a the legitimate McAfee utility (SHA256\n3124fcb79da0bdf9d0d1995e37b06f7929d83c1c4b60e38c104743be71170efe) named mcut.exe instead of the Norman Safeground AS\nfor sideloading as they have in the past. The encrypted ZeroT payload, named Mctl.mui, is decoded in memory revealing a similarly\ntampered PE header and only slightly modified code when compared to ZeroT payloads we analyzed previously.\nOnce ZeroT is running, we observed that the fake User-Agent used in the requests changed from “Mozilla/6.0 (compatible; MSIE 10.0;\nWindows NT 6.2; Tzcdrnt/6.0)” to “Mozilla/6.0 (compatible; MSIE 11.0; Windows NT 6.2)”, thus removing the “Tzcdrnt” typo observed in\nprevious versions. The initial beacon to index.php changed to index.txt but ZeroT still expects an RC4-encrypted response using a static key:\n“(*^GF(9042&*”.\nFigure 5: ZeroT initial beacon over HTTP requesting URL configuration\nNext, ZeroT uses HTTP beacons to transmit information about the infected system to the command and control (C&C). All posts are\nencrypted, unlike the last time we analyzed a sample from this actor, when the first POST was accidentally not encrypted. After that, stage 2\npayloads are still retrieved as Bitmap (BMP) images that use Least Significant Bit (LSB) Steganography  to hide the real payloads. These\nimages appear normal in image viewers.\n \nFigure 6: Collage of example BMP images containing stage 2 payloads hidden using LSB steganography\nThe stage 2 payload was PlugX that beaconed to C&C servers www[.]icefirebest[.]com and www[.]icekkk[.]net.\nFigure 7: ZeroT and PlugX HTTP network activity\nAdditional 2017 activity by TA459\nThroughout 2017 we observed this threat actor actively attempting to compromise victims with various malware payloads. ZeroT remained\nthe primary stage 1 payload, but the stage 2 payloads varied. One such interesting example was “ПЛАН РЕАЛИЗАЦИИ ПРОЕКТА.rar”\n(SHA256 b5c208e4fb8ba255883f771d384ca85566c7be8adcf5c87114a62efb53b73fda).  Translated from Russian, this file is named\n“PROJECT REALIZATION PLAN” and contains a compressed .scr executable. This ZeroT executable communicated with the C&C domain\nwww[.]kz-info[.]net and downloaded PlugX as well as an additional PCRat/Gh0st Trojan which communicated with the www[.]ruvim[.]net C&C\nserver. PCRat/Gh0st is a payload that we do not see this group using frequently.\nAnother interesting ZeroT sample (SHA256 bc2246813d7267608e1a80a04dac32da9115a15b1550b0c4842b9d6e2e7de374) contained\nthe executable 0228.exe and a decoy document 0228.doc in the RAR SFX archive. Bundling decoy documents is a common tactic by this\ngroup. RAR SFX directives are used to display the decoy while the malicious payload is executed. We suspect that this specific lure was\ncopied from the news article hxxp://www.cis.minsk[.]by/news.php?id=7557. This article was about “73-го заседания Экономического\nсовета СНГ”, translated from Russian as “73rd meeting of the CIS Economic Council”, which describes a meeting held in Moscow by the\nCommonwealth of Independent States (CIS) countries, an organization that includes nine out of the fifteen former Soviet Republics.\nFigure 8: Decoy document\nFigure 9: The believed source of the text in decoy document\nConclusion\nTA459 is well-known for targeting organizations in Russia and neighboring countries. However, their strategy, tactics, techniques, and\nprocedures in this particular attack emphasize the importance of rigorous patching regimens for all organizations. Even as software\nvulnerabilities often take a back seat to human exploits and social engineering, robust defenses must include protection at the email\ngateway, proactive patch management, and thoughtful end user education. Paying attention to the details of past attacks is also an important\nmeans of preparing for future attacks. Noting who is targeted, with what malware, and with what types of lures provide clues with which\norganizations can improve their security posture.\nAt the same time, multinational organizations like the financial services firms targeted here must be acutely aware of the threats from state-\nsponsored actors working with sophisticated malware to compromise users and networks. Ongoing activity from attack groups like TA459\nwho consistently target individuals specializing in particular areas of research and expertise further complicate an already difficult security\nsituation for organizations dealing with more traditional malware threats, phishing  campaigns, and socially engineered threats every day.\nReferences\n[1]https://www.proofpoint.com/us/threat-insight/post/PlugX-in-Russia\n[3]https://www.proofpoint.com/us/threat-insight/post/nettraveler-apt-targets-russian-european-interests\n[3]https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx\n \nIndicators of Compromise (IOCs)\nIOC IOC Type Description\na64ea888d412fd406392985358a489955b0f7b27da70ff604e827df86d2ca2aa SHA256 0721.doc CVE-2017-0199\nhxxp://122.9.52[.]215/news/power.rtf URL 0721.doc payload\nhxxp://122.9.52[.]215/news/power.ps1 URL 0721.doc payload\nhxxp://www.firesyst[.]net/info/net/sports/drag/cgi.exe URL 0721.doc payload\nbf4b88e42a406aa83def0942207c8358efb880b18928e41d60a2dc59a59973ba SHA256 ZeroT (cgi.exe)\nwww.firesyst[.]net Hostname ZeroT C&C\nwww.icekkk[.]net Hostname PlugX C&C\n \nIndicators of Compromise (IOCs) - Related\nIOC IOC Type Description\nwww.kz-info[.]net Hostname ZeroT C&C\nwww.firesyst[.]net Hostname ZeroT C&C\nwww.buleray[.]net Hostname ZeroT C&C\nwww.intersu[.]net Hostname ZeroT C&C\n868ee879ca843349bfa3d200f858654656ec3c8128113813cd7e481a37dcc61a SHA256 ZeroT\n4601133e94c4bc74916a9d96a5bc27cc3125cdc0be7225b2c7d4047f8506b3aa SHA256 ZeroT\n5fd61793d498a395861fa263e4438183a3c4e6f1e4f098ac6e97c9d0911327bf SHA256 ZeroT\nb5c208e4fb8ba255883f771d384ca85566c7be8adcf5c87114a62efb53b73fda SHA256 ZeroT\nab4cbfb1468dd6b0f09f6e74ac7f0d31a001d396d8d03f01bceb2e7c917cf565 SHA256 ZeroT\n79bd109dc7c35f45b781978436a6c2b98a5df659d09dee658c2daa4f1984a04e SHA256 ZeroT\nwww.icekkk[.]net Hostname PlugX C&C\nwww.icefirebest[.]com Hostname PlugX C&C\nwww.ruvim[.]net Hostname PlugX C&C\n \n \nET and ETPRO Suricata/Snort Coverage\n2821028 | ETPRO TROJAN APT.ZeroT CnC Beacon HTTP POST\n2825365 | ETPRO TROJAN APT.ZeroT CnC Beacon Fake User-Agent\n2824641 | ETPRO TROJAN APT.ZeroT Receiving Config\n2810326 | ETPRO TROJAN PlugX Related Checkin\n2024196 | ET WEB_CLIENT HTA File containing Wscript.Shell Call - Potential Office Exploit Attempt\n2024197 | ET CURRENT_EVENTS SUSPICIOUS MSXMLHTTP DL of HTA (Observed in RTF 0-day )\n2016922 | ET TROJAN Backdoor family PCRat/Gh0st CnC traffic\n2021716 | ET TROJAN Backdoor family PCRat/Gh0st CnC traffic (OUTBOUND) 102\n \nOverview\nWhy Proofpoint\nCareers\nLeadership Team\nNews Center\nInvestors CenterLatest Threat Report\nHuman Factor Report\nThreat Glossary\nThreat Blog\nDaily RulesetEmail Protection\nAdvanced Threat Protection\nSecurity Awareness Training\nCloud App Security\nArchive & Compliance\nInformation Protection\nDigital Risk Protection\nProduct Bundles\nNexus PlatformWhitepapers\nWebinars\nDatasheets\nEvents\nCustomer Stories\nBlog\nFree Trial+1-408-517-4710\nContact Us\nOffice Locations\nRequest a Demo\nSupport Login\nSupport Services\nIP Address Blocked?\n   © 2020. All rights reserved. Terms and conditions  Privacy Policy  Sitemap\n \nAPT Targets Financial Analysts with CVE-2017-\n0199Continua a vedere i contenuti per la tua posizione Continua United States\nProducts Solutions Partners Resources CompanyCONTACT LOGIN\n "
}