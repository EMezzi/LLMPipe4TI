{
    "title": "puttering into the future…",
    "text": "Puttering into the Future…\nThreatVector  > Spotlight Share It:\n by Jon Gross   and  Jim Walter  | January 12, 2016\nCyber-espionage has steadily migrated from a world of shadowy closed-door government\nplayers into the public spotlight over the past three years. Mandiant’s APT1 report was the\nfirst to change the game, and paved the way for private security companies to expose\nadvanced threat actors en masse. In the years since, both private security companies and\nmedia organizations alike have sought to capitalize on this craze. What is often neglected is\nreporting on the aftermath of such exposure, and what measures the attackers take to remain\nhidden, ready to strike again.\nVery few reports offer follow-ups to what transpires after an attacker is completely pushed out\nof an environment. If they did, those reports would most likely paint a much bleaker picture of\nthe cyberthreat landscape. The truth is most companies are never aware they’ve been\nbreached again, even if they are hit multiple times after the initial attack. The truth is that\nintelligent attackers with long-term surveillance goals do not simply give up after their\nmalware and command and control (C2) infrastructure is burned. Attackers typically redesign\nC2 infrastructure and deploy entirely new or updated malware after being exposed. Unless\ncompanies are well positioned to detect these changes, attackers will quietly slip back in time\nand time again.\nAt Cylance, we’ve become more interested in following the repercussions of public exposure of\nso-called advanced threat groups and malware, since this tends to be the new operational\nnorm for security companies. While it’s generally accepted that any exposure of coordinated\ncyber-espionage is a good thing, we believe it's not clear enough yet whether all the additional\npublic attention is assisting or hindering cyber defenders. Intelligent attackers will adapt,\nmodify tactics, and bolster their operational security in order to survive. We will err on the side\nof “it's generally better to know more than less”, and will continue to explore the ramifications\nof public research to attacker activity over the months to come.\nIn 2014, our colleagues at Crowdstrike wrote an exposé about a long-standing Chinese APT\nthreat group they self-named Putter Panda, which Mandiant/FireEye refers to as APT2. This\nthreat group has been around for quite a while, and commonly operated tangentially to APT1\nintrusions into defense contractors and aerospace companies. We've been tracking a series of\nexploit documents which, upon successful exploitation, simply drop a file and perform no other\nactions; these documents have dropped a variety of backdoors associated with a range of\npreviously identified threat groups. One of them was of particular interest because we'd never\nseen the backdoor before and it leveraged a relatively unique German dynamic DNS provider\nfor command and control.\nThe exploit document was targeted at a Russian speaker with the title \" Гасий  Константин\nВасильевич .doc\", which roughly translates as “Gasy Konstantin”, which seems to be\nsomeone’s name. The document itself was a MIME-encoded HTML file which contained a\nbase64-encoded word document as well as an appended XOR-encoded executable. The\ndocument exploited CVE-2012-0158 and will decode and write an executable to disk upon\ninfection. The executable began at offset 0x9C50 in the MIME-document and used an\nencoding mechanism that consisted of an incrementing XOR key, starting at byte 0xAC\ncombined with an additional XOR operation against the byte 0x28, which ultimately yields a\nunique 256-byte XOR key. \nDocument Details:\nFilename: Гасий  Константин  Васильевич .doc\nSHA256:\n333061e6c4847aa72d3ba241c1df39aa41ce317a3d2898d3d13a5b6eccffc6d9\nFile Size: 105,552 Bytes\nAuthor: User123\nUpon successful exploitation, the backdoor is dropped to \"%USERPROFILE%\\Start\nMenu\\Programs\\Startup\\time.exe\" . No other changes to the file system or registry are made.\nThis method achieves persistence but the backdoor will not execute until the user logs off and\nback into the machine. This functionality alone can assist in the evasion of certain\nsandbox/dynamic analysis systems. Unless a live human can intervene in the sandboxing\nprocess, it would be impossible to observe the post-logoff behavior.\nBackdoor Details:\nFilename: %USERPROFILE%\\Start Menu\\Programs\\Startup\\time.exe\nFile Size: 40,960 Bytes\nSHA256:\n523AD50B498BFB5AB688D9B1958C8058F905B634BEFC65E96F9F947E40893E5B\nCompile Time: 6/2/2015 7:21:08 UTC\nFilename: Reappraisal_of_India_Tibet_Policy.doc\nSHA256:\n8d98155283c4d8373d2cf2c7b8a79302251a0ce76d227a8a2abdc2a244fc550e\nFile Size: 71680 bytes\nAuthor: User\nFilename: %temp%/kav.exe [2]\nFile Size: 18944 bytes\nSHA256:\n3d9bd26f5bd5401efa17690357f40054a3d7b438ce8c91367dbf469f0d9bd520\nCompile Time: 3/7/2014 06:38:37 UTC\nThe above sample (kav.exe/wizard.exe) leverages sys.firewall-gateway.net  for C2.\nThe German dynamic DNS provider supplies a number of free secondary domains\nfor public use that network defenders should be on the lookout for , including:\n*.firewall-gateway.com\n*.firewall-gateway.de\n*.firewall-gateway.net\n*.kustomize.de\n*.medical-dns.de\n*.myfirewall.org\n*.my-firewall.org\n*.my-gateway.de\n*.my-router.de\n*.pptp.de\n*.spdns.de\n*.spdns.eu\n*.spdns.org\n*.spnoc.de\nCurrent dynamic command and control infrastructure for these campaigns rely\nheavily upon the following domains and IP addresses:\nDomains:\naccounts-google.firewall-gateway.com\nadmin.spdns.org\ncreatnimei.dyndns-wiki.com\ndetail43.myfirewall.org\ndocs.google.com.publicvm.com\neconomy.spdns.de\neconomy.spdns.eu\nextension.spdns.org\nfirefox.spdns.de\nfirewallupdate.firewall-gateway.net\nintersecurity.firewall-gateway.com\njdk.spdns.eu\nkaspersky.firewall-gateway.net\nkissecurity.firewall-gateway.net\nnews.firewall-gateway.com\nopero.spdns.org\nsys.firewall-gateway.com\nsys.firewall-gateway.net\ntally.myfirewall.org\nzuni.spdns.org\nIP Addresses:\n78.129.252.159\n87.117.229.26\n109.169.86.25\nConclusion\nIt’s dangerous to develop a sense of “research malaise” when approaching piles of\nsamples and the seemingly endless supply of malware we see and tear apart\nevery day. Our many investigations have made us well aware that many regional\nthreat actors employ, share, and recycle tools, techniques, and other identifiable\nbits of their tradecraft. Whether we refer to them as furry animals, numerals, or\nany other moniker, our investigations revealed a great deal of repetition. That\nbeing said, we know we must continue to be vigilant, considering the alarming fact\nthat many of these known, familiar, and old techniques are still highly successful.\nWell-documented exploits from 2012 and 2013 are still working very effectively\nfor these actors. Many of these antiquated exploits are still being used to deliver\nmalware that is 100% undetected by the current AV industry, even though that\nindustry continues to pat itself on the back for a job well done.\nOne of the goals of Cylance’s SPEAR Team ™ is to break down these “old” threats,\nreveal continued exposure to them, and demonstrate the value of thinking about\ncountermeasures in a new way.\nNOTE: These samples presented no problem for CylancePROTECT®:\nBelieve the math!!\n[1]\nhttp://community.websense.com/blogs/securitylabs/archive/2013/08/15/tibetan-\ncompromise.aspx\n[2] Variations named “wizard.exe” are also commonly observed\nThe backdoor utilizes a few simple checks to ensure that Kaspersky products are not\ninstalled on the system , via a simple registry check looking for the key\n\"HKLM\\Software\\KasperskyLab\" , as well as scanning running processes for a process\nnamed \"avp.exe\".\nIf both checks pass, the backdoor calls the API function SetTimer with a 10 second\ntimeout. Once the timer elapses , a notification function is called. This notification\nfunction kills the timer and calls CreateThread with the start address of the backdoor\ncode. The backdoor code is initially obfuscated by a single byte XOR against 0x61 where\nevery even byte is skipped; control is then transferred to the second stage, which\ndecrypts itself further using a single byte XOR with 0xB1. The backdoor will create an\nevent named \"Mi++(:v\" and communicates to \"aa123.spdns.de\" on TCP port 8083.  \nAt the time of this report , aa123.spdns.de resolved to \"192.253.253.22\". The backdoor\nappears to use its own custom binary protocol that begins with 128 bytes of data, which\nis further padded with 0x00's. Additional analysis into the protocol is ongoing.  \nA sample packet is presented below:\n00000000  83 b2 68 0a 0a 19 3e 0b  d0 44 91 41 3d 3d a4 16 ..h...>. .D.A==..\n00000010  89 b1 a0 96 32 73 02 ca  01 aa 84 a0 c2 37 35 1e ....2s.. .....75.\n00000020  d6 3a 90 20 f0 1e e0 cf  4a 15 4b 2b 9b 68 67 25 .:. .... J.K+.hg%\n00000030  87 35 f7 5e 86 fa 0b 05  8f 8e b2 c4 3a 9d 1e 88 .5.^.... ....:...\n00000040  48 bf 4e 86 d8 1e 6b 1f  18 96 0f 60 3f 9e a1 d3 H.N...k. ...`?...\n00000050  9d f4 80 9a b3 fd 6f 97  ce b0 f7 e9 ab a7 60 96 ......o. ......`.\n00000060  81 68 47 ff a5 0b 68 b8  af 29 9b 46 54 dd 49 0c .hG...h. .).FT.I.\n00000070  28 32 91 a2 21 b9 63 72  9b 94 d6 27 24 4c dc 91 (2..!.cr ...'$L..\n00000080  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00 ........ ........\n00000090  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00 ........ ........\n000000A0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00 ........ ........\n000000B0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00 ........ ........\n000000C0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00 ........ ........\n000000D0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00 ........ ........\n000000E0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00 ........ ........\n000000F0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00 ........ ........\n00000100  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00 ........ ........\n---Truncated---\nAlso of interest is the fact that this and similar backdoors currently have zero detection\nby current anti virus vendors. This was verified recently a second time as we were\nreviewing the research in January 2016.\nIn addition, of particular note is the fact one Chinese AV firm briefly detected this sample\nwhen it was rescanned on July 14, 2015, and quickly corrected that detection by July\n21st, behaving as if it were a false detection. As the investigation continued, we were\nable to identify more publically available backdoors of the same type.\nBackdoor Details:\nFilename: %USERPROFILE%\\Start Menu\\Programs\\Startup\\time.exe\nFile Size: 40,960 Bytes\nSHA256:\nA569F3B02A4BE99E0B4A9F1CFF43115DA803F0660DD4DF114B624316F3F63DC6\nCompile Time: 5/18/2015 8:11:57 UTC\nAlthough compiled earlier in time, this file\n(A569F3B02A4BE99E0B4A9F1CFF43115DA803F0660DD4DF114B624316F3F63DC6)\nis virtually identical from a functionality perspective. It used the byte 0x4D to XOR\ndecode the second stage of malicious code and was configured to beacon to\nopero.spdns.org and firefox.spdns.de. Also of slight difference was the event it created ,\nwhich was named \"ZFhyBPk\".  \nTies to Tibet-Themed Watering Hole Campaign\nVery similar behavior (in terms of the first few stages of attack) can be observed in\npreviously analyzed attacks [1]which center on pro-Tibet and other Tibetan-related\ntargets. The campaigns are also linked by C2 servers (largely *.firewall-gateway.com\nand *.myfirewall.org) and by the post-exploitation behavior of the installed tools.\nExample:\nDocument Details:\nBackdoor Details:\nThreat ResearchShare It:\nJon Gross\nJon Gross is the Director of Threat Intelligence at Cylance.\nAuthor's Bio\nJim Walter\nJim Walter is a Senior Security Researcher at Cylance.\nAuthor's BioGet the ThreatVector Newsletter\nEnter your email address Subscribe\n400 Spectrum Center Dr., Suite #900\nIrvine, CA 92618\n1-844-CYLANCE\n1-844-295-2623\n©2019 BlackBerry Limited.\nAll rights reservedBlog\nHome\nNews Bites\nVideos\nResources\nCylance News\nWebcasts\nPodcasts\nContributorsCompany\nWho We Are\nResource Center\nCylance News\nPress Releases\nPrivacy Notice\nTerms of ServiceProducts\nCylancePROTECT\nCylanceOPTICS\nCylance ThreatZERO\nCylance Smart Antivirus\nServices\nConsulting Overview\nIndustry OverviewAbout The Author\n| Research & Intel Videos Webcasts Podcasts News Resources Cylance.com\nWe use cookies to provide you a relevant user experience, analyze our traffic, and provide social media features. Read More Got it\n "
}