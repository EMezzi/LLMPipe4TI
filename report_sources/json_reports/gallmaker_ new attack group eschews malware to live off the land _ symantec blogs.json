{
    "title": "gallmaker_ new attack group eschews malware to live off the land _ symantec blogs",
    "text": "Symantec's Enterprise Security business will now operate as the Symantec Enterprise division of Broadcom. Click for details.\n\nCritical Attack\nDiscovery and\nIntelligence Team\nSymantec\n\n\n SUBSCRIBE\nGallmaker: New Attack Group Eschews\nMalware to Live off the Land\nA new attack group is targeting government, military, and defense sectors in\nwhat appears to be a classic espionage campaign.\nUPDATE October 11, 2018\nThis blog has been updated with a revised list of IoCs. An earlier list of IOCs attached to this blog was generated through an\nautomated system and, due to the dual-use nature of the tools used by the group, erroneously included some low fidelity\nIoCs.\nSymantec researchers have uncovered a previously unknown attack group that is targeting government and military\ntargets, including several overseas embassies of an Eastern European country, and military and defense targets in the\nMiddle East. This group eschews custom malware and uses living off the land (LotL) tactics and publicly available hack\ntools to carry out activities that bear all the hallmarks of a cyber espionage campaign.\n\"#Gallmaker eschews custom malware, uses living off the land and publicly available hack\ntools https://symc.ly/2RBkaR8\"\nCLICK TO TWEET\nThe group, which we have given the name Gallmaker, has been operating since at least December 2017, with its most\nrecent activity observed in June 2018.\nTactics and tools\nThe most interesting aspect of Gallmaker’s approach is that the group doesn’t use malware in its operations.  Rather, the\nattack activity we observed is carried out exclusively using LotL tactics and publicly available hack tools. The group takes\na number of steps to gain access to a victim’s device and then deploys several different attack tools, as follows:\n1. The group delivers a malicious Office lure document to victims, most likely via a spear-phishing email.\n2. These lure documents use titles with government, military, and diplomatic themes, and the file names are written in\nEnglish or Cyrillic languages. These documents are not very sophisticated, but evidence of infections shows that\nthey’re effective. The attackers use filenames that would be of interest to a variety of targets in Eastern Europe,\nincluding:\nbg embassy list.docx\nNavy.ro members list.docx\n3. These lure documents attempt to exploit the Microsoft Office Dynamic Data Exchange (DDE) protocol in order to\ngain access to victim machines. When the victim opens the lure document, a warning appears asking victims to\n“enable content” (See Figure 1) . Should a user enable this content, the attackers are then able to use the DDE\nprotocol to remotely execute commands in memory on the victim’s system. By running solely in memory, the\nattackers avoid leaving artifacts on disk, which makes their activities difficult to detect.\n4. Once the Gallmaker attackers gain access to a device, they execute various tools, including:\nWindowsRoamingToolsTask: Used to schedule PowerShell scripts and tasks.\nA \"reverse_tcp\" payload from Metasploit: The attackers use obfuscated shellcode that is executed via PowerShell to\ndownload this reverse shell.\nA legitimate version of the WinZip console: This creates a task to execute commands and communicate with the\ncommand-and-control (C&C) server. It’s likely this WinZip console is used to archive data, probably for exfiltration.\nThe Rex PowerShell library, which is publicly available on GitHub, is also seen on victim machines. This library helps\ncreate and manipulate PowerShell scripts for use with Metasploit exploits. \nGallmaker is using three primary IP addresses for its C&C infrastructure to communicate with infected devices. There is\nalso evidence that it is deleting some of its tools from victim machines once it is finished, to hide traces of its activity.\nFigure 1. An example of the type of warning displayed by the lure document\nThe DDE protocol can be used for legitimate purposes to send messages between Microsoft applications that share data\nthrough shared memory, e.g. to share data between Excel and Word. \nHowever, the DDE protocol was flagged as unsecure last year , when researchers discovered it could be exploited to\nexecute code on victim machines via Excel and Word, without macros being enabled in those applications. Microsoft said\nat the time that this capability was a feature and the company did not consider it a vulnerability  because Office always\nwarned users before enabling DDE in documents, as seen in Figure 1. However, after the DDE protocol was subsequently\nexploited in a number of malware campaigns, Microsoft issued an update to Office in December 2017 that disabled DDE\nby default in Word and Excel . DDE can be enabled manually after this update is applied but only if the registry is altered\nby an admin account.\nThe Gallmaker victims we have seen did not have this patch installed and therefore were still vulnerable to exploit via\nthe DDE protocol.\nTargets and timeline\nGallmaker’s activity appears to be highly targeted, with its victims all related to government, military, or defense sectors.\nSeveral targets are embassies of an Eastern European country. The targeted embassies are located in a number of\ndifferent regions globally, but all have the same home country.\nThe other targets we have seen are a Middle Eastern defense contractor and a military organization. There are no\nobvious links between the Eastern European and Middle Eastern targets, but it is clear that Gallmaker is specifically\ntargeting the defense, military, and government sectors: its targets appear unlikely to be random or accidental.\nGallmaker’s activity has been quite consistent since we started tracking it. The group has carried out attacks most\nmonths since December 2017. Its activity subsequently increased in the second quarter of 2018, with a particular spike in\nApril 2018.\nFigure 2. Gallmaker activity, December 2017 to June 2018\nGallmaker’s activity points strongly to it being a cyber espionage campaign, likely carried out by a state-sponsored group.\nHow did we discover Gallmaker?\nThe fact that Gallmaker appears to rely exclusively on LotL tactics and publicly available hack tools makes its activities\nextremely hard to detect. We have written extensively about the increasing use of LotL tools  and publicly available hack\ntools by cyber criminals. One of the primary reasons for the increased popularity of these kinds of tools is to avoid\ndetection; attackers are hoping to “hide in plain sight”, with their malicious activity hidden in a sea of legitimate\nprocesses.\nGallmaker may well have continued to avoid detection were it not for Symantec’s Targeted Attack Analytics (TAA)\ntechnology. TAA combines the capabilities of Symantec’s world-leading security experts with advanced artificial\nintelligence and machine learning to provide organizations with their own “virtual analysts”, via our Advanced Threat\nProtection (ATP) product.  Since its inception, TAA has detected security incidents at thousands of organizations,\nautomating what would have taken many hours of analyst time. In this instance, TAA identified the specific PowerShell\ncommands used by Gallmaker as being suspicious, leading to the discovery of this new campaign.  Without TAA’s\nadvanced AI-based capabilities, Gallmaker’s activities may well have remained undetected.\nProtection\nThe following protections are in place to protect customers against Gallmaker attacks:\nSystem Infected: Meterpreter Reverse TCP\nW97M.Downloader\nNetwork protection products also detect activity associated with Gallmaker.\nIndicators of Compromise\nThe following indicators are specific to Gallmaker:\nNetwork\n111[.]90.149.99/o2\n94[.]140.116.124/o2\n94[.]140.116.231/o2\nFilenames\nbg embassy list.docx\nNavy.ro members list.docx\nБГ в чуждите  медии  23.03.2018-1.docx\n[REDACTED] and cae join forces to develop integrated live virtual constructive training solutions.docx\nА-9237-18-brasil.docx\nGallmaker also used tools that were available in open source projects. Yara rule and methods shared below were used by\nGallmaker but aren't exclusive to the group's activity. Detection of these in one's environment is only indicative of\npossible unauthorized activity. Each occurrence of triggers must be examined to determine intent.\nrule Suspicious_docx\n{\nmeta:\ncopyright = \"Symantec\"\nfamily = \"Suspicious DOCX”\ngroup = \"Gallmaker\"\ndescription = \"Suspicious file that might be Gallmaker”\nstrings:\n$quote = /<w:fldSimple w:instr=\" QUOTE (( [^\"]+)* [0-9]\n{2,3}\n)\n{4}\n/\n$text = \"select \\\"Update field\\\" and click \\\"OK\\\"\"\ncondition:\nany of them\n}\nUse of Rex Powershell - https://github.com/rapid7/rex-powershell\nUse of obfuscated shellcode executed via PowerShell to download a \"reverse_tcp\" payload from Metasploit\nonto victim systems. For example, msfvenom -p windows/meterpreter/reverse_tcp -o payload.bin\nFurther reading\nTo find out more about TAA, read our whitepaper: Targeted Attack Analytics: Using Cloud-based Artificial Intelligence for\nEnterprise-Focused Advanced Threat Protection .SHAREPOSTED: 10 OCT, 2018 6 MIN READ THREAT INTELLIGENCE\nGallmaker may well have continued to avoid detection were it not\nfor Symantec’s Targeted Attack Analytics (TAA) technology.“\nAbout the Author\nBlogs Threat Intelligence/ Menu\n "
}